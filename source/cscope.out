cscope 15 /Volumes/All/Global/Code/Macaulay/Now/source/C23               0000433934
	@array.c

4 
	~"sh¬ed.h
"

5 
	~"¬¿y.h
"

6 
	~"¡ash.h
"

7 
	~"mÚ™Ü.h
"

10 
¡©ic_as£¹
((*) == 8, "64-bit system„equired");

13 *
	g¬¿y_¡ash
;

15 
	$¬¿y_š™
()

17 
¬¿y_¡ash
 = 
	`İ’_¡ash
(
NARRAY
 + (
¦ab»c
 *), "arrays");

18 
	}
}

20 
	$š™_¬¿y
(
¬¿y
 *
a
, 
–em’t_size
)

22 
a
->
Ën
 = 0;

23 
a
->
size
 = 
–em’t_size
;

24 
a
->
–ems
 = 
nuÎ±r
;

25 ià(
–em’t_size
 == 0)

26 
a
->
v®_size
 = 
NARRAY
;

28 
a
->
v®_size
 = (
NARRAY
 / 
–em’t_size
) *ƒlement_size;

29 
	}
}

31 
	$ä“_¬¿y
(
¬¿y
 *
a
)

33 
¦ab
 *
p
 = 
a
->
–ems
;

34 
¦ab
 *
‹mp
;

36 
p
 !ğ
nuÎ±r
)

38 
‹mp
 = 
p
;

39 
p
 =…->
Ãxt
;

40 
	`ä“_¦ug
((
¡ash
 *)
¬¿y_¡ash
, (
¦ug
 *)
‹mp
);

42 
	`š™_¬¿y
(
a
, 0);

43 
	}
}

45 
	$Ëngth
(
¬¿y
 *
a
)

47  
a
->
Ën
;

48 
	}
}

50 *
	$»f
(
¬¿y
 *
a
, 
i
)

52 
¦ab
 *
p
 = 
a
->
–ems
;

53 
wh”e
 = (
a
->
size
è* (
i
 - 1);

54 
Ç¼ay
 = 
a
->
v®_size
;

56 ià((
i
 <ğ0è|| (˜> 
a
->
Ën
))

58 
	`´”rÜ
(";internalƒrror:‡rray„ef out of bounds: index = ");

59 
	`´”rÜ
("%d,†’ = %d , sizğ%d\n", 
i
, 
a
->
Ën
,‡->
size
);

60  
nuÎ±r
;

62 
wh”e
 >ğ
Ç¼ay
)

64 
wh”e
 -ğ
Ç¼ay
;

65 
p
 =…->
Ãxt
;

67  &(
p
->
v®s
[
wh”e
]);

68 
	}
}

70 *
	$šs_¬¿y
(
¬¿y
 *
a
)

72 
¦ab
 *
p
;

73 
wh”e
;

74 
Ç¼ay
 = 
a
->
v®_size
;

76 ià(
a
->
Ën
 == 0)

78 
p
 = (
¦ab
 *)(*)
	`g‘_¦ug
((
¡ash
 *)
¬¿y_¡ash
);

79 
p
->
Ãxt
 = 
nuÎ±r
;

80 
a
->
–ems
 = 
p
;

81 
wh”e
 = 0;

85 
p
 = 
a
->
–ems
;

86 
wh”e
 = (
a
->
size
è* (a->
Ën
);

87 
wh”e
 >ğ
Ç¼ay
)

89 
wh”e
 -ğ
Ç¼ay
;

90 ià(
wh”e
 == 0)

92 
p
->
Ãxt
 = (
¦ab
 *)(*)
	`g‘_¦ug
((
¡ash
 *)
¬¿y_¡ash
);

93 
p
->
Ãxt
->Ãxˆğ
nuÎ±r
;

95 
p
 =…->
Ãxt
;

98 
a
->
Ën
++;

99  &(
p
->
v®s
[
wh”e
]);

100 
	}
}

	@array.h

5 
¬¿y_š™
();

6 
š™_¬¿y
(
¬¿y
 *
a
, 
–em’t_size
);

7 
ä“_¬¿y
(
¬¿y
 *
a
);

8 
Ëngth
(
¬¿y
 *
a
);

9 *
»f
(
¬¿y
 *
a
, 
i
);

10 *
šs_¬¿y
(
¬¿y
 *
a
);

13 *
¬¿y_¡ash
;

	@betti.c

4 
	~<¡dio.h
>

5 
	~"sh¬ed.h
"

6 
	~"b‘ti.h
"

7 
	~"v¬s.h
"

8 
	~"gm©rix.h
"

9 
	~"mÚ™Ü.h
"

10 
	~"¶i¡.h
"

11 
	~"cmds.h
"

12 
	~"sh–l.h
"

15 
cÚ¡ex´
 
	gRESSIZE
 = 20;

19 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
* 
g
, 
¬gc
, ** 
¬gv
, 
i
)

21 ià(
i
 >ğ
¬gc
)

22  
çl£
;

23 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

24  (*
g
 !ğ
NULL
);

25 
	}
}

27 
	$dl_ndeg
(
dli¡
* 
dl
, 
deg
)

29 
sum
 = 0;

30 
i
;

32 
i
 = 1; i <ğ
	`Ëngth
(
dl
); i++)

33 ià(
	`dli¡_»f
(
dl
, 
i
è=ğ
deg
)

34 
sum
++;

35  
sum
;

36 
	}
}

38 
	$»sLoHi
(
v
, * 
ResL’gth
, * 
lo
, * 
hi
, 
b‘ti
[])

40 
v¬ŸbË
* 
p
;

41 
»¦’
, 
l
, 
h
;

42 
gm©rix
 
M
;

44 
p
 = 
	`v»f
(
v
);

45 
»¦’
 = -1;

48 ià(
	`is_a_moduË
(
p
))

50 ià(
p
->
Çme
[0] != '0')

52 
M
 = 
	`v¬_g‘_moduË
(
p
);

53 ià(
»¦’
 == -1)

55 
»¦’
 = 0;

56 
	`dl_lohi
(&
M
->
deg»es
, 
lo
, 
hi
);

57 
b‘ti
[0] = 
	`Ëngth
(&
M
->
deg»es
);

59 ià(
	`ncŞs
(
M
) == 0)

61 
»¦’
++;

62 
b‘ti
[
»¦’
] = 
	`ncŞs
(
M
);

63 
	`dl_lohi
(&
M
->
degg’s
, &
l
, &
h
);

64 
l
 -ğ
»¦’
;

65 
h
 -ğ
»¦’
;

66 ià(
l
 < *
lo
)

67 *
lo
 = 
l
;

68 ià(
h
 > *
hi
)

69 *
hi
 = 
h
;

72 
v
++;

73 ià(
v
 > 
Ï¡_v¬
)

75 
p
 = 
	`v»f
(
v
);

76 } 
p
->
exi¡s
 =ğ
PARTVAR
);

77 *
ResL’gth
 = 
»¦’
;

78 
	}
}

80 
	$»sDeg
(
v
, 
deg
, 
b‘ti
[])

82 
v¬ŸbË
* 
p
;

83 
»¦’
;

84 
gm©rix
 
M
;

86 
p
 = 
	`v»f
(
v
);

87 
»¦’
 = -1;

90 ià(
	`is_a_moduË
(
p
))

92 ià(
p
->
Çme
[0] != '0')

94 
M
 = 
	`v¬_g‘_moduË
(
p
);

95 ià(
»¦’
 == -1)

97 
»¦’
 = 0;

98 
b‘ti
[0] = 
	`dl_ndeg
(&
M
->
deg»es
, 
deg
);

100 ià(
	`ncŞs
(
M
) == 0)

102 
»¦’
++;

103 
b‘ti
[
»¦’
] = 
	`dl_ndeg
(&
M
->
degg’s
, 
deg
 +„eslen);

106 
v
++;

107 ià(
v
 > 
Ï¡_v¬
)

109 
p
 = 
	`v»f
(
v
);

110 } 
p
->
exi¡s
 =ğ
PARTVAR
);

111 
	}
}

113 
	$b‘ti
(
FILE
* 
f
, 
v¬ŸbË
* 
p
)

115 
v
, 
i
, 
deg
;

116 
lo
, 
hi
, 
»¦’
;

117 
b‘ti
[
RESSIZE
];

119 
v
 = 
p
->
v¬_num
;

120 
	`»sLoHi
(
v
, &
»¦’
, &
lo
, &
hi
, 
b‘ti
);

122 
	`âewlše
(
f
);

123 
	`åršt
(
f
, "total: ");

124 
i
 = 0; i <ğ
»¦’
; i++)

125 
	`åršt
(
f
, "%5d ", 
b‘ti
[
i
]);

126 
	`åršt
(
f
, "\n");

128 
	`âewlše
(
f
);

129 
	`åršt
(
f
, "--------");

130 
i
 = 0; i <ğ
»¦’
; i++)

131 
	`åršt
(
f
, "------");

132 
	`åršt
(
f
, "\n");

134 
deg
 = 
lo
; deg <ğ
hi
; deg++)

136 
	`âewlše
(
f
);

137 
	`åršt
(
f
, "%5d: ", 
deg
);

138 
	`»sDeg
(
v
, 
deg
, 
b‘ti
);

139 
i
 = 0; i <ğ
»¦’
; i++)

140 ià(
b‘ti
[
i
] == 0)

141 
	`åršt
(
f
, " - ");

143 
	`åršt
(
f
, "%5d ", 
b‘ti
[
i
]);

144 
	`åršt
(
f
, "\n");

146 
	}
}

148 
	$b‘ti_cmd
(
¬gc
, * 
¬gv
[])

150 
v¬ŸbË
* 
p
;

152 ià(
¬gc
 != 2)

154 
	`´šŠew
("betti <res>\n");

157 
p
 = 
	`fšd_v¬
(
¬gv
[1]);

158 ià(
p
 =ğ
NULL
)

160 
	`b‘ti
(
outfe
, 
p
);

161 
	}
}

163 
	$nMÚoms
(
pŞy
 
f
)

165 
tÙ®
 = 0;

167 
f
 !ğ
NULL
)

169 
f
 = f->
Ãxt
;

170 
tÙ®
++;

172  
tÙ®
;

173 
	}
}

175 
	$¶_lohi
(
gm©rix
 
M
, 
¶i¡
* 
¶
, * 
lo
, * 
hi
)

177 
i
, 
d
;

179 ià(
	`Ëngth
(
¶
) == 0)

181 *
lo
 = 0;

182 *
hi
 = 0;

185 *
lo
 = 
	`deg»e
(
M
, 
	`¶i¡_»f
(
¶
, 1));

186 *
hi
 = *
lo
;

187 
i
 = 2; i <ğ
	`Ëngth
(
¶
); i++)

189 
d
 = 
	`deg»e
(
M
, 
	`¶i¡_»f
(
¶
, 
i
));

190 ià(
d
 < *
lo
)

191 *
lo
 = 
d
;

192 ià(
d
 > *
hi
)

193 *
hi
 = 
d
;

195 
	}
}

197 
	$¡d_lohi
(
gm©rix
 
M
, * 
lo
, * 
hi
)

201 
mn_¡ªd¬d
 
p
;

203 ià(
M
->
¡dbasis
 =ğ
NULL
)

205 *
lo
 = 0;

206 *
hi
 = 0;

209 
p
 = 
M
->
¡dbasis
;

210 *
hi
 = 
p
->
deg»e
;

211 
p
->
Ãxt
 !ğ
NULL
)

212 
p
 =…->
Ãxt
;

213 *
lo
 = 
p
->
deg»e
;

214 
	}
}

216 
	$g‘NumMÚoms
(
gm©rix
 
M
, 
¶i¡
* 
¶
, 
deg
, * 
ng’s
, * 
nmÚoms
)

218 
j
;

219 
pŞy
 
f
;

221 *
ng’s
 = 0;

222 *
nmÚoms
 = 0;

223 
j
 = 1; j <ğ
	`Ëngth
(
¶
); j++)

225 
f
 = 
	`¶i¡_»f
(
¶
, 
j
);

226 ià(
	`deg»e
(
M
, 
f
è=ğ
deg
)

228 (*
ng’s
)++;

229 *
nmÚoms
 +ğ
	`nMÚoms
(
f
);

232 
	}
}

234 
	$g‘N¡dMÚoms
(
gm©rix
 
M
, 
deg
, * 
ng’s
, * 
nmÚoms
)

236 
ng
, 
nm
;

237 
d
;

238 
mn_¡ªd¬d
 
p
;

240 
ng
 = 0;

241 
nm
 = 0;

242 
p
 = 
M
->
¡dbasis
;

243 (
p
 !ğ
NULL
è&& ((
d
 =…->
deg»e
è>ğ
deg
))

245 ià(
d
 =ğ
deg
)

247 
ng
++;

248 
nm
 +ğ
	`nMÚoms
(
p
->
¡ªd¬d
);

250 
p
 =…->
Ãxt
;

252 *
ng’s
 = 
ng
;

253 *
nmÚoms
 = 
nm
;

254 
	}
}

256 
	$gmSize
(
gm©rix
 
M
)

258 
tÙg’s
, 
tÙ¡d
;

259 
ng’s
, 
n¡d
, 
nmÚs
, 
nmÚ¡d
;

260 
lo
, 
lo2
, 
hi
, 
hi2
, 
i
;

262 
tÙg’s
 = 0;

263 
tÙ¡d
 = 0;

264 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

265 
	`¡d_lohi
(
M
, &
lo2
, &
hi2
);

266 
	`Ãwlše
();

267 
	`´št
("degree #gens #standard #monoms in gens #monoms in std\n");

268 ià(
lo2
 < 
lo
)

269 
lo
 = 
lo2
;

270 ià(
hi2
 > 
hi
)

271 
hi
 = 
hi2
;

272 
i
 = 
lo
; i <ğ
hi
; i++)

274 
	`g‘NumMÚoms
(
M
, &M->
g’s
, 
i
, &
ng’s
, &
nmÚs
);

275 
	`g‘N¡dMÚoms
(
M
, 
i
, &
n¡d
, &
nmÚ¡d
);

276 
tÙg’s
 +ğ
nmÚs
;

277 
tÙ¡d
 +ğ
nmÚ¡d
;

278 
	`Ãwlše
();

279 
	`´št
("%6d%8ld%13ld", 
i
, 
ng’s
, 
n¡d
);

280 
	`´št
("%19ld%18ld\n", 
nmÚs
, 
nmÚ¡d
);

282 
	`Ãwlše
();

283 
	`´št
("tÙ® %8d%13d%19ld%18ld\n", 
	`Ëngth
(&
M
->
g’s
), M->
n¡ªd¬d
, 
tÙg’s
, 
tÙ¡d
);

284 
	}
}

286 
	$nSPaœs
(
gm©rix
 
M
)

288 
mn_syzes
* 
a
;

289 
i
, 
d
;

290 
tÙ®
, 
g¿nd
;

291 
mn_·œ
* 
p
;

293 
a
 = &
M
->
mÚsyz
;

294 
d
 = 
M
->
mn_lodeg
;

296 
g¿nd
 = 0;

297 
	`Ãwlše
();

298 
	`´št
("degree #S-pairs\n");

299 
	`Ãwlše
();

300 
	`´št
("------ --------\n");

301 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

303 
tÙ®
 = 0;

304 
p
 = *(
mn_·œ
**)
	`»f
(
a
, 
i
);

305 
p
 !ğ
NULL
)

307 
tÙ®
++;

308 
p
 =…->
mµ
;

310 
g¿nd
 +ğ
tÙ®
;

311 ià(
tÙ®
 != 0)

313 
	`Ãwlše
();

314 
	`´št
("%6d %8ld\n", 
d
 + 
i
, 
tÙ®
);

317 
	`Ãwlše
();

318 
	`´št
("------ --------\n");

319 
	`Ãwlše
();

320 
	`´št
("tÙ® %8ld\n", 
g¿nd
);

321 
	}
}

323 
	$¥aœs_cmd
(
¬gc
, * 
¬gv
[])

325 
gm©rix
 
M
;

327 ià(
¬gc
 != 2)

329 
	`´šŠew
("spairs <module>\n");

333 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

335 
	`´”rÜ
("; module‚ot found\n");

338 
	`nSPaœs
(
M
);

339 
	}
}

341 
	$¥aœs_æush
(
gm©rix
 
M
)

343 
mn_syzes
* 
a
;

344 
i
;

345 
tÙ®
;

346 
mn_·œ
* 
p
;

348 
a
 = &
M
->
mÚsyz
;

350 
tÙ®
 = 0;

351 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

353 
p
 = *(
mn_·œ
**)
	`»f
(
a
, 
i
);

354 
p
 !ğ
NULL
)

356 
tÙ®
++;

357 
p
 =…->
mµ
;

360 
	`štæush
("<%ld>", ()
tÙ®
);

361 
	}
}

363 
	$size_cmd
(
¬gc
, * 
¬gv
[])

365 
gm©rix
 
M
;

367 ià(
¬gc
 != 2)

369 
	`´šŠew
("size <module>\n");

373 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

375 
	`´”rÜ
("; module‚ot found\n");

378 
	`gmSize
(
M
);

379 
	}
}

	@betti.h

5 
»sLoHi
(
v
, * 
ResL’gth
, * 
lo
, * 
hi
, 
b‘ti
[]);

6 
»sDeg
(
v
, 
deg
, 
b‘ti
[]);

7 
b‘ti
(
FILE
* 
f
, 
v¬ŸbË
* 
p
);

10 
gmSize
(
gm©rix
 
M
);

11 
nSPaœs
(
gm©rix
 
M
);

12 
¥aœs_æush
(
gm©rix
 
M
);

15 
b‘ti_cmd
(
¬gc
, * 
¬gv
[]);

16 
¥aœs_cmd
(
¬gc
, * 
¬gv
[]);

17 
size_cmd
(
¬gc
, * 
¬gv
[]);

20 
dl_ndeg
(
dli¡
* 
dl
, 
deg
);

21 
¶_lohi
(
gm©rix
 
M
, 
¶i¡
* 
¶
, * 
lo
, * 
hi
);

22 
¡d_lohi
(
gm©rix
 
M
, * 
lo
, * 
hi
);

23 
g‘NumMÚoms
(
gm©rix
 
M
, 
¶i¡
* 
¶
, 
deg
, * 
ng’s
, * 
nmÚoms
);

24 
g‘N¡dMÚoms
(
gm©rix
 
M
, 
deg
, * 
ng’s
, * 
nmÚoms
);

25 
nMÚoms
(
pŞy
 
f
);

	@boxcmds.c

4 
	~"sh¬ed.h
"

5 
	~"boxcmds.h
"

6 
	~"v¬s.h
"

7 
	~"cmds.h
"

8 
	~"box´ocs.h
"

9 
	~"mÚ™Ü.h
"

10 
	~"·r£.h
"

11 
	~"g’”ic.h
"

14 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
* 
g
, ** 
¬gv
, 
i
)

16 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

17  (*
g
 !ğ
NULL
);

18 
	}
}

20 
šlše
 
boŞ
 
	$g‘_vmod
(
v¬ŸbË
** 
p
, ** 
¬gv
, 
i
)

22 *
p
 = 
	`vg‘_vmod
(
¬gv
[
i
]);

23  (*
p
 !ğ
NULL
);

24 
	}
}

26 
	$cŞl_cmd
(
¬gc
, * 
¬gv
[])

28 ià(
¬gc
 == 1)

29 
	`mkcŞËù
("");

31 
	`mkcŞËù
(
¬gv
[1]);

33 
	}
}

35 
	$Œash_cmd
(
¬gc
, * 
¬gv
[])

37 ià(
¬gc
 == 1)

38 
	`mkŒash
("");

40 
	`mkŒash
(
¬gv
[1]);

42 
	}
}

44 
	$mkÄes_cmd
(
¬gc
, * 
¬gv
[])

46 
n
, 
ch
;

47 
Ï¡_ch
, 
fœ¡
;

49 ià(
¬gc
 != 5)

51 
	`´šŠew
("mknres <#o make> <# in change> <# in†ast change>");

52 
	`´št
(" [int.‚ame of first‚res]\n");

55 
n
 = 
	`g‘IÁ
(
¬gv
[1]);

56 
ch
 = 
	`g‘IÁ
(
¬gv
[2]);

57 
Ï¡_ch
 = 
	`g‘IÁ
(
¬gv
[3]);

58 
fœ¡
 = 
	`g‘IÁ
(
¬gv
[4]);

59 ià(
n
 <= 0)

61 
	`´”rÜ
(";‚ot creating‡ny‚res vars\n");

64 ià(
fœ¡
 < 0)

66 
	`´”rÜ
("; first‚ame must be‚on-negative integer\n");

69 ià(
Ï¡_ch
 < 0)

70 
Ï¡_ch
 = -1;

71 ià(
ch
 < 0)

72 
ch
 = -1;

73 
	`mk_£v_Äes
(
fœ¡
, 
n
, 
ch
, 
Ï¡_ch
);

75 
	}
}

77 
	$mk¡d_cmd
(
¬gc
, * 
¬gv
[])

79 cÚ¡ * 
Çme
;

81 ià(
¬gc
 > 2)

83 
	`´šŠew
("mkstd [name]\n");

86 
Çme
 = (
¬gc
 =ğ2 ? 
¬gv
[1] : "");

87 
	`mk¡d
(
Çme
);

89 
	}
}

91 
	$mki¡d_cmd
(
¬gc
, * 
¬gv
[])

93 cÚ¡ * 
Çme
;

94 
gm©rix
 
M
;

95 
štv®
;

97 ià((
¬gc
 < 3) || (argc > 4))

99 
	`´šŠew
("mkistd <# in change> <matrix> [name]\n");

102 
Çme
 = (
¬gc
 =ğ4 ? 
¬gv
[3] : "");

103 
štv®
 = 
	`g‘IÁ
(
¬gv
[1]);

104 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 2))

106 
	`mki¡d
(
Çme
, 
štv®
, 
M
);

108 
	}
}

110 
	$mk»s_cmd
(
¬gc
, * 
¬gv
[])

112 
ch
;

113 
gm©rix
 
M
;

114 cÚ¡ * 
Çme
;

116 ià((
¬gc
 < 3) || (argc > 4))

118 
	`´šŠew
("mkres <# in change> <module> [name]\n");

121 
ch
 = 
	`g‘IÁ
(
¬gv
[1]);

122 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 2))

124 
Çme
 = (
¬gc
 =ğ4 ? 
¬gv
[3] : "");

125 
	`mk»s
(
Çme
, 
ch
, 
M
);

127 
	}
}

129 
	$em™_cmd
(
¬gc
, * 
¬gv
[])

131 
v¬ŸbË
* 
p
;

132 cÚ¡ * 
Çme
;

134 ià((
¬gc
 < 2) || (argc > 3))

136 
	`´šŠew
("mkemit <module> [name]\n");

139 ià(!
	`g‘_vmod
(&
p
, 
¬gv
, 1))

141 
Çme
 = (
¬gc
 =ğ3 ? 
¬gv
[2] : "");

142 
	`mkem™
(
Çme
, 
p
);

144 
	}
}

146 
	$¡dem™_cmd
(
¬gc
, * 
¬gv
[])

148 
v¬ŸbË
* 
p
;

149 cÚ¡ * 
Çme
;

151 ià((
¬gc
 < 2) || (argc > 3))

153 
	`´šŠew
("mkstdemit <module> [name]\n");

156 ià(!
	`g‘_vmod
(&
p
, 
¬gv
, 1))

158 
Çme
 = (
¬gc
 =ğ3 ? 
¬gv
[2] : "");

159 
	`mk¡dem™
(
Çme
, 
p
);

161 
	}
}

163 
	$mkliá_cmd
(
¬gc
, * 
¬gv
[])

165 
v¬ŸbË
* 
p
;

166 cÚ¡ * 
Çme
;

168 ià((
¬gc
 < 2) || (argc > 3))

170 
	`´šŠew
("mklift <module> [name]\n");

173 ià(!
	`g‘_vmod
(&
p
, 
¬gv
, 1))

175 
Çme
 = (
¬gc
 =ğ3 ? 
¬gv
[2] : "");

176 
	`mkliá
(
Çme
, 
p
);

178 
	}
}

180 
	$shiá_cmd
(
¬gc
, * 
¬gv
[])

182 
n
;

183 cÚ¡ * 
Çme
;

185 ià((
¬gc
 < 2) || (argc > 3))

187 
	`´šŠew
("mkshift <shiftval> [name]\n");

190 
Çme
 = (
¬gc
 =ğ3 ? 
¬gv
[2] : "");

191 
n
 = 
	`g‘IÁ
(
¬gv
[1]);

192 
	`mkshiá
(
Çme
, 
n
);

194 
	}
}

196 
	$m”ge_cmd
(
¬gc
, * 
¬gv
[])

198 cÚ¡ * 
Çme
;

200 
Çme
 = (
¬gc
 =ğ2 ? 
¬gv
[1] : "");

201 
	`mkm”ge
(
Çme
);

203 
	}
}

205 
	$¡¬t0_cmd
(
¬gc
, * 
¬gv
[])

207 
num¡¬t
, 
maxg’
, 
Ï¡deg
;

209 ià(
¬gc
 != 5)

211 
	`´šŠew
("mkstart0 <name> <#o start> <maxgen> <lastdeg done>\n");

214 
num¡¬t
 = 
	`g‘IÁ
(
¬gv
[2]);

215 
maxg’
 = 
	`g‘IÁ
(
¬gv
[3]);

216 
Ï¡deg
 = 
	`g‘IÁ
(
¬gv
[4]);

217 
	`mk¡¬‹r
(
¬gv
[1], 
maxg’
, 
Ï¡deg
, 
num¡¬t
);

219 
	}
}

221 
	$cÚn_cmd
(
¬gc
, * 
¬gv
[])

223 
v¬ŸbË
* 
šv¬
, * 
outv¬
;

225 ià((
¬gc
 < 2) || (argc > 3))

227 
	`´šŠew
("connect <in var> [out var]\n");

230 
šv¬
 = 
	`fšd_v¬
(
¬gv
[1]);

231 ià(
šv¬
 =ğ
NULL
)

233 ià(
¬gc
 == 2)

234 
outv¬
 = 
NULL
;

236 
outv¬
 = 
	`fšd_v¬
(
¬gv
[2]);

237 
šv¬
->
b_Ãxt
 = 
outv¬
;

239 
	}
}

241 
	$chÿlc_cmd
(
¬gc
, * 
¬gv
[])

243 
¡¬t_»c
* 
s
;

244 
v¬ŸbË
* 
p
;

246 ià((
¬gc
 < 2) || (argc > 3))

248 
	`´šŠew
("chcalc <computation> [new hi deg]\n");

251 
p
 = 
	`fšd_v¬
(
¬gv
[1]);

252 ià(
p
 =ğ
NULL
)

254 ià(
p
->
ty³
 !ğ
VSTARTER
)

256 
	`´”rÜ
("; variable is‚ot‡ computation\n");

259 
s
 = (
¡¬t_»c
*)
p
->
v®ue
;

260 ià((
s
->
hideg
 =ğ(s->
Ï¡deg
 - 1)è&& (!s->
dßÎdegs
))

262 
	`´”rÜ
("; computation is‚ot in…rogress\n");

265 
	`¡_bounds
(
p
, 
¬gc
, 
¬gv
);

267 
	}
}

269 
	$ÿlc_cmd
(
¬gc
, * 
¬gv
[])

271 
v¬ŸbË
* 
p
;

273 ià((
¬gc
 < 2) || (argc > 3))

275 
	`´šŠew
("calc <computation> [hi degree]\n");

278 ià((
p
 = 
	`fšd_v¬
(
¬gv
[1])è=ğ
NULL
)

280 ià(
p
->
ty³
 !ğ
VSTARTER
)

282 
	`´”rÜ
("; variable is‚ot‡ computation\n");

285 #´agm¨
GCC
 
dŸgno¡ic
 
push


286 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

287 #ifdeà
__şªg__


288 #´agm¨
şªg
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type-mismatch"

290 
	`¡_¡¬t
(
p
, 
¬gc
, 
¬gv
);

291 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


293 
	}
}

	@boxcmds.h

5 
cŞl_cmd
(
¬gc
, * 
¬gv
[]);

6 
Œash_cmd
(
¬gc
, * 
¬gv
[]);

7 
mkÄes_cmd
(
¬gc
, * 
¬gv
[]);

8 
mk¡d_cmd
(
¬gc
, * 
¬gv
[]);

9 
mki¡d_cmd
(
¬gc
, * 
¬gv
[]);

10 
mk»s_cmd
(
¬gc
, * 
¬gv
[]);

11 
em™_cmd
(
¬gc
, * 
¬gv
[]);

12 
¡dem™_cmd
(
¬gc
, * 
¬gv
[]);

13 
mkliá_cmd
(
¬gc
, * 
¬gv
[]);

14 
shiá_cmd
(
¬gc
, * 
¬gv
[]);

15 
m”ge_cmd
(
¬gc
, * 
¬gv
[]);

16 
¡¬t0_cmd
(
¬gc
, * 
¬gv
[]);

17 
cÚn_cmd
(
¬gc
, * 
¬gv
[]);

18 
chÿlc_cmd
(
¬gc
, * 
¬gv
[]);

19 
ÿlc_cmd
(
¬gc
, * 
¬gv
[]);

	@boxprocs.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<£tjmp.h
>

7 
	~"sh¬ed.h
"

8 
	~"box´ocs.h
"

9 
	~"v¬s.h
"

10 
	~"¶i¡.h
"

11 
	~"g’”ic.h
"

12 
	~"sh–l.h
"

13 
	~"·r£.h
"

14 
	~"mem.h
"

15 
	~"mÚ™Ü.h
"

16 
	~"pŞy.h
"

17 
	~"¡ªd¬d.h
"

18 
	~"hb.h
"

19 
	~"šhomog.h
"

27 
šlše
 
gm©rix
 
	$VAR_MODULE
(
v¬ŸbË
 *
p
)

29  (
gm©rix
)
p
->
v®ue
;

30 
	}
}

32 
šlše
 
v¬ŸbË
 *
	$out_box
(
v¬ŸbË
 *
box
)

34  
box
->
b_Ãxt
;

35 
	}
}

39 
šlše
 
boŞ—n
 
	$do_deg»e
(
v¬ŸbË
 *
box
, 
deg
)

41 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
box
->
ty³
);

42 ià(
vbË
 && vbË->
msg2
.
do_deg»e
)

44  
vbË
->
msg2
.
	`do_deg»e
(
box
, 
deg
);

46  
TRUE
;

47 
	}
}

49 
šlše
 
boŞ—n
 
	$’d_š_deg»e
(
v¬ŸbË
 *
box
, 
deg
)

51 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
box
->
ty³
);

52 ià(
vbË
 && vbË->
’d_deg»e
)

54  
vbË
->
	`’d_deg»e
(
box
, 
deg
);

56  
TRUE
;

57 
	}
}

59 
	$£nd_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

61 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
box
->
ty³
);

62 ià(
vbË
 && vbË->
pŞy_»ûive
)

64 
vbË
->
	`pŞy_»ûive
(
box
, 
f
, 
deg
);

66 
	}
}

68 
šlše
 
	$£nd_degs
(
v¬ŸbË
 *
box
, 
dli¡
 *
dl
, 
deg
)

70 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
box
->
ty³
);

71 ià(
vbË
 && vbË->
msg2
.
degs_»ûive
)

73 
vbË
->
msg2
.
	`degs_»ûive
(
box
, 
dl
, 
deg
);

75 
	}
}

82 
v¬ŸbË
 *
	$mkcŞËù
(cÚ¡ *
Çme
)

84 
v¬ŸbË
 *
»suÉ
;

86 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VCOLLECT
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

87 
	`£t_v®ue
(
»suÉ
, 
	`mod_š™
());

88  
»suÉ
;

89 
	}
}

91 
v¬ŸbË
 *
	$mkŒash
(cÚ¡ *
Çme
)

93  
	`make_v¬
(
Çme
, 
PARTVAR
, 
VTRASH
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

94 
	}
}

96 
v¬ŸbË
 *
	$mkÄes
(cÚ¡ *
Çme
, 
štv®
)

98 
v¬ŸbË
 *
»suÉ
;

100 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VNRES
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

101 
»suÉ
->
štv®
 = intval;

102 
	`£t_v®ue
(
»suÉ
, 
	`mod_š™
());

103  
»suÉ
;

104 
	}
}

106 
v¬ŸbË
 *
	$mk¡d
(cÚ¡ *
Çme
)

108 
v¬ŸbË
 *
»suÉ
;

110 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VSTD
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

111 
»suÉ
->
štv®
 = 0;

112 
	`£t_v®ue
(
»suÉ
, 
	`mod_š™
());

113  
»suÉ
;

114 
	}
}

116 
v¬ŸbË
 *
	$mki¡d
(cÚ¡ *
Çme
, 
štv®
, 
gm©rix
 
M
)

118 
v¬ŸbË
 *
»suÉ
;

120 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VISTD
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

121 
»suÉ
->
štv®
 = intval;

122 
	`£t_v®ue
(
»suÉ
, 
	`m©_cİy
(
M
));

123  
»suÉ
;

124 
	}
}

126 
	$mk_£v_Äes
(
fœ¡
, 
num_to_make
, 
štv®
, 
Ï¡_štv®
)

128 
s
[20];

129 
i
;

131 ià(
num_to_make
 <= 0)

133 
em±y
[] = "";

134 
	`mkŒash
(
em±y
);

137 
i
 = 
fœ¡
; i < fœ¡ + 
num_to_make
 - 1; i++)

139 
	`¥rštf
(
s
, "%d", 
i
);

140 
	`mkÄes
(
s
, 
štv®
);

142 
	`¥rštf
(
s
, "%d", 
fœ¡
 + 
num_to_make
 - 1);

143 
	`mkÄes
(
s
, 
Ï¡_štv®
);

144 
	}
}

146 
v¬ŸbË
 *
	$mk»s
(cÚ¡ *
Çme
, 
štv®
, 
gm©rix
 
M
)

148 
v¬ŸbË
 *
»suÉ
;

150 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VRES
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

151 
»suÉ
->
štv®
 = intval;

152 
	`£t_v®ue
(
»suÉ
, 
	`m©_cİy
(
M
));

153  
»suÉ
;

154 
	}
}

156 
v¬ŸbË
 *
	$mkem™
(cÚ¡ *
Çme
, 
v¬ŸbË
 *
Mv¬
)

158 
v¬ŸbË
 *
»suÉ
;

160 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VEMIT
, 
Mv¬
->
b_ršg
);

161 
	`£t_v®ue
(
»suÉ
, 
Mv¬
);

162  
»suÉ
;

163 
	}
}

165 
v¬ŸbË
 *
	$mk¡dem™
(cÚ¡ *
Çme
, 
v¬ŸbË
 *
Mv¬
)

167 
v¬ŸbË
 *
»suÉ
;

169 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VSTDEMIT
, 
Mv¬
->
b_ršg
);

170 
	`£t_v®ue
(
»suÉ
, 
Mv¬
);

171  
»suÉ
;

172 
	}
}

174 
v¬ŸbË
 *
	$mkliá
(cÚ¡ *
Çme
, 
v¬ŸbË
 *
Mv¬
)

176 
v¬ŸbË
 *
»suÉ
;

178 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VLIFT
, 
Mv¬
->
b_ršg
);

179 
	`£t_v®ue
(
»suÉ
, 
Mv¬
);

180  
»suÉ
;

181 
	}
}

183 
v¬ŸbË
 *
	$mkm”ge
(cÚ¡ *
Çme
)

185 
v¬ŸbË
 *
»suÉ
;

187 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VMERGE
, 
NULL
);

188 
»suÉ
->
štv®
 = 0;

189 
	`£t_v®ue
(
»suÉ
, 
NULL
);

190  
»suÉ
;

191 
	}
}

193 
v¬ŸbË
 *
	$mkshiá
(cÚ¡ *
Çme
, 
shiáv®
)

195 
v¬ŸbË
 *
»suÉ
;

197 
»suÉ
 = 
	`make_v¬
(
Çme
, 
PARTVAR
, 
VSHIFT
, 
NULL
);

198 
»suÉ
->
štv®
 = 
shiáv®
;

199 
	`£t_v®ue
(
»suÉ
, 
NULL
);

200  
»suÉ
;

201 
	}
}

203 
v¬ŸbË
 *
	$mk¡¬‹r
(cÚ¡ *
Çme
, 
maxg’
, 
Ï¡deg
, 
num¡¬t
)

205 
v¬ŸbË
 *
»suÉ
;

207 
»suÉ
 = 
	`make_v¬
(
Çme
, 
MAINVAR
, 
VSTARTER
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

208 
	`£t_v®ue
(
»suÉ
, 
	`¡_š™
(
maxg’
, 
Ï¡deg
, 
num¡¬t
));

209  
»suÉ
;

210 
	}
}

214 
	$®Ÿs_ty³
(
v¬ŸbË
 *
p
)

217 
	}
}

221 
¡¬t_»c
 *
	$¡_š™
(
maxg’
, 
Ï¡deg
, 
num¡¬t
)

223 
¡¬t_»c
 *
s
;

225 
s
 = (
¡¬t_»c
 *)(*)
	`g‘_sm®l
((start_rec));

226 
s
->
maxg’
 = maxgen;

227 
s
->
Ï¡deg
 =†astdeg;

228 
s
->
num¡¬t
 =‚umstart;

229 
s
->
iscom¶‘e
 = 
çl£
;

230 
s
->
hideg
 = s->
Ï¡deg
 - 1;

231 
s
->
dßÎdegs
 = 
çl£
;

232  
s
;

233 
	}
}

235 
	$¡_kl
(
v¬ŸbË
 *
box
)

237 #ifdeà
ANSI


238 #´agm¨
	`unu£d
(
box
)

240 
	}
}

242 
	$¡_bounds
(
v¬ŸbË
 *
box
, 
¬gc
, *
¬gv
[])

244 
¡¬t_»c
 *
s
;

246 
s
 = (
¡¬t_»c
 *)
box
->
v®ue
;

247 ià(
¬gc
 == 2)

249 
s
->
dßÎdegs
 = 
Œue
;

250 
s
->
hideg
 = s->
Ï¡deg
 - 1;

254 
s
->
hideg
 = 
	`g‘IÁ
(
¬gv
[2]);

255 
s
->
dßÎdegs
 = 
çl£
;

257 
	}
}

259 
	$¡_¡¬t
(
v¬ŸbË
 *
box
, 
¬gc
, *
¬gv
[])

261 
	`¡_bounds
(
box
, 
¬gc
, 
¬gv
);

262 
	`doÿlc
(
box
);

263 
	}
}

265 
	$ÿlc
(
v¬ŸbË
 *
box
, 
boŞ—n
 
dßÎdegs
, 
hideg
)

267 
¡¬t_»c
 *
s
;

269 
s
 = (
¡¬t_»c
 *)
box
->
v®ue
;

270 
s
->
dßÎdegs
 = doalldegs;

271 ià(
dßÎdegs
)

272 
s
->
hideg
 = s->
Ï¡deg
 - 1;

274 
s
->
hideg
 = hideg;

275 
	`doÿlc
(
box
);

276 
	}
}

278 
	$doÿlc
(
v¬ŸbË
 *
box
)

280 
deg
;

281 
boŞ—n
 
b
, 
dÚe_y‘
;

282 
B
;

283 
v¬ŸbË
 *
p
;

284 
¡¬t_»c
 *
s
;

286 
s
 = (
¡¬t_»c
 *)
box
->
v®ue
;

288 
dÚe_y‘
 = 
s
->
iscom¶‘e
;

289 
	`Ãwlše
();

290 
deg
 = 
s
->
Ï¡deg
 + 1; ((deg <ğs->
hideg
è|| s->
dßÎdegs
è&& (!
dÚe_y‘
); deg++)

292 
	`štæush
("%d", 
deg
);

293 
dÚe_y‘
 = (
s
->
maxg’
 < 
deg
);

294 
B
 = 1; B <ğ
s
->
num¡¬t
; B++)

296 
p
 = (
v¬ŸbË
 *)
	`»f
(&
v¬_li¡
, 
box
->
v¬_num
 + 
B
);

297 
b
 = 
	`do_deg»e
(
p
, 
deg
);

298 
dÚe_y‘
 = dÚe_y‘ && 
b
;

300 
s
->
Ï¡deg
++;

302 
s
->
iscom¶‘e
 = 
dÚe_y‘
;

303 
s
->
hideg
 = s->
Ï¡deg
 - 1;

304 
s
->
dßÎdegs
 = 
çl£
;

305 
	`´št
("\n");

306 ià(
dÚe_y‘
)

308 
	`Ãwlše
();

309 
	`´št
("computiÚ com¶‘aá” deg»%d\n", 
s
->
Ï¡deg
);

311 
	}
}

313 
	$¡_µršt
(
¡¬t_»c
 *
s
)

315 
	`âewlše
(
outfe
);

316 
	`åršt
(
outfe
, "computiÚ i com¶‘thru deg»%d\n", 
s
->
Ï¡deg
);

317 
	`âewlše
(
outfe
);

318 
	`åršt
(
outfe
, "highe¡ deg»g’”©Ü ha deg»%d\n", 
s
->
maxg’
);

319 
	`âewlše
(
outfe
);

320 
	`åršt
(
outfe
, "#Ø¡¬ˆğ%d\n", 
s
->
num¡¬t
);

321 
	`âewlše
(
outfe
);

322 ià(
s
->
iscom¶‘e
)

323 
	`åršt
(
outfe
, "the computation is complete\n");

325 
	`åršt
(
outfe
, "the computation is‚ot yet complete\n");

327 
	`âewlše
(
outfe
);

328 ià((
s
->
hideg
 >ğs->
Ï¡deg
è|| s->
dßÎdegs
)

330 
	`åršt
(
outfe
, "computation is in…rogress: ");

331 ià(
s
->
dßÎdegs
)

332 
	`åršt
(
outfe
, "doing‡ll degrees\n");

334 
	`åršt
(
outfe
, "došghru deg»%d\n", 
s
->
hideg
);

336 
	}
}

340 
	$cŞl_degs
(
v¬ŸbË
 *
box
, 
dli¡
 *
dl
, 
deg
)

342 
gm©rix
 
M
;

343 #ifdeà
ANSI


344 #´agm¨
	`unu£d
(
deg
)

347 
M
 = 
	`VAR_MODULE
(
box
);

348 
	`dl_kl
(&(
M
->
deg»es
));

349 
	`dl_cİy
(
dl
, &(
M
->
deg»es
));

350 
	}
}

352 
	$cŞl_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

354 
gm©rix
 
M
;

356 
M
 = 
	`VAR_MODULE
(
box
);

357 
	`make1_mÚic
(&
f
);

358 
	`¶i¡_š£¹
(&(
M
->
g’s
), 
f
);

359 
	`dli¡_š£¹
(&(
M
->
degg’s
), 
deg
);

360 
	}
}

364 
	$Œash_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

366 #ifdeà
ANSI


367 #´agm¨
	`unu£d
(
box
, 
deg
)

369 
	`p_kl
(&
f
);

370 
	}
}

374 
boŞ—n
 
	$em™_dodeg
(
v¬ŸbË
 *
box
, 
deg
)

376 
gm©rix
 
M
;

377 
v¬ŸbË
 *
®ŸsM
;

378 
i
;

379 
pŞy
 
f
;

381 
®ŸsM
 = (
v¬ŸbË
 *)
box
->
v®ue
;

382 
M
 = 
	`VAR_MODULE
(
®ŸsM
);

383 
	`vrg_š¡®l
(
®ŸsM
->
b_ršg
);

384 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
deg»es
), 
deg
);

385 
i
 = 1; i <ğ
	`Ëngth
(&(
M
->
g’s
)); i++)

386 ià(
	`dli¡_»f
(&(
M
->
degg’s
), 
i
è=ğ
deg
)

388 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&(
M
->
g’s
), 
i
));

389 
	`£nd_pŞy
(
	`out_box
(
box
), 
f
, 
deg
);

391  
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

392 
	}
}

396 
boŞ—n
 
	$£m™_dodeg
(
v¬ŸbË
 *
box
, 
deg
)

398 
gm©rix
 
M
;

399 
mn_¡ªd¬d
 
p
;

400 
v¬ŸbË
 *
®ŸsM
;

401 
pŞy
 
f
;

403 
®ŸsM
 = (
v¬ŸbË
 *)
box
->
v®ue
;

404 
M
 = 
	`VAR_MODULE
(
®ŸsM
);

405 
	`vrg_š¡®l
(
®ŸsM
->
b_ršg
);

406 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
deg»es
), 
deg
);

407 
p
 = 
M
->
¡dbasis
;

408 
p
 !ğ
NULL
)

410 
f
 = 
p
->
¡ªd¬d
;

411 ià(
p
->
deg»e
 =ğ
deg
)

413 
f
 = 
	`p_cİy
(f);

414 
	`£nd_pŞy
(
	`out_box
(
box
), 
f
, 
deg
);

416 
p
 =…->
Ãxt
;

418  
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

419 
	}
}

423 
boŞ—n
 
	$i¡d_dodeg
(
v¬ŸbË
 *
box
, 
deg
)

425 
gm©rix
 
M
;

426 
‹mp_Ën
;

428 
	`vrg_š¡®l
(
box
->
b_ršg
);

429 
M
 = 
	`VAR_MODULE
(
box
);

431 ià((
box
->
štv®
 >ğ0è&& (box->štv® < 
	`Ëngth
(&(
M
->
degg’s
))))

433 
‹mp_Ën
 = 
M
->
degg’s
.
Ën
;

434 
M
->
degg’s
.
Ën
 = 
box
->
štv®
;

435 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

436 
M
->
degg’s
.
Ën
 = 
‹mp_Ën
;

440 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

443 
	`IHÜig_g’s
(
M
, 
box
->
štv®
, 
	`out_box
(box));

444 
	`IHÿlc_¡ªd¬d
(
M
, 
	`out_box
(
box
));

445 
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

446  
Œue
;

447 
	}
}

452 
boŞ—n
 
	$»s_dodeg
(
v¬ŸbË
 *
box
, 
deg
)

454 
gm©rix
 
M
;

455 
boŞ—n
 
dÚe_y‘
, 
»¡_dÚe
;

456 
‹mp_Ën
;

458 
	`vrg_š¡®l
(
box
->
b_ršg
);

459 
M
 = 
	`VAR_MODULE
(
box
);

461 ià((
box
->
štv®
 >ğ0è&& (box->štv® < 
	`Ëngth
(&(
M
->
degg’s
))))

463 
‹mp_Ën
 = 
M
->
degg’s
.
Ën
;

464 
M
->
degg’s
.
Ën
 = 
box
->
štv®
;

465 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

466 
M
->
degg’s
.
Ën
 = 
‹mp_Ën
;

470 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

473 
dÚe_y‘
 = 
	`ÿlc_¡ªd¬d
(
M
, 
deg
, 
	`out_box
(
box
));

474 
	`Üig_g’s
(
M
, 
deg
, 
box
->
štv®
, 
	`out_box
(box));

475 
»¡_dÚe
 = 
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

476  
dÚe_y‘
 && 
»¡_dÚe
;

477 
	}
}

481 
	$šs_Äes
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

483 
pŞy
 
h
, 
h»p
;

484 
i
;

485 
gm©rix
 
M
;

487 
M
 = 
	`VAR_MODULE
(
box
);

488 
h
 = 
	`»duû
(
M
, &
f
);

489 ià(
h
 =ğ
NULL
)

493 
	`make1_mÚic
(&
h
);

494 
	`¶i¡_š£¹
(&(
M
->
g’s
), 
h
);

495 
i
 = 
	`Ëngth
(&(
M
->
g’s
));

496 
	`dli¡_š£¹
(&(
M
->
degg’s
), 
deg
);

497 ià((
box
->
štv®
 < 0è|| (box->štv® >ğ
i
))

498 
h»p
 = 
	`e_sub_i
(
i
);

500 
h»p
 = 
NULL
;

501 
	`šs_–em
(
M
, 
deg
, 
	`p_cİy
(
h
), 
h»p
);

502 
	}
}

504 
boŞ—n
 
	$Äes_’ddeg
(
v¬ŸbË
 *
box
, 
deg
)

506 
gm©rix
 
M
;

507 
boŞ—n
 
dÚe_y‘
, 
»¡_dÚe
;

508 
‹mp_Ën
;

510 
M
 = 
	`VAR_MODULE
(
box
);

512 ià((
box
->
štv®
 >ğ0è&& (box->štv® < 
	`Ëngth
(&(
M
->
degg’s
))))

514 
‹mp_Ën
 = 
M
->
degg’s
.
Ën
;

515 
M
->
degg’s
.
Ën
 = 
box
->
štv®
;

516 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

517 
M
->
degg’s
.
Ën
 = 
‹mp_Ën
;

521 
	`£nd_degs
(
	`out_box
(
box
), &(
M
->
degg’s
), 
deg
);

524 
dÚe_y‘
 = 
	`ÿlc_¡ªd¬d
(
M
, 
deg
 + 1, 
	`out_box
(
box
));

525 
»¡_dÚe
 = 
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
 + 1);

526  
dÚe_y‘
 && 
»¡_dÚe
;

527 
	}
}

531 
boŞ—n
 
	$¡d_’ddeg
(
v¬ŸbË
 *
box
, 
deg
)

533 #ifdeà
ANSI


534 #´agm¨
	`unu£d
(
deg
)

536  
	`mn_iscom¶‘e
(
	`VAR_MODULE
(
box
));

537 
	}
}

539 
	$¡d_degs
(
v¬ŸbË
 *
box
, 
dli¡
 *
dl
, 
deg
)

541 
gm©rix
 
M
;

543 
	`cŞl_degs
(
box
, 
dl
, 
deg
);

544 
M
 = 
	`VAR_MODULE
(
box
);

545 
	`ÿlc_¡ªd¬d
(
M
, 
deg
, 
NULL
);

546 
	}
}

550 
	$mg_degs
(
v¬ŸbË
 *
box
, 
dli¡
 *
dl
, 
deg
)

552 
	`£nd_degs
(
	`out_box
(
box
), 
dl
, 
deg
);

553 
	}
}

555 
	$mg_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

557 
	`£nd_pŞy
(
	`out_box
(
box
), 
f
, 
deg
);

558 
	}
}

560 
boŞ—n
 
	$mg_’ddeg
(
v¬ŸbË
 *
box
, 
deg
)

562 ià(
box
->
štv®
 == 0)

564 
box
->
štv®
 = 1;

565  
Œue
;

569 
box
->
štv®
 = 0;

570  
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

572 
	}
}

576 
boŞ—n
 
	$shiá_dodeg
(
v¬ŸbË
 *
box
, 
deg
)

578  
	`do_deg»e
(
	`out_box
(
box
), 
deg
 + box->
štv®
);

579 
	}
}

583 
boŞ—n
 
	$liá_’ddeg
(
v¬ŸbË
 *
box
, 
deg
)

585  
	`’d_š_deg»e
(
	`out_box
(
box
), 
deg
);

586 
	}
}

588 
	$liá_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

590 
gm©rix
 
M
;

591 
pŞy
 
g
, 
h
;

593 
M
 = 
	`VAR_MODULE
((
v¬ŸbË
 *)
box
->
v®ue
);

594 
	`divisiÚ
(
M
, &
f
, &
g
, &
h
);

595 ià(
h
 !ğ
NULL
)

597 
	`´”rÜ
(";†ifted…olynomial isn't in desired module\n");

599 
	`£nd_pŞy
(
	`out_box
(
box
), 
g
, 
deg
);

600 
	}
}

	@boxprocs.h

7 
	sobjeù_vbË


10 (*
	mg‘_ty³
)(* 
	mobj
);

13 (*
	mkl
)(* 
	mobj
);

18 (*
	m¡¬t
)(* 
	mobj
, 
	m¬gc
, ** 
	m¬gv
);

19 
boŞ—n
 (*
do_deg»e
)(* 
	mobj
, 
	mdeg
);

20 (*
	mdegs_»ûive
)(* 
	mobj
, * 
	mdli¡
, 
	mdeg
);

21 } 
	mmsg2
;

24 (*
	mpŞy_»ûive
)(* 
	mobj
, 
pŞy
 
	mp
, 
	mdeg
);

27 
boŞ—n
 (*
’d_deg»e
)(* 
	mobj
, 
	mdeg
);

28 } 
	tobjeù_vbË
;

31 cÚ¡ 
objeù_vbË
*
g‘_vbË
(
ty³
);

34 *
g‘_mes§ge_hªdËr
(
ty³
, 
mes§ge
);

37 
¡¬t_»c
 
	t¡¬t_»c
;

40 
	s¡¬t_»c


42 
	mmaxg’
;

43 
	mÏ¡deg
;

44 
	mnum¡¬t
;

45 
boŞ—n
 
	miscom¶‘e
;

46 
	mhideg
;

47 
boŞ—n
 
	mdßÎdegs
;

51 
v¬ŸbË
*
mkcŞËù
(cÚ¡ * 
Çme
);

52 
v¬ŸbË
*
mkŒash
(cÚ¡ * 
Çme
);

53 
v¬ŸbË
*
mkÄes
(cÚ¡ * 
Çme
, 
štv®
);

54 
v¬ŸbË
*
mk¡d
(cÚ¡ * 
Çme
);

55 
v¬ŸbË
*
mki¡d
(cÚ¡ * 
Çme
, 
štv®
, 
gm©rix
 
M
);

56 
mk_£v_Äes
(
fœ¡
, 
num_to_make
, 
štv®
, 
Ï¡_štv®
);

57 
v¬ŸbË
*
mk»s
(cÚ¡ * 
Çme
, 
štv®
, 
gm©rix
 
M
);

58 
v¬ŸbË
*
mkem™
(cÚ¡ * 
Çme
, v¬ŸbË* 
Mv¬
);

59 
v¬ŸbË
*
mk¡dem™
(cÚ¡ * 
Çme
, v¬ŸbË* 
Mv¬
);

60 
v¬ŸbË
*
mkliá
(cÚ¡ * 
Çme
, v¬ŸbË* 
Mv¬
);

61 
v¬ŸbË
*
mkm”ge
(cÚ¡ * 
Çme
);

62 
v¬ŸbË
*
mkshiá
(cÚ¡ * 
Çme
, 
shiáv®
);

63 
v¬ŸbË
*
mk¡¬‹r
(cÚ¡ * 
Çme
, 
maxg’
, 
Ï¡deg
, 
num¡¬t
);

66 
®Ÿs_ty³
(
v¬ŸbË
* 
p
);

69 
¡¬t_»c
*
¡_š™
(
maxg’
, 
Ï¡deg
, 
num¡¬t
);

70 
¡_kl
(
v¬ŸbË
* 
box
);

71 
¡_bounds
(
v¬ŸbË
* 
box
, 
¬gc
, * 
¬gv
[]);

72 
¡_¡¬t
(
v¬ŸbË
* 
box
, 
¬gc
, * 
¬gv
[]);

73 
ÿlc
(
v¬ŸbË
* 
box
, 
boŞ—n
 
dßÎdegs
, 
hideg
);

74 
doÿlc
(
v¬ŸbË
* 
box
);

75 
¡_µršt
(
¡¬t_»c
* 
s
);

78 
cŞl_degs
(
v¬ŸbË
* 
box
, 
dli¡
* 
dl
, 
deg
);

79 
cŞl_pŞy
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

82 
Œash_pŞy
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

85 
boŞ—n
 
em™_dodeg
(
v¬ŸbË
* 
box
, 
deg
);

88 
boŞ—n
 
£m™_dodeg
(
v¬ŸbË
* 
box
, 
deg
);

91 
boŞ—n
 
i¡d_dodeg
(
v¬ŸbË
* 
box
, 
deg
);

94 
boŞ—n
 
»s_dodeg
(
v¬ŸbË
* 
box
, 
deg
);

97 
šs_Äes
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

98 
boŞ—n
 
Äes_’ddeg
(
v¬ŸbË
* 
box
, 
deg
);

101 
boŞ—n
 
¡d_’ddeg
(
v¬ŸbË
* 
box
, 
deg
);

102 
¡d_degs
(
v¬ŸbË
* 
box
, 
dli¡
* 
dl
, 
deg
);

105 
mg_degs
(
v¬ŸbË
* 
box
, 
dli¡
* 
dl
, 
deg
);

106 
mg_pŞy
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

107 
boŞ—n
 
mg_’ddeg
(
v¬ŸbË
* 
box
, 
deg
);

110 
boŞ—n
 
shiá_dodeg
(
v¬ŸbË
* 
box
, 
deg
);

113 
boŞ—n
 
liá_’ddeg
(
v¬ŸbË
* 
box
, 
deg
);

114 
liá_pŞy
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

117 
£nd_pŞy
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

	@charp.c

4 
	~"sh¬ed.h
"

5 
	~"ch¬p.h
"

7 
	t¬™h
;

9 
	gch¬ac
;

10 
¬™h
 
	gch¬aş
;

11 
	gh®f_pos
;

12 
	gh®f_Ãg
;

14 
f›ld
 
	gfd_z”o
 = 0;

15 
f›ld
 
	gfd_Úe
 = 1;

16 
	gf›ld_size
 = (
f›ld
);

18 
	$š™_ch¬p
(
ch¬aù”i¡ic
)

20 
ch¬ac
 = 
ch¬aù”i¡ic
;

21 
ch¬aş
 = 
ch¬ac
;

22 ià(
ch¬ac
 == 2)

24 
h®f_pos
 = 1;

25 
h®f_Ãg
 = 0;

29 
h®f_pos
 = (
ch¬ac
 - 1) / 2;

30 
h®f_Ãg
 = -
h®f_pos
;

32 
	}
}

34 
f›ld
 
	$nÜm®ize
(
¬™h
 
n
)

36 
f›ld
 
a
;

38 
a
 = (
f›ld
)(
n
 % 
ch¬ac
);

39 ià(
a
 < 
h®f_Ãg
)

40 
a
 = (
f›ld
)× + 
ch¬ac
);

41 ià(
a
 > 
h®f_pos
)

42 
a
 = (
f›ld
)× - 
ch¬ac
);

43  (
a
);

44 
	}
}

46 
	$gcd_ex‹nded
(
¬™h
 
a
,‡r™h 
b
,‡r™h* 
u
,‡r™h* 
v
,‡r™h* 
g
)

48 
¬™h
 
q
;

49 
¬™h
 
u1
, 
v1
, 
g1
;

50 
¬™h
 
u‹mp
, 
v‹mp
, 
g‹mp
;

52 
g1
 = 
b
;

53 
u1
 = 0;

54 
v1
 = 1;

55 *
g
 = 
a
;

56 *
u
 = 1;

57 *
v
 = 0;

58 
g1
 != 0)

60 
q
 = *
g
 / 
g1
;

61 
g‹mp
 = (*
g
è- 
q
 * 
g1
;

62 
u‹mp
 = (*
u
è- 
q
 * 
u1
;

63 
v‹mp
 = (*
v
è- 
q
 * 
v1
;

64 *
g
 = 
g1
;

65 *
u
 = 
u1
;

66 *
v
 = 
v1
;

67 
g1
 = 
g‹mp
;

68 
u1
 = 
u‹mp
;

69 
v1
 = 
v‹mp
;

71 
	}
}

73 
	$liá
(
m
, 
c
, * 
v2
, * 
v3
)

75 
¬™h
 
vv2
, 
vv3
;

76 
u1
, 
u2
, 
u3
, 
r1
, 
r2
, 
r3
, 
v1
;

77 
q
;

79 
vv3
 = 
c
;

80 
v1
 = 0;

81 
vv2
 = 1;

82 
u3
 = 
m
;

83 
u1
 = 1;

84 
u2
 = 0;

85 2 * (
vv3
è* (vv3è>ğ
m
)

87 
q
 = 
u3
 / ()(
vv3
);

88 
r3
 = (
u3
è- 
q
 * ()(
vv3
);

89 
r1
 = (
u1
è- 
q
 * 
v1
;

90 
r2
 = (
u2
è- 
q
 * ()(
vv2
);

91 
u3
 = ()
vv3
;

92 
u1
 = 
v1
;

93 
u2
 = ()
vv2
;

94 
vv3
 = 
r3
;

95 
v1
 = 
r1
;

96 
vv2
 = 
r2
;

98 ià(2 * (
vv2
è* (vv2è>ğ
m
)

99 (
vv2
) = 0;

100 *
v2
 = ()
vv2
;

101 *
v3
 = ()
vv3
;

102 
	}
}

104 
	$fd_add
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
)

106 
¬™h
 
v®
 = 
a
;

107 
v®
 +ğ
b
;

108 *
c
 = 
	`nÜm®ize
(
v®
);

109 
	}
}

111 
	$fd_sub
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
)

113 
¬™h
 
v®
 = 
a
;

114 
v®
 -ğ
b
;

115 *
c
 = 
	`nÜm®ize
(
v®
);

116 
	}
}

118 
	$fd_muÉ
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
)

120 
¬™h
 
v®
 = 
a
;

121 
v®
 *ğ
b
;

122 *
c
 = 
	`nÜm®ize
(
v®
);

123 
	}
}

125 
	$fd_Ãg©e
(
f›ld
* 
a
)

127 
¬™h
 
v®
 = -(*
a
);

128 *
a
 = 
	`nÜm®ize
(
v®
);

129 
	}
}

131 
	$fd_div
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
)

133 
¬™h
 
bl
 = 
b
;

134 
¬™h
 
v®
;

135 
¬™h
 
bšv
, 
m
, 
n
;

137 
	`gcd_ex‹nded
(
bl
, 
ch¬aş
, &
bšv
, &
m
, &
n
);

138 
v®
 = 
a
 * 
bšv
 * 
n
;

139 *
c
 = 
	`nÜm®ize
(
v®
);

140 
	}
}

142 
	$fd_»c
(
f›ld
* 
a
)

144 
¬™h
 
®
 = *
a
;

145 
¬™h
 
v®
;

146 
¬™h
 
ašv
, 
m
, 
n
;

148 
	`gcd_ex‹nded
(
®
, 
ch¬aş
, &
ašv
, &
m
, &
n
);

149 
v®
 = 
ašv
 * 
n
;

150 *
a
 = 
	`nÜm®ize
(
v®
);

151 
	}
}

153 
f›ld
 
	$fd_cİy
(
f›ld
 
a
)

155  (
a
);

156 
	}
}

158 
boŞ—n
 
	$fd_isz”o
(
f›ld
 
a
)

160  (
a
 == 0);

161 
	}
}

	@charp.h

5 
š™_ch¬p
(
ch¬aù”i¡ic
);

6 
f›ld
 
nÜm®ize
(
n
);

7 
gcd_ex‹nded
(
a
, 
b
, * 
u
, * 
v
, * 
g
);

8 
liá
(
m
, 
c
, * 
v2
, * 
v3
);

9 
fd_add
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
);

10 
fd_sub
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
);

11 
fd_muÉ
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
);

12 
fd_Ãg©e
(
f›ld
* 
a
);

13 
fd_div
(
f›ld
 
a
, f›ld 
b
, f›ld* 
c
);

14 
fd_»c
(
f›ld
* 
a
);

15 
f›ld
 
fd_cİy
(f›ld 
a
);

16 
boŞ—n
 
fd_isz”o
(
f›ld
 
a
);

19 
ch¬ac
;

20 
f›ld
 
fd_z”o
;

21 
f›ld
 
fd_Úe
;

22 
f›ld_size
;

	@cmdnames.c

4 
	~"sh¬ed.h
"

5 
	~"cmdÇmes.h
"

8 
	~<£tjmp.h
>

9 
	~"cmds.h
"

10 
	~"¡dcmds.h
"

11 
	~"»scmds.h
"

12 
	~"¥cmds.h
"

13 
	~"b‘ti.h
"

14 
	~"h–p.h
"

15 
	~"ršg.h
"

16 
	~"qršg.h
"

17 
	~"v¬s.h
"

18 
	~"£t.h
"

19 
	~"sh–l.h
"

20 
	~"dÙ_âs.h
"

21 
	~"ed.h
"

22 
	~"humª_io.h
"

23 
	~"šput.h
"

24 
	~"hb.h
"

25 
	~"hb2.h
"

26 
	~"pŞy.h
"

27 
	~"´pŞy.h
"

28 
	~"gm_cmds.h
"

29 
	~"gm©rix.h
"

30 
	~"boxcmds.h
"

31 
	~"¡ash.h
"

32 
	~"d‘.h
"

33 
	~"g‘d‘.h
"

34 
	~"koszul.h
"

35 
	~"š‹r£ù.h
"

36 
	~"šhomog.h
"

37 
	~"ch¬p.h
"

38 
	~"rm­.h
"

39 
	~"mÚid—l.h
"

40 
	~"¡©s.h
"

41 
	~"hulb.h
"

42 
	~"mÚ™Ü.h
"

67 #ifdeà
__şªg__


68 #´agm¨
şªg
 
dŸgno¡ic
 
push


69 #´agm¨
şªg
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type-mismatch"

70 #´agm¨
şªg
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

72 #ifdeà
__GNUC__


73 #´agm¨
GCC
 
dŸgno¡ic
 
push


74 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

77 
cmd_»c
 
	gcmd_li¡
[] = {{".", (
cmd_func
)
dÙ_cmd
, 0},

78 {"ac", (
cmd_func
)
ac_cmd
, 0},

79 {"add", (
cmd_func
)
add_cmd
, 3},

80 {"¬", (
cmd_func
)
¬_cmd
, 0},

81 {"¬gs", (
cmd_func
)
¬gs_cmd
, 0},

82 {"b‘ti", (
cmd_func
)
b‘ti_cmd
, 0},

83 {"bšoms", (
cmd_func
)
bšoms_cmd
, 3},

84 {"ÿche_mem", (
cmd_func
)
ÿchemem_cmd
, 0},

85 {"ÿlc", (
cmd_func
)
ÿlc_cmd
, 0},

86 {"ÿt", (
cmd_func
)
ÿt_cmd
, 2},

87 {"cdœ", (
cmd_func
)
cdœ_cmd
, 0},

88 {"û", (
cmd_func
)
û_cmd
, 0},

89 {"ch¬aù”i¡ic", (
cmd_func
)
ch¬ac_cmd
, 2},

90 {"chÿlc", (
cmd_func
)
chÿlc_cmd
, 0},

91 {"codim", (
cmd_func
)
codim_cmd
, 2},

92 {"cÛf", (
cmd_func
)
cÛf_cmd
, 3},

93 {"cŞ_deg»e", (
cmd_func
)
cŞdeg_cmd
, 3},

94 {"cŞ_degs", (
cmd_func
)
cŞdegs_cmd
, 0},

95 {"commªds", (
cmd_func
)
commªds_cmd
, 0},

96 {"com´ess", (
cmd_func
)
com´ess_cmd
, 2},

97 {"cÚÿt", (
cmd_func
)
cÚÿt_cmd
, 0},

98 {"cÚtšue", (
cmd_func
)
cÚtšue_cmd
, 0},

99 {"cÚŒaù", (
cmd_func
)
diff_cmd
, 3},

100 {"cİy", (
cmd_func
)
cİy_cmd
, 2},

101 {"deg»e", (
cmd_func
)
deg»e_cmd
, 3},

102 {"d‘”mšªts", (
cmd_func
)
d‘”mšªts_cmd
, 3},

103 {"dŸg", (
cmd_func
)
dŸg_cmd
, 2},

104 {"diff", (
cmd_func
)
diff_cmd
, 3},

105 {"dshiá", (
cmd_func
)
dshiá_cmd
, 0},

106 {"dsum", (
cmd_func
)
dsum_cmd
, 3},

107 {"echo", (
cmd_func
)
ech_cmd
, 0},

108 {"ed™", (
cmd_func
)
ed™_cmd
, 0},

109 {"ed™_m­", (
cmd_func
)
modrm­_cmd
, 0},

110 {"–im", (
cmd_func
)
–im_cmd
, 2},

111 {"’dmÚ", (
cmd_func
)
’d_mÚ™Ü
, 0},

112 {"ev", (
cmd_func
)
ev_cmd
, 3},

113 {"ex™", (
cmd_func
)
ex™_cmd
, 0},

114 {"ãtch", (
cmd_func
)
ãtch_cmd
, 2},

115 {"æ©‹n", (
cmd_func
)
æ©‹n_cmd
, 2},

116 {"fÜû¡d", (
cmd_func
)
fÜû¡d_cmd
, 2},

117 {"h–p", (
cmd_func
)
h–p_cmd
, 0},

118 {"h–p_fe", (
cmd_func
)
h–pfe_cmd
, 0},

119 {"hb", (
cmd_func
)
hb_cmd
, 0},

120 {"hb_num”", (
cmd_func
)
hb_num”_cmd
, 3},

121 {"homog", (
cmd_func
)
homog_cmd
, 3},

122 {"hulb", (
cmd_func
)
hulb_cmd
, 0},

123 {"id—l", (
cmd_func
)
id—l_cmd
, 1},

124 {"id’", (
cmd_func
)
id’_cmd
, 2},

125 {"if", (
cmd_func
)
if_cmd
, 0},

126 {"im­", (
cmd_func
)
im­_cmd
, 0},

127 {"š", (
cmd_func
)
š_cmd
, 2},

128 {"šü_£t", (
cmd_func
)
šc£t_cmd
, 0},

129 {"š·¹", (
cmd_func
)
š·¹_cmd
, 2},

130 {"št", (
cmd_func
)
št_cmd
, 0},

131 {"š‹r£ù", (
cmd_func
)
š‹r_cmd
, 3},

132 {"is_z”o", (
cmd_func
)
isz”o_cmd
, 2},

133 {"jacob", (
cmd_func
)
jacob_cmd
, 2},

134 {"jump", (
cmd_func
)
jump_cmd
, 0},

135 {"k_basis", (
cmd_func
)
basis_cmd
, 2},

136 {"k“p", (
cmd_func
)
k“p_cmd
, 2},

137 {"kl", (
cmd_func
)
kl_cmd
, 0},

138 {"koszul", (
cmd_func
)
koszul_cmd
, 3},

139 {"liá", (
cmd_func
)
liá_cmd
, 3},

140 {"liá_¡d", (
cmd_func
)
liá¡d_cmd
, 2},

141 {"li¡v¬s", (
cmd_func
)
li¡v¬s_cmd
, 0},

142 {"m©", (
cmd_func
)
m©_cmd
, 1},

143 {"max", (
cmd_func
)
max_cmd
, 2},

144 {"mc", (
cmd_func
)
mc_cmd
, 0},

145 {"mš", (
cmd_func
)
mš_cmd
, 2},

146 {"modulo", (
cmd_func
)
modulo_cmd
, 3},

147 {"mÚ™Ü", (
cmd_func
)
mÚ_cmd
, 0},

148 {"mÚoms", (
cmd_func
)
mÚoms_cmd
, 3},

149 {"mÚ´imes", (
cmd_func
)
mÚ´imes_cmd
, 3},

150 {"mr", (
cmd_func
)
mr_cmd
, 0},

151 {"muÉ", (
cmd_func
)
muÉ_cmd
, 3},

152 {"ncŞs", (
cmd_func
)
ncŞs_cmd
, 2},

153 {"Äes", (
cmd_func
)
Äes_cmd
, 2},

154 {"Äows", (
cmd_func
)
Äows_cmd
, 2},

155 {"numšfo", (
cmd_func
)
numšfo_cmd
, 0},

156 {"nv¬s", (
cmd_func
)
nv¬s_cmd
, 2},

157 {"ou‹r", (
cmd_func
)
ou‹r_cmd
, 3},

158 {"·th", (
cmd_func
)
·th_cmd
, 0},

159 {"pc", (
cmd_func
)
pc_cmd
, 0},

160 {"pçff", (
cmd_func
)
pçff_cmd
, 2},

161 {"pm­", (
cmd_func
)
pm­_cmd
, 0},

162 {"pŞy", (
cmd_func
)
pŞy_cmd
, 0},

163 {"pow”", (
cmd_func
)
pow”_cmd
, 3},

164 {"´", (
cmd_func
)
´_cmd
, 0},

165 {"´es", (
cmd_func
)
´es_cmd
, 0},

166 {"´e£Á_ršg", (
cmd_func
)
´e£Áršg_cmd
, 2},

167 {"´šg", (
cmd_func
)
´šg_cmd
, 0},

168 {"´m©", (
cmd_func
)
´m©_cmd
, 0},

169 {"putchªge", (
cmd_func
)
putchªge_cmd
, 2},

170 {"putm©", (
cmd_func
)
putm©_cmd
, 0},

171 {"put¡d", (
cmd_func
)
put¡d_cmd
, 2},

172 {"qršg", (
cmd_func
)
qršg_cmd
, 2},

173 {"qu™", (
cmd_func
)
ex™_cmd
, 0},

174 {"quÙ›Á", (
cmd_func
)
quÙ_cmd
, 3},

175 {"¿ndom", (
cmd_func
)
¿ndom_cmd
, 3},

176 {"»duû", (
cmd_func
)
»duû_cmd
, 3},

177 {"»s", (
cmd_func
)
»s_cmd
, 2},

178 {"»£t", (
cmd_func
)
»£t_cmd
, 0},

179 {"ršg", (
cmd_func
)
ršg_cmd
, 1},

180 {"ršg_äom_cŞs", (
cmd_func
)
ršgcŞ_cmd
, 2},

181 {"ršg_äom_rows", (
cmd_func
)
ršgrow_cmd
, 2},

182 {"ršg_sum", (
cmd_func
)
ršgsum_cmd
, 3},

183 {"rm­", (
cmd_func
)
rm­_cmd
, 0},

184 {"row_deg»e", (
cmd_func
)
rowdeg_cmd
, 3},

185 {"row_degs", (
cmd_func
)
rowdegs_cmd
, 0},

186 {"§t", (
cmd_func
)
§t_cmd
, 0},

187 {"£t", (
cmd_func
)
£t_cmd
, 0},

188 {"£t_v®ue", (
cmd_func
)
£tv®ue_cmd
, 2},

189 {"£tcŞdegs", (
cmd_func
)
£tcŞdegs_cmd
, 0},

190 {"£tdegs", (
cmd_func
)
£tdegs_cmd
, 0},

191 {"£Œšg", (
cmd_func
)
£Œšg_cmd
, 0},

192 {"shout", (
cmd_func
)
shout_cmd
, 0},

193 {"size", (
cmd_func
)
size_cmd
, 0},

194 {"smuÉ", (
cmd_func
)
smuÉ_cmd
, 3},

195 {"¥aû", (
cmd_func
)
¥aû_cmd
, 0},

196 {"¥aœs", (
cmd_func
)
¥aœs_cmd
, 0},

197 {"¥¬e", (
cmd_func
)
¥¬e_cmd
, 0},

198 {"¥¬£", (
cmd_func
)
¥¬£_cmd
, 1},

199 {"¡d", (
cmd_func
)
¡d_cmd
, 2},

200 {"¡d_mšim®", (
cmd_func
)
¡dmš_cmd
, 2},

201 {"¡d·¹", (
cmd_func
)
¡d·¹_cmd
, 2},

202 {"subm©", (
cmd_func
)
subm©_cmd
, 2},

203 {"subŒaù", (
cmd_func
)
sub_cmd
, 3},

204 {"syz", (
cmd_func
)
syz_cmd
, 3},

205 {"‹nsÜ", (
cmd_func
)
‹nsÜ_cmd
, 3},

206 {"Œaû", (
cmd_func
)
Œaû_cmd
, 2},

207 {"Œª¥o£", (
cmd_func
)
Œªs_cmd
, 2},

208 {"Œunÿ‹", (
cmd_func
)
Œunÿ‹_cmd
, 2},

209 {"ty³", (
cmd_func
)
ty³_cmd
, 0},

210 {"v”siÚ", (
cmd_func
)
v”s_cmd
, 0},

211 {"wedge", (
cmd_func
)
wedge_cmd
, 3},

212 {"", 
NULL
, 0}};

215 #ifdeà
__şªg__


216 #´agm¨
şªg
 
dŸgno¡ic
 
pİ


218 #ifdeà
__GNUC__


219 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


	@cmdnames.h

5 (*
	tcmd_func
)(
	t¬gc
, *
	t¬gv
[]);

8 
	scmd_»c


10 cÚ¡ *
Çme
;

11 
cmd_func
 
´oc
;

12 
¬gs
;

13 } 
	tcmd_»c
;

16 
cmd_»c
 
cmd_li¡
[];

	@cmds.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<£tjmp.h
>

8 
	~"sh¬ed.h
"

9 
	~"cmds.h
"

10 
	~"v¬s.h
"

11 
	~"ršg.h
"

12 
	~"gm©rix.h
"

13 
	~"mÚ™Ü.h
"

14 
	~"šput.h
"

15 
	~"·r£.h
"

16 
	~"humª_io.h
"

17 
	~"qršg.h
"

18 
	~"pŞy.h
"

19 
	~"¡ªd¬d.h
"

20 
	~"cmdÇmes.h
"

21 
	~"£t.h
"

22 
	~"sh–l.h
"

23 
	~"ch¬p.h
"

24 
	~"¶i¡.h
"

25 
	~"¡dcmds.h
"

26 
	~"g’”ic.h
"

28 
	~"gm_dli¡.h
"

29 
	~"rv¬.h
"

30 
	~"·r£pŞy.h
"

33 
cÚ¡ex´
 
	gIDSIZE
 = 50;

38 
šlše
 
gm©rix
 
	$VAR_MODULE
(
v¬ŸbË
 *
p
)

40  
	`v¬_g‘_moduË
(
p
);

41 
	}
}

43 
šlše
 
ršg
 
	$VAR_RING
(
v¬ŸbË
 *
p
)

45  
	`v¬_g‘_ršg
(
p
);

46 
	}
}

48 
šlše
 
v¬ŸbË
 *
	$VREF
(
n
)

50  
	`v»f
(
n
);

51 
	}
}

53 
šlše
 
	$DREF
(
dli¡
 
dl
, 
i
)

55  
	`dli¡_»f
(&
dl
, 
i
);

56 
	}
}

62 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
g
, 
¬gc
, **
¬gv
, 
i
)

64 ià(
i
 >ğ
¬gc
)

65  
çl£
;

66 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

67  (*
g
 !ğ
NULL
);

68 
	}
}

70 
šlše
 
boŞ
 
	$g‘_vršg
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

72 ià(
i
 >ğ
¬gc
)

73  
çl£
;

74 *
p
 = 
	`vg‘_ršg
(
¬gv
[
i
]);

75  (*
p
 !ğ
NULL
);

76 
	}
}

78 
šlše
 
boŞ
 
	$g‘_ršg_¬g
(
ršg
 *
R
, 
¬gc
, **
¬gv
, 
i
)

80 ià(
i
 >ğ
¬gc
)

81  
çl£
;

82 *
R
 = 
	`g‘_ršg
(
¬gv
[
i
]);

83  (*
R
 !ğ
NULL
);

84 
	}
}

86 
šlše
 
boŞ
 
	$Ãw_ršg
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

88 ià(
i
 >ğ
¬gc
)

89  
çl£
;

90 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VRING
, 
NULL
);

91  (*
p
 !ğ
NULL
);

92 
	}
}

94 
šlše
 
boŞ
 
	$Ãw_mod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

96 ià(
i
 >ğ
¬gc
)

97  
çl£
;

98 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

99  (*
p
 !ğ
NULL
);

100 
	}
}

102 
šlše
 
boŞ
 
	$Ãw_št
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

104 ià(
i
 >ğ
¬gc
)

105  
çl£
;

106 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VINT
, 
NULL
);

107  (*
p
 !ğ
NULL
);

108 
	}
}

110 
šlše
 
boŞ
 
	$Ãw_§vršg
(
v¬ŸbË
 **
p
, *
s
)

112 *
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VRING
, 
NULL
);

113  (*
p
 !ğ
NULL
);

114 
	}
}

116 
šlše
 
boŞ
 
	$Ãw_§vmod
(
v¬ŸbË
 **
p
, *
s
)

118 *
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

119  (*
p
 !ğ
NULL
);

120 
	}
}

130 
v¬ŸbË
 *
	$vg‘mod
(cÚ¡ *
Çme
)

132 
v¬ŸbË
 *
p
;

134 
p
 = 
	`fšd_v¬
(
Çme
);

135 ià(
p
 =ğ
NULL
)

136  (
NULL
);

137 ià(
p
->
b_®Ÿs
 !ğ
NULL
)

138 
p
 =…->
b_®Ÿs
;

139 ià(!
	`is_a_moduË
(
p
))

141 
	`´”rÜ
("; variable isn't‡ module\n");

142  (
NULL
);

144  (
p
);

145 
	}
}

147 
v¬ŸbË
 *
	$vg‘_vmod
(cÚ¡ *
Çme
)

149 
v¬ŸbË
 *
p
;

151 
p
 = 
	`fšd_v¬
(
Çme
);

152 ià(
p
 =ğ
NULL
)

153  (
NULL
);

154 ià(
p
->
b_®Ÿs
 !ğ
NULL
)

155 
p
 =…->
b_®Ÿs
;

156 ià(!
	`is_a_moduË
(
p
))

158 
	`´”rÜ
("; variable isn't‡ module\n");

159  (
NULL
);

163 
	`vrg_š¡®l
(
p
->
b_ršg
);

164  (
p
);

166 
	}
}

168 
gm©rix
 
	$vg‘_mod
(cÚ¡ *
Çme
)

170 
v¬ŸbË
 *
p
;

172 
p
 = 
	`vg‘_vmod
(
Çme
);

173 ià(
p
 =ğ
NULL
)

174  (
NULL
);

176  (
	`VAR_MODULE
(
p
));

177 
	}
}

179 
gm©rix
 
	$vg‘_rgmod
(cÚ¡ *
Çme
)

181 
v¬ŸbË
 *
p
;

183 
p
 = 
	`vg‘mod
(
Çme
);

184 ià(
p
 =ğ
NULL
)

185  (
NULL
);

186 ià(
p
->
b_ršg
 !ğ
cu¼’t_ršg
)

188 
	`´”rÜ
("; v¬ŸbË % ha difã»Á o¸šcÜ»ù ba£„šg\n", 
Çme
);

189  (
NULL
);

191  (
	`VAR_MODULE
(
p
));

192 
	}
}

198 
v¬ŸbË
 *
	$vg‘_ršg
(cÚ¡ *
Çme
)

200 
v¬ŸbË
 *
p
;

202 
p
 = 
	`fšd_v¬
(
Çme
);

203 ià(
p
 =ğ
NULL
)

204  (
NULL
);

205 ià(
p
->
ty³
 !ğ
VRING
)

207 
p
 =…->
b_ršg
;

208 ià(
p
 =ğ
NULL
)

210 
	`´”rÜ
("; v¬ŸbË % ha nØba£„šg\n", 
Çme
);

211  (
NULL
);

214 
	`debug_as£¹
("; iÁ”ÇÈ”rÜ: bad ba£„šg", 
p
->
ty³
 =ğ
VRING
);

215 
	`vrg_š¡®l
(
p
);

216  (
p
);

217 
	}
}

219 
ršg
 
	$g‘_ršg
(cÚ¡ *
Çme
)

221 
v¬ŸbË
 *
p
;

223 
p
 = 
	`vg‘_ršg
(
Çme
);

224  (
	`VAR_RING
(
p
));

225 
	}
}

237 
	$do_ršg_v¬s
()

239 
v¬ŸbË
 *
p
, *
q
;

240 
s
[100];

242 ià(
cu¼’t_ršg
 =ğ
NULL
)

244 
	`¥rštf
(
s
, "%s'z”o", 
cu¼’t_ršg
->
Çme
);

245 
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

246 
	`£t_v®ue
(
p
, (
ADDRESS
)
	`mod_š™
());

247 
q
 = 
	`make_v¬
(
cu¼’t_ršg
->
Çme
, 
MAINVAR
, 
VMODULE
, current_ring);

248 
	`£t_v®ue
(
q
, (
ADDRESS
)
	`gm_v¬s
());

250 
	}
}

252 
	$ršg_cmd
(
¬gc
, *
¬gv
[])

254 
v¬ŸbË
 *
p
;

255 
s
[
IDSIZE
];

256 
ršg
 
R
;

258 ià(
¬gc
 != 2)

260 
	`´šŠew
("ring <result„ing>\n");

263 
	`¡rıy
(
s
, 
¬gv
[1]);

264 
R
 = 
	`rgSÿn
();

265 
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VRING
, 
NULL
);

266 ià(
p
 =ğ
NULL
)

268 
	`£t_v®ue
(
p
, (
ADDRESS
)
R
);

269 
	`vrg_š¡®l
(
p
);

270 
	`do_ršg_v¬s
();

272 
	}
}

274 
	$ršgsum_cmd
(
¬gc
, *
¬gv
[])

276 
v¬ŸbË
 *
RR1
, *
RR2
;

277 
ršg
 
R1
, 
R2
;

278 
v¬ŸbË
 *
p
, *
q
;

280 ià(
¬gc
 != 4)

282 
	`´šŠew
("ring_sum <ring1> <ring2> <result„ing>\n");

285 ià(!
	`g‘_vršg
(&
RR1
, 
¬gc
, 
¬gv
, 1))

287 ià(!
	`g‘_vršg
(&
RR2
, 
¬gc
, 
¬gv
, 2))

289 
R1
 = 
	`VAR_RING
(
RR1
);

290 
R2
 = 
	`VAR_RING
(
RR2
);

291 ià(!
	`Ãw_ršg
(&
p
, 
¬gc
, 
¬gv
, 3))

296 
	`£t_v®ue
(
p
, (
ADDRESS
)
	`rgSum
(
R1
, 
R2
));

297 
	`vrg_š¡®l
(
p
);

298 ià((
	`isQRšg
(
RR1
)è|| (isQRšg(
RR2
)))

300 
q
 = 
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VRING
, 
cu¼’t_ršg
);

301 ià(
q
 =ğ
NULL
)

303 
	`£t_v®ue
(
q
, (
ADDRESS
)
	`qrgSum
(
RR1
, 
RR2
, 
p
));

304 
	`vrg_š¡®l
(
q
);

306 
	`do_ršg_v¬s
();

308 
	}
}

310 
	$£Œšg_cmd
(
¬gc
, *
¬gv
[])

312 
v¬ŸbË
 *
p
;

314 ià(
¬gc
 != 2)

316 
	`´šŠew
("setring <new current„ing>\n");

319 
p
 = 
	`vg‘_ršg
(
¬gv
[1]);

320 ià(
p
 =ğ
NULL
)

322 
	`vrg_š¡®l
(
p
);

324 
	}
}

326 
	$´šg_cmd
(
¬gc
, *
¬gv
[])

328 
v¬ŸbË
 *
p
;

330 ià(
¬gc
 == 1)

332 
	`Ãwlše
();

333 ià(
cu¼’t_ršg
 !ğ
NULL
)

335 
	`´št
("cu¼’ˆršg i %s\n", 
cu¼’t_ršg
->
Çme
);

336 
	`rgDi¥Ïy
(
outfe
, 
	`VAR_RING
(
cu¼’t_ršg
));

339 
	`´št
("no current„ing\n");

342 
p
 = 
	`vg‘_ršg
(
¬gv
[1]);

343 ià(
p
 =ğ
NULL
)

345 
	`Ãwlše
();

346 
	`´št
("ršg %s\n", 
p
->
Çme
);

347 
	`rgDi¥Ïy
(
outfe
, 
	`VAR_RING
(
p
));

349 
	}
}

351 
	$ršgcŞ_cmd
(
¬gc
, *
¬gv
[])

353 
gm©rix
 
M
;

354 **
v¬s
;

355 
v¬ŸbË
 *
p
;

356 
s
[
IDSIZE
];

357 
ršg
 
R
;

359 ià(
¬gc
 != 3)

361 
	`´šŠew
("ring_from_cols <matrix> <result„ing>\n");

364 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

366 ià(
	`ncŞs
(
M
) == 0)

368 
	`´”rÜ
(";‚umber of columns must be…ositive\n");

371 
	`¡rıy
(
s
, 
¬gv
[2]);

372 
v¬s
 = 
	`g‘V¬s
(
	`ncŞs
(
M
));

373 ià(
v¬s
 =ğ
NULL
)

375 
R
 = 
	`rgFromDeg»es
(&
M
->
degg’s
, 
v¬s
);

376 ià(!
	`Ãw_§vršg
(&
p
, 
s
))

378 
	`£t_v®ue
(
p
, (
ADDRESS
)
R
);

379 
	`vrg_š¡®l
(
p
);

380 
	`do_ršg_v¬s
();

382 
	}
}

384 
	$ršgrow_cmd
(
¬gc
, *
¬gv
[])

386 
gm©rix
 
M
;

387 **
v¬s
;

388 
v¬ŸbË
 *
p
;

389 
s
[
IDSIZE
];

390 
ršg
 
R
;

392 ià(
¬gc
 != 3)

394 
	`´šŠew
("ring_from_rows <matrix> <result„ing>\n");

397 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

399 ià(
	`Äows
(
M
) == 0)

401 
	`´”rÜ
(";‚umber of„ows must be…ositive\n");

404 
	`¡rıy
(
s
, 
¬gv
[2]);

405 
v¬s
 = 
	`g‘V¬s
(
	`Äows
(
M
));

406 ià(
v¬s
 =ğ
NULL
)

408 
R
 = 
	`rgFromDeg»es
(&
M
->
deg»es
, 
v¬s
);

409 ià(!
	`Ãw_ršg
(&
p
, 
¬gc
, 
¬gv
, 2))

411 
	`£t_v®ue
(
p
, (
ADDRESS
)
R
);

412 
	`vrg_š¡®l
(
p
);

413 
	`do_ršg_v¬s
();

415 
	}
}

417 
	$m©_cmd
(
¬gc
, *
¬gv
[])

419 
v¬ŸbË
 *
p
;

420 
¶ev
;

421 
gm©rix
 
M
;

422 
s
[
IDSIZE
];

424 ià((
¬gc
 < 2) || (argc > 3))

426 
	`´šŠew
("mat <result matrix> [optional: file‚ame]\n");

429 ià(
cu¼’t_ršg
 =ğ
NULL
)

431 
	`´”rÜ
(";‚o„ing defined yet\n");

434 ià(
¬gc
 == 3)

436 
¶ev
 = 
´Ëv–
;

437 ià(
	`İ’_tour
(
¬gv
[2]) == 0)

439 
´Ëv–
 = 1;

441 
	`¡rıy
(
s
, 
¬gv
[1]);

442 
M
 = 
	`m©_sÿn
();

443 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

445 
	`£t_v®ue
(
p
, (
ADDRESS
)
M
);

446 ià(
¬gc
 == 3)

447 
´Ëv–
 = 
¶ev
;

449 
	}
}

451 
	$¥¬£_cmd
(
¬gc
, *
¬gv
[])

453 
v¬ŸbË
 *
p
;

454 
¶ev
;

455 
s
[
IDSIZE
];

456 
gm©rix
 
M
;

458 ià((
¬gc
 < 2) || (argc > 3))

460 
	`´šŠew
("sparse <result matrix> [optional: file‚ame]\n");

463 ià(
cu¼’t_ršg
 =ğ
NULL
)

465 
	`´”rÜ
(";‚o„ing defined yet\n");

468 ià(
¬gc
 == 3)

470 
¶ev
 = 
´Ëv–
;

471 ià(
	`İ’_tour
(
¬gv
[2]) == 0)

473 
´Ëv–
 = 1;

475 
	`¡rıy
(
s
, 
¬gv
[1]);

476 
M
 = 
	`¥¬£_sÿn
();

477 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

479 
	`£t_v®ue
(
p
, (
ADDRESS
)
M
);

480 ià(
¬gc
 == 3)

481 
´Ëv–
 = 
¶ev
;

483 
	}
}

485 
	$id—l_cmd
(
¬gc
, *
¬gv
[])

487 
v¬ŸbË
 *
p
;

488 
gm©rix
 
M
;

489 
s
[
IDSIZE
];

491 ià(
¬gc
 != 2)

493 
	`´šŠew
("ideal <resulting matrix>\n");

496 ià(
cu¼’t_ršg
 =ğ
NULL
)

498 
	`´”rÜ
(";‚o„ing defined yet\n");

501 
	`¡rıy
(
s
, 
¬gv
[1]);

502 
M
 = 
	`id—l_sÿn
();

503 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

505 
	`£t_v®ue
(
p
, (
ADDRESS
)
M
);

507 
	}
}

509 
	$pŞy_cmd
(
¬gc
, *
¬gv
[])

511 
v¬ŸbË
 *
p
;

512 
gm©rix
 
f
;

513 
s
[
IDSIZE
];

515 ià(
¬gc
 < 3)

517 
	`´šŠew
("poly <result> <polynomial>\n");

520 ià(
cu¼’t_ršg
 =ğ
NULL
)

522 
	`´”rÜ
(";‚o„ing defined yet\n");

526 
	`¡rıy
(
s
, 
¬gv
[1]);

528 
f
 = 
	`pŞy_sÿn
(
¬gc
 - 2, 
¬gv
 + 2);

530 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

532 
	`£t_v®ue
(
p
, (
ADDRESS
)
f
);

534 
	}
}

536 
	$ıx_cmd
(
¬gc
, *
¬gv
[])

538 
v¬ŸbË
 *
p
;

539 
gm©rix
 
M
;

540 
s
[20];

541 
num
;

543 ià(
¬gc
 != 2)

545 
	`´šŠew
("cpx <resulting complex>\n");

549 ià(
cu¼’t_ršg
 =ğ
NULL
)

551 
	`´”rÜ
(";‚o„ing defined yet\n");

554 
p
 = 
	`make_v¬
(
¬gv
[1], 
MAINVAR
, 
VCOMPLEX
, 
cu¼’t_ršg
);

555 ià(
p
 =ğ
NULL
)

557 
num
 = 0;

558 (
M
 = 
	`m©_sÿn
()è!ğ
NULL
)

560 
	`´št
("\n");

561 
	`¥rštf
(
s
, "%d", 
num
);

562 
num
++;

563 
p
 = 
	`make_v¬
(
s
, 
PARTVAR
, 
VMODULE
, 
cu¼’t_ršg
);

564 
	`£t_v®ue
(
p
, (
ADDRESS
)
M
);

567 
	}
}

569 
	$put¡d_cmd
(
¬gc
, *
¬gv
[])

571 
gm©rix
 
M
;

572 
v¬ŸbË
 *
p
;

574 ià((
¬gc
 < 2) || (argc > 3))

576 
	`´šŠew
("putstd <standard basis> [optional:„esult matrix]\n");

579 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

581 ià(
¬gc
 == 2)

582 
	`put_¡d
(
outfe
, 
M
, 
USESTD
);

585 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

587 
	`£t_v®ue
(
p
, (
ADDRESS
)
	`gm_¡d
(
M
, 
USESTD
));

590 
	}
}

592 
	$putchªge_cmd
(
¬gc
, *
¬gv
[])

594 
gm©rix
 
M
;

595 
v¬ŸbË
 *
p
;

597 ià((
¬gc
 < 2) || (argc > 3))

599 
	`´šŠew
("putchange <standard basis> [optional:„esult matrix]\n");

602 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

604 ià(
¬gc
 == 2)

605 
	`put_¡d
(
outfe
, 
M
, 
USECHANGE
);

608 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

610 
	`£t_v®ue
(
p
, (
ADDRESS
)
	`gm_¡d
(
M
, 
USECHANGE
));

613 
	}
}

615 
	$rowdegs_cmd
(
¬gc
, *
¬gv
[])

617 
gm©rix
 
M
, 
N
;

618 
v¬ŸbË
 *
p
;

620 ià((
¬gc
 < 2) || (argc > 3))

622 
	`´šŠew
("row_degs <matrix> [row degrees]\n");

625 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

627 ià(
¬gc
 == 3)

629 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

631 
N
 = 
	`mod_š™
();

632 
	`dl_cİy
(&
M
->
deg»es
, &
N
->degrees);

633 
	`£t_v®ue
(
p
, (
ADDRESS
)
N
);

637 
	`âewlše
(
outfe
);

638 
	`dlDi¥Ïy
(
outfe
, &(
M
->
deg»es
), 
lšesize
);

641 
	}
}

643 
	$cŞdegs_cmd
(
¬gc
, *
¬gv
[])

645 
gm©rix
 
M
, 
N
;

646 
v¬ŸbË
 *
p
;

648 ià((
¬gc
 < 2) || (argc > 3))

650 
	`´šŠew
("col_degs <matrix> [column degrees]\n");

653 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

655 ià(
¬gc
 == 3)

657 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

659 
N
 = 
	`mod_š™
();

660 
	`dl_cİy
(&
M
->
degg’s
, &
N
->
deg»es
);

661 
	`£t_v®ue
(
p
, (
ADDRESS
)
N
);

665 
	`âewlše
(
outfe
);

666 
	`dlDi¥Ïy
(
outfe
, &(
M
->
degg’s
), 
lšesize
);

669 
	}
}

671 
	$putm©_cmd
(
¬gc
, *
¬gv
[])

673 
gm©rix
 
M
;

675 ià(
¬gc
 != 2)

677 
	`´šŠew
("putmat <matrix>\n");

680 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

682 
	`putm©
(
outfe
, 
M
);

684 
	}
}

686 
	$´es_cmd
(
¬gc
, *
¬gv
[])

688 
gm©rix
 
M
;

689 
v¬ŸbË
 *
p
;

690 
v
;

692 ià(
¬gc
 != 2)

694 
	`´šŠew
("pres <complex> \n");

697 
p
 = 
	`fšd_v¬
(
¬gv
[1]);

698 ià(
p
 =ğ
NULL
)

700 
v
 = 
p
->
v¬_num
;

701 
p
 = 
	`VREF
(
v
);

704 ià(
	`is_a_moduË
(
p
))

706 ià(
p
->
Çme
[0] != '0')

708 
M
 = 
	`VAR_MODULE
(
p
);

709 ià(
	`ncŞs
(
M
) == 0)

711 
	`vrg_š¡®l
(
p
->
b_ršg
);

712 
	`âewlše
(
outfe
);

713 
	`åršt
(
outfe
, "\n");

714 
	`âewlše
(
outfe
);

715 
	`åršt
(
outfe
, "----------------------------------\n\n");

716 
	`¶_µršt
(
outfe
, &(
M
->
g’s
), 
	`Äows
(M), 
lšesize
);

719 
v
++;

720 ià(
v
 > 
Ï¡_v¬
)

722 
p
 = 
	`VREF
(
v
);

723 } 
p
->
exi¡s
 =ğ
PARTVAR
);

724 
	`âewlše
(
outfe
);

725 
	`åršt
(
outfe
, "\n");

726 
	`âewlše
(
outfe
);

727 
	`åršt
(
outfe
, "----------------------------------\n\n");

729 
	}
}

731 
	$cİy_cmd
(
¬gc
, *
¬gv
[])

733 
gm©rix
 
MŞd
;

734 
v¬ŸbË
 *
Ãwv
;

736 ià(
¬gc
 != 3)

738 
	`´šŠew
("copy <existing matrix> <copy of matrix>\n");

741 ià(!
	`g‘_mod
(&
MŞd
, 
¬gc
, 
¬gv
, 1))

743 ià(!
	`Ãw_mod
(&
Ãwv
, 
¬gc
, 
¬gv
, 2))

745 
	`£t_v®ue
(
Ãwv
, (
ADDRESS
)
	`m©_cİy
(
MŞd
));

747 
	}
}

749 
	$numšfo_cmd
(
¬gc
, *
¬gv
[])

751 
gm©rix
 
M
;

752 
v¬ŸbË
 *
p
;

753 
v
;

755 ià(
¬gc
 != 2)

757 
	`´šŠew
("numinfo <res>\n");

760 
p
 = 
	`fšd_v¬
(
¬gv
[1]);

761 ià(
p
 =ğ
NULL
)

763 
v
 = 
p
->
v¬_num
;

764 
	`âewlše
(
outfe
);

765 
	`åršt
(
outfe
, "name #rows #cols #standard degrees\n");

768 ià(
	`is_a_moduË
(
p
))

770 
M
 = 
	`VAR_MODULE
(
p
);

771 ià(
	`ncŞs
(
M
) == 0)

773 
	`âewlše
(
outfe
);

774 
	`åršt
(
outfe
, "%-8s", 
p
->
Çme
);

775 
	`åršt
(
outfe
, "%-6d", 
	`Äows
(
M
));

776 
	`åršt
(
outfe
, "%-6d", 
	`ncŞs
(
M
));

777 
	`åršt
(
outfe
, "%-11d", 
M
->
n¡ªd¬d
);

778 
di¥Ïy_width
 = 
lšesize
 - 31;

779 ià(
di¥Ïy_width
 < 10)

780 
di¥Ïy_width
 = 10;

781 
	`dlDi¥Ïy
(
outfe
, &(
M
->
degg’s
), 
di¥Ïy_width
);

783 
v
++;

784 ià(
v
 > 
Ï¡_v¬
)

786 
p
 = 
	`VREF
(
v
);

787 } 
p
->
exi¡s
 =ğ
PARTVAR
);

789 
	}
}

791 
	$£tdegs_cmd
(
¬gc
, *
¬gv
[])

793 
gm©rix
 
M
;

795 ià(
¬gc
 != 2)

797 
	`´šŠew
("setdegs <matrix>\n");

800 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

802 
	`£tdegs
(
M
);

804 
	}
}

806 
	$£tcŞdegs_cmd
(
¬gc
, *
¬gv
[])

808 
gm©rix
 
M
;

810 ià(
¬gc
 != 2)

812 
	`´šŠew
("setcoldegs <matrix>\n");

815 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

817 
	`£tdegg’s
(
M
);

819 
	}
}

821 
	$dshiá_cmd
(
¬gc
, *
¬gv
[])

823 
gm©rix
 
M
;

824 
i
, 
n
;

826 ià(
¬gc
 != 3)

828 
	`´šŠew
("dshift <matrix> <degreeo shift by>\n");

831 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

833 
n
 = 
	`g‘IÁ
(
¬gv
[2]);

834 
i
 = 1; i <ğ
	`Ëngth
(&
M
->
deg»es
); i++)

835 
	`dli¡_£t
(&
M
->
deg»es
, 
i
, 
	`DREF
(M->deg»es, iè+ 
n
);

836 
i
 = 1; i <ğ
	`Ëngth
(&
M
->
degg’s
); i++)

837 
	`dli¡_£t
(&
M
->
degg’s
, 
i
, 
	`DREF
(M->degg’s, iè+ 
n
);

839 
	}
}

841 
	$št_cmd
(
¬gc
, *
¬gv
[])

843 
v¬ŸbË
 *
p
;

844 
n
;

846 ià(
¬gc
 != 3)

848 
	`´šŠew
("int <name> <new value>\n");

851 
n
 = 
	`·r£IÁ
(
¬gv
 + 2);

852 ià(!
	`Ãw_št
(&
p
, 
¬gc
, 
¬gv
, 1))

854 
	`v¬_£t_št
(
p
, 
n
);

856 
	}
}

858 
	$doIÁCmd
(*
Çme
, 
v®
, 
boŞ—n
 
£tv®
, cÚ¡ *
mess
)

860 
v¬ŸbË
 *
p
;

862 ià(
£tv®
)

864 
p
 = 
	`make_v¬
(
Çme
, 
MAINVAR
, 
VINT
, 
NULL
);

865 ià(
p
 =ğ
NULL
)

867 
	`v¬_£t_št
(
p
, 
v®
);

871 
	`Ãwlše
();

872 
	`´št
("% : %d\n", 
mess
, 
v®
);

875 
	}
}

877 
	$Äows_cmd
(
¬gc
, *
¬gv
[])

879 
gm©rix
 
M
;

880 
n
;

882 ià((
¬gc
 < 2) || (argc > 3))

884 
	`´šŠew
("nrows <matrix> [result integer]\n");

887 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

889 
n
 = 
	`Äows
(
M
);

890 
	`doIÁCmd
(
¬gv
[2], 
n
, (
¬gc
 == 3), "number of„ows");

892 
	}
}

894 
	$ncŞs_cmd
(
¬gc
, *
¬gv
[])

896 
gm©rix
 
M
;

897 
n
;

899 ià((
¬gc
 < 2) || (argc > 3))

901 
	`´šŠew
("ncols <matrix> [result integer]\n");

904 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

906 
n
 = 
	`ncŞs
(
M
);

907 
	`doIÁCmd
(
¬gv
[2], 
n
, (
¬gc
 == 3), "number of columns");

909 
	}
}

911 
	$nv¬s_cmd
(
¬gc
, *
¬gv
[])

913 
ršg
 
R
;

914 
n
;

916 ià((
¬gc
 < 2) || (argc > 3))

918 
	`´šŠew
("nvars <ring> [result integer]\n");

921 ià(!
	`g‘_ršg_¬g
(&
R
, 
¬gc
, 
¬gv
, 1))

923 
n
 = 
numv¬s
;

924 
	`doIÁCmd
(
¬gv
[2], 
n
, (
¬gc
 == 3), "number of variables in„ing");

926 
	}
}

928 
	$ch¬ac_cmd
(
¬gc
, *
¬gv
[])

930 
ršg
 
R
;

931 
n
;

933 ià((
¬gc
 < 2) || (argc > 3))

935 
	`´šŠew
("characteristic <ring> [result integer]\n");

938 ià(!
	`g‘_ršg_¬g
(&
R
, 
¬gc
, 
¬gv
, 1))

940 
n
 = 
ch¬ac
;

941 
	`doIÁCmd
(
¬gv
[2], 
n
, (
¬gc
 == 3), "characteristic of„ing");

943 
	}
}

945 
	$rowdeg_cmd
(
¬gc
, *
¬gv
[])

947 
gm©rix
 
M
;

948 
n
, 
r
;

950 ià((
¬gc
 < 3) || (argc > 4))

952 
	`´šŠew
("row_degree <matrix> <row> [result integer]\n");

955 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

957 
r
 = 
	`g‘IÁ
(
¬gv
[2]);

958 ià((
r
 <ğ0è|| (¸> 
	`Äows
(
M
)))

959 
n
 = 0;

961 
n
 = 
	`DREF
(
M
->
deg»es
, 
r
);

963 
	`doIÁCmd
(
¬gv
[3], 
n
, (
¬gc
 == 4), "row degree");

965 
	}
}

967 
	$cŞdeg_cmd
(
¬gc
, *
¬gv
[])

969 
gm©rix
 
M
;

970 
n
, 
c
;

972 ià((
¬gc
 < 3) || (argc > 4))

974 
	`´šŠew
("col_degree <matrix> <column> [result integer]\n");

977 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

979 
c
 = 
	`g‘IÁ
(
¬gv
[2]);

980 ià((
c
 <ğ0è|| (ø> 
	`ncŞs
(
M
)))

981 
n
 = 0;

983 
n
 = 
	`DREF
(
M
->
degg’s
, 
c
);

985 
	`doIÁCmd
(
¬gv
[3], 
n
, (
¬gc
 == 4), "column degree");

987 
	}
}

989 
	$max_cmd
(
¬gc
, *
¬gv
[])

991 
gm©rix
 
M
;

993 ià((
¬gc
 < 2) || (argc > 3))

995 
	`´šŠew
("max <matrix> [result maximum„ow degree]\n");

998 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

1000 
	`doIÁCmd
(
¬gv
[2], 
	`dl_max
(&
M
->
deg»es
), (
¬gc
 == 3), "maximum„ow degree");

1002 
	}
}

1004 
	$mš_cmd
(
¬gc
, *
¬gv
[])

1006 
gm©rix
 
M
;

1008 ià((
¬gc
 < 2) || (argc > 3))

1010 
	`´šŠew
("min <matrix> [result minimum„ow degree]\n");

1013 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

1015 
	`doIÁCmd
(
¬gv
[2], 
	`dl_mš
(&
M
->
deg»es
), (
¬gc
 == 3), "minimum„ow degree");

1017 
	}
}

1019 
	$isz”o_cmd
(
¬gc
, *
¬gv
[])

1021 
pŞy
 
f
;

1023 ià(
¬gc
 != 3)

1025 
	`´šŠew
("is_zero <poly> <result integer: 1 if zero,ƒlse 0>\n");

1028 
f
 = 
	`g‘PŞy
(
¬gv
[1], 1);

1029 
	`doIÁCmd
(
¬gv
[2], 
f
 =ğ
NULL
, (
¬gc
 == 3), "");

1031 
	}
}

1035 
	$¬gs_cmd
(
¬gc
, *
¬gv
[])

1037 
i
, 
¬gs
;

1038 *
p
;

1040 ià(
¬gc
 == 2 ||‡rgc == 3)

1042 
p
 = 
¬gv
[1]; *p != '\0'; ++p)

1043 ià(*
p
 == '-')

1044 *
p
 = '_';

1045 
i
 = 
	`cmd_lookup
(
¬gv
[1], 1);

1046 ià(
i
 >= 0)

1048 ià(
¬gc
 == 2)

1050 
	`´šŠew
("%d\n", 
cmd_li¡
[
i
].
¬gs
);

1054 ià(
	`ssÿnf
(
¬gv
[2], "%d", &
¬gs
) &&‡rgs >= 0)

1055 
cmd_li¡
[
i
].
¬gs
 =‡rgs;

1057 
	`´”rÜ
("; inv®id‡rgum’ˆtØ¬gs: %s\n", 
¬gv
[2]);

1060 ià(
i
 == -1)

1062 
	`´”rÜ
("; commªd‚Ù found: %s\n", 
¬gv
[1]);

1067 
	`´šŠew
("args <command‚ame> (to inspect)\n");

1068 
	`´šŠew
("args <command‚ame> <int> (to modify)\n");

1071 
	}
}

	@cmds.h

5 
v¬ŸbË
 *
vg‘mod
(cÚ¡ *
Çme
);

6 
v¬ŸbË
 *
vg‘_vmod
(cÚ¡ *
Çme
);

7 
gm©rix
 
vg‘_mod
(cÚ¡ *
Çme
);

8 
gm©rix
 
vg‘_rgmod
(cÚ¡ *
Çme
);

9 
v¬ŸbË
 *
vg‘_ršg
(cÚ¡ *
Çme
);

10 
ršg
 
g‘_ršg
(cÚ¡ *
Çme
);

11 
do_ršg_v¬s
();

12 
ršg_cmd
(
¬gc
, *
¬gv
[]);

13 
ršgsum_cmd
(
¬gc
, *
¬gv
[]);

14 
£Œšg_cmd
(
¬gc
, *
¬gv
[]);

15 
´šg_cmd
(
¬gc
, *
¬gv
[]);

16 
ršgcŞ_cmd
(
¬gc
, *
¬gv
[]);

17 
ršgrow_cmd
(
¬gc
, *
¬gv
[]);

18 
m©_cmd
(
¬gc
, *
¬gv
[]);

19 
¥¬£_cmd
(
¬gc
, *
¬gv
[]);

20 
id—l_cmd
(
¬gc
, *
¬gv
[]);

21 
pŞy_cmd
(
¬gc
, *
¬gv
[]);

22 
ıx_cmd
(
¬gc
, *
¬gv
[]);

23 
put¡d_cmd
(
¬gc
, *
¬gv
[]);

24 
putchªge_cmd
(
¬gc
, *
¬gv
[]);

25 
rowdegs_cmd
(
¬gc
, *
¬gv
[]);

26 
cŞdegs_cmd
(
¬gc
, *
¬gv
[]);

27 
putm©_cmd
(
¬gc
, *
¬gv
[]);

28 
´es_cmd
(
¬gc
, *
¬gv
[]);

29 
cİy_cmd
(
¬gc
, *
¬gv
[]);

30 
numšfo_cmd
(
¬gc
, *
¬gv
[]);

31 
£tdegs_cmd
(
¬gc
, *
¬gv
[]);

32 
£tcŞdegs_cmd
(
¬gc
, *
¬gv
[]);

33 
dshiá_cmd
(
¬gc
, *
¬gv
[]);

34 
št_cmd
(
¬gc
, *
¬gv
[]);

35 
Äows_cmd
(
¬gc
, *
¬gv
[]);

36 
ncŞs_cmd
(
¬gc
, *
¬gv
[]);

37 
nv¬s_cmd
(
¬gc
, *
¬gv
[]);

38 
ch¬ac_cmd
(
¬gc
, *
¬gv
[]);

39 
rowdeg_cmd
(
¬gc
, *
¬gv
[]);

40 
cŞdeg_cmd
(
¬gc
, *
¬gv
[]);

41 
max_cmd
(
¬gc
, *
¬gv
[]);

42 
mš_cmd
(
¬gc
, *
¬gv
[]);

43 
isz”o_cmd
(
¬gc
, *
¬gv
[]);

44 
¬gs_cmd
(
¬gc
, *
¬gv
[]);

45 
doIÁCmd
(*
Çme
, 
v®
, 
boŞ—n
 
£tv®
, cÚ¡ *
mess
);

	@comb_rec.c

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~"sh¬ed.h
"

7 
	~"comb_»c.h
"

8 
	~"¡ash.h
"

11 
šlše
 
	$combs
(
n
, 
r
)

13  
comb_bË
[
n
][
r
];

14 
	}
}

16 
šlše
 
	$ODD
(
x
)

18  (
x
 % 2) != 0;

19 
	}
}

21 *
	g»c¡ash
;

25 **
	gcomb_bË
;

26 
	gbË_Ëngth
;

28 
	$š™_combs
(
maxn
)

30 
n
, 
r
;

36 ià((
comb_bË
 = (**)
	`m®loc
((
size_t
)(
maxn
 + 1è* (*))è=ğ
NULL
)

39 
bË_Ëngth
 = 
maxn
 + 1;

41 
n
 = 0;‚ <ğ
maxn
;‚++)

42 
comb_bË
[
n
] = 
NULL
;

44 
n
 = 0;‚ <ğ
maxn
;‚++)

46 ià((
comb_bË
[
n
] = (*)
	`m®loc
((
size_t
)Ò + 1è* ())è=ğ
NULL
)

49 
comb_bË
[
n
][0] = 1;

50 
comb_bË
[
n
][n] = 1;

51 
r
 = 1;„ < 
n
;„++)

52 
comb_bË
[
n
][
r
] = comb_table[n - 1][r - 1] + comb_table[n - 1][r];

54 
	}
}

56 
	$ä“_combs
()

58 
i
;

60 
i
 = 0; i < 
bË_Ëngth
; i++)

61 ià(
comb_bË
[
i
] !ğ
NULL
)

62 
	`ä“
(
comb_bË
[
i
]);

64 
	`ä“
(
comb_bË
);

65 
	}
}

71 
	$š™_comb_»cs
(
maxl
)

73 
»c¡ash
 = 
	`İ’_¡ash
(()((
size_t
)
maxl
 * ()), "combinations");

74 
	}
}

76 
	$g‘_comb_»c
(
comb_»c
 *
c
, 
l
)

79 *
±r
 = 
	`g‘_¦ug
((
¡ash
 *)
»c¡ash
);

80 
c
->
t
 = (*)
±r
;

81 
c
->
Ëngth
 = 
l
;

82 
	}
}

84 
	$š™_comb_»c
(
comb_»c
 *
c
)

86 
i
;

88 
i
 = 0; i < 
c
->
Ëngth
; i++)

89 
c
->
t
[
i
] = i;

90 
c
->
sign
 = 1;

91 
	}
}

93 
	$di¥Ïy_comb_»c
(
comb_»c
 *
c
)

95 
i
;

97 
i
 = 0; i < 
c
->
Ëngth
 - 1; i++)

98 
	`årštf
(
¡d”r
, "%d,", 
c
->
t
[
i
]);

99 
	`årštf
(
¡d”r
, "%d", 
c
->
t
[c->
Ëngth
 - 1]);

100 
	}
}

106 
	$comb_num
(*
¬y
, 
Ëngth
, 
n
)

108 
i
, 
j
, 
a
, 
»suÉ
 = 0;

113 
i
 = 0, 
a
 = 0; i < 
Ëngth
; i++,‡++)

115 
j
 = 
a
; j < 
¬y
[
i
]; j++,‡++)

117 
»suÉ
 +ğ
	`combs
(
n
 - 
j
 - 1, 
Ëngth
 - 
i
 - 1);

120  
»suÉ
;

121 
	}
}

126 
	$Ãxt_comb
(*
t
, *
sign
, 
Ëngth
, 
¿nge
)

128 
i
, 
‹mp
;

130 
i
 = 
Ëngth
 - 1; i >ğ0 && 
t
[i] - i =ğ
¿nge
 -†ength; i--)

133 ià(
i
 < 0)

136 
‹mp
 = 
t
[
i
] - i;

138 *
sign
 = 
	`ODD
(
‹mp
) ? -1 : 1;

140 
t
[
i
++]++; i < 
Ëngth
; i++)

141 
t
[
i
] =[i - 1] + 1;

144 
	}
}

146 
	$ä“_comb_»c
(
comb_»c
 *
c
)

148 
	`ä“_¦ug
((
¡ash
 *)
»c¡ash
, (
¦ug
 *)
c
->
t
);

149 
	}
}

151 
	$ä“_comb_»cs
()

153 
	`’dof_¡ash
((
¡ash
 *)
»c¡ash
);

154 
	}
}

	@comb_rec.h

5 
	scomb_»c


7 *
	mt
;

8 
	mËngth
;

9 
	msign
;

13 
š™_combs
(
maxn
);

14 
ä“_combs
();

15 
š™_comb_»cs
(
maxl
);

16 
g‘_comb_»c
(
comb_»c
 *
c
, 
l
);

17 
š™_comb_»c
(
comb_»c
 *
c
);

18 
di¥Ïy_comb_»c
(
comb_»c
 *
c
);

19 
comb_num
(*
¬y
, 
Ëngth
, 
n
);

20 
Ãxt_comb
(*
t
, *
sign
, 
Ëngth
, 
¿nge
);

21 
ä“_comb_»c
(
comb_»c
 *
c
);

22 
ä“_comb_»cs
();

25 **
comb_bË
;

26 
bË_Ëngth
;

27 *
»c¡ash
;

	@debug.c

4 
	~"sh¬ed.h
"

5 
	~"debug.h
"

6 
	~"v¬s.h
"

7 
	~"mÚ™Ü.h
"

8 
	~"cmds.h
"

9 
	~"mÚid—l.h
"

10 
	~"hb.h
"

12 
	$mÚom_cmd
(
¬gc
, * 
¬gv
[])

14 
gm©rix
 
M
;

15 
¬row
 
h—d
;

17 ià(
¬gc
 != 2)

19 
	`´št
("monom <matrix>\n");

22 ià(1 >ğ
¬gc
)

24 
M
 = 
	`vg‘_mod
(
¬gv
[1]);

25 ià(
M
 =ğ
NULL
)

27 
h—d
 = 
	`mÚmake
(
M
, 1, 
NULL
);

28 
	`mÚdi¥Ïy
(
h—d
);

29 
	`mÚ»fund
(
h—d
);

30 
	}
}

32 
	$debug_cmd
(
¬gc
, * 
¬gv
[])

35 #ifdeà
ANSI


36 #´agm¨
	`unu£d
(
¬gv
, 
¬gc
)

43 ()
¬gc
;

44 ()
¬gv
;

45 
	}
}

	@debug.h

5 
mÚom_cmd
(
¬gc
, * 
¬gv
[]);

6 
debug_cmd
(
¬gc
, * 
¬gv
[]);

	@det.c

4 
	~"sh¬ed.h
"

5 
	~"d‘.h
"

6 
	~"gm_pŞy.h
"

7 
	~"pŞy.h
"

8 
	~"ch¬p.h
"

9 
	~"mac.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"£t.h
"

21 
boŞ—n
 
	$pšü_¬¿y
(
p
, 
n
, 
t
[], * 
a
, * 
sign
)

23 
i
;

24 
¯
 = *
a
;

26 ià(
¯
 == 0)

27  
çl£
;

28 
t
[
¯
]++;

29 ià(
t
[
¯
] =ğ
n
 - 
p
 +‡a)

31 
¯
--;

32 *
sign
 = -(*sign);

36 
i
 = 1; i <ğ
p
 - 
¯
; i++)

37 
t
[
¯
 + 
i
] =[aa] + i;

46 ià((((
p
 - 
¯
è% 2è=ğ0è|| (((
n
 - 
t
[aa]) % 2) == 1))

47 *
sign
 = -(*sign);

48 
¯
 = 
p
;

50 *
a
 = 
¯
;

51  
Œue
;

52 
	}
}

54 
	$pš™_¬¿y
(
p
, 
n
, 
t
[], * 
a
, * 
sign
)

56 
i
;

58 *
sign
 = 1;

59 
i
 = 1; i <ğ
p
; i++)

60 
t
[
i
] = i;

61 ià(
p
 =ğ
n
)

62 *
a
 = 0;

64 *
a
 = 
p
;

65 
	}
}

67 
	$·¼_´
(
p
, 
t
[], 
a
)

69 
i
;

71 
	`Ãwlše
();

72 
i
 = 1; i <ğ
p
; i++)

73 
	`´št
("%d ", 
t
[
i
]);

74 
	`´št
("‡ = %d\n", 
a
);

75 
	}
}

80 
	$dl_wedge
(
p
, 
dli¡
* 
dl
, dli¡* 
»suÉ
)

82 
t
[
NDET
];

83 
a
, 
i
, 
sum
, 
sign
;

85 
	`pš™_¬¿y
(
p
, 
	`Ëngth
(
dl
), 
t
, &
a
, &
sign
);

88 
sum
 = 0;

89 
i
 = 1; i <ğ
p
; i++)

90 
sum
 +ğ
	`dli¡_»f
(
dl
, 
t
[
i
]);

91 
	`dli¡_š£¹
(
»suÉ
, 
sum
);

92 } 
	`pšü_¬¿y
(
p
, 
	`Ëngth
(
dl
), 
t
, &
a
, &
sign
));

93 
	}
}

95 
	$¶_wedge
(
p
, 
Äows
, 
ncŞs
, 
¶i¡
* 
¶
,…li¡* 
»suÉ
)

97 
a
, 
b
, 
r
, 
rowsign
, 
cŞsign
;

98 
pŞy
 
f
, 
thiscŞ
;

99 
rows
[
NDET
], 
cŞs
[NDET];

100 
d‘m©
 
MAT
;

101 
boŞ—n
 
isšŒ
;

103 
	`pš™_¬¿y
(
p
, 
ncŞs
, 
cŞs
, &
a
, &
cŞsign
);

104 
isšŒ
 = 
çl£
;

107 
	`pš™_¬¿y
(
p
, 
Äows
, 
rows
, &
b
, &
rowsign
);

108 
r
 = 1;

109 
thiscŞ
 = 
NULL
;

112 ià(
	`have_šŒ
())

113 
isšŒ
 = 
Œue
;

114 ià(!
isšŒ
)

116 ià(
v”bo£
 > 0)

117 
	`´æush
(".");

118 
	`tod‘m©
(
p
, 
¶
, 
rows
, 
cŞs
, 
MAT
);

119 
f
 = 
	`d‘
(
MAT
, 
p
, 
cŞsign
 * 
rowsign
, 
r
);

120 
	`p_add
(&
thiscŞ
, &
f
);

121 
r
++;

123 } 
	`pšü_¬¿y
(
p
, 
Äows
, 
rows
, &
b
, &
rowsign
));

124 
	`¶i¡_š£¹
(
»suÉ
, 
thiscŞ
);

125 } 
	`pšü_¬¿y
(
p
, 
ncŞs
, 
cŞs
, &
a
, &
cŞsign
));

126 
	}
}

128 
	$tod‘m©
(
p
, 
¶i¡
* 
¶
, 
rows
[], 
cŞs
[], 
d‘m©
 
MAT
)

130 
r
, 
c
;

132 
r
 = 1;„ <ğ
p
;„++)

133 
c
 = 1; c <ğ
p
; c++)

134 
MAT
[
r
][
c
] = 
	`exŒ1
(
	`¶i¡_»f
(
¶
, 
cŞs
[c]), 
rows
[r], 0);

135 
	}
}

137 
	$g‘_pivÙ
(
d‘m©
 
MAT
, 
p
, * 
cŞpivÙ
, 
pŞy
* 
pivÙ
)

139 
c
;

141 
c
 = 1; c <ğ
p
; c++)

142 ià(
MAT
[
p
][
c
] !ğ
NULL
)

144 *
cŞpivÙ
 = 
c
;

145 *
pivÙ
 = 
MAT
[
p
][
c
];

148 *
pivÙ
 = 
NULL
;

149 
	}
}

154 
pŞy
 
	$d‘muÉ
(
pŞy
 
f1
,…Şy 
g1
,…Şy 
f2
,…Şy 
g2
,…Şy 
divpŞy
)

156 
pŞy
 
a
, 
b
;

158 
a
 = 
	`p_muÉ
(
f1
, 
g1
);

159 
b
 = 
	`p_muÉ
(
f2
, 
g2
);

160 
	`p_sub
(&
a
, &
b
);

161 ià(
divpŞy
 !ğ
NULL
)

162 
a
 = 
	`p_div
(&a, 
divpŞy
);

163 
	`p_kl
(&
g1
);

164  
a
;

165 
	}
}

167 
	$gauss
(
d‘m©
 
MAT
, 
r
, 
p
, 
cŞpivÙ
, 
pŞy
 
pivÙ
,…Şy 
Ï¡pivÙ
)

169 
c
;

170 
pŞy
 
f
;

172 
f
 = 
MAT
[
r
][
cŞpivÙ
];

173 
c
 = 1; c < 
cŞpivÙ
; c++)

174 
MAT
[
r
][
c
] = 
	`d‘muÉ
(
pivÙ
, MAT[r][c], 
f
, MAT[
p
][c], 
Ï¡pivÙ
);

175 
c
 = 
cŞpivÙ
 + 1; c <ğ
p
; c++)

176 
MAT
[
r
][
c
 - 1] = 
	`d‘muÉ
(
pivÙ
, MAT[r][c], 
f
, MAT[
p
][c], 
Ï¡pivÙ
);

177 
	`p_kl
(&
f
);

178 
	}
}

180 
pŞy
 
	$d‘
(
d‘m©
 
MAT
, 
size
, 
sign
, 
comp
)

182 
pŞy
 
pivÙ
, 
Ï¡pivÙ
;

183 
pŞy
 
»suÉ
;

184 
p
, 
cŞpivÙ
, 
r
, 
c
;

186 
pivÙ
 = 
NULL
;

187 
Ï¡pivÙ
 = 
NULL
;

188 
p
 = 
size
;… >= 2;…--)

190 
	`p_kl
(&
Ï¡pivÙ
);

191 
Ï¡pivÙ
 = 
pivÙ
;

192 
	`g‘_pivÙ
(
MAT
, 
p
, &
cŞpivÙ
, &
pivÙ
);

193 ià(
pivÙ
 =ğ
NULL
)

195 
r
 = 1;„ <ğ
p
;„++)

196 
c
 = 1; c <ğ
p
; c++)

197 
	`p_kl
(&(
MAT
[
r
][
c
]));

198 
	`p_kl
(&
Ï¡pivÙ
);

199  
NULL
;

202 
r
 = 1;„ < 
p
;„++)

203 
	`gauss
(
MAT
, 
r
, 
p
, 
cŞpivÙ
, 
pivÙ
, 
Ï¡pivÙ
);

205 ià(((
p
 + 
cŞpivÙ
) % 2) == 1)

206 
sign
 = -sign;

207 
c
 = 1; c <ğ
p
; c++)

208 ià(
c
 !ğ
cŞpivÙ
)

209 
	`p_kl
(&(
MAT
[
p
][
c
]));

211 
	`p_kl
(&
pivÙ
);

212 
	`p_kl
(&
Ï¡pivÙ
);

214 
»suÉ
 = 
MAT
[1][1];

215 
»suÉ
 !ğ
NULL
)

217 
	`£t_comp
(
»suÉ
, 
comp
);

218 ià(
sign
 == -1)

219 
	`fd_Ãg©e
(&(
»suÉ
->
cÛf
));

220 
»suÉ
 =„esuÉ->
Ãxt
;

222  
MAT
[1][1];

223 
	}
}

227 
pŞy
 
	$pçff4
(
gm©rix
 
g
, 
t
[])

229 
pŞy
 
f1
, 
f2
, 
»suÉ
, 
h
;

231 
f1
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[2]),[1], 1);

232 
f2
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[4]),[3], 1);

233 
»suÉ
 = 
	`p_muÉ
(
f1
, 
f2
);

234 
	`p_kl
(&
f1
);

235 
	`p_kl
(&
f2
);

236 
f1
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[3]),[1], 1);

237 
f2
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[4]),[2], 1);

238 
h
 = 
	`p_muÉ
(
f1
, 
f2
);

239 
	`p_sub
(&
»suÉ
, &
h
);

240 
	`p_kl
(&
f1
);

241 
	`p_kl
(&
f2
);

242 
f1
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[3]),[2], 1);

243 
f2
 = 
	`exŒ1
(
	`¶i¡_»f
(&(
g
->
g’s
), 
t
[4]),[1], 1);

244 
h
 = 
	`p_muÉ
(
f1
, 
f2
);

245 
	`p_add
(&
»suÉ
, &
h
);

246 
	`p_kl
(&
f1
);

247 
	`p_kl
(&
f2
);

248  
»suÉ
;

249 
	}
}

	@det.h

5 
cÚ¡ex´
 
	gNDET
 = 15;

8 
pŞy
 
	td‘m©
[
NDET
][NDET];

11 
boŞ—n
 
pšü_¬¿y
(
p
, 
n
, 
t
[], * 
a
, * 
sign
);

12 
pš™_¬¿y
(
p
, 
n
, 
t
[], * 
a
, * 
sign
);

13 
·¼_´
(
p
, 
t
[], 
a
);

16 
dl_wedge
(
p
, 
dli¡
* 
dl
, dli¡* 
»suÉ
);

17 
¶_wedge
(
p
, 
Äows
, 
ncŞs
, 
¶i¡
* 
¶
,…li¡* 
»suÉ
);

20 
tod‘m©
(
p
, 
¶i¡
* 
¶
, 
rows
[], 
cŞs
[], 
d‘m©
 
MAT
);

21 
g‘_pivÙ
(
d‘m©
 
MAT
, 
p
, * 
cŞpivÙ
, 
pŞy
* 
pivÙ
);

22 
pŞy
 
d‘muÉ
ÕŞy 
f1
,…Şy 
g1
,…Şy 
f2
,…Şy 
g2
,…Şy 
divpŞy
);

23 
gauss
(
d‘m©
 
MAT
, 
r
, 
p
, 
cŞpivÙ
, 
pŞy
 
pivÙ
,…Şy 
Ï¡pivÙ
);

24 
pŞy
 
d‘
(
d‘m©
 
MAT
, 
size
, 
sign
, 
comp
);

27 
pŞy
 
pçff4
(
gm©rix
 
g
, 
t
[]);

	@detach.c

4 #ifdeà
USEDETACH


5 
	~<sigÇl.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	~<uni¡d.h
>

10 
	~"sh¬ed.h
"

11 
	~"d‘ach.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"šput.h
"

15 
cÚ¡ex´
 
	gsigA
 = 
SIGFPE
;

16 
cÚ¡ex´
 
	gsigB
 = 
SIGIOT
;

18 
	gâame
[] = "ttyfile";

19 
	g£ndPID
;

20 
	gzomb›PID
 = 0;

22 
	$ex™MaÿuÏy
()

24 ià(
zomb›PID
 != 0)

25 
	`kl
(
zomb›PID
, 
SIGKILL
);

26 
	`ex™
(0);

27 
	}
}

29 
FILE
*
	$fO³n
(* 
s
)

31 
FILE
* 
f
;

33 
f
 = 
	`tİ’
(
âame
, 
s
);

34 ià(
f
 =ğ
NULL
)

36 
	`´”rÜ
("; cª'ˆİ’ %s\n", 
âame
);

37  (
NULL
);

39  (
f
);

40 
	}
}

42 
	$wrTTY
()

44 
FILE
* 
f
;

46 
f
 = 
	`fO³n
("w");

47 ià(
f
 =ğ
NULL
)

49 
	`åršt
(
f
, "%d\n", 
	`g‘pid
());

50 
	`åršt
(
f
, "%s\n", 
	`‰yÇme
(0));

51 
	`åršt
(
f
, "%s\n", 
	`‰yÇme
(1));

52 
	`åršt
(
f
, "%s\n", 
	`‰yÇme
(2));

53 
	`fşo£
(
f
);

54 
	}
}

56 
	$rdPID
()

58 
FILE
* 
f
;

59 
n
;

61 
n
 = 0;

62 
f
 = 
	`fO³n
("r");

63 
	`fsÿnf
(
f
, "%d", &
n
);

64 
	`fşo£
(
f
);

65  (
n
);

66 
	}
}

68 
	$wrPID
(
n
)

70 
FILE
* 
f
;

72 
f
 = 
	`fO³n
("w");

73 
	`åršt
(
f
, "%d", 
n
);

74 
	`fşo£
(
f
);

75 
	}
}

77 
	$©chTTY
()

79 
FILE
* 
f
;

80 
¡r
[100];

81 
pid
, 
n
;

83 
f
 = 
	`fO³n
("r");

85 
n
 = 
	`fsÿnf
(
f
, "%d", &
pid
);

86 ià((
n
 =ğ0è|| (À=ğ
EOF
))

88 
	`fsÿnf
(
f
, "%99s", 
¡r
);

89 
	`äeİ’
(
¡r
, "r", 
¡dš
);

90 
	`fsÿnf
(
f
, "%99s", 
¡r
);

91 
	`äeİ’
(
¡r
, "w", 
¡dout
);

92 
	`fsÿnf
(
f
, "%99s", 
¡r
);

93 
	`äeİ’
(
¡r
, "w", 
¡d”r
);

94 
	`fşo£
(
f
);

95 
f
 = 
	`fO³n
("w");

96 
	`fşo£
(
f
);

97  (
pid
);

98 
	}
}

100 
	$ÜphªHªdËr
(
sig
)

102 ()
sig
;

103 
	`sigÇl
(
sigA
, 
SIG_IGN
);

104 
zomb›PID
 = 
	`©chTTY
();

105 ià(
zomb›PID
 == 0)

106 
	`´”rÜ
("; can't‡ttacho Macaulay\n");

108 
	`´”rÜ
("; just‡ttached...\n");

109 
	}
}

111 
	$doO½hª
()

113 
	`sigÇl
(
sigA
, 
ÜphªHªdËr
);

114 
	`´”rÜ
("; made it into orphan...\n");

115 
	}
}

117 
	$£ndINT
(
sig
)

119 ()
sig
;

120 
	`kl
(
£ndPID
, 
SIGINT
);

121 
	}
}

123 
	$£ndTERM
(
sig
)

125 ()
sig
;

126 
	`kl
(
£ndPID
, 
SIGTERM
);

127 
	`ex™MaÿuÏy
();

128 
	}
}

130 
	$£ndCONT
(
sig
)

132 ()
sig
;

133 
	`kl
(
£ndPID
, 
SIGCONT
);

134 
	}
}

136 
	$doZomb›
(
pid
)

138 
£ndPID
 = 
pid
;

140 
	`sigÇl
(
SIGINT
, 
£ndINT
);

141 
	`sigÇl
(
SIGTERM
, 
£ndTERM
);

142 
	`sigÇl
(
SIGCONT
, 
£ndCONT
);

143 
	}
}

145 
	$wa™_cmd
()

147 
	`sig·u£
(0);

148 
	}
}

150 
	$d‘ach_cmd
(
¬gc
, * 
¬gv
[])

152 
pid
;

154 ià(
¬gc
 > 2)

156 
	`´šŠew
("detach [output file]\n");

159 
	`sigÇl
(
SIGHUP
, 
SIG_IGN
);

160 
pid
 = 
	`fÜk
();

161 ià(
pid
 == 0)

163 ià(
¬gc
 > 1)

164 
	`äeİ’
(
¬gv
[1], "w", 
¡dout
);

165 
	`doO½hª
();

169 
	`wrPID
(
pid
);

170 
	`ex™MaÿuÏy
();

172 
	}
}

174 
	$©ch_cmd
()

176 
pid
;

178 
pid
 = 
	`rdPID
();

179 ià(
pid
 == 0)

181 
	`´”rÜ
("; can't‡ttacho Macaulay\n");

184 
	`wrTTY
();

185 
	`doZomb›
(
pid
);

186 
	`kl
(
pid
, 
sigA
);

188 
	`sig·u£
(0);

189 
	}
}

191 
	$sighup_cmd
()

193 
	`sigÇl
(
SIGHUP
, 
SIG_IGN
);

194 
	`wrPID
(
	`g‘pid
());

195 
	`doO½hª
();

196 
	}
}

200 
	~"sh¬ed.h
"

201 
	~"d‘ach.h
"

203 
	$ex™MaÿuÏy
()

205 #ifdeà
SIOW


206 
	`´št
("\n[Macaulay has quit]\n");

208 
	`ex™
(0);

209 
	}
}

	@detach.h

5 
ex™MaÿuÏy
();

7 #ifdeà
USEDETACH


8 
wa™_cmd
();

9 
d‘ach_cmd
(
¬gc
, * 
¬gv
[]);

10 
©ch_cmd
();

11 
sighup_cmd
();

	@dot_fns.c

4 
	~<as£¹.h
>

5 
	~<ùy³.h
>

6 
	~<£tjmp.h
>

7 
	~<¡dio.h
>

8 
	~<¡dlib.h
>

9 
	~<¡ršg.h
>

10 
	~"sh¬ed.h
"

11 
	~"dÙ_âs.h
"

15 
	~"cmdÇmes.h
"

16 
	~"sh–l.h
"

17 
	~"v¬s.h
"

18 
	~"¡ash.h
"

19 
	~"mÚ™Ü.h
"

20 
	~"cmds.h
"

21 
	~"šput.h
"

22 
	~"gm_cmds.h
"

24 
cÚ¡ex´
 
	gPMAX
 = 4;

25 
cÚ¡ex´
 
	gSMAX
 = 256;

26 
cÚ¡ex´
 
	gIDSIZE
 = 256;

27 
cÚ¡ex´
 
	gVINT
 = 1;

29 
	gš_dÙ_cmd_mode
 = 0;

31 
	ekšds


33 
	m’d
,

34 
	mid’t
,

35 
	mnumb”
,

36 
	mİ”
,

37 
	mb¿û
,

38 
	m¥aû
,

39 
	m”rÜ


40 } 
	tkšd
;

42 cÚ¡ *
	gkšd_¡r
[] = {"end", "ident", "number", "oper", "brace", "space", "error"};

45 
™em_¡ruù
 
	t™em
;

49 cÚ¡ *
	mtok
;

50 cÚ¡ *
	mËá
, *
	mright
;

51 (*
	mhªdËr
)(
	m™em
 *);

52 
	mËn
;

53 
	mlmem
[
PMAX
 + 1], 
	mrmem
[PMAX + 1];

54 } 
	ttok’Œy
;

57 
assign
(
™em
 *
p
);

58 
¶us
(
™em
 *
p
);

59 
mšus
(
™em
 *
p
);

60 
times
(
™em
 *
p
);

61 
cÚÿt
(
™em
 *
p
);

62 
Œª¥o£
(
™em
 *
p
);

63 
Í¬’
(
™em
 *
p
);

64 
½¬’
(
™em
 *
p
);

65 
§ve
(
™em
 *
p
);

66 
commªd
(
™em
 *
p
);

67 
Œaû
(
™em
 *
p
);

68 
¡İ
(
™em
 *
p
);

69 
·r£
(
™em
 *
p
);

71 
tok’Œy
 
	gtok’s
[] = {

72 {"=", "z", "c", 
assign
, 0, "", ""}, {"+", "m", "n", 
¶us
, 0, "", ""},

73 {"-", "m", "n", 
mšus
, 0, "", ""}, {"*", "p", "q", 
times
, 0, "", ""},

74 {",", "r", "s", 
cÚÿt
, 0, "", ""}, {"\\", "z", "x", 
Œª¥o£
, 0, "", ""},

75 {"(", "y", "b", 
Í¬’
, 0, "", ""}, {")", "b", "y", 
½¬’
, 0, "", ""},

76 {"`", "a", "c", 
§ve
, 0, "", ""}, {".cmd", "z", "c", 
commªd
, 0, "", ""},

77 {".Œaû", "z", "x", 
Œaû
, 0, "", ""}, {".¡İ", "z", "x", 
¡İ
, 0, "", ""},

78 {".·r£", "z", "x", 
·r£
, 0, "", ""}, {"$", "a", "a", 
NULL
, 0, "", ""},

79 {
NULL
, NULL, NULL, NULL, 0, "", ""}};

81 
tok’Œy
 *
	g’d_’Œy
, *
	gcmd_’Œy
, *
	gquo_’Œy
, *
	g½¬_’Œy
;

83 
tok’Œy
 
	g’dtok’
 = {"$", "", "", 
NULL
, 0, "", ""};

85 
	s™em_¡ruù


87 
kšd
 
	mwh©
;

88 cÚ¡ *
	mtok
;

89 
cmd_»c
 *
	mcmd
;

90 
tok’Œy
 *
	m’Œy
;

91 
™em
 *
	m´ev
, *
	mÃxt
;

94 
	sdÙ_äame_¡ruù


96 
jmp_buf
 
	mjmp_Ú_”rÜ
;

97 *
	m¡ršg_memÜy
, *
	m¡ršg_mem_’d
;

98 
	mg’sym_št
;

99 
	m¡İpšg
;

100 
™em
 *
	m™em_li¡
;

101 
dÙ_äame_¡ruù
 *
	mäame
;

102 } 
	tdÙ_äame
;

104 
dÙ_äame
 *
	gäame
 = 
NULL
;

105 
¡ash
 *
	g™em_¡ash
 = 
NULL
;

106 
	gg’sym_št
 = 0;

107 
	gŒacšg
 = 0;

111 
	$´št_tok’ized
(
™em
 *
q
)

114 
™em
 *
p
;

115 
s
[
IDSIZE
 + 1];

116 
i
;

118 ià(
æushnum
)

120 
	`´št
("\n");

121 
æushnum
 = 0;

123 
i
 = 2, 
p
 = 
äame
->
™em_li¡
; i > 0;… =…->
Ãxt
)

125 ià(
p
->
wh©
 =ğ
’d
)

126 --
i
;

127 
	`´št
("% ", 
p
->
tok
);

129 
	`´št
("\n");

130 ià(
q
 !ğ
NULL
)

132 
i
 = 2, 
p
 = 
äame
->
™em_li¡
; i > 0;… =…->
Ãxt
)

134 ià(
p
->
wh©
 =ğ
’d
)

135 --
i
;

136 ià(
p
 =ğ
q
)

137 
	`¥rštf
(
s
, "^%*s", ()
	`¡¾’
(
p
->
tok
), "");

139 
	`¥rštf
(
s
, "%* ", ()
	`¡¾’
(
p
->
tok
), "");

140 
	`´št
("%s", 
s
);

142 
	`´št
("\n");

144 
	}
}

146 
	$dÙ_”rÜ
(
™em
 *
p
)

148 
	`´št_tok’ized
(
p
);

149 
äame
->
¡İpšg
 = -1;

150 
	`lÚgjmp
(
äame
->
jmp_Ú_”rÜ
, 1);

151 
	}
}

153 
	$dÙ_¬g_”rÜ
(
™em
 *
İ
, i‹m *
¬g
)

155 
	`´”rÜ
("; inv®id‡rgum’ˆtØ%s\n", 
İ
->
tok
);

156 
	`dÙ_”rÜ
(
¬g
);

157 
	}
}

159 
__©Œibu‹__
((
unu£d
)è
	$´št_tok’_li¡
()

162 
™em
 *
p
;

163 
i
;

165 
	`´št
("\n");

166 
i
 = 0, 
p
 = 
äame
->
™em_li¡
; i =ğ0 ||…->
wh©
 !ğ
’d
; ++i,… =…->
Ãxt
)

168 
	`´št
("{ %s, %s", 
kšd_¡r
[
p
->
wh©
],…->
tok
);

169 ià(
p
->
’Œy
)

171 
	`´št
(", {%s, %s, %s}", 
p
->
’Œy
->
tok
,…->’Œy->
Ëá
,…->’Œy->
right
);

173 
	`´št
(" }\n");

175 
	`´št
("\n");

176 
	}
}

180 
	$š™_dÙ
()

184 
™em_¡ash
 = 
NULL
;

185 
	}
}

187 
	$is_İ
(cÚ¡ *
s
, 
tok’Œy
 **
’Œy
)

190 
tok’Œy
 *
p
;

191 
Ën
 = 0;

193 
p
 = 
tok’s
;…->
tok
 !ğ
NULL
; ++p)

194 ià(
p
->
Ën
 >†’ && 
	`¡ºcmp
(
s
,…->
tok
, (
size_t
)p->len) == 0)

196 *
’Œy
 = 
p
;

197 
Ën
 = 
p
->len;

199  
Ën
;

200 
	}
}

202 
	$´iv©e_š™
()

205 
tok’Œy
 *
p
;

207 
äame
->
g’sym_št
 = gensym_int;

208 
äame
->
¡İpšg
 = -2;

209 ià(!
™em_¡ash
)

211 
™em_¡ash
 = (
¡ash
 *)
	`İ’_¡ash
((
™em
), "dot items");

212 
p
 = 
tok’s
;…->
tok
 !ğ
NULL
; ++p)

213 
p
->
Ën
 = ()
	`¡¾’
Õ->
tok
);

214 
	`is_İ
("$", &
’d_’Œy
);

215 
	`is_İ
(".cmd", &
cmd_’Œy
);

216 
	`is_İ
("`", &
quo_’Œy
);

217 
	`is_İ
("(", &
½¬_’Œy
);

219 
	}
}

221 *
	$make_¡ršg
(cÚ¡ *
s
, 
Ën
)

223 *
t
;

225 ià(
Ën
 + 1 > 
äame
->
¡ršg_mem_’d
 - f¿me->
¡ršg_memÜy
)

227 
	`´”rÜ
("; out of memory for strings\n");

228 
	`lÚgjmp
(
äame
->
jmp_Ú_”rÜ
, 1);

230 
t
 = 
äame
->
¡ršg_memÜy
;

231 
äame
->
¡ršg_memÜy
 +ğ
Ën
 + 1;

232 
	`¡ºıy
(
t
, 
s
, (
size_t
)
Ën
);

233 
t
[
Ën
] = '\0';

234  
t
;

235 
	}
}

237 
__©Œibu‹__
((
unu£d
)è*
	$»ad_¤c
(
¬gc
, *
¬gv
[], 
n
)

239 
cur_Ën
, 
cur_wÜd
;

240 *
cur_¡ršg
;

242 ià(
n
 == 0)

245 
cur_wÜd
 = 
š_dÙ_cmd_mode
 ? 0 : 1;

250 ià(
n
 < 
cur_Ën
)

252 
cur_Ën
 -ğ
n
;

253  
cur_¡ršg
 +ğ
n
;

257 ++
cur_wÜd
;

260 ià(
¬gc
 <ğ
cur_wÜd
)

261  
NULL
;

262 
cur_¡ršg
 = 
¬gv
[
cur_wÜd
];

263 
cur_Ën
 = ()
	`¡¾’
(
cur_¡ršg
);

264  
cur_¡ršg
;

265 
	}
}

267 
	$¥aû_ch¬
(
c
)

269  (
	`is¥aû
(
c
));

270 
	}
}

272 
	$dig™_ch¬
(
c
)

274  (
	`isdig™
(
c
));

275 
	}
}

277 
	$cmd_ch¬1
(
c
)

279  (
	`i§Íha
(
c
));

280 
	}
}

282 
	$cmd_ch¬2
(
c
)

284  (
	`i§Íha
(
c
) || c == '_');

285 
	}
}

287 
	$id’t_ch¬1
(
c
)

289  (
	`i§Íha
(
c
) || c == '@');

290 
	}
}

292 
	$id’t_ch¬2
(
c
)

294  (
	`i§Êum
(
c
) || c == '_' || c == '@' || c == '\'' || c == '.');

295 
	}
}

297 
is_tok’
(cÚ¡ *
s
, (*
ch¬1
)(), (*
ch¬2
)())

301 
i
 = 0;

302 ià(
	`ch¬1
(*
s
))

303 ++
i
, *++
s
 != '\0')

304 ià(!
	`ch¬2
(*
s
))

306  
i
;

307 
	}
}

309 
	$is_cmd
(cÚ¡ *
s
, **
t
, 
cmd_»c
 **
cmd
)

313 
Ën
, 
i
;

314 
Çme
[
SMAX
];

316 
Ën
 = 
	`is_tok’
(
s
, 
cmd_ch¬1
, 
cmd_ch¬2
);

317 ià(
Ën
 == 0)

319 
	`¡ºıy
(
Çme
, 
s
, (
size_t
)
Ën
);

320 
Çme
[
Ën
] = '\0';

321 
i
 = 
	`cmd_lookup
(
Çme
, 4);

322 ià(
i
 >= 0)

324 #´agm¨
GCC
 
dŸgno¡ic
 
push


325 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

326 *
t
 = (*)
cmd_li¡
[
i
].
Çme
;

327 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


328 *
cmd
 = 
cmd_li¡
 + 
i
;

329  
Ën
;

333 
	}
}

335 
	$is_quÙe
(*
s
, **
t
)

339 
i
 = 0;

340 ià(*
s
 == '"')

342 *
t
 = 
s
 + 1;

343 ++
i
, *++
s
 != '\0')

344 ià(*
s
 == '"')

346 *
s
 = '\0';

347 ++
i
;

349  
i
;

350 
	}
}

352 
	$is_b¿û
(cÚ¡ *
s
, **
t
)

356 
i
 = 0;

357 ià(*
s
 == '{')

359 
d
 = 1;

360 cÚ¡ *
¡¬t
 = 
s
;

361 ++
i
, *++
s
 != '\0')

363 ià(*
s
 == '{')

364 ++
d
;

365 ià(*
s
 == '}')

366 --
d
;

367 ià(
d
 == 0)

370 ++
i
;

371 *
t
 = 
	`make_¡ršg
(
¡¬t
, 
i
);

373  
i
;

374 
	}
}

376 *
	$g’sym_id’t
()

378 
¡
[16];

380 
	`¥rštf
(
¡
, "@00@%d", ++
g’sym_št
);

381  
	`make_¡ršg
(
¡
, ()
	`¡¾’
(st));

382 
	}
}

384 
	$tok’ize_¤c
(
¬gc
, *
¬gv
[])

386 *
s
, *
t
, *
¤c
;

387 
™em
 *
p
, *
q
;

388 
tok’Œy
 *
’Œy
;

389 
kšd
 
wh©
;

390 
Ën
, 
n
;

391 
cmd_»c
 *
cmd
;

393 
p
 = 
q
 = 
äame
->
™em_li¡
 = (
™em
 *)(*)
	`g‘_¦ug
(
™em_¡ash
);

394 
p
->
wh©
 = 
’d
;

395 
p
->
tok
 = 
’d_’Œy
->tok;

396 
p
->
’Œy
 = 
’d_’Œy
;

397 
p
->
´ev
 = 
NULL
;

400 
n
 = 
š_dÙ_cmd_mode
 ? 0 : 1;

401 
s
 = 
¤c
 = 
¬gv
[
n
];

402 ++
n
;‚ < 
¬gc
; ++n)

406 ++
s
;

407 } *
s
 != '\0');

408 *
s
 = ' ';

411 
s
 = 
¤c
;

412 
wh©
 = 
¥aû
;

413 *
s
 != '\0')

415 
t
 = 
NULL
;

416 
cmd
 = 
NULL
;

417 
’Œy
 = 
NULL
;

418 ià((
Ën
 = 
	`is_tok’
(
s
, 
¥aû_ch¬
, space_char)))

419 
wh©
 = 
¥aû
;

420 ià((
Ën
 = 
	`is_cmd
(
s
, &
t
, &
cmd
)))

422 
wh©
 = 
İ”
;

423 
’Œy
 = 
cmd_’Œy
;

425 ià((
Ën
 = 
	`is_quÙe
(
s
, &
t
)))

426 
wh©
 = 
id’t
;

427 ià((
Ën
 = 
	`is_b¿û
(
s
, &
t
)))

428 
wh©
 = 
b¿û
;

429 ià((
Ën
 = 
	`is_tok’
(
s
, 
id’t_ch¬1
, 
id’t_ch¬2
)))

430 
wh©
 = 
id’t
;

431 ià(*
s
 == '_')

433 
Ën
 = 1;

434 
wh©
 = 
id’t
;

435 
t
 = 
	`g’sym_id’t
();

437 ià((
Ën
 = 
	`is_tok’
(
s
, 
dig™_ch¬
, digit_char)))

438 
wh©
 = 
numb”
;

439 ià(*
s
 =ğ'-' && (
wh©
 =ğ
¥aû
 || (wh© =ğ
İ”
 && 
p
->
’Œy
 !ğ
½¬_’Œy
)) &&

440 (
Ën
 = 
	`is_tok’
(
s
 + 1, 
dig™_ch¬
, digit_char)))

442 ++
Ën
;

443 
wh©
 = 
numb”
;

445 ià((
Ën
 = 
	`is_İ
(
s
, &
’Œy
)))

446 
wh©
 = 
İ”
;

449 
wh©
 = 
”rÜ
;

450 
Ën
 = ()
	`¡¾’
(
s
);

453 ià(
wh©
 !ğ
¥aû
)

455 
p
 = (
™em
 *)(*)
	`g‘_¦ug
(
™em_¡ash
);

456 
p
->
´ev
 = 
q
;

457 
q
->
Ãxt
 = 
p
;

458 
q
 = 
p
;

459 
p
->
wh©
 = what;

460 
p
->
tok
 = 
t
 ? : 
	`make_¡ršg
(
s
, 
Ën
);

461 
p
->
cmd
 = cmd;

462 
p
->
’Œy
 =ƒntry;

463 ià(
wh©
 =ğ
”rÜ
)

465 
p
->
Ãxt
 = 
äame
->
™em_li¡
;

466 
äame
->
™em_li¡
->
´ev
 = 
p
;

467 
	`´”rÜ
("; unrecognizedoken\n");

468 
	`dÙ_”rÜ
(
p
);

471 
s
 +ğ
Ën
;

473 
p
 = 
äame
->
™em_li¡
;

474 
p
->
´ev
 = 
q
;

475 
q
->
Ãxt
 = 
p
;

476 
	}
}

478 
™em
 *
	$´ev_İ
(
™em
 *
p
)

481 
p
 =…->
´ev
;…->
wh©
 !ğ
’d
;… =…->prev)

482 ià(
p
->
wh©
 =ğ
İ”
)

484  
p
;

485 
	}
}

487 
__©Œibu‹__
((
unu£d
)è
	$debug_·r£
(
™em
 *
p
, i‹m *
q
)

489 ià(
p
->
’Œy
)

490 
	`´št
("{%s, %s, %s} ", 
p
->
’Œy
->
Ëá
,…->’Œy->
tok
,…->’Œy->
right
);

492 
	`´št
("{ NULL } ");

493 ià(
q
->
’Œy
)

494 
	`´št
("{%s, %s, %s}\n", 
q
->
’Œy
->
Ëá
, q->’Œy->
tok
, q->’Œy->
right
);

496 
	`´št
("{ NULL } ");

497 
	}
}

499 
	$·r£_¤c
()

501 
™em
 *
p
, *
q
;

502 
debug
;

506 
q
 = 
äame
->
™em_li¡
;

509 
p
 = 
q
;

510 
q
 = 
	`´ev_İ
(
p
);

511 } (
debug
 = 
	`¡rcmp
(
q
->
’Œy
->
right
, 
p
->’Œy->
Ëá
) > 0));

512 ià(
p
->
wh©
 =ğ
’d
)

514 ià(
Œacšg
 && 
p
->
Ãxt
->
wh©
 !ğ
’d
)

515 
	`´št_tok’ized
(
NULL
);

518 ià(
Œacšg
)

519 
	`´št_tok’ized
(
p
);

520 
	`as£¹
(
p
->
’Œy
 !ğ
NULL
 &&…->’Œy->
hªdËr
 != NULL);

521 (
p
->
’Œy
->
hªdËr
)(p);

522 ià(
äame
->
¡İpšg
 > -1 && --(frame->stopping) == -1)

524 
	`´št_tok’ized
(
NULL
);

528 
	}
}

530 
™em
 *
	$d–‘e_™em
(
™em
 *
p
)

533 
™em
 *
q
;

534 
v¬ŸbË
 *
v
;

536 
p
->
´ev
->
Ãxt
 =…->next;

537 
p
->
Ãxt
->
´ev
 =…->prev;

538 
q
 = 
p
->
Ãxt
;

539 ià(
q
 =ğ
p
)

540 
q
 = 
NULL
;

541 ià(
p
->
wh©
 =ğ
id’t
 && 
	`¡ºcmp
Õ->
tok
, "@00@", 4è=ğ0 && 
äame
->
¡İpšg
 == -2)

543 
v
 = 
	`fšd_v¬
(
p
->
tok
);

544 ià(
v
 !ğ
NULL
)

545 
	`»m_v¬
(
v
);

547 
	`ä“_¦ug
(
™em_¡ash
, (
¦ug
 *)
p
);

548  
q
;

549 
	}
}

551 
	$d–‘e_™em_li¡
()

553 
™em
 *
p
;

555 ià(
äame
->
™em_li¡
 !ğ
NULL
)

557 
p
 = 
äame
->
™em_li¡
;… !ğ
NULL
;… = 
	`d–‘e_™em
(p))

559 
äame
->
™em_li¡
 = 
NULL
;

561 
	}
}

563 
	$mİ_up
()

565 
	`d–‘e_™em_li¡
();

566 
g’sym_št
 = 
äame
->gensym_int;

567 
	}
}

569 
	$dÙ_cmd
(
¬gc
, *
¬gv
[])

571 
dÙ_äame
 
äame_»c
;

572 
mem
[
SMAX
];

574 ià(
¬gc
 =ğ1 && 
	`¡rcmp
(
¬gv
[0], ".") == 0)

576 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
] = !in_dot_cmd_mode;

580 
äame_»c
.
äame
 = frame;

581 
äame
 = &
äame_»c
;

582 
äame
->
¡ršg_memÜy
 = 
mem
;

583 
äame
->
¡ršg_mem_’d
 = 
mem
 + 
SMAX
;

584 
	`´iv©e_š™
();

586 ià(
	`£tjmp
(
äame
->
jmp_Ú_”rÜ
))

588 
	`mİ_up
();

589 
äame
 = 
äame_»c
.frame;

593 
	`tok’ize_¤c
(
¬gc
, 
¬gv
);

595 
	`·r£_¤c
();

596 
	`mİ_up
();

597 
äame
 = 
äame_»c
.frame;

599 
	}
}

603 
	$š£¹_™em
(
™em
 *
p
, i‹m *
q
)

606 
p
->
´ev
->
Ãxt
 = 
q
;

607 
q
->
´ev
 = 
p
->prev;

608 
q
->
Ãxt
 = 
p
;

609 
p
->
´ev
 = 
q
;

610 
	}
}

612 
	$·tch_™ems
(
™em
 *
p
, 
Ëá
, 
right
, i‹m *
q
)

614 
i
;

615 
tÙ®_™ems
;

620 
i
 = 0; i < 
Ëá
; ++i)

621 
p
 =…->
´ev
;

623 
tÙ®_™ems
 = 
Ëá
 + 
right
 + 1;

624 
i
 = 0; i < 
tÙ®_™ems
; ++i)

625 
p
 = 
	`d–‘e_™em
(p);

628 ià(
q
 !ğ
NULL
)

629 
	`š£¹_™em
(
p
, 
q
);

630 
	}
}

634 
™em
 *
	$Ãw_™em
(
kšd
 
wh©
, cÚ¡ *
tok
)

636 
™em
 *
t
;

638 
t
 = (
™em
 *)(*)
	`g‘_¦ug
(
™em_¡ash
);

639 
t
->
wh©
 = what;

640 
t
->
tok
 =ok;

641 
t
->
’Œy
 = 
NULL
;

642  
t
;

643 
	}
}

645 
	$is_§ve
(
™em
 *
p
)

647  (
p
->
wh©
 =ğ
İ”
 &&…->
tok
[0] == '`');

648 
	}
}

650 *
	$š£¹_quÙed_v¬
(
™em
 *
p
)

653 *
s
;

654 
™em
 *
t
;

656 
t
 = 
	`Ãw_™em
(
İ”
, "`");

657 
t
->
’Œy
 = 
quo_’Œy
;

658 
	`š£¹_™em
(
p
, 
t
);

660 
s
 = 
	`g’sym_id’t
();

661 
t
 = 
	`Ãw_™em
(
id’t
, 
s
);

662 
	`š£¹_™em
(
p
, 
t
);

663  
s
;

664 
	}
}

666 
	$commªd
(
™em
 *
p
)

668 *
¬gv
[16];

669 
i
, 
¬gc
;

670 
™em
 *
q
;

672 ià(
p
->
cmd
 =ğ
NULL
)

674 
	`´”rÜ
("; cannot use .cmd‡s‡ command\n");

675 
	`dÙ_”rÜ
(
p
);

678 #´agm¨
GCC
 
dŸgno¡ic
 
push


679 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

680 
¬gv
[0] = (*)
p
->
tok
;

681 
¬gc
 = 1, 
q
 = 
p
->
Ãxt
;‡rgc < 16; ++argc, q = q->next)

683 
	`is_§ve
(
q
))

684 
q
 = q->
Ãxt
;

685 ià(
q
->
wh©
 !ğ
id’t
 && q->wh© !ğ
numb”
)

687 
¬gv
[
¬gc
] = (*)
q
->
tok
;

689 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


690 ià(
p
->
´ev
->
wh©
 !ğ
’d
)

692 
»quœed_¬gs
 = 1 + 
p
->
cmd
->
¬gs
;

693 
¬gc
 < 
»quœed_¬gs
)

694 
¬gv
[
¬gc
++] = 
	`š£¹_quÙed_v¬
(
q
);

697 
cmd_”rÜ
 = 0;

698 (*
p
->
cmd
->
´oc
)(
¬gc
, 
¬gv
);

699 ià(
cmd_”rÜ
)

700 
	`dÙ_”rÜ
(
p
);

702 
q
 = 
p
->
Ãxt
, 
i
 = 1; i < 
¬gc
; ++i)

704 ià(
	`is_§ve
(
q
))

706 
q
 = 
	`d–‘e_™em
(q);

707 
	`is_§ve
(
q
))

708 
q
 = q->
Ãxt
;

709 
q
 = q->
Ãxt
;

712 
q
 = 
	`d–‘e_™em
(q);

714 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

715 
	}
}

717 
	$§ve
(
™em
 *
p
)

719 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

720 
	}
}

722 
	$Œaû
(
™em
 *
p
)

724 
Œacšg
 = !tracing;

725 
	`´št
(";¿cšg %s\n", 
Œacšg
 ? "on" : "off");

726 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

727 
	}
}

729 
	$¡İ
(
™em
 *
p
)

731 ià(
p
->
Ãxt
->
wh©
 !ğ
numb”
)

732 
	`dÙ_¬g_”rÜ
(
p
,…->
Ãxt
);

733 
	`ssÿnf
(
p
->
Ãxt
->
tok
, "%d", &(
äame
->
¡İpšg
));

734 
	`·tch_™ems
(
p
, 0, 1, 
NULL
);

735 
	}
}

737 
	$·r£
(
™em
 *
p
)

739 
™em
 *
qİ
, *
ql
, *
qr
;

740 
tok’Œy
 *
t
;

741 
n
;

743 ià((
qİ
 = 
p
->
´ev
)->
wh©
 =ğ
İ”
 && (
ql
 =…->
Ãxt
)->wh© =ğ
id’t
 &&

744 (
qr
 = 
ql
->
Ãxt
)->
wh©
 =ğ
id’t
)

746 
t
 = 
qİ
->
’Œy
;

748 
n
 = ()
	`¡¾’
(
ql
->
tok
);

749 
n
 =‚ > 
PMAX
 ? PMAX :‚;

750 
	`¡ºıy
(
t
->
lmem
, 
ql
->
tok
, (
size_t
)
n
);

751 
t
->
lmem
[
n
] = '\0';

752 
t
->
Ëá
 =->
lmem
;

754 
n
 = ()
	`¡¾’
(
qr
->
tok
);

755 
n
 =‚ > 
PMAX
 ? PMAX :‚;

756 
	`¡ºıy
(
t
->
rmem
, 
qr
->
tok
, (
size_t
)
n
);

757 
t
->
rmem
[
n
] = '\0';

758 
t
->
right
 =->
rmem
;

760 
	`·tch_™ems
(
p
, 1, 2, 
NULL
);

764 
t
 = 
tok’s
;->
tok
 !ğ
NULL
; ++t)

765 
	`´št
("%16  %4 %4s\n", 
t
->
tok
,->
Ëá
,->
right
);

766 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

768 
	}
}

770 
	$is_lv®ue
(
™em
 *
p
)

772  (
p
->
wh©
 =ğ
id’t
);

773 
	}
}

775 
	$is_rv®ue
(
™em
 *
p
)

777  (
p
->
wh©
 =ğ
id’t
 ||…->wh© =ğ
numb”
);

778 
	}
}

780 
	$check_v¬ŸbË
(
v¬ŸbË
 *
v
, 
™em
 *
p
)

782 ià(
v
 =ğ
NULL
)

783 
	`dÙ_”rÜ
(
p
);

784 
	}
}

786 
	$št_Ü_mod
(
™em
 *
İ
, i‹m *
p
)

789 
v¬ŸbË
 *
v
;

791 ià(
p
->
wh©
 =ğ
numb”
)

795 ià(
p
->
wh©
 !ğ
id’t
)

796 
	`dÙ_¬g_”rÜ
(
İ
, 
p
);

797 
v
 = 
	`fšd_v¬
(
p
->
tok
);

798 
	`check_v¬ŸbË
(
v
, 
p
);

799 ià(
v
->
ty³
 =ğ
VINT
)

804 
	}
}

807 
	$št_cmd_w¿µ”
(
¬gc
, *
¬gv
[])

809 ()
	`št_cmd
(
¬gc
, 
¬gv
);

810 
	}
}

812 
	$cİy_cmd_w¿µ”
(
¬gc
, *
¬gv
[])

814 ()
	`cİy_cmd
(
¬gc
, 
¬gv
);

815 
	}
}

817 
do_cmd2
(
™em
 *
p
, (*
cmd
)(, *[]), cÚ¡ *
s1
, cÚ¡ *
s2
)

819 *
¬gv
[3];

821 
cmd_”rÜ
 = 0;

822 #´agm¨
GCC
 
dŸgno¡ic
 
push


823 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

824 
¬gv
[0] = (*)"";

825 
¬gv
[1] = (*)
s1
;

826 
¬gv
[2] = (*)
s2
;

827 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


828 (*
cmd
)(3, 
¬gv
);

829 ià(
cmd_”rÜ
)

830 
	`dÙ_”rÜ
(
p
);

831 
	}
}

833 
do_cmd3
(
™em
 *
p
, (*
cmd
)(, *[]), cÚ¡ *
s1
, cÚ¡ *
s2
,

834 cÚ¡ *
s3
)

836 *
¬gv
[4];

838 
cmd_”rÜ
 = 0;

839 #´agm¨
GCC
 
dŸgno¡ic
 
push


840 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

841 
¬gv
[0] = (*)"";

842 
¬gv
[1] = (*)
s1
;

843 
¬gv
[2] = (*)
s2
;

844 
¬gv
[3] = (*)
s3
;

845 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


846 (*
cmd
)(4, 
¬gv
);

847 ià(
cmd_”rÜ
)

848 
	`dÙ_”rÜ
(
p
);

849 
	}
}

851 
	$assign
(
™em
 *
p
)

853 
v¬ŸbË
 *
vr
 = 
NULL
, *
vq
 = NULL;

854 
i
, 
j
, 
štæag
;

855 
™em
 *
q
, *
r
;

858 
i
 = 0, 
q
 = 
p
, 
r
 =…->
Ãxt
;; ++i, q = q->
´ev
,„ =„->next)

860 ià(!
	`is_lv®ue
(
q
->
´ev
))

862 ià(!
	`is_rv®ue
(
r
))

865 ià(
i
 == 0)

867 
	`´”rÜ
(";‚Ø¬gum’t tØ%s\n", 
p
->
tok
);

868 
	`dÙ_”rÜ
(
p
);

870 
r
 = 
p
->
Ãxt
;

873 
j
 = 1; j <ğ
i
; ++j, 
q
 = q->
Ãxt
, 
r
 =„->next)

876 
štæag
 = 
	`št_Ü_mod
(
p
, 
r
);

879 ià(
štæag
)

880 
	`do_cmd2
(
r
, 
št_cmd_w¿µ”
, 
q
->
tok
,„->tok);

882 
	`do_cmd2
(
r
, 
cİy_cmd_w¿µ”
,„->
tok
, 
q
->tok);

884 
	`·tch_™ems
(
p
, 0, 
i
, 
NULL
);

885 
	}
}

887 
bš¬y_İ
(
™em
 *
p
, (*
mod_cmd
)(, *[]), cÚ¡ *
št_İ
)

889 
™em
 *
q
, *
r
, *
t
;

890 *
s
, 
¬g
[
SMAX
];

891 
qæag
, 
ræag
;

893 
r
 = 
p
->
Ãxt
;

894 
q
 = 
p
->
´ev
;

895 
ræag
 = 
	`št_Ü_mod
(
p
, 
r
);

896 
qæag
 = 
	`št_Ü_mod
(
p
, 
q
);

897 ià(
qæag
 !ğ
ræag
)

898 
	`dÙ_¬g_”rÜ
(
p
, 
q
);

899 
s
 = 
	`g’sym_id’t
();

902 
cmd_”rÜ
 = 0;

903 ià(
qæag
)

905 ià(
št_İ
 =ğ
NULL
)

906 
	`dÙ_¬g_”rÜ
(
p
, 
q
);

907 
	`¥rštf
(
¬g
, "%s%s%s", 
q
->
tok
, 
št_İ
, 
r
->tok);

908 
	`do_cmd2
(
p
, 
št_cmd_w¿µ”
, 
s
, 
¬g
);

912 ià(
mod_cmd
 =ğ
NULL
)

913 
	`dÙ_¬g_”rÜ
(
p
, 
q
);

914 
	`do_cmd3
(
p
, 
mod_cmd
, 
q
->
tok
, 
r
->tok, 
s
);

916 ià(
cmd_”rÜ
)

917 
	`dÙ_”rÜ
(
p
);

919 
t
 = 
	`Ãw_™em
(
id’t
, 
s
);

920 
	`·tch_™ems
(
p
, 1, 1, 
t
);

921 
	}
}

923 
	$¶us
(
™em
 *
p
)

925 
	`bš¬y_İ
(
p
, 
add_cmd
, "+");

926 
	}
}

928 
	$mšus
(
™em
 *
p
)

930 
	`bš¬y_İ
(
p
, 
sub_cmd
, "-");

931 
	}
}

933 
	$times
(
™em
 *
p
)

935 
	`bš¬y_İ
(
p
, 
muÉ_cmd
, "*");

936 
	}
}

938 
	$cÚÿt
(
™em
 *
p
)

940 
™em
 *
q
, *
r
, *
t
;

941 *
s
;

943 
r
 = 
p
->
Ãxt
;

944 
q
 = 
p
->
´ev
;

945 
s
 = 
	`g’sym_id’t
();

947 
	`do_cmd2
(
p
, 
cİy_cmd_w¿µ”
, 
q
->
tok
, 
s
);

948 
	`do_cmd2
(
p
, 
cÚÿt_cmd
, 
s
, 
r
->
tok
);

950 
t
 = 
	`Ãw_™em
(
id’t
, 
s
);

951 
	`·tch_™ems
(
p
, 1, 1, 
t
);

952 
	}
}

954 
	$Œª¥o£
(
™em
 *
p
)

956 
™em
 *
r
, *
t
;

957 *
s
;

959 
r
 = 
p
->
Ãxt
;

960 
s
 = 
	`g’sym_id’t
();

962 
	`do_cmd2
(
p
, 
Œªs_cmd
, 
r
->
tok
, 
s
);

964 
t
 = 
	`Ãw_™em
(
id’t
, 
s
);

965 
	`·tch_™ems
(
p
, 0, 1, 
t
);

966 
	}
}

968 
	$Í¬’
(
™em
 *
p
)

970 
™em
 *
q
;

972 
q
 = 
p
->
Ãxt
; q->
wh©
 !ğ
’d
; q = q->next)

973 ià(
q
->
wh©
 =ğ
İ”
 && q->
’Œy
->
hªdËr
 =ğ
½¬’
)

975 ià(
q
->
wh©
 !ğ
’d
)

976 
	`·tch_™ems
(
q
, 0, 0, 
NULL
);

977 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

978 
	}
}

980 
	$½¬’
(
™em
 *
p
)

982 
™em
 *
q
;

984 
q
 = 
p
->
´ev
; q->
wh©
 !ğ
’d
; q = q->prev)

985 ià(
q
->
wh©
 =ğ
İ”
 && q->
’Œy
->
hªdËr
 =ğ
Í¬’
)

987 ià(
q
->
wh©
 !ğ
’d
)

988 
	`·tch_™ems
(
q
, 0, 0, 
NULL
);

989 
	`·tch_™ems
(
p
, 0, 0, 
NULL
);

990 
	}
}

	@dot_fns.h

5 
š™_dÙ
();

6 
dÙ_cmd
(
¬gc
, * 
¬gv
[]);

9 
š_dÙ_cmd_mode
;

	@ed.c

4 
	~"sh¬ed.h
"

5 
	~"ed.h
"

6 
	~"v¬s.h
"

7 
	~"mÚ™Ü.h
"

8 
	~"šput.h
"

9 
	~"pŞy.h
"

10 
	~"gm©rix.h
"

11 
	~"sm®É”m.h
"

12 
	~"ch¬p.h
"

13 
	~"cmds.h
"

14 
	~"·r£pŞy.h
"

15 
	~"·r£.h
"

16 
	~"‹rm.h
"

17 
	~"gm_pŞy.h
"

18 
	~"ršg.h
"

19 
	~"¶i¡.h
"

22 
cÚ¡ex´
 
	gROW
 = 1;

23 
cÚ¡ex´
 
	gCOL
 = 2;

26 
šlše
 
gm©rix
 
	$VAR_MODULE
(
v¬ŸbË
 *
p
)

28  
	`v¬_g‘_moduË
(
p
);

29 
	}
}

31 
šlše
 
pŞy
 
	$PREF
(
¶i¡
 
¶
, 
i
)

33  
	`¶i¡_»f
(&
¶
, 
i
);

34 
	}
}

36 
šlše
 
	$DREF
(
dli¡
 
dl
, 
i
)

38  
	`dli¡_»f
(&
dl
, 
i
);

39 
	}
}

41 
šlše
 
‹rm
 
	$INITIAL
(
pŞy
 
f
)

43  
	`pŞy_š™Ÿl
(
f
);

44 
	}
}

47 
šlše
 
boŞ
 
	$g‘_vmod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

49 ià(
i
 >ğ
¬gc
)

50  
çl£
;

51 *
p
 = 
	`vg‘_vmod
(
¬gv
[
i
]);

52  (*
p
 !ğ
NULL
);

53 
	}
}

55 
šlše
 
boŞ
 
	$GET_VMOD
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

57  
	`g‘_vmod
(
p
, 
¬gc
, 
¬gv
, 
i
);

58 
	}
}

60 
v¬ŸbË
 *
	ged™v¬
;

61 
gm©rix
 
	ged™m©
;

62 
boŞ—n
 
	gi¥çff
;

64 
	$ed™_cmd
(
¬gc
, *
¬gv
[])

66 ià(
¬gc
 == 1)

67 
ed™v¬
 = 
NULL
;

70 ià(!
	`GET_VMOD
(&
ed™v¬
, 
¬gc
, 
¬gv
, 1))

72 
i¥çff
 = ((
¬gc
 =ğ3è? 
Œue
 : 
çl£
);

75 
	}
}

77 
boŞ—n
 
	$ok_ed™
(
row_Ü_cŞ
)

79 ià(
ed™v¬
 =ğ
NULL
)

81 
	`´”rÜ
(";‚o matrixoƒdit\n");

82  (
çl£
);

84 ià((
i¥çff
è&& (
row_Ü_cŞ
 =ğ
COL
))

86 
	`´”rÜ
("; use„ow commands for…faffians\n");

87  (
çl£
);

89 
	`vrg_š¡®l
(
ed™v¬
->
b_ršg
);

90 
ed™m©
 = 
	`VAR_MODULE
(
ed™v¬
);

91  (
Œue
);

92 
	}
}

94 
boŞ—n
 
	$rcheck
(
n
)

96 ià((
n
 <ğ0è|| (À> 
	`Äows
(
ed™m©
)))

98 
	`´”rÜ
(";„ow %d ouˆoà¿nge\n", 
n
);

99  (
çl£
);

101  (
Œue
);

102 
	}
}

104 
boŞ—n
 
	$ccheck
(
n
)

106 ià((
n
 <ğ0è|| (À> 
	`ncŞs
(
ed™m©
)))

108 
	`´”rÜ
("; cŞumÀ%d ouˆoà¿nge\n", 
n
);

109  (
çl£
);

111  (
Œue
);

112 
	}
}

114 
	$´_cmd
(
¬gc
, *
¬gv
[])

116 
i1
, 
i2
;

118 ià(
¬gc
 != 3)

120 
	`´šŠew
("pr <row 1> <row 2> (permute„ows)\n");

123 ià(!
	`ok_ed™
(
ROW
))

125 
i1
 = 
	`g‘IÁ
(
¬gv
[1]);

126 
i2
 = 
	`g‘IÁ
(
¬gv
[2]);

127 ià(!
	`rcheck
(
i1
))

129 ià(!
	`rcheck
(
i2
))

131 
	`gmR_³rmu‹
(
ed™m©
, 
i1
, 
i2
);

132 ià(
i¥çff
)

133 
	`gmC_³rmu‹
(
ed™m©
, 
i1
, 
i2
);

135 
	}
}

137 
	$pc_cmd
(
¬gc
, *
¬gv
[])

139 
i1
, 
i2
;

141 ià(
¬gc
 != 3)

143 
	`´šŠew
("pc <column 1> <column 2> (permute columns)\n");

146 ià(!
	`ok_ed™
(
COL
))

148 
i1
 = 
	`g‘IÁ
(
¬gv
[1]);

149 
i2
 = 
	`g‘IÁ
(
¬gv
[2]);

150 ià(!
	`ccheck
(
i1
))

152 ià(!
	`ccheck
(
i2
))

154 
	`gmC_³rmu‹
(
ed™m©
, 
i1
, 
i2
);

156 
	}
}

158 
	$mr_cmd
(
¬gc
, *
¬gv
[])

160 
i
;

161 
pŞy
 
f
;

163 ià(
¬gc
 != 3)

165 
	`´šŠew
("mr <row> <poly multiplier> (multiply„ow)\n");

168 ià(!
	`ok_ed™
(
ROW
))

170 
i
 = 
	`g‘IÁ
(
¬gv
[1]);

171 ià(!
	`rcheck
(
i
))

173 
f
 = 
	`g‘PŞy
(
¬gv
[2], 1);

174 
	`gmR_muÉ
(
ed™m©
, 
i
, 
f
);

175 ià(
i¥çff
)

176 
	`gmC_muÉ
(
ed™m©
, 
i
, 
f
);

177 
	`p_kl
(&
f
);

179 
	}
}

181 
	$mc_cmd
(
¬gc
, *
¬gv
[])

183 
i
;

184 
pŞy
 
f
;

186 ià(
¬gc
 != 3)

188 
	`´šŠew
("mc <col> <poly multiplier> (multiply col.)\n");

191 ià(!
	`ok_ed™
(
COL
))

193 
i
 = 
	`g‘IÁ
(
¬gv
[1]);

194 ià(!
	`ccheck
(
i
))

196 
f
 = 
	`g‘PŞy
(
¬gv
[2], 1);

197 
	`gmC_muÉ
(
ed™m©
, 
i
, 
f
);

198 
	`p_kl
(&
f
);

200 
	}
}

202 
	$dr_cmd
(
¬gc
, *
¬gv
[])

204 
i
;

205 
f›ld
 
a
;

206 
pŞy
 
f
;

208 ià(
¬gc
 != 3)

210 
	`´šŠew
("dr <row> <fieldƒlem> (divide„ow)\n");

213 ià(!
	`ok_ed™
(
ROW
))

215 
i
 = 
	`g‘IÁ
(
¬gv
[1]);

216 ià(!
	`rcheck
(
i
))

218 
a
 = (
f›ld
)
	`g‘IÁ
(
¬gv
[2]);

219 ià(
a
 == 0)

221 
	`´”rÜ
("; can't divide by zero\n");

224 
	`fd_»c
(&
a
);

225 
f
 = 
	`p_mÚom
(
a
);

226 
	`tm_cİy
(
z”odegs
, 
	`INITIAL
(
f
));

227 
	`gmR_muÉ
(
ed™m©
, 
i
, 
f
);

228 ià(
i¥çff
)

229 
	`gmC_muÉ
(
ed™m©
, 
i
, 
f
);

230 
	`p_kl
(&
f
);

232 
	}
}

234 
	$dc_cmd
(
¬gc
, *
¬gv
[])

236 
i
;

237 
f›ld
 
a
;

238 
pŞy
 
f
;

240 ià(
¬gc
 != 3)

242 
	`´šŠew
("dc <col> <fieldƒlem> (divide col.)\n");

245 ià(!
	`ok_ed™
(
COL
))

247 
i
 = 
	`g‘IÁ
(
¬gv
[1]);

248 ià(!
	`ccheck
(
i
))

250 
a
 = (
f›ld
)
	`g‘IÁ
(
¬gv
[2]);

251 ià(
a
 == 0)

253 
	`´”rÜ
("; can't divide by zero\n");

256 
	`fd_»c
(&
a
);

257 
f
 = 
	`p_mÚom
(
a
);

258 
	`tm_cİy
(
z”odegs
, 
	`INITIAL
(
f
));

259 
	`gmC_muÉ
(
ed™m©
, 
i
, 
f
);

260 
	`p_kl
(&
f
);

262 
	}
}

264 
	$¬_cmd
(
¬gc
, *
¬gv
[])

266 
i1
, 
i2
;

267 
pŞy
 
f
;

269 ià(
¬gc
 != 4)

271 
	`´šŠew
("ar <row> <poly. multiplier> <rowo modify> ");

272 
	`´št
(" (addo„ow)\n");

275 ià(!
	`ok_ed™
(
ROW
))

277 
i1
 = 
	`g‘IÁ
(
¬gv
[1]);

278 
i2
 = 
	`g‘IÁ
(
¬gv
[3]);

279 ià(!
	`rcheck
(
i1
))

281 ià(!
	`rcheck
(
i2
))

283 
f
 = 
	`g‘PŞy
(
¬gv
[2], 1);

284 
	`gmR_addto
(
ed™m©
, 
i1
, 
f
, 
i2
);

285 ià(
i¥çff
)

286 
	`gmC_addto
(
ed™m©
, 
i1
, 
f
, 
i2
);

287 
	`p_kl
(&
f
);

289 
	}
}

291 
	$ac_cmd
(
¬gc
, *
¬gv
[])

293 
i1
, 
i2
;

294 
pŞy
 
f
;

296 ià(
¬gc
 != 4)

298 
	`´šŠew
("ac <col> <poly. multiplier> <colo modify> ");

299 
	`´št
(" (addo col)\n");

302 ià(!
	`ok_ed™
(
COL
))

304 
i1
 = 
	`g‘IÁ
(
¬gv
[1]);

305 
i2
 = 
	`g‘IÁ
(
¬gv
[3]);

306 ià(!
	`ccheck
(
i1
))

308 ià(!
	`ccheck
(
i2
))

310 
f
 = 
	`g‘PŞy
(
¬gv
[2], 1);

311 
	`gmC_addto
(
ed™m©
, 
i1
, 
f
, 
i2
);

313 
	}
}

315 
	$û_cmd
(
¬gc
, *
¬gv
[])

317 
pŞy
 
f
, 
g
;

318 
i
, 
j
;

320 ià(
¬gc
 != 4)

322 
	`´šŠew
("ce <row> <col> <new…oly.ƒntry> changeƒntry\n");

325 ià(!
	`ok_ed™
(
ROW
))

327 
i
 = 
	`g‘IÁ
(
¬gv
[1]);

328 
j
 = 
	`g‘IÁ
(
¬gv
[2]);

329 ià(!
	`rcheck
(
i
))

331 ià(!
	`ccheck
(
j
))

333 
g
 = 
	`g‘PŞy
(
¬gv
[3], 
i
);

334 
f
 = 
	`PREF
(
ed™m©
->
g’s
, 
j
);

335 
	`p_chEÁry
(&
f
, 
i
, 
g
);

336 
	`¶i¡_£t
(&
ed™m©
->
g’s
, 
j
, 
f
);

338 
	}
}

340 
	$gmR_³rmu‹
(
gm©rix
 
g
, 
r1
, 
r2
)

342 
i
;

344 
i
 = 1; i <ğ
	`ncŞs
(
g
); i++)

346 
pŞy
 
p
 = 
	`PREF
(
g
->
g’s
, 
i
);

347 
	`p_³rm
(&
p
, 
r1
, 
r2
);

348 
	`¶i¡_£t
(&
g
->
g’s
, 
i
, 
p
);

350 
	`dl_³rmu‹
(&(
g
->
deg»es
), 
r1
, 
r2
);

351 
	}
}

353 
	$gmC_³rmu‹
(
gm©rix
 
g
, 
c1
, 
c2
)

355 
pŞy
 
‹mp
;

357 
	`dl_³rmu‹
(&(
g
->
degg’s
), 
c1
, 
c2
);

358 
‹mp
 = 
	`PREF
(
g
->
g’s
, 
c1
);

359 
	`¶i¡_£t
(&
g
->
g’s
, 
c1
, 
	`PREF
(g->g’s, 
c2
));

360 
	`¶i¡_£t
(&
g
->
g’s
, 
c2
, 
‹mp
);

361 
	}
}

363 
	$dl_³rmu‹
(
dli¡
 *
dl
, 
i1
, 
i2
)

365 
‹mp
;

367 
‹mp
 = 
	`DREF
(*
dl
, 
i1
);

368 
	`dli¡_£t
(
dl
, 
i1
, 
	`DREF
(*dl, 
i2
));

369 
	`dli¡_£t
(
dl
, 
i2
, 
‹mp
);

370 
	}
}

372 
	$p_³rm
(
pŞy
 *
f
, 
i
, 
j
)

374 
pŞy
 
»suÉ
, 
‹mp
;

375 
pŞy
 
ff
;

376 
c
;

378 
»suÉ
 = 
NULL
;

379 
ff
 = *
f
;

380 
ff
 !ğ
NULL
)

382 
‹mp
 = 
ff
;

383 
ff
 = ff->
Ãxt
;

384 
‹mp
->
Ãxt
 = 
NULL
;

385 
c
 = 
	`g‘_comp
(
‹mp
);

386 ià(
c
 =ğ
i
)

387 
	`£t_comp
(
‹mp
, 
j
);

388 ià(
c
 =ğ
j
)

389 
	`£t_comp
(
‹mp
, 
i
);

390 
	`p_add
(&
»suÉ
, &
‹mp
);

392 *
f
 = 
»suÉ
;

393 
	}
}

395 
	$gmR_addto
(
gm©rix
 
g
, 
r1
, 
pŞy
 
f
, 
r2
)

398 
i
;

400 
i
 = 1; i <ğ
	`ncŞs
(
g
); i++)

402 
pŞy
 
p
 = 
	`PREF
(
g
->
g’s
, 
i
);

403 
	`p_addto
(&
p
, 
r1
, 
f
, 
r2
);

404 
	`¶i¡_£t
(&
g
->
g’s
, 
i
, 
p
);

406 
	}
}

408 
	$gmC_addto
(
gm©rix
 
g
, 
c1
, 
pŞy
 
f
, 
c2
)

410 
pŞy
 
a
;

412 
a
 = 
	`p_muÉ
(
f
, 
	`PREF
(
g
->
g’s
, 
c1
));

413 
pŞy
 
p
 = 
	`PREF
(
g
->
g’s
, 
c2
);

414 
	`p_add
(&
p
, &
a
);

415 
	`¶i¡_£t
(&
g
->
g’s
, 
c2
, 
p
);

416 
	}
}

418 
	$p_addto
(
pŞy
 *
pŞ
, 
i1
,…Şy 
f
, 
i2
)

420 
pŞy
 
»suÉ
, 
‹mp
, 
h
;

421 
pŞy
 
p
;

423 
»suÉ
 = 
NULL
;

424 
p
 = *
pŞ
;

425 
p
 !ğ
NULL
)

427 
‹mp
 = 
p
;

428 
p
 =…->
Ãxt
;

429 
‹mp
->
Ãxt
 = 
NULL
;

430 ià(
	`g‘_comp
(
‹mp
è=ğ
i1
)

432 
	`£t_comp
(
‹mp
, 
i2
);

433 
h
 = 
	`p_muÉ
(
f
, 
‹mp
);

434 
	`p_add
(&
»suÉ
, &
h
);

435 
	`£t_comp
(
‹mp
, 
i1
);

437 
	`p_add
(&
»suÉ
, &
‹mp
);

439 *
pŞ
 = 
»suÉ
;

440 
	}
}

442 
	$gmC_muÉ
(
gm©rix
 
g
, 
i
, 
pŞy
 
f
)

444 
pŞy
 
k
, 
h
;

446 
k
 = 
	`PREF
(
g
->
g’s
, 
i
);

447 
h
 = 
	`p_muÉ
(
f
, 
k
);

448 
	`p_kl
(&
k
);

449 
	`¶i¡_£t
(&
g
->
g’s
, 
i
, 
h
);

450 
	`dli¡_£t
(&
g
->
degg’s
, 
i
, 
	`deg»e
(g, 
h
));

451 
	}
}

453 
	$gmR_muÉ
(
gm©rix
 
g
, 
i
, 
pŞy
 
f
)

455 
deg
, 
j
;

457 
deg
 = 
	`deg»e
(
g
, 
f
);

458 
	`dli¡_£t
(&
g
->
deg»es
, 
i
, 
	`DREF
(g->deg»es, iè- 
deg
);

459 
j
 = 1; j <ğ
	`ncŞs
(
g
); j++)

461 
pŞy
 
p
 = 
	`PREF
(
g
->
g’s
, 
j
);

462 
	`p_muÉcomp
(&
p
, 
i
, 
f
);

463 
	`¶i¡_£t
(&
g
->
g’s
, 
j
, 
p
);

465 
	}
}

467 
	$p_muÉcomp
(
pŞy
 *
pŞ
, 
i
,…Şy 
f
)

469 
pŞy
 
»suÉ
, 
‹mp
, 
h
;

470 
pŞy
 
p
;

472 
»suÉ
 = 
NULL
;

473 
p
 = *
pŞ
;

474 
p
 !ğ
NULL
)

476 
‹mp
 = 
p
;

477 
p
 =…->
Ãxt
;

478 
‹mp
->
Ãxt
 = 
NULL
;

479 ià(
	`g‘_comp
(
‹mp
è=ğ
i
)

481 
h
 = 
	`p_muÉ
(
f
, 
‹mp
);

482 
	`p_add
(&
»suÉ
, &
h
);

485 
	`p_add
(&
»suÉ
, &
‹mp
);

487 *
pŞ
 = 
»suÉ
;

488 
	}
}

	@ed.h

5 
v¬ŸbË
* 
ed™v¬
;

6 
gm©rix
 
ed™m©
;

7 
boŞ—n
 
i¥çff
;

10 
ed™_cmd
(
¬gc
, * 
¬gv
[]);

11 
´_cmd
(
¬gc
, * 
¬gv
[]);

12 
pc_cmd
(
¬gc
, * 
¬gv
[]);

13 
mr_cmd
(
¬gc
, * 
¬gv
[]);

14 
mc_cmd
(
¬gc
, * 
¬gv
[]);

15 
dr_cmd
(
¬gc
, * 
¬gv
[]);

16 
dc_cmd
(
¬gc
, * 
¬gv
[]);

17 
¬_cmd
(
¬gc
, * 
¬gv
[]);

18 
ac_cmd
(
¬gc
, * 
¬gv
[]);

19 
û_cmd
(
¬gc
, * 
¬gv
[]);

21 
boŞ—n
 
ok_ed™
(
row_Ü_cŞ
);

22 
boŞ—n
 
rcheck
(
n
);

23 
boŞ—n
 
ccheck
(
n
);

25 
gmR_³rmu‹
(
gm©rix
 
g
, 
r1
, 
r2
);

26 
gmR_addto
(
gm©rix
 
g
, 
r1
, 
pŞy
 
f
, 
r2
);

27 
gmR_muÉ
(
gm©rix
 
g
, 
i
, 
pŞy
 
f
);

29 
gmC_³rmu‹
(
gm©rix
 
g
, 
c1
, 
c2
);

30 
gmC_addto
(
gm©rix
 
g
, 
c1
, 
pŞy
 
f
, 
c2
);

31 
gmC_muÉ
(
gm©rix
 
g
, 
i
, 
pŞy
 
f
);

33 
dl_³rmu‹
(
dli¡
* 
dl
, 
i1
, 
i2
);

34 
p_³rm
(
pŞy
* 
f
, 
i
, 
j
);

35 
p_addto
(
pŞy
* 
pŞ
, 
i1
,…Şy 
f
, 
i2
);

36 
p_muÉcomp
(
pŞy
* 
pŞ
, 
i
,…Şy 
f
);

	@generic.c

4 
	~"sh¬ed.h
"

5 
	~"g’”ic.h
"

6 
	~"ršg.h
"

7 
	~"v¬s.h
"

8 
	~"¶i¡.h
"

9 
	~"box´ocs.h
"

12 
cÚ¡ex´
 
	gNTYPES
 = 18;

14 cÚ¡ * 
	gty³_Çmes
[] = { "none", "int", "ring", "poly", "matrix",

22 
	$do_nÙhšg_void
(* 
obj
)

24 ()
obj
;

25 
	}
}

28 
boŞ—n
 
	$do_nÙhšg_boŞ—n
(* 
obj
, 
deg
)

30 ()
obj
;

31 ()
deg
;

32  
TRUE
;

33 
	}
}

36 
	$št_ty³_w¿µ”
(* 
obj
)

40 
šŒ_t
 
n
 = (šŒ_t)
obj
;

41 
	`št_ty³
(()
n
);

42 
	}
}

45 cÚ¡ 
objeù_vbË
 
	gnuÎ_vbË
 = { .
g‘_ty³
 = 
NULL
,

46 .
	gkl
 = 
NULL
,

47 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

48 .
	gpŞy_»ûive
 = 
NULL
,

49 .
	g’d_deg»e
 = 
NULL
 };

52 cÚ¡ 
objeù_vbË
 
	gšt_vbË
 = { .
g‘_ty³
 = 
št_ty³_w¿µ”
,

53 .
	gkl
 = 
do_nÙhšg_void
,

54 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

55 .
	gpŞy_»ûive
 = 
NULL
,

56 .
	g’d_deg»e
 = 
NULL
 };

59 cÚ¡ 
objeù_vbË
 
	gršg_vbË
 = { .
g‘_ty³
 = ((*)(*)è
vrg_ty³
,

60 .
	gkl
 = ((*)(*)è
rgKl
,

61 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

62 .
	gpŞy_»ûive
 = 
NULL
,

63 .
	g’d_deg»e
 = 
NULL
 };

66 cÚ¡ 
objeù_vbË
 
	gpŞy_vbË
 = { .
g‘_ty³
 = 
do_nÙhšg_void
,

67 .
	gkl
 = 
do_nÙhšg_void
,

68 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

69 .
	gpŞy_»ûive
 = 
NULL
,

70 .
	g’d_deg»e
 = 
NULL
 };

73 cÚ¡ 
objeù_vbË
 
	gmoduË_vbË
 = { .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

74 .
	gkl
 = ((*)(*)è
mod_kl
,

75 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

76 .
	gpŞy_»ûive
 = 
NULL
,

77 .
	g’d_deg»e
 = 
NULL
 };

80 cÚ¡ 
objeù_vbË
 
	gcom¶ex_vbË
 = { .
g‘_ty³
 = 
NULL
,

81 .
	gkl
 = 
NULL
,

82 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

83 .
	gpŞy_»ûive
 = 
NULL
,

84 .
	g’d_deg»e
 = 
NULL
 };

87 cÚ¡ 
objeù_vbË
 
	g¡¬‹r_vbË
 = {

88 .
g‘_ty³
 = ((*)(*)è
¡_µršt
,

89 .
	gkl
 = ((*)(*)è
¡_kl
,

90 .
	gmsg2
 = { .
¡¬t
 = ((*)(*, , **)è
	g¡_¡¬t
 },

91 .
	gpŞy_»ûive
 = 
NULL
,

92 .
	g’d_deg»e
 = 
NULL


96 cÚ¡ 
objeù_vbË
 
	gem™_vbË
 = {

97 .
g‘_ty³
 = ((*)(*)è
®Ÿs_ty³
,

98 .
	gkl
 = 
do_nÙhšg_void
,

99 .
	gmsg2
 = { .
do_deg»e
 = (
boŞ—n
 (*)(*, )è
	gem™_dodeg
 },

100 .
	gpŞy_»ûive
 = 
NULL
,

101 .
	g’d_deg»e
 = 
NULL


105 cÚ¡ 
objeù_vbË
 
	g¡dem™_vbË
 = {

106 .
g‘_ty³
 = ((*)(*)è
®Ÿs_ty³
,

107 .
	gkl
 = 
do_nÙhšg_void
,

108 .
	gmsg2
 = { .
do_deg»e
 = (
boŞ—n
 (*)(*, )è
	g£m™_dodeg
 },

109 .
	gpŞy_»ûive
 = 
NULL
,

110 .
	g’d_deg»e
 = 
NULL


114 cÚ¡ 
objeù_vbË
 
	g»s_vbË
 = { .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

115 .
	gkl
 = ((*)(*)è
mod_kl
,

116 .
	gmsg2
 = { .
do_deg»e
 = (
boŞ—n
 (*)(*,

117 )è
	g»s_dodeg
 },

118 .
	gpŞy_»ûive
 = 
NULL
,

119 .
	g’d_deg»e
 = 
NULL
 };

122 cÚ¡ 
objeù_vbË
 
	gshiá_vbË
 = {

123 .
g‘_ty³
 = 
do_nÙhšg_void
,

124 .
	gkl
 = 
do_nÙhšg_void
,

125 .
	gmsg2
 = { .
do_deg»e
 = (
boŞ—n
 (*)(*, )è
	gshiá_dodeg
 },

126 .
	gpŞy_»ûive
 = 
NULL
,

127 .
	g’d_deg»e
 = 
NULL


131 cÚ¡ 
objeù_vbË
 
	gcŞËù_vbË
 = {

132 .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

133 .
	gkl
 = ((*)(*)è
mod_kl
,

134 .
	gmsg2
 = { .
degs_»ûive
 = ((*)(*, *, )è
	gcŞl_degs
 },

135 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gcŞl_pŞy
,

136 .
	g’d_deg»e
 = 
do_nÙhšg_boŞ—n


140 cÚ¡ 
objeù_vbË
 
	gŒash_vbË
 = { .
g‘_ty³
 = 
do_nÙhšg_void
,

141 .
	gkl
 = 
do_nÙhšg_void
,

142 .
	gmsg2
 = { .
do_deg»e
 = 
NULL
 },

143 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gŒash_pŞy
,

144 .
	g’d_deg»e
 = 
do_nÙhšg_boŞ—n
 };

147 cÚ¡ 
objeù_vbË
 
	gliá_vbË
 = {

148 .
g‘_ty³
 = ((*)(*)è
®Ÿs_ty³
,

149 .
	gkl
 = 
do_nÙhšg_void
,

150 .
	gmsg2
 = { .
degs_»ûive
 = ((*)(*, *, )è
	gmg_degs
 },

151 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gliá_pŞy
,

152 .
	g’d_deg»e
 = (
boŞ—n
 (*)(*, )è
	gliá_’ddeg


156 cÚ¡ 
objeù_vbË
 
	gm”ge_vbË
 = {

157 .
g‘_ty³
 = 
do_nÙhšg_void
,

158 .
	gkl
 = 
do_nÙhšg_void
,

159 .
	gmsg2
 = { .
degs_»ûive
 = ((*)(*, *, )è
	gmg_degs
 },

160 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gmg_pŞy
,

161 .
	g’d_deg»e
 = (
boŞ—n
 (*)(*, )è
	gmg_’ddeg


165 cÚ¡ 
objeù_vbË
 
	gÄes_vbË
 = {

166 .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

167 .
	gkl
 = ((*)(*)è
mod_kl
,

168 .
	gmsg2
 = { .
degs_»ûive
 = ((*)(*, *, )è
	gcŞl_degs
 },

169 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gšs_Äes
,

170 .
	g’d_deg»e
 = (
boŞ—n
 (*)(*, )è
	gÄes_’ddeg


174 cÚ¡ 
objeù_vbË
 
	g¡d_vbË
 = {

175 .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

176 .
	gkl
 = ((*)(*)è
mod_kl
,

177 .
	gmsg2
 = { .
degs_»ûive
 = ((*)(*, *, )è
	g¡d_degs
 },

178 .
	gpŞy_»ûive
 = ((*)(*, 
	gpŞy
, )è
	gšs_Äes
,

179 .
	g’d_deg»e
 = (
boŞ—n
 (*)(*, )è
	g¡d_’ddeg


183 cÚ¡ 
objeù_vbË
 
	gi¡d_vbË
 = {

184 .
g‘_ty³
 = ((*)(*)è
vmod_ty³
,

185 .
	gkl
 = ((*)(*)è
mod_kl
,

186 .
	gmsg2
 = { .
do_deg»e
 = (
boŞ—n
 (*)(*, )è
	gi¡d_dodeg
 },

187 .
	gpŞy_»ûive
 = 
NULL
,

188 .
	g’d_deg»e
 = 
NULL


192 cÚ¡ 
objeù_vbË
* 
	gvbËs
[
NTYPES
] = {

193 [
VNOTYPE
] = &
nuÎ_vbË
, [
VINT
] = &
št_vbË
, [
VRING
] = &
ršg_vbË
,

194 [
VPOLY
] = &
pŞy_vbË
, [
VMODULE
] = &
moduË_vbË
, [
VCOMPLEX
] = &
com¶ex_vbË
,

195 [
VSTARTER
] = &
¡¬‹r_vbË
, [
VEMIT
] = &
em™_vbË
, [
VSTDEMIT
] = &
¡dem™_vbË
,

196 [
VRES
] = &
»s_vbË
, [
VSHIFT
] = &
shiá_vbË
, [
VCOLLECT
] = &
cŞËù_vbË
,

197 [
VTRASH
] = &
Œash_vbË
, [
VLIFT
] = &
liá_vbË
, [
VMERGE
] = &
m”ge_vbË
,

198 [
VNRES
] = &
Äes_vbË
, [
VSTD
] = &
¡d_vbË
, [
VISTD
] = &
i¡d_vbË


202 cÚ¡ 
objeù_vbË
*
	$g‘_vbË
(
ty³
)

204 ià(
ty³
 < 0 ||y³ >ğ
NTYPES
)

205  
NULL
;

206  
vbËs
[
ty³
];

207 
	}
}

209 *
	$g‘_mes§ge_hªdËr
(
ty³
, 
mes§ge
)

211 ià(
ty³
 < 0 ||y³ >ğ
NTYPES
)

212  
NULL
;

214 cÚ¡ 
objeù_vbË
* 
vbË
 = 
vbËs
[
ty³
];

215 ià(!
vbË
)

216  
NULL
;

218 
mes§ge
)

220 
MTYPE
:

221  (*)
vbË
->
g‘_ty³
;

222 
MKILL
:

223  (*)
vbË
->
kl
;

224 
MSTART
:

226  (*)
vbË
->
msg2
.
do_deg»e
;

227 
MPOLY_RECEIVE
:

228  (*)
vbË
->
pŞy_»ûive
;

229 
MENDDEG
:

230  (*)
vbË
->
’d_deg»e
;

232  
NULL
;

234 
	}
}

	@generic.h

5 
cÚ¡ex´
 
	gVNOTYPE
 = 0;

6 
cÚ¡ex´
 
	gVINT
 = 1;

7 
cÚ¡ex´
 
	gVRING
 = 2;

8 
cÚ¡ex´
 
	gVPOLY
 = 3;

9 
cÚ¡ex´
 
	gVMODULE
 = 4;

10 
cÚ¡ex´
 
	gVCOMPLEX
 = 5;

11 
cÚ¡ex´
 
	gVSTARTER
 = 6;

12 
cÚ¡ex´
 
	gVEMIT
 = 7;

13 
cÚ¡ex´
 
	gVSTDEMIT
 = 8;

14 
cÚ¡ex´
 
	gVRES
 = 9;

15 
cÚ¡ex´
 
	gVSHIFT
 = 10;

16 
cÚ¡ex´
 
	gVCOLLECT
 = 11;

17 
cÚ¡ex´
 
	gVTRASH
 = 12;

18 
cÚ¡ex´
 
	gVLIFT
 = 13;

19 
cÚ¡ex´
 
	gVMERGE
 = 14;

20 
cÚ¡ex´
 
	gVNRES
 = 15;

21 
cÚ¡ex´
 
	gVSTD
 = 16;

22 
cÚ¡ex´
 
	gVISTD
 = 17;

25 
cÚ¡ex´
 
	gMTYPE
 = 0;

26 
cÚ¡ex´
 
	gMKILL
 = 1;

27 
cÚ¡ex´
 
	gMSTART
 = 2;

28 
cÚ¡ex´
 
	gMDODEG
 = 2;

29 
cÚ¡ex´
 
	gMDEGS_RECEIVE
 = 2;

30 
cÚ¡ex´
 
	gMPOLY_RECEIVE
 = 3;

31 
cÚ¡ex´
 
	gMENDDEG
 = 4;

34 cÚ¡ * 
ty³_Çmes
[];

	@getdet.c

4 
	~"sh¬ed.h
"

5 
	~"g‘d‘.h
"

6 
	~<¡dio.h
>

7 
	~<£tjmp.h
>

9 
	~"comb_»c.h
"

10 
	~"bËs.h
"

11 
	~"gm©rix.h
"

12 
	~"pŞy.h
"

13 
	~"¶i¡.h
"

14 
	~"v¬s.h
"

15 
	~"cmds.h
"

16 
	~"·r£.h
"

17 
	~"mÚ™Ü.h
"

20 
	gTemp
;

22 #ifdeà
OPCOUNT


23 
	gmuÉcouÁ
 = 0, 
	gaddcouÁ
 = 0;

27 
boŞ
 
	$g‘_mod
(
gm©rix
* 
g
, 
¬gc
, ** 
¬gv
, 
i
)

29 ià(
i
 >ğ
¬gc
)

30  
çl£
;

31 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

32  (*
g
 !ğ
NULL
);

33 
	}
}

39 
pŞy
 
	$ÿlc_d‘
(
gm©rix
 
M
, * 
r
, * 
c
, 
p
)

41 
Ãg©e
 = 0;

42 
i
;

43 
pŞy
 
»suÉ
;

44 
‹mp
;

45 
pŞy
* 
´ev»suÉ
;

46 
pŞy
 
±emp
;

47 
pŞy
 
±emp2
;

52 ià(*(
´ev»suÉ
 = 
	`¡Üed_v®ue
(
r
, 
c
, 
p
))

54 !ğ
NO_ENTRY
)

55  (*
´ev»suÉ
);

61 ià((
±emp2
 = 
	`m©rixsub
(*
c
, *
r
)è=ğ
NULL
)

62 
»suÉ
 = 
NULL
;

64 
»suÉ
 = 
	`p_muÉ
(
±emp2
, 
	`ÿlc_d‘
(
M
, 
r
 + 1, 
c
 + 1, 
p
 - 1));

66 #ifdeà
OPCOUNT


67 
muÉcouÁ
++;

70 
i
 = 1; i < 
p
; i++)

72 
Ãg©e
 = !negate;

74 
	`sw­šts
(&
c
[0], &c[
i
]);

76 ià((
±emp2
 = 
	`m©rixsub
(*
c
, *
r
)è!ğ
NULL
)

78 
±emp
 = 
	`p_muÉ
(
±emp2
, 
	`ÿlc_d‘
(
M
, 
r
 + 1, 
c
 + 1, 
p
 - 1));

80 ià(
Ãg©e
)

81 
	`p_sub
(&
»suÉ
, &
±emp
);

83 
	`p_add
(&
»suÉ
, &
±emp
);

85 #ifdeà
OPCOUNT


86 
muÉcouÁ
++;

87 
addcouÁ
++;

94 
‹mp
 = 
c
[0];

95 
i
 = 0; i < 
p
 - 1; i++)

96 
c
[
i
] = c[i + 1];

97 
c
[
p
 - 1] = 
‹mp
;

102 *
´ev»suÉ
 = 
»suÉ
;

104  
»suÉ
;

105 
	}
}

107 
gm©rix
 
	$d‘”mšªts
(
gm©rix
 
M
, 
s
)

109 
x
, 
y
;

110 
comb_»c
 
rowli¡
, 
cŞli¡
;

111 
gm©rix
 
»suÉ
;

113 
x
 = 
	`ncŞs
(
M
);

114 
y
 = 
	`Äows
(
M
);

117 ià(
s
 > 
x
 || s > 
y
)

119 
	`´”rÜ
("; g‘d‘: mšÜ siz%dƒxûed m©rix dim’siÚ %dx%d\n", 
s
, 
y
, 
x
);

120  
	`mod_š™
();

122 ià(
s
 <= 0)

124 
	`´”rÜ
("; getdet: minor size must be…ositive\n");

125  
	`mod_š™
();

128 
»suÉ
 = 
	`mod_š™
();

129 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 0);

133 
	`š™_combs
(
	`max_št
(
x
, 
y
));

134 
	`š™_comb_»cs
(
s
);

135 ià(
	`š™_bËs
(
M
, 
x
, 
y
, 
s
) == 0)

137 
	`´štf
("notƒnough memoryo usehis command\n");

138 
	`ä“_comb_»cs
();

139 
	`ä“_combs
();

140  
»suÉ
;

143 
	`g‘_comb_»c
(&
rowli¡
, 
s
);

144 
	`g‘_comb_»c
(&
cŞli¡
, 
s
);

145 
	`š™_comb_»c
(&
rowli¡
);

149 
	`š™_comb_»c
(&
cŞli¡
);

152 
	`gmIn£¹
(
»suÉ
, 
	`p_cİy
(
	`ÿlc_d‘
(
M
, 
rowli¡
.
t
, 
cŞli¡
.t, 
s
)));

153 } 
	`Ãxt_comb
(
cŞli¡
.
t
, &cŞli¡.
sign
, cŞli¡.
Ëngth
, 
x
));

154 } 
	`Ãxt_comb
(
rowli¡
.
t
, &rowli¡.
sign
,„owli¡.
Ëngth
, 
y
));

156 
	`ä“_comb_»c
(&
rowli¡
);

157 
	`ä“_comb_»c
(&
cŞli¡
);

159 
	`ä“_bËs
();

160 
	`ä“_comb_»cs
();

161 
	`ä“_combs
();

163 #ifdeà
OPCOUNT


164 
	`årštf
(
¡d”r
, "U£d %u‡dd ªd %u muÉl›s.\n", 
addcouÁ
, 
muÉcouÁ
);

167  
»suÉ
;

168 
	}
}

170 
	$d‘”mšªts_cmd
(
¬gc
, * 
¬gv
[])

172 
gm©rix
 
g
;

173 
n
;

174 
v¬ŸbË
* 
p
;

176 ià(
¬gc
 != 4)

178 
	`´šŠew
("determinants <matrix> <p> <result>\n");

182 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

185 
n
 = 
	`g‘IÁ
(
¬gv
[2]);

187 ià((
n
 <ğ0è|| (À> 
	`Äows
(
g
)è|| (À> 
	`ncŞs
(g)))

189 
	`´”rÜ
(";‡Î siz%d mšÜ ¬z”o\n", 
n
);

193 ià(((
p
èğ
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VMODULE
, (
v¬ŸbË
*)
cu¼’t_ršg
)è=ğ
NULL
)

195 
	`£t_v®ue
(
p
, 
	`d‘”mšªts
(
g
, 
n
));

196 
	}
}

	@getdet.h

6 
cÚ¡ex´
 
	gVMODULE
 = 4;

9 
Temp
;

12 
šlše
 
	$sw­šts
(* 
x
, * 
y
)

14 
‹mp
 = *
x
;

15 *
x
 = *
y
;

16 *
y
 = 
‹mp
;

17 
	}
}

19 
šlše
 
	$odd
(
x
)

21  
x
 % 2;

22 
	}
}

24 
šlše
 
	$ev’
(
x
)

26  !(
x
 % 2);

27 
	}
}

30 
boŞ
 
g‘_mod
(
gm©rix
* 
g
, 
¬gc
, ** 
¬gv
, 
i
);

33 
pŞy
 
NO_ENTRY
;

36 
pŞy
 
m©rixsub
(
x
, 
y
);

39 
pŞy
 
ÿlc_d‘
(
gm©rix
 
M
, * 
r
, * 
c
, 
p
);

40 
gm©rix
 
d‘”mšªts
(gm©rix 
M
, 
s
);

43 
d‘”mšªts_cmd
(
¬gc
, * 
¬gv
[]);

45 #ifdeà
OPCOUNT


46 
muÉcouÁ
, 
addcouÁ
;

	@gm_cmds.c

4 
	~<¡ršg.h
>

5 
	~<£tjmp.h
>

7 
	~"sh¬ed.h
"

8 
	~"gm_cmds.h
"

9 
	~"v¬s.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"gm©rix.h
"

12 
	~"¶i¡.h
"

13 
	~"gm_dli¡.h
"

14 
	~"·r£.h
"

15 
	~"rv¬.h
"

16 
	~"·r£pŞy.h
"

17 
	~"¡dcmds.h
"

18 
	~"ršg.h
"

19 
	~"cmds.h
"

22 
cÚ¡ex´
 
	gIDSIZE
 = 50;

24 
cÚ¡ex´
 
	gVMODULE
 = 4;

27 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
g
, 
¬gc
, **
¬gv
, 
i
)

29 ià(
i
 >ğ
¬gc
)

30  
çl£
;

31 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

32  (*
g
 !ğ
NULL
);

33 
	}
}

35 
šlše
 
boŞ
 
	$g‘_rgmod
(
gm©rix
 *
g
, 
¬gc
, **
¬gv
, 
i
)

37 ià(
i
 >ğ
¬gc
)

38  
çl£
;

39 *
g
 = 
	`vg‘_rgmod
(
¬gv
[
i
]);

40  (*
g
 !ğ
NULL
);

41 
	}
}

43 
šlše
 
boŞ
 
	$Ãw_mod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

45 ià(
i
 >ğ
¬gc
)

46  
çl£
;

47 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

48  (*
p
 !ğ
NULL
);

49 
	}
}

51 
šlše
 
boŞ
 
	$Ãw_§vmod
(
v¬ŸbË
 **
p
, *
s
)

53 *
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

54  (*
p
 !ğ
NULL
);

55 
	}
}

57 
	$add_cmd
(
¬gc
, *
¬gv
[])

59 
gm©rix
 
f
, 
g
;

60 
v¬ŸbË
 *
p
;

62 ià(
¬gc
 != 4)

64 
	`´šŠew
("add <matrix> <matrix> <result>\n");

67 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

69 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 2))

71 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

73 
	`£t_v®ue
(
p
, 
	`gm_add
(
f
, 
g
));

74 
	}
}

76 
	$muÉ_cmd
(
¬gc
, *
¬gv
[])

78 
gm©rix
 
f
, 
g
;

79 
v¬ŸbË
 *
p
;

81 ià(
¬gc
 != 4)

83 
	`´šŠew
("mult <matrix> <matrix> <result>\n");

86 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

88 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 2))

90 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

92 
	`£t_v®ue
(
p
, 
	`gm_muÉ
(
f
, 
g
));

93 
	}
}

95 
	$smuÉ_cmd
(
¬gc
, *
¬gv
[])

97 
gm©rix
 
M
;

98 
pŞy
 
f
;

99 
v¬ŸbË
 *
p
;

101 ià(
¬gc
 != 4)

103 
	`´šŠew
("smult <matrix> <polynomial> <result matrix>\n");

106 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

108 
f
 = 
	`g‘PŞy
(
¬gv
[2], 1);

109 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

111 
	`£t_v®ue
(
p
, 
	`gm_smuÉ
(
M
, 
f
));

112 
	}
}

114 
	$sub_cmd
(
¬gc
, *
¬gv
[])

116 
gm©rix
 
f
, 
g
;

117 
v¬ŸbË
 *
p
;

119 ià(
¬gc
 != 4)

121 
	`´šŠew
("subtract <matrix> <matrix> <result>\n");

124 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

126 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 2))

128 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

130 
	`£t_v®ue
(
p
, 
	`gm_sub
(
f
, 
g
));

131 
	}
}

133 
	$Œªs_cmd
(
¬gc
, *
¬gv
[])

135 
gm©rix
 
f
;

136 
v¬ŸbË
 *
p
;

138 ià(
¬gc
 != 3)

140 
	`´šŠew
("transpose <matrix> <result matrix>\n");

143 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

145 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

147 
	`£t_v®ue
(
p
, 
	`gm_Œª¥o£
(
f
));

148 
	}
}

150 
	$dsum_cmd
(
¬gc
, *
¬gv
[])

152 
gm©rix
 
»suÉ
, 
M
;

153 
i
;

154 
v¬ŸbË
 *
p
;

156 ià(
¬gc
 < 3)

158 
	`´šŠew
("dsum <matrix> ... <matrix> <result>\n");

162 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

165 
i
 = 2; i < 
¬gc
 - 1; i++)

166 ià(!
	`g‘_rgmod
(&
M
, 
¬gc
, 
¬gv
, 
i
))

169 
»suÉ
 = 
	`mod_š™
();

170 
i
 = 1; i < 
¬gc
 - 1; i++)

172 ià(!
	`g‘_rgmod
(&
M
, 
¬gc
, 
¬gv
, 
i
))

174 
	`gm_dsum
(
»suÉ
, 
M
);

176 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
,‡rgc - 1))

178 
	`£t_v®ue
(
p
, 
»suÉ
);

179 
	}
}

181 
	$id’_cmd
(
¬gc
, *
¬gv
[])

183 
n
;

184 
v¬ŸbË
 *
p
;

186 ià(
¬gc
 != 3)

188 
	`´šŠew
("iden <size> <result>\n");

191 ià(
cu¼’t_ršg
 =ğ
NULL
)

193 
	`´”rÜ
(";‚o current„ing is defined\n");

196 
n
 = 
	`g‘IÁ
(
¬gv
[1]);

197 ià(
n
 < 0)

199 
	`´”rÜ
("; size must be‚on-negative\n");

202 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

204 
	`£t_v®ue
(
p
, 
	`gm_id’
(
n
));

205 
	}
}

207 
	$dŸg_cmd
(
¬gc
, *
¬gv
[])

209 
gm©rix
 
M
;

210 
v¬ŸbË
 *
p
;

212 ià(
¬gc
 != 3)

214 
	`´šŠew
("diag <matrix> <result>\n");

217 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

219 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

221 
	`£t_v®ue
(
p
, 
	`gm_dŸg
(
M
));

222 
	}
}

224 
	$subm©_cmd
(
¬gc
, *
¬gv
[])

226 
gm©rix
 
g
;

227 
v¬ŸbË
 *
p
;

228 
dli¡
 
drows
, 
dcŞs
;

229 
s
[
IDSIZE
];

231 ià(
¬gc
 != 3)

233 
	`´šŠew
("submat <matrix> <result submatrix>\n");

236 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

238 
	`¡rıy
(
s
, 
¬gv
[2]);

239 
	`´šput
("rows");

240 ià(!
	`dlV¬G‘
(&
drows
, 1, 
	`Äows
(
g
)))

242 
	`´šput
("columns");

243 ià(!
	`dlV¬G‘
(&
dcŞs
, 1, 
	`ncŞs
(
g
)))

245 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

247 
	`£t_v®ue
(
p
, 
	`gm_subm©
(
g
, &
drows
, &
dcŞs
));

248 
	`dl_kl
(&
drows
);

249 
	`dl_kl
(&
dcŞs
);

250 
	}
}

252 
	$wedge_cmd
(
¬gc
, *
¬gv
[])

254 
gm©rix
 
g
;

255 
n
;

256 
v¬ŸbË
 *
p
;

258 ià(
¬gc
 != 4)

260 
	`´šŠew
("wedge <matrix> <p> <result>\n");

263 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

265 
n
 = 
	`g‘IÁ
(
¬gv
[2]);

266 ià((
n
 <ğ0è|| (À> 
	`Äows
(
g
)è|| (À> 
	`ncŞs
(g)))

268 
	`´”rÜ
(";‡Î siz%d mšÜ ¬z”o\n", 
n
);

271 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

273 
	`£t_v®ue
(
p
, 
	`gm_wedge
(
g
, 
n
));

274 
	}
}

276 
	$pçff_cmd
(
¬gc
, *
¬gv
[])

278 
gm©rix
 
g
;

279 
v¬ŸbË
 *
p
;

281 ià(
¬gc
 != 3)

283 
	`´šŠew
("pfaff <skew matrix> <result ideal of 4 by 4…faffians>\n");

286 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

288 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

290 
	`£t_v®ue
(
p
, 
	`gm_pçff4
(
g
));

291 
	}
}

293 
	$æ©‹n_cmd
(
¬gc
, *
¬gv
[])

295 
gm©rix
 
g
;

296 
v¬ŸbË
 *
p
;

298 ià(
¬gc
 != 3)

300 
	`´šŠew
("flatten <matrix> <result ideal ofƒntries>\n");

303 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

305 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

307 
	`£t_v®ue
(
p
, 
	`gm_æ©‹n
(
g
));

308 
	}
}

310 
	$ÿt_cmd
(
¬gc
, *
¬gv
[])

312 
v¬ŸbË
 *
p
;

313 
dli¡
 
drows
, 
dcŞs
;

314 
fœ¡v¬
;

315 
s
[
IDSIZE
];

317 ià(
¬gc
 != 3)

319 
	`´šŠew
("cat <first var(0..numvars-1)> <result matrix>\n");

322 
	`¡rıy
(
s
, 
¬gv
[2]);

323 
fœ¡v¬
 = 
	`g‘V¬
(
¬gv
[1]);

324 ià(
fœ¡v¬
 < 0)

325 
fœ¡v¬
 = 
	`g‘IÁ
(
¬gv
[1]);

327 
	`´šput
("rows");

328 
	`dlV¬Sÿn
(&
drows
, 0, 
numv¬s
 - 1);

329 
	`´šput
("columns");

330 
	`dlV¬Sÿn
(&
dcŞs
, 0, 
numv¬s
 - 1);

331 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

333 
	`£t_v®ue
(
p
, 
	`gm_g’M©
(&
drows
, &
dcŞs
, 
fœ¡v¬
));

334 
	}
}

336 
	$jacob_cmd
(
¬gc
, *
¬gv
[])

338 
v¬ŸbË
 *
p
;

339 
gm©rix
 
g
;

340 
ex±”m
 
v¬s
;

342 ià(
¬gc
 < 3)

344 
	`´šŠew
("jacob <ideal> <resulting jacobian> [variable†ist]\n");

347 ià(!
	`g‘_mod
(&
g
, 
¬gc
, 
¬gv
, 1))

349 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

351 cÚ¡ **
cÚ¡_¬gv
 = (cÚ¡ **)(*)(
¬gv
 + 3);

352 ià(!(
	`g‘V¬Li¡
(
¬gc
 - 3, 
cÚ¡_¬gv
, 
v¬s
)))

354 
	`£t_v®ue
(
p
, 
	`gm_jacobŸn
(
g
, 
v¬s
));

355 
	}
}

357 
	$cÚÿt_cmd
(
¬gc
, *
¬gv
[])

359 
gm©rix
 
»suÉ
, 
g
;

360 
i
;

362 ià(
¬gc
 <= 2)

364 
	`´šŠew
("concat <matrix> <matrix2> ... <matrix‚>\n");

367 ià(!
	`g‘_mod
(&
»suÉ
, 
¬gc
, 
¬gv
, 1))

369 
i
 = 2; i < 
¬gc
; i++)

371 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 
i
))

373 
	`gm_cÚÿt
(
»suÉ
, 
g
);

375 
	}
}

377 
	$»duû_cmd
(
¬gc
, *
¬gv
[])

379 
gm©rix
 
f
, 
g
;

380 
gm©rix
 
»d
, 
liá
;

381 
v¬ŸbË
 *
p
, *
q
;

383 ià((
¬gc
 < 4) || (argc > 5))

385 
	`´šŠew
("reduce <standard basis> <matrixo„educe> ");

386 
	`´št
("<result„educed matrix> [result†ifted matrix]\n");

389 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

391 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 2))

393 ià(
	`Äows
(
f
è<‚rows(
g
))

395 
	`´”rÜ
("; % ha toØmªy„ows\n", 
¬gv
[2]);

398 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

400 ià(
¬gc
 == 5)

402 ià(!
	`Ãw_mod
(&
q
, 
¬gc
, 
¬gv
, 4))

404 
	`gm_»duû
(
f
, 
g
, &
»d
, &
liá
);

405 
	`£t_v®ue
(
q
, 
liá
);

408 
	`gm_»duû
(
f
, 
g
, &
»d
, 
NULL
);

409 
	`£t_v®ue
(
p
, 
»d
);

410 
	}
}

412 
	$liá_cmd
(
¬gc
, *
¬gv
[])

414 
gm©rix
 
f
, 
g
;

415 
v¬ŸbË
 *
p
;

417 ià(
¬gc
 != 4)

419 
	`´šŠew
("lift <standard basis> <matrixo†ift> <result>\n");

422 ià(!
	`g‘_mod
(&
f
, 
¬gc
, 
¬gv
, 1))

424 ià(!
	`g‘_rgmod
(&
g
, 
¬gc
, 
¬gv
, 2))

426 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

428 
	`£t_v®ue
(
p
, 
	`gm_liá
(
f
, 
g
));

429 
	}
}

431 
	$Œaû_cmd
(
¬gc
, *
¬gv
[])

433 
gm©rix
 
M
;

434 
v¬ŸbË
 *
p
;

436 ià(
¬gc
 != 3)

438 
	`´šŠew
("trace <matrix> <resultingrace>\n");

441 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

443 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

445 
	`£t_v®ue
(
p
, 
	`gm_Œaû
(
M
));

446 
	}
}

448 
	$‹nsÜ_cmd
(
¬gc
, *
¬gv
[])

450 
gm©rix
 
M
, 
N
;

451 
v¬ŸbË
 *
p
;

453 ià(
¬gc
 != 4)

455 
	`´šŠew
("tensor <matrix M> <matrix N> <result matrix M.N>\n");

458 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

460 ià(!
	`g‘_rgmod
(&
N
, 
¬gc
, 
¬gv
, 2))

462 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

464 
	`£t_v®ue
(
p
, 
	`gm_‹nsÜ
(
M
, 
N
));

465 
	}
}

467 
	$ou‹r_cmd
(
¬gc
, *
¬gv
[])

469 
gm©rix
 
M
, 
N
;

470 
v¬ŸbË
 *
p
;

472 ià(
¬gc
 != 4)

474 
	`´šŠew
("outer <matrix> <matrix> <result matrix>\n");

477 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

479 ià(!
	`g‘_rgmod
(&
N
, 
¬gc
, 
¬gv
, 2))

481 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

483 
	`£t_v®ue
(
p
, 
	`gm_ou‹r
(
M
, 
N
));

484 
	}
}

486 
	$pow”_cmd
(
¬gc
, *
¬gv
[])

488 
gm©rix
 
M
;

489 
n
;

490 
v¬ŸbË
 *
p
;

492 ià(
¬gc
 != 4)

494 
	`´šŠew
("power <matrix 1 by‚> <int…ower> <result matrix>\n");

497 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

499 ià(
	`Äows
(
M
) != 1)

501 
	`´”rÜ
(";here must be only one„ow inhe given matrix\n");

504 
n
 = 
	`g‘IÁ
(
¬gv
[2]);

505 ià(
n
 < 0)

507 
	`´”rÜ
(";…ower must be‚on-negative\n");

510 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

512 
	`£t_v®ue
(
p
, 
	`gm_pow”
(
M
, 
n
));

513 
	}
}

515 
	$diff_cmd
(
¬gc
, *
¬gv
[])

517 
gm©rix
 
M
, 
N
;

518 
v¬ŸbË
 *
p
;

519 
boŞ—n
 
u£cÛf
;

521 ià(
¬gc
 != 4)

523 
	`´šŠew
("% <id—l> <id—l> <»suÉ m©rix>\n", 
¬gv
[0]);

526 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

528 ià(!
	`g‘_mod
(&
N
, 
¬gc
, 
¬gv
, 2))

530 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

532 
u£cÛf
 = (
¬gv
[0][0] == 'd');

534 
	`£t_v®ue
(
p
, 
	`gm_diff
(
M
, 
N
, 
u£cÛf
));

535 
	}
}

537 
	$¿ndom_cmd
(
¬gc
, *
¬gv
[])

539 
r
, 
c
;

540 
v¬ŸbË
 *
p
;

542 ià(
¬gc
 != 4)

544 
	`´šŠew
("random <nrows> <ncolumns> <result„andom matrix>\n");

547 
r
 = 
	`g‘IÁ
(
¬gv
[1]);

548 
c
 = 
	`g‘IÁ
(
¬gv
[2]);

549 ià((
r
 < 0è|| (
c
 < 0))

551 
	`´”rÜ
(";‚eed‚on-negative‚umber of„ows‡nd columns\n");

554 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

556 
	`£t_v®ue
(
p
, 
	`gm_¿ndom
(
r
, 
c
));

557 
	}
}

559 
	$com´ess_cmd
(
¬gc
, *
¬gv
[])

561 
gm©rix
 
M
;

562 
v¬ŸbË
 *
p
;

564 ià(
¬gc
 != 3)

566 
	`´šŠew
("compress <matrix> <result matrix>\n");

569 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

571 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 2))

573 
	`£t_v®ue
(
p
, 
	`gm_com´ess
(
M
));

574 
	}
}

	@gm_cmds.h

5 
add_cmd
(
¬gc
, * 
¬gv
[]);

6 
muÉ_cmd
(
¬gc
, * 
¬gv
[]);

7 
smuÉ_cmd
(
¬gc
, * 
¬gv
[]);

8 
sub_cmd
(
¬gc
, * 
¬gv
[]);

9 
Œªs_cmd
(
¬gc
, * 
¬gv
[]);

10 
dsum_cmd
(
¬gc
, * 
¬gv
[]);

11 
id’_cmd
(
¬gc
, * 
¬gv
[]);

12 
dŸg_cmd
(
¬gc
, * 
¬gv
[]);

13 
subm©_cmd
(
¬gc
, * 
¬gv
[]);

14 
wedge_cmd
(
¬gc
, * 
¬gv
[]);

15 
pçff_cmd
(
¬gc
, * 
¬gv
[]);

16 
æ©‹n_cmd
(
¬gc
, * 
¬gv
[]);

17 
ÿt_cmd
(
¬gc
, * 
¬gv
[]);

18 
jacob_cmd
(
¬gc
, * 
¬gv
[]);

19 
cÚÿt_cmd
(
¬gc
, * 
¬gv
[]);

20 
»duû_cmd
(
¬gc
, * 
¬gv
[]);

21 
liá_cmd
(
¬gc
, * 
¬gv
[]);

22 
Œaû_cmd
(
¬gc
, * 
¬gv
[]);

23 
‹nsÜ_cmd
(
¬gc
, * 
¬gv
[]);

24 
ou‹r_cmd
(
¬gc
, * 
¬gv
[]);

25 
pow”_cmd
(
¬gc
, * 
¬gv
[]);

26 
diff_cmd
(
¬gc
, * 
¬gv
[]);

27 
¿ndom_cmd
(
¬gc
, * 
¬gv
[]);

28 
com´ess_cmd
(
¬gc
, * 
¬gv
[]);

	@gm_dlist.c

4 
	~<¡ršg.h
>

5 
	~<¡dio.h
>

6 
	~<£tjmp.h
>

7 
	~"sh¬ed.h
"

8 
	~"gm_dli¡.h
"

9 
	~"v¬s.h
"

10 
	~"·r£.h
"

11 
	~"sh–l.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"¬¿y.h
"

14 
	~"´štf.h
"

15 
	~"šput.h
"

16 
	~"humª_io.h
"

17 
	~"£t.h
"

20 
šlše
 
gm©rix
 
	$VAR_MODULE
(
v¬ŸbË
* 
p
)

22  
	`v¬_g‘_moduË
(
p
);

23 
	}
}

26 
šlše
 
	$dl_š£¹
(
dli¡
* 
dl
, 
i
)

28 
	`dli¡_š£¹
(
dl
, 
i
);

29 
	}
}

31 
šlše
 
	$DREF
(
dli¡
 
dl
, 
i
)

33  
	`dli¡_»f
(&
dl
, 
i
);

34 
	}
}

36 
šlše
 
	$dl_š™
(
dli¡
* 
dl
)

38 
	`dli¡_š™
(
dl
);

39 
	}
}

41 
	$dl_Ãw®l
(
dli¡
* 
»suÉ
, 
n
, 
size
)

43 
i
;

45 
i
 = 1; i <ğ
size
; i++)

46 
	`dl_š£¹
(
»suÉ
, 
n
);

47 
	}
}

49 
	$dl_Ãw
(
dli¡
* 
»suÉ
, 
size
)

51 
	`dl_Ãw®l
(
»suÉ
, 0, 
size
);

52 
	}
}

54 
	$dl_Œªs
(
dli¡
* 
»suÉ
, dli¡* 
a
)

56 
i
;

58 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

59 
	`dl_š£¹
(
»suÉ
, -
	`DREF
(*
a
, 
i
));

60 
	}
}

62 
	$dl_cÚÿt
(
dli¡
* 
»suÉ
, dli¡* 
a
, dli¡* 
b
)

64 
i
;

66 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

67 
	`dl_š£¹
(
»suÉ
, 
	`DREF
(*
a
, 
i
));

68 
i
 = 1; i <ğ
	`Ëngth
(
b
); i++)

69 
	`dl_š£¹
(
»suÉ
, 
	`DREF
(*
b
, 
i
));

70 
	}
}

72 
	$dl_compos™e
(
dli¡
* 
»suÉ
, dli¡* 
a
, dli¡* 
b
)

74 
i
;

76 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

77 
	`dl_š£¹
(
»suÉ
, 
	`DREF
(*
b
, DREF(*
a
, 
i
)));

78 
	}
}

80 
	$dl_addto
(
dli¡
* 
»suÉ
, 
n
, dli¡* 
a
)

82 
i
;

84 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

85 
	`dl_š£¹
(
»suÉ
, 
n
 + 
	`DREF
(*
a
, 
i
));

86 
	}
}

88 
	$dl_max
(
dli¡
* 
dl
)

90 
n
, 
i
, 
a
;

92 ià(
	`Ëngth
(
dl
) == 0)

94 
n
 = 
	`DREF
(*
dl
, 1);

95 
i
 = 2; i <ğ
	`Ëngth
(
dl
); i++)

97 
a
 = 
	`DREF
(*
dl
, 
i
);

98 ià(
a
 > 
n
)

99 
n
 = 
a
;

101  (
n
);

102 
	}
}

104 
	$dl_mš
(
dli¡
* 
dl
)

106 
n
, 
i
, 
a
;

108 ià(
	`Ëngth
(
dl
) == 0)

110 
n
 = 
	`DREF
(*
dl
, 1);

111 
i
 = 2; i <ğ
	`Ëngth
(
dl
); i++)

113 
a
 = 
	`DREF
(*
dl
, 
i
);

114 ià(
a
 < 
n
)

115 
n
 = 
a
;

117  (
n
);

118 
	}
}

120 
cÚ¡ex´
 
	gDLCONT
 = 0;

121 
cÚ¡ex´
 
	gDLRANGE
 = 1;

122 
cÚ¡ex´
 
	gDLREPL
 = 2;

123 
cÚ¡ex´
 
	gDLLIST
 = 3;

124 
cÚ¡ex´
 
	gDLNONE
 = 4;

132 
m©ches
 
	gv¬U£
[4] = { { "w", 
RWTFCN
 }, { "c", 
RCOMP
 }, { "", 0 } };

134 
m©ches
* 
	g¥eûËms
;

136 
	$dlS³cS‘
(
m©ches
* 
p
)

138 ià(
p
 !ğ
NULL
)

139 
¥eûËms
 = 
p
;

141 
¥eûËms
 = 
v¬U£
;

142 
	}
}

144 
boŞ—n
 
	$dlS³cŸl
(* 
s
, * 
v®
)

146 
m©ches
* 
p
;

147 ià(
¥eûËms
 =ğ
NULL
)

149 
p
 = 
¥eûËms
;…->
Çme
[0] != '\0';…++)

151 ià(
	`¡rcmp
(
s
, 
p
->
Çme
) == 0)

153 *
v®
 = 
p
->
u£d
;

158 
	}
}

160 
	$dlg‘–em
(* 
s
, * 
fœ¡
, * 
£cÚd
, 
dli¡
** 
dl
)

162 
v¬ŸbË
* 
p
;

163 * 
t
, 
id’t
[100];

165 ià(*
s
 == '\\')

166  (
DLCONT
);

167 ià(
	`dlS³cŸl
(
s
, 
fœ¡
))

169 *
£cÚd
 = *
fœ¡
;

170  (
DLRANGE
);

174 ià(
	`ÿnS¹V¬
(*
s
))

176 
t
 = 
s
;

177 
	`g‘Id’tif›r
(&
t
, 
id’t
);

178 
p
 = 
	`fšd_v¬
(
id’t
);

179 ià(
p
 =ğ
NULL
)

180  (
DLNONE
);

181 ià(
p
->
b_®Ÿs
 !ğ
NULL
)

182 
p
 =…->
b_®Ÿs
;

183 ià(
	`is_a_moduË
(
p
))

185 *
dl
 = &((
	`VAR_MODULE
(
p
))->
deg»es
);

186  (
DLLIST
);

190 *
fœ¡
 = 
	`·r£IÁ
(&
s
);

191 ià(*
s
 == ':')

193 
s
++;

194 *
£cÚd
 = 
	`g‘IÁ
(
s
);

195  (
DLREPL
);

197 ià(*
s
 == '.')

199 
s
++;

200 ià(*
s
 != '.')

202 *
£cÚd
 = *
fœ¡
 - 1;

203  (
DLRANGE
);

205 
s
++;

206 *
£cÚd
 = 
	`g‘IÁ
(
s
);

207  (
DLRANGE
);

209 *
£cÚd
 = *
fœ¡
;

210  (
DLRANGE
);

211 
	}
}

213 
	$dlCÚsume
(
dli¡
* 
dl
, 
¬gc
, * 
¬gv
[], 
Ën
, 
def
)

215 
i
, 
j
, 
l
, 
n
, 
kšd
;

216 
fœ¡
, 
£cÚd
;

217 
dli¡
* 
·¹dl
;

219 
i
 = 0;

220 
i
 < 
¬gc
)

222 
kšd
 = 
	`dlg‘–em
(
¬gv
[
i
], &
fœ¡
, &
£cÚd
, &
·¹dl
);

223 
kšd
)

225 
DLCONT
:

226 
	`g‘_lše
(&
¬gc
, &
¬gv
);

227 
i
 = -1;

229 
DLRANGE
:

230 
j
 = 
fœ¡
; j <ğ
£cÚd
; j++)

232 ià(
	`Ëngth
(
dl
è=ğ
Ën
)

234 
	`dl_š£¹
(
dl
, 
j
);

237 
DLREPL
:

238 
j
 = 1; j <ğ
£cÚd
; j++)

240 ià(
	`Ëngth
(
dl
è=ğ
Ën
)

242 
	`dl_š£¹
(
dl
, 
fœ¡
);

245 
DLLIST
:

246 
j
 = 1; j <ğ
	`Ëngth
(
·¹dl
); j++)

248 ià(
	`Ëngth
(
dl
è=ğ
Ën
)

250 
	`dl_š£¹
(
dl
, 
	`DREF
(*
·¹dl
, 
j
));

253 
DLNONE
:

256 
i
++;

258 
l
 = 
	`Ëngth
(
dl
);

259 ià(
l
 == 0)

260 
n
 = 
def
;

262 
n
 = 
	`DREF
(*
dl
, 
l
);

263 
j
 = 
l
 + 1; j <ğ
Ën
; j++)

264 
	`dl_š£¹
(
dl
, 
n
);

265 
	}
}

267 
	$dlV¬CÚsume
(
dli¡
* 
dl
, 
¬gc
, * 
¬gv
[])

269 
i
, 
j
, 
kšd
, 
fœ¡
, 
£cÚd
;

270 
dli¡
* 
·¹dl
;

272 
i
 = 0;

273 
i
 < 
¬gc
)

275 
kšd
 = 
	`dlg‘–em
(
¬gv
[
i
], &
fœ¡
, &
£cÚd
, &
·¹dl
);

276 
kšd
)

278 
DLCONT
:

279 
	`g‘_lše
(&
¬gc
, &
¬gv
);

280 
i
 = -1;

282 
DLRANGE
:

283 
j
 = 
fœ¡
; j <ğ
£cÚd
; j++)

285 
	`dl_š£¹
(
dl
, 
j
);

288 
DLREPL
:

289 
j
 = 1; j <ğ
£cÚd
; j++)

291 
	`dl_š£¹
(
dl
, 
fœ¡
);

294 
DLLIST
:

295 
j
 = 1; j <ğ
	`Ëngth
(
·¹dl
); j++)

297 
	`dl_š£¹
(
dl
, 
	`DREF
(*
·¹dl
, 
j
));

301 
i
++;

303 
	}
}

305 
	$dlSÿn
(
dli¡
* 
dl
, 
Ën
, 
def
)

307 
¬gc
;

308 ** 
¬gv
;

310 
	`g‘_lše
(&
¬gc
, &
¬gv
);

311 
	`dlCÚsume
(
dl
, 
¬gc
, 
¬gv
, 
Ën
, 
def
);

312 
	}
}

314 
	$dlV¬Sÿn
(
dli¡
* 
dl
, 
lo
, 
hi
)

316 
i
, 
¬gc
;

317 ** 
¬gv
;

319 
	`dl_š™
(
dl
);

320 
	`g‘_lše
(&
¬gc
, &
¬gv
);

321 ià(
¬gc
 > 0)

322 
	`dlV¬CÚsume
(
dl
, 
¬gc
, 
¬gv
);

324 
i
 = 
lo
; i <ğ
hi
; i++)

325 
	`dl_š£¹
(
dl
, 
i
);

326 
	}
}

328 
boŞ—n
 
	$dlV¬G‘
(
dli¡
* 
dl
, 
lo
, 
hi
)

330 
i
, 
d
, 
¬gc
;

331 ** 
¬gv
;

333 
	`dl_š™
(
dl
);

334 
	`g‘_lše
(&
¬gc
, &
¬gv
);

335 ià(
¬gc
 > 0)

336 
	`dlV¬CÚsume
(
dl
, 
¬gc
, 
¬gv
);

338 
i
 = 
lo
; i <ğ
hi
; i++)

339 
	`dl_š£¹
(
dl
, 
i
);

341 
i
 = 1; i <ğ
	`Ëngth
(
dl
); i++)

343 
d
 = 
	`DREF
(*
dl
, 
i
);

344 ià((
d
 < 
lo
è|| (d > 
hi
))

346 
	`´”rÜ
(";ƒrror: integer out of bounds\n");

351 
	}
}

354 
	$dlDisP¬t
(
FILE
* 
f
, 
–em
, 
»¶
)

356 
sz
;

358 ià(
»¶
 == 1)

360 
	`št_µršt
(
f
, 
–em
, 1, 0);

361 
sz
 = 
	`št_size
(
–em
, 1, 0);

363 ià(
»¶
 == 2)

365 
	`št_µršt
(
f
, 
–em
, 1, 0);

366 
	`åršt
(
f
, " ");

367 
	`št_µršt
(
f
, 
–em
, 1, 0);

368 
sz
 = 1 + 2 * 
	`št_size
(
–em
, 1, 0);

372 
	`št_µršt
(
f
, 
–em
, 1, 0);

373 
	`åršt
(
f
, ":");

374 
	`št_µršt
(
f
, 
»¶
, 1, 0);

375 
sz
 = 1 + 
	`št_size
(
–em
, 1, 0è+ iÁ_size(
»¶
, 1, 0);

377  (
sz
);

378 
	}
}

380 
	$dlDi¥Ïy
(
FILE
* 
f
, 
dli¡
* 
dl
, 
rowsize
)

382 
Ën
, 
sz
, 
this
, 
num
, 
i
;

384 ià(
´comm’t
 > 0)

385 
rowsize
 -= 2;

386 
Ën
 = 
	`Ëngth
(
dl
);

387 
sz
 = 0;

388 ià(
Ën
 == 0)

390 
this
 = 
	`DREF
(*
dl
, 1);

391 
num
 = 1;

392 
i
 = 2; i <ğ
Ën
; i++)

393 ià(
this
 =ğ
	`DREF
(*
dl
, 
i
))

394 
num
++;

397 ià(
sz
 >ğ
rowsize
 - 5)

399 
	`åršt
(
f
, "\\");

400 
	`âewlše
(
f
);

401 
	`åršt
(
f
, "\n");

402 
sz
 = -1;

404 
sz
 +ğ1 + 
	`dlDisP¬t
(
f
, 
this
, 
num
);

405 
	`åršt
(
f
, " ");

406 
this
 = 
	`DREF
(*
dl
, 
i
);

407 
num
 = 1;

409 
	`dlDisP¬t
(
f
, 
this
, 
num
);

410 
	`åršt
(
f
, "\n");

411 
	}
}

413 
	$dlIns
(
dli¡
* 
dl
, 
i
, 
n
)

415 
Ën
, 
j
;

416 * 
this
, * 
Ï¡
;

418 
Ën
 = 
	`Ëngth
(
dl
);

419 
Ï¡
 = (*)
	`»f
((
¬¿y
*)
dl
, 
Ën
);

420 
	`dl_š£¹
(
dl
, *
Ï¡
);

421 
j
 = 
Ën
 - 1; j >ğ
i
; j--)

423 
this
 = (*)
	`»f
((
¬¿y
*)
dl
, 
j
);

424 
Ï¡
 = (*)
	`»f
((
¬¿y
*)
dl
, 
j
 + 1);

425 *
Ï¡
 = *
this
;

427 *(*)
	`»f
((
¬¿y
*)
dl
, 
i
èğ
n
;

428 
	}
}

430 
	$dl_£t
(
dli¡
* 
dl
, 
i
, 
v®
)

432 *(*)
	`»f
((
¬¿y
*)
dl
, 
i
èğ
v®
;

433 
	}
}

	@gm_dlist.h

5 
	sm©ches


7 cÚ¡ *
	mÇme
;

8 
	mu£d
;

9 } 
	tm©ches
;

12 
dl_Ãw®l
(
dli¡
 *
»suÉ
, 
n
, 
size
);

13 
dl_Ãw
(
dli¡
 *
»suÉ
, 
size
);

16 
dl_Œªs
(
dli¡
 *
»suÉ
, dli¡ *
a
);

17 
dl_cÚÿt
(
dli¡
 *
»suÉ
, dli¡ *
a
, dli¡ *
b
);

18 
dl_compos™e
(
dli¡
 *
»suÉ
, dli¡ *
a
, dli¡ *
b
);

19 
dl_addto
(
dli¡
 *
»suÉ
, 
n
, dli¡ *
a
);

22 
dl_max
(
dli¡
 *
dl
);

23 
dl_mš
(
dli¡
 *
dl
);

26 
dlS³cS‘
(
m©ches
 *
p
);

27 
boŞ—n
 
dlS³cŸl
(*
s
, *
v®
);

30 
dlg‘–em
(*
s
, *
fœ¡
, *
£cÚd
, 
dli¡
 **
dl
);

31 
dlCÚsume
(
dli¡
 *
dl
, 
¬gc
, *
¬gv
[], 
Ën
, 
def
);

32 
dlV¬CÚsume
(
dli¡
 *
dl
, 
¬gc
, *
¬gv
[]);

33 
dlSÿn
(
dli¡
 *
dl
, 
Ën
, 
def
);

34 
dlV¬Sÿn
(
dli¡
 *
dl
, 
lo
, 
hi
);

35 
boŞ—n
 
dlV¬G‘
(
dli¡
 *
dl
, 
lo
, 
hi
);

38 
dlDisP¬t
(
FILE
 *
f
, 
–em
, 
»¶
);

39 
dlDi¥Ïy
(
FILE
 *
f
, 
dli¡
 *
dl
, 
rowsize
);

42 
dlIns
(
dli¡
 *
dl
, 
i
, 
n
);

43 
dl_£t
(
dli¡
 *
dl
, 
i
, 
v®
);

46 
m©ches
 
v¬U£
[];

	@gm_plist.c

4 
	~"sh¬ed.h
"

5 
	~"gm_¶i¡.h
"

6 
	~"¶i¡.h
"

7 
	~"pŞy.h
"

8 
	~"gm_pŞy.h
"

10 
	$¶_Ãw
(
¶i¡
* 
»suÉ
, 
size
)

12 
i
;

14 
i
 = 1; i <ğ
size
; i++)

15 
	`¶i¡_š£¹
(
»suÉ
, 
NULL
);

16 
	}
}

18 
	$¶_add
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
)

20 
i
, 
Ï¡
;

21 
pŞy
 
f
, 
g
;

23 
Ï¡
 = 
	`mš_št
(
	`¬¿y_Ëngth
((
¬¿y
*)
a
),‡¼ay_Ëngth(×¼ay*)
b
));

24 
i
 = 1; i <ğ
Ï¡
; i++)

26 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(
a
, 
i
));

27 
g
 = 
	`p_cİy
(
	`¶i¡_»f
(
b
, 
i
));

28 
	`p_add
(&
f
, &
g
);

29 
	`¶i¡_š£¹
(
»suÉ
, 
f
);

31 
	}
}

33 
	$¶_sub
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
)

35 
i
, 
Ï¡
;

36 
pŞy
 
f
, 
g
;

38 
Ï¡
 = 
	`mš_št
(
	`¬¿y_Ëngth
((
¬¿y
*)
a
),‡¼ay_Ëngth(×¼ay*)
b
));

39 
i
 = 1; i <ğ
Ï¡
; i++)

41 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(
a
, 
i
));

42 
g
 = 
	`p_cİy
(
	`¶i¡_»f
(
b
, 
i
));

43 
	`p_sub
(&
f
, &
g
);

44 
	`¶i¡_š£¹
(
»suÉ
, 
f
);

46 
	}
}

48 
	$¶_Œª¥o£
(
¶i¡
* 
»suÉ
,…li¡* 
a
, 
ncŞs
)

50 
i
;

52 
	`¶_Ãw
(
»suÉ
, 
ncŞs
);

53 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
a
); i++)

54 
	`g‘cŞ
(
»suÉ
, 
	`¶i¡_»f
(
a
, 
i
), i);

55 
	}
}

57 
	$¶_muÉ
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
, 
Äows
)

59 
¶i¡
 
¶
;

60 
pŞy
 
f
;

61 
r
, 
c
;

63 
	`¶i¡_š™
(&
¶
);

64 
	`¶_Ãw
(
»suÉ
, 
	`¬¿y_Ëngth
((
¬¿y
*)
b
));

65 
	`¶_Œª¥o£
(&
¶
, 
a
, 
Äows
);

66 
r
 = 1;„ <ğ
Äows
;„++)

67 
c
 = 1; c <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
b
); c++)

69 
f
 = 
	`p_dÙ
(
	`¶i¡_»f
(&
¶
, 
r
),…li¡_»f(
b
, 
c
),„);

70 
pŞy
 
p
 = 
	`¶i¡_»f
(
»suÉ
, 
c
);

71 
	`p_add
(&
p
, &
f
);

72 
	`¶i¡_£t
(
»suÉ
, 
c
, 
p
);

74 
	`¶_kl
(&
¶
);

75 
	}
}

77 
	$¶_dsum
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
, 
shiáv®
)

79 
i
;

81 
	`¶_cİy
(
a
, 
»suÉ
);

82 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
b
); i++)

83 
	`¶i¡_š£¹
(
»suÉ
, 
	`compshiá
(
	`¶i¡_»f
(
b
, 
i
), 
shiáv®
));

84 
	}
}

86 
	$¶_subm©
(
¶i¡
* 
»suÉ
,…li¡* 
a
, 
dli¡
* 
drows
, dli¡* 
dcŞs
)

88 
i
;

90 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
dcŞs
); i++)

91 
	`¶i¡_š£¹
(
»suÉ
, 
	`exŒaù
(
	`¶i¡_»f
(
a
, 
	`dli¡_»f
(
dcŞs
, 
i
)), 
drows
));

92 
	}
}

94 
	$¶_dŸg
(
¶i¡
* 
»suÉ
, 
pŞy
 
f
, 
size
)

96 
i
;

97 
pŞy
 
g
;

99 
g
 = 
	`e_sub_i
(1);

100 
i
 = 1; i <ğ
size
; i++)

102 
	`£t_comp
(
g
, 
i
);

103 
	`¶i¡_š£¹
(
»suÉ
, 
	`p_muÉ
(
f
, 
g
));

105 
	`p_kl
(&
g
);

106 
	}
}

	@gm_plist.h

5 
¶_Ãw
(
¶i¡
* 
»suÉ
, 
size
);

6 
¶_add
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
);

7 
¶_sub
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
);

10 
¶_Œª¥o£
(
¶i¡
* 
»suÉ
,…li¡* 
a
, 
ncŞs
);

11 
¶_muÉ
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
, 
Äows
);

12 
¶_dsum
(
¶i¡
* 
»suÉ
,…li¡* 
a
,…li¡* 
b
, 
shiáv®
);

13 
¶_subm©
(
¶i¡
* 
»suÉ
,…li¡* 
a
, 
dli¡
* 
drows
, dli¡* 
dcŞs
);

16 
¶_dŸg
(
¶i¡
* 
»suÉ
, 
pŞy
 
f
, 
size
);

	@gm_poly.c

4 
	~"sh¬ed.h
"

5 
	~"gm_pŞy.h
"

6 
	~"pŞy.h
"

7 
	~"‹rm.h
"

8 
	~"ch¬p.h
"

9 
	~"¬¿y.h
"

10 
	~"qršg.h
"

13 
šlše
 
‹rm
 
	$INITIAL
(
pŞy
 
f
)

15  
f
->
mÚom
;

16 
	}
}

18 
	$g‘_comp
(
pŞy
 
f
)

20  
	`tm_compÚ’t
(
	`INITIAL
(
f
));

21 
	}
}

23 
	$£t_comp
(
pŞy
 
f
, 
n
)

25 
	`tm_£tcomp
(
	`INITIAL
(
f
), 
n
);

26 
	}
}

31 
	$g‘cŞ
(
¶i¡
 *
a
, 
pŞy
 
f
, 
r
)

33 
pŞy
 
g
;

34 
i
;

36 
i
 = 1; i <ğ
	`Ëngth
(
a
); i++)

38 
g
 = 
	`exŒ1
(
f
, 
i
, 
r
);

39 
	`p_add
(
	`¶i¡_»f_±r
(
a
, 
i
), &
g
);

41 
	}
}

48 
pŞy
 
	$p11_muÉ
(
pŞy
 
f
, 
big‹rm
 
big
,…Şy 
g
, 
comp
)

50 
pŞy
 
»suÉ
;

51 
f›ld
 
a
;

53 
	`fd_muÉ
(
f
->
cÛf
, 
g
->cÛf, &
a
);

54 
»suÉ
 = 
	`p_mÚom
(
a
);

55 
	`tm_add
(
	`INITIAL
(
g
), 
big
, INITIAL(
»suÉ
));

56 
	`£t_comp
(
»suÉ
, 
comp
);

57  
»suÉ
;

58 
	}
}

60 
pŞy
 
	$dÙ1
(
pŞy
 
f
,…Şy 
g
, 
comp
)

62 
pŞy
 
»suÉ
, 
‹mp
;

63 
which
;

64 
big‹rm
 
big
;

66 
»suÉ
 = 
NULL
;

67 
which
 = 
	`g‘_comp
(
f
);

68 
	`sToBig
(
	`INITIAL
(
f
), 
big
);

69 
g
 !ğ
NULL
)

71 ià(
which
 =ğ
	`g‘_comp
(
g
))

73 
‹mp
 = 
	`p11_muÉ
(
f
, 
big
, 
g
, 
comp
);

74 
	`p_add
(&
»suÉ
, &
‹mp
);

76 
g
 = g->
Ãxt
;

78  
»suÉ
;

79 
	}
}

81 
pŞy
 
	$p_dÙ
(
pŞy
 
f
,…Şy 
g
, 
comp
)

83 
pŞy
 
»suÉ
, 
‹mp
;

85 
»suÉ
 = 
NULL
;

86 
f
 !ğ
NULL
)

88 
‹mp
 = 
	`dÙ1
(
f
, 
g
, 
comp
);

89 
	`p_add
(&
»suÉ
, &
‹mp
);

90 
f
 = f->
Ãxt
;

92 
	`qrgReduû
(&
»suÉ
);

93  
»suÉ
;

94 
	}
}

100 
pŞy
 
	$compshiá
(
pŞy
 
f
, 
n
)

102 
pŞy
 
»suÉ
;

104 
f
 = 
	`p_cİy
(f);

105 
»suÉ
 = 
f
;

106 
f
 !ğ
NULL
)

108 
	`£t_comp
(
f
, 
n
 + 
	`g‘_comp
(f));

109 
f
 = f->
Ãxt
;

111  
»suÉ
;

112 
	}
}

118 
pŞy
 
	$‹nsÜShiá
(
pŞy
 
f
, 
m
, 
j
)

120 
pŞy
 
»suÉ
;

122 
f
 = 
	`p_cİy
(f);

123 
»suÉ
 = 
f
;

124 
f
 !ğ
NULL
)

126 
	`£t_comp
(
f
, (
	`g‘_comp
(fè- 1è* 
m
 + 
j
);

127 
f
 = f->
Ãxt
;

129  
»suÉ
;

130 
	}
}

138 
pŞy
 
	$exŒ1
(
pŞy
 
f
, 
i
, 
j
)

140 
pŞy
 
p
;

142 
p
 = 
addnode
;

143 
p
->
Ãxt
 = 
NULL
;

144 
f
 !ğ
NULL
)

146 ià(
i
 =ğ
	`g‘_comp
(
f
))

148 
p
->
Ãxt
 = 
	`p_š™Ÿl
(
f
);

149 
p
 =…->
Ãxt
;

150 
	`£t_comp
(
p
, 
j
);

152 
f
 = f->
Ãxt
;

154  
addnode
->
Ãxt
;

155 
	}
}

157 
pŞy
 
	$exŒaù
(
pŞy
 
f
, 
dli¡
 *
a
)

159 
pŞy
 
»suÉ
, 
‹mp
;

160 
j
;

162 
»suÉ
 = 
NULL
;

163 
j
 = 1; j <ğ
	`Ëngth
(
a
); j++)

165 
‹mp
 = 
	`exŒ1
(
f
, 
	`dli¡_»f
(
a
, 
j
), j);

166 
	`p_add
(&
»suÉ
, &
‹mp
);

168  
»suÉ
;

169 
	}
}

174 
	$p_chEÁry
(
pŞy
 *
f
, 
i
,…Şy 
g
)

176 
pŞy
 
p
, 
q
;

178 
p
 = 
addnode
;

179 
p
->
Ãxt
 = *
f
;

180 
p
->
Ãxt
 !ğ
NULL
)

181 ià(
	`g‘_comp
(
p
->
Ãxt
è=ğ
i
)

183 
q
 = 
p
->
Ãxt
;

184 
p
->
Ãxt
 = 
q
->next;

185 
q
->
Ãxt
 = 
NULL
;

186 
	`p_kl
(&
q
);

189 
p
 =…->
Ãxt
;

190 *
f
 = 
addnode
->
Ãxt
;

191 
	`p_add
(
f
, &
g
);

192 
	}
}

194 
	$p_divmod
(
pŞy
 *
ff
,…Şy 
g
,…Şy *
hdiv
,…Şy *
hmod
)

196 
pŞy
 
rdiv
, 
rmod
, 
f
, 
h
;

197 
f›ld
 
a
, 
cÛf
;

199 ià(
g
 =ğ
NULL
)

201 *
hdiv
 = 
NULL
;

202 *
hmod
 = *
ff
;

203 *
ff
 = 
NULL
;

206 
rdiv
 = 
NULL
;

207 
rmod
 = 
NULL
;

208 
f
 = *
ff
;

209 
a
 = 
	`fd_cİy
(
g
->
cÛf
);

210 
	`fd_»c
(&
a
);

211 
f
 !ğ
NULL
)

213 
	`fd_muÉ
(
f
->
cÛf
, 
a
, &coef);

214 
h
 = 
	`p_mÚom
(
cÛf
);

215 ià(!
	`tm_divides
(
	`INITIAL
(
f
), INITIAL(
g
), 
	`g‘_comp
(f), INITIAL(
h
)))

217 
	`p_kl
(&
h
);

218 
h
 = 
f
;

219 
f
 = f->
Ãxt
;

220 
h
->
Ãxt
 = 
NULL
;

221 
	`p_add
(&
rmod
, &
h
);

225 
	`¥ecŸl_sub
(&
f
, 
cÛf
, 
	`INITIAL
(
h
), 
g
);

226 
	`p_add
(&
rdiv
, &
h
);

229 *
hdiv
 = 
rdiv
;

230 *
hmod
 = 
rmod
;

231 
	}
}

233 
pŞy
 
	$p_div
(
pŞy
 *
f
,…Şy 
g
)

235 
pŞy
 
hdiv
, 
hmod
;

237 
	`p_divmod
(
f
, 
g
, &
hdiv
, &
hmod
);

238 
	`p_kl
(&
hmod
);

239  
hdiv
;

240 
	}
}

242 
pŞy
 
	$p_mod
(
pŞy
 *
f
,…Şy 
g
)

244 
pŞy
 
hdiv
, 
hmod
;

246 
	`p_divmod
(
f
, 
g
, &
hdiv
, &
hmod
);

247 
	`p_kl
(&
hdiv
);

248  
hmod
;

249 
	}
}

251 
pŞy
 
	$p_diff
(
pŞy
 
f
, 
v¬
, 
comp
)

253 
pŞy
 
»suÉ
, 
g
;

254 
exp
;

255 
f›ld
 
a
;

257 
»suÉ
 = 
NULL
;

258 
f
 !ğ
NULL
)

260 
g
 = 
	`p_mÚom
(
fd_z”o
);

261 
	`tm_diff
(
	`INITIAL
(
f
), INITIAL(
g
), 
v¬
, &
exp
);

262 
a
 = 
	`nÜm®ize
(
exp
);

263 ià(
a
 != 0)

265 
	`fd_muÉ
(
f
->
cÛf
, 
a
, &(
g
->coef));

266 
	`£t_comp
(
g
, 
comp
);

267 
	`p_add
(&
»suÉ
, &
g
);

270 
	`p_kl
(&
g
);

271 
f
 = f->
Ãxt
;

273  
»suÉ
;

274 
	}
}

276 
pŞy
 
	$p_cÚŒaù
(
pŞy
 
x
,…Şy 
f
, 
boŞ—n
 
u£cÛf
, 
comp
)

278 
pŞy
 
»suÉ
, 
y
, 
g
, 
h
;

279 
f›ld
 
a
, 
b
;

280 
cÛfv®
;

282 
»suÉ
 = 
NULL
;

283 
y
 = 
x
; y !ğ
NULL
; y = y->
Ãxt
)

285 
g
 = 
f
; g !ğ
NULL
; g = g->
Ãxt
)

287 
h
 = 
	`p_mÚom
(
fd_z”o
);

288 
	`tm_cÚŒaù
(
	`INITIAL
(
y
), INITIAL(
g
), INITIAL(
h
), &
cÛfv®
);

289 
a
 = 
	`nÜm®ize
(
cÛfv®
);

290 ià((
u£cÛf
 && (
a
 !ğ0)è|| ((!u£cÛfè&& (
cÛfv®
 != 0)))

292 ià(
u£cÛf
)

293 
	`fd_muÉ
(
g
->
cÛf
, 
a
, &
b
);

295 
b
 = 
g
->
cÛf
;

296 
	`fd_muÉ
(
y
->
cÛf
, 
b
, &
h
->coef);

297 
	`£t_comp
(
h
, 
comp
);

298 
	`p_add
(&
»suÉ
, &
h
);

301 
	`p_kl
(&
h
);

304  
»suÉ
;

305 
	}
}

	@gm_poly.h

7 
g‘_comp
(
pŞy
 
f
);

8 
£t_comp
(
pŞy
 
f
, 
n
);

11 
g‘cŞ
(
¶i¡
 *
a
, 
pŞy
 
f
, 
r
);

14 
pŞy
 
p11_muÉ
ÕŞy 
f
, 
big‹rm
 
big
,…Şy 
g
, 
comp
);

15 
pŞy
 
dÙ1
ÕŞy 
f
,…Şy 
g
, 
comp
);

16 
pŞy
 
p_dÙ
ÕŞy 
f
,…Şy 
g
, 
comp
);

19 
pŞy
 
compshiá
ÕŞy 
f
, 
n
);

20 
pŞy
 
‹nsÜShiá
ÕŞy 
f
, 
m
, 
j
);

23 
pŞy
 
exŒ1
ÕŞy 
f
, 
i
, 
j
);

24 
pŞy
 
exŒaù
ÕŞy 
f
, 
dli¡
 *
a
);

27 
p_chEÁry
(
pŞy
 *
f
, 
i
,…Şy 
g
);

30 
p_divmod
(
pŞy
 *
ff
,…Şy 
g
,…Şy *
hdiv
,…Şy *
hmod
);

31 
pŞy
 
p_div
ÕŞy *
f
,…Şy 
g
);

32 
pŞy
 
p_mod
ÕŞy *
f
,…Şy 
g
);

35 
pŞy
 
p_diff
ÕŞy 
f
, 
v¬
, 
comp
);

36 
pŞy
 
p_cÚŒaù
ÕŞy 
x
,…Şy 
f
, 
boŞ—n
 
u£cÛf
, 
comp
);

	@gmatrix.c

4 
	~<¡dlib.h
>

5 
	~"sh¬ed.h
"

6 
	~"gm©rix.h
"

7 
	~"d‘.h
"

8 
	~"gm_pŞy.h
"

9 
	~"pŞy.h
"

10 
	~"¶i¡.h
"

11 
	~"gm_¶i¡.h
"

12 
	~"gm_dli¡.h
"

14 
	~"qršg.h
"

15 
	~"mÚ™Ü.h
"

16 
	~"‹rm.h
"

17 
	~"¡ªd¬d.h
"

18 
	~"mac.h
"

19 
	~"ršg.h
"

20 
	~"ch¬p.h
"

21 
	~"v¬s.h
"

22 
	~"£t.h
"

24 
	$Äows
(
gm©rix
 
g
)

26  
	`¬¿y_Ëngth
(&(
g
->
deg»es
));

27 
	}
}

29 
	$ncŞs
(
gm©rix
 
g
)

31  
	`¬¿y_Ëngth
(&(
g
->
degg’s
));

32 
	}
}

34 
	$gmIn£¹
(
gm©rix
 
g
, 
pŞy
 
f
)

36 
n
;

38 
	`¶i¡_š£¹
(&
g
->
g’s
, 
f
);

39 ià(
f
 =ğ
NULL
)

40 
n
 = 0;

42 
n
 = 
	`deg»e
(
g
, 
f
);

43 
	`dli¡_š£¹
(&
g
->
degg’s
, 
n
);

44 
	}
}

46 
pŞy
 
	$gm_–em
(
gm©rix
 
g
, 
i
, 
j
, 
comp
)

48 
pŞy
 
f
;

50 ià(
g
 =ğ
NULL
)

51  
NULL
;

52 ià((
	`Äows
(
g
è< 1è|| (
	`ncŞs
(g) < 1))

53  
NULL
;

54 
f
 = 
	`¶i¡_»f
(&
g
->
g’s
, 
j
);

55  
	`exŒ1
(
f
, 
i
, 
comp
);

56 
	}
}

58 
gm©rix
 
	$gm_add
(
gm©rix
 
f
, gm©rix 
g
)

60 
gm©rix
 
»suÉ
;

62 
»suÉ
 = 
	`mod_š™
();

63 ià(
	`Äows
(
f
è!ğÄows(
g
))

65 
	`´”rÜ
("; matrices have different‚umber of„ows\n");

66  
»suÉ
;

68 ià(
	`ncŞs
(
f
è!ğncŞs(
g
))

70 
	`´”rÜ
("; matrices have different‚umber of columns\n");

71  
»suÉ
;

73 
	`¶_add
(&(
»suÉ
->
g’s
), &(
f
->g’s), &(
g
->gens));

74 
	`dl_cİy
(&(
f
->
deg»es
), &(
»suÉ
->degrees));

75 
	`dl_cİy
(&(
f
->
degg’s
), &(
»suÉ
->deggens));

76  
»suÉ
;

77 
	}
}

79 
gm©rix
 
	$gm_sub
(
gm©rix
 
f
, gm©rix 
g
)

81 
gm©rix
 
»suÉ
;

83 
»suÉ
 = 
	`mod_š™
();

84 ià(
	`Äows
(
f
è!ğÄows(
g
))

86 
	`´”rÜ
("; matrices have different‚umber of„ows\n");

87  
»suÉ
;

89 ià(
	`ncŞs
(
f
è!ğncŞs(
g
))

91 
	`´”rÜ
("; matrices have different‚umber of columns\n");

92  
»suÉ
;

94 
	`¶_sub
(&(
»suÉ
->
g’s
), &(
f
->g’s), &(
g
->gens));

95 
	`dl_cİy
(&(
f
->
deg»es
), &(
»suÉ
->degrees));

96 
	`dl_cİy
(&(
f
->
degg’s
), &(
»suÉ
->deggens));

97  
»suÉ
;

98 
	}
}

100 
gm©rix
 
	$gm_Œª¥o£
(
gm©rix
 
f
)

102 
gm©rix
 
»suÉ
;

104 
»suÉ
 = 
	`mod_š™
();

105 
	`¶_Œª¥o£
(&(
»suÉ
->
g’s
), &(
f
->g’s), 
	`Äows
(f));

106 
	`dl_Œªs
(&(
»suÉ
->
deg»es
), &(
f
->
degg’s
));

107 
	`dl_Œªs
(&(
»suÉ
->
degg’s
), &(
f
->
deg»es
));

108  
»suÉ
;

109 
	}
}

111 
gm©rix
 
	$gm_muÉ
(
gm©rix
 
f
, gm©rix 
g
)

113 
gm©rix
 
»suÉ
;

115 
»suÉ
 = 
	`mod_š™
();

116 ià(
	`ncŞs
(
f
è!ğ
	`Äows
(
g
))

118 
	`´”rÜ
("; matrices‡re wrong shapeo be multiplied\n");

119  
»suÉ
;

121 
	`¶_muÉ
(&(
»suÉ
->
g’s
), &(
f
->g’s), &(
g
->g’s), 
	`Äows
(f));

122 
	`dl_cİy
(&(
f
->
deg»es
), &(
»suÉ
->degrees));

123 ià(
	`ncŞs
(
f
) > 0)

125 
	`dl_addto
(&(
»suÉ
->
degg’s
), 
	`dli¡_»f
(&
f
->degg’s, 1è- dli¡_»f(&
g
->
deg»es
, 1),

126 &(
g
->
degg’s
));

129 
	`dl_cİy
(&
g
->
degg’s
, &
»suÉ
->deggens);

130  
»suÉ
;

131 
	}
}

133 
gm©rix
 
	$gm_smuÉ
(
gm©rix
 
M
, 
pŞy
 
f
)

135 
gm©rix
 
»suÉ
;

136 
i
, 
deg
;

137 
pŞy
 
g
;

139 
»suÉ
 = 
	`mod_š™
();

140 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

141 ià(
f
 =ğ
NULL
)

142 
deg
 = 0;

144 
deg
 = 
	`tm_deg»e
(
	`pŞy_š™Ÿl
(
f
));

145 
	`dl_addto
(&
»suÉ
->
degg’s
, 
deg
, &
M
->deggens);

146 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

148 
g
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

149 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
	`p_muÉ
(
f
, 
g
));

151  
»suÉ
;

152 
	}
}

154 
	$gm_dsum
(
gm©rix
 
»suÉ
, gm©rix 
M
)

156 
n
, 
i
;

158 
n
 = 
	`Äows
(
»suÉ
);

159 
	`dl_addto
(&
»suÉ
->
deg»es
, 0, &
M
->degrees);

160 
	`dl_addto
(&
»suÉ
->
degg’s
, 0, &
M
->deggens);

161 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

162 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
	`compshiá
(
	`¶i¡_»f
(&
M
->g’s, 
i
), 
n
));

163 
	}
}

165 
gm©rix
 
	$gm_id’
(
n
)

167 
gm©rix
 
»suÉ
;

168 
i
;

169 
pŞy
 
f
;

171 
»suÉ
 = 
	`mod_š™
();

172 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 
n
);

173 
i
 = 1; i <ğ
n
; i++)

175 
f
 = 
	`e_sub_i
(
i
);

176 
	`qrgReduû
(&
f
);

177 
	`gmIn£¹
(
»suÉ
, 
f
);

179  
»suÉ
;

180 
	}
}

182 
gm©rix
 
	$gm_dŸg
(
gm©rix
 
M
)

184 
gm©rix
 
»suÉ
;

185 
thiscomp
, 
r
, 
c
, 
i
, 
j
, 
degf
, 
deg
;

186 
pŞy
 
f
;

188 
»suÉ
 = 
	`mod_š™
();

189 
r
 = 
	`Äows
(
M
);

190 
c
 = 
	`ncŞs
(
M
);

191 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 
r
 * 
c
);

192 
thiscomp
 = 1;

193 
i
 = 1; i <ğ
c
; i++)

195 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

196 
degf
 = 
	`dli¡_»f
(&
M
->
degg’s
, 
i
);

197 
j
 = 1; j <ğ
r
; j++)

199 
deg
 = 
degf
 - 
	`dli¡_»f
(&
M
->
deg»es
, 
j
);

200 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 
deg
);

201 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
	`exŒ1
(
f
, 
j
, 
thiscomp
++));

204  
»suÉ
;

205 
	}
}

207 
gm©rix
 
	$gm_subm©
(
gm©rix
 
g
, 
dli¡
* 
drows
, dli¡* 
dcŞs
)

209 
gm©rix
 
»suÉ
;

211 
»suÉ
 = 
	`mod_š™
();

212 
	`¶_subm©
(&(
»suÉ
->
g’s
), &(
g
->g’s), 
drows
, 
dcŞs
);

213 
	`dl_compos™e
(&(
»suÉ
->
deg»es
), 
drows
, &(
g
->degrees));

214 
	`dl_compos™e
(&(
»suÉ
->
degg’s
), 
dcŞs
, &(
g
->deggens));

215  
»suÉ
;

216 
	}
}

218 
gm©rix
 
	$gm_wedge
(
gm©rix
 
g
, 
p
)

220 
gm©rix
 
»suÉ
;

222 
»suÉ
 = 
	`mod_š™
();

223 
	`dl_wedge
(
p
, &(
g
->
deg»es
), &(
»suÉ
->degrees));

224 
	`dl_wedge
(
p
, &(
g
->
degg’s
), &(
»suÉ
->deggens));

225 
	`¶_wedge
(
p
, 
	`Äows
(
g
), 
	`ncŞs
(g), &(g->
g’s
), &(
»suÉ
->gens));

226  
»suÉ
;

227 
	}
}

229 
gm©rix
 
	$gm_pçff4
(
gm©rix
 
g
)

231 
gm©rix
 
»suÉ
;

232 
pŞy
 
f
;

233 
t
[5];

234 
a
, 
sign
;

236 
»suÉ
 = 
	`mod_š™
();

237 
	`dli¡_š£¹
(&(
»suÉ
->
deg»es
), 0);

238 
	`pš™_¬¿y
(4, 
	`ncŞs
(
g
), 
t
, &
a
, &
sign
);

241 
f
 = 
	`pçff4
(
g
, 
t
);

242 
	`¶i¡_š£¹
(&(
»suÉ
->
g’s
), 
f
);

243 
	`dli¡_š£¹
(&(
»suÉ
->
degg’s
), 
	`deg»e
ÔesuÉ, 
f
));

244 } 
	`pšü_¬¿y
(4, 
	`ncŞs
(
g
), 
t
, &
a
, &
sign
));

245  
»suÉ
;

246 
	}
}

248 
gm©rix
 
	$gm_æ©‹n
(
gm©rix
 
g
)

250 
gm©rix
 
»suÉ
;

251 
r
, 
c
;

252 
pŞy
 
f
, 
h
;

254 
»suÉ
 = 
	`mod_š™
();

255 
	`dli¡_š£¹
(&(
»suÉ
->
deg»es
), 0);

256 
c
 = 1; c <ğ
	`ncŞs
(
g
); c++)

258 
f
 = 
	`¶i¡_»f
(&
g
->
g’s
, 
c
);

259 
r
 = 1;„ <ğ
	`Äows
(
g
);„++)

261 
h
 = 
	`exŒ1
(
f
, 
r
, 1);

262 
	`¶i¡_š£¹
(&(
»suÉ
->
g’s
), 
h
);

263 
	`dli¡_š£¹
(&(
»suÉ
->
degg’s
), 
	`deg»e
ÔesuÉ, 
h
));

266  
»suÉ
;

267 
	}
}

269 
gm©rix
 
	$gm_g’M©
(
dli¡
* 
rows
, dli¡* 
cŞs
, 
fœ¡v¬
)

271 
gm©rix
 
»suÉ
;

272 
r
, 
c
, 
maxR
, 
maxC
, 
v®
;

273 
dcŞ
, 
thisdeg
;

274 
pŞy
 
f
, 
g
;

276 
»suÉ
 = 
	`mod_š™
();

277 
maxR
 = 
	`¬¿y_Ëngth
(
rows
);

278 
maxC
 = 
	`¬¿y_Ëngth
(
cŞs
);

279 
	`dl_Ãw®l
(&(
»suÉ
->
deg»es
), 0, 
maxR
);

280 
c
 = 1; c <ğ
maxC
; c++)

282 
dcŞ
 = 
	`dli¡_»f
(
cŞs
, 
c
è+ 
fœ¡v¬
;

283 
f
 = 
NULL
;

284 
thisdeg
 = 
	`dli¡_»f
(&
rgDegs
, 1 + 
dcŞ
 + dli¡_»f(
rows
, 1));

285 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 
thisdeg
);

286 
r
 = 1;„ <ğ
maxR
;„++)

288 
v®
 = 
dcŞ
 + 
	`dli¡_»f
(
rows
, 
r
);

289 ià((
v®
 >ğ0è&& (v® < 
numv¬s
))

291 
g
 = 
	`p_xjei
(
v®
, 
r
);

292 
	`p_add
(&
f
, &
g
);

295 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
f
);

297  
»suÉ
;

298 
	}
}

300 
gm©rix
 
	$gm_jacobŸn
(
gm©rix
 
g
, 
ex±”m
 
v¬s
)

302 
gm©rix
 
»suÉ
;

303 
v
, 
i
, 
e
;

304 
pŞy
 
f
, 
h
;

306 ià(
	`ncŞs
(
g
) >= 1)

307 
e
 = 
	`dli¡_»f
(&
g
->
deg»es
, 1);

308 
»suÉ
 = 
	`mod_š™
();

309 
i
 = 1; i <ğ
	`ncŞs
(
g
); i++)

311 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 
e
 - 
	`deg»e
(
g
, 
	`¶i¡_»f
(&g->
g’s
, 
i
)));

312 
v
 = 0; v < 
numv¬s
; v++)

314 ià(
v¬s
[
v
] == 0)

316 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, -
	`v¬Weight
((
ršg
)
cu¼’t_ršg
, 
v
));

317 
f
 = 
NULL
;

318 
i
 = 1; i <ğ
	`ncŞs
(
g
); i++)

320 
h
 = 
	`p_diff
(
	`¶i¡_»f
(&
g
->
g’s
, 
i
), 
v
, i);

321 
	`p_add
(&
f
, &
h
);

323 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
f
);

325  
»suÉ
;

326 
	}
}

330 
	$gm_cÚÿt
(
gm©rix
 
»suÉ
, gm©rix 
g
)

332 
i
;

333 
pŞy
 
f
;

335 ià(
	`Äows
(
»suÉ
è<‚rows(
g
))

337 
	`dl_kl
(&
»suÉ
->
deg»es
);

338 
	`dl_cİy
(&
g
->
deg»es
, &
»suÉ
->degrees);

340 
i
 = 1; i <ğ
	`ncŞs
(
g
); i++)

342 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&
g
->
g’s
, 
i
));

343 
	`¶i¡_š£¹
(&(
»suÉ
->
g’s
), 
f
);

344 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 
	`dli¡_»f
(&
g
->degg’s, 
i
));

346 
	}
}

348 
gm©rix
 
	$gm_liá
(
gm©rix
 
M
, gm©rix 
N
)

350 
i
;

351 
pŞy
 
f
, 
g
, 
h
;

352 
gm©rix
 
»suÉ
;

354 
»suÉ
 = 
	`mod_š™
();

355 
	`dl_cİy
(&
M
->
degg’s
, &
»suÉ
->
deg»es
);

356 
i
 = 1; i <ğ
	`ncŞs
(
N
); i++)

358 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&
N
->
g’s
, 
i
));

359 
	`divisiÚ
(
M
, &
f
, &
g
, &
h
);

360 ià(
h
 !ğ
NULL
)

361 
	`´”rÜ
("; cŞumÀ#%d‚Ù iÀmoduË\n", 
i
);

362 
	`p_Ãg©e
(&
g
);

363 
	`gmIn£¹
(
»suÉ
, 
g
);

364 ià(
v”bo£
 > 0)

365 
	`´æush
("x");

366 ià(
	`have_šŒ
())

367  
»suÉ
;

369  
»suÉ
;

370 
	}
}

372 
	$gm_»duû
(
gm©rix
 
M
, gm©rix 
N
, gm©rix* 
»dN
, gm©rix* 
liáN
)

374 
i
;

375 
pŞy
 
f
, 
g
, 
h
;

377 
	`debug_as£¹
("gm_»duû: M mu¡ hav©†—¡‡ mªy„ow a N", (
	`Äows
(
M
è>ğÄows(
N
)));

378 *
»dN
 = 
	`mod_š™
();

379 
	`dl_cİy
(&
M
->
deg»es
, &(*
»dN
)->degrees);

380 ià(
liáN
 !ğ
NULL
)

382 *
liáN
 = 
	`mod_š™
();

383 
	`dl_cİy
(&
M
->
degg’s
, &(*
liáN
)->
deg»es
);

385 
i
 = 1; i <ğ
	`ncŞs
(
N
); i++)

387 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&
N
->
g’s
, 
i
));

388 ià(
liáN
 =ğ
NULL
)

389 
h
 = 
	`»duû
(
M
, &
f
);

392 
	`divisiÚ
(
M
, &
f
, &
g
, &
h
);

393 
	`p_Ãg©e
(&
g
);

394 
	`gmIn£¹
(*
liáN
, 
g
);

396 
	`gmIn£¹
(*
»dN
, 
h
);

397 ià(
v”bo£
 > 0)

398 
	`´æush
("x");

399 ià(
	`have_šŒ
())

402 
	}
}

404 
gm©rix
 
	$gm_Œaû
(
gm©rix
 
M
)

406 
gm©rix
 
»suÉ
;

407 
tİ
, 
i
;

408 
pŞy
 
f
, 
g
;

410 
»suÉ
 = 
	`mod_š™
();

411 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 1);

413 ià(
	`Äows
(
M
è> 
	`ncŞs
(M))

414 
tİ
 = 
	`ncŞs
(
M
);

416 
tİ
 = 
	`Äows
(
M
);

418 
f
 = 
NULL
;

419 
i
 = 1; i <ğ
tİ
; i++)

421 
g
 = 
	`exŒ1
(
	`¶i¡_»f
(&
M
->
g’s
, 
i
), i, 1);

422 
	`p_add
(&
f
, &
g
);

424 
	`gmIn£¹
(
»suÉ
, 
f
);

425  
»suÉ
;

426 
	}
}

428 
gm©rix
 
	$gm_‹nsÜ
(
gm©rix
 
M
, gm©rix 
N
)

430 
gm©rix
 
»suÉ
;

431 
m
, 
n
, 
i
, 
j
;

432 
pŞy
 
f
;

434 
»suÉ
 = 
	`mod_š™
();

436 
m
 = 
	`Äows
(
M
);

437 
n
 = 
	`Äows
(
N
);

438 
i
 = 1; i <ğ
m
; i++)

439 
j
 = 1; j <ğ
n
; j++)

440 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 
	`dli¡_»f
(&
M
->deg»es, 
i
è+ dli¡_»f(&
N
->deg»es, 
j
));

442 
j
 = 1; j <ğ
m
; j++)

443 
i
 = 1; i <ğ
	`ncŞs
(
N
); i++)

445 
f
 = 
	`¶i¡_»f
(&
N
->
g’s
, 
i
);

446 
	`gmIn£¹
(
»suÉ
, 
	`compshiá
(
f
, (
j
 - 1è* 
n
));

448 
j
 = 1; j <ğ
n
; j++)

449 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

451 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

452 
	`gmIn£¹
(
»suÉ
, 
	`‹nsÜShiá
(
f
, 
n
, 
j
));

454  
»suÉ
;

455 
	}
}

457 
gm©rix
 
	$gm_ou‹r
(
gm©rix
 
M
, gm©rix 
N
)

459 
gm©rix
 
»suÉ
;

460 
mr
, 
mc
, 
Ä
, 
nc
, 
i
, 
j
, 
jc
, 
ic
, 
jr
;

461 
pŞy
 
f
, 
g
, 
h
, 
a
, 
b
, 
c
;

463 
mr
 = 
	`Äows
(
M
);

464 
mc
 = 
	`ncŞs
(
M
);

465 
Ä
 = 
	`Äows
(
N
);

466 
nc
 = 
	`ncŞs
(
N
);

467 
»suÉ
 = 
	`mod_š™
();

468 
i
 = 1; i <ğ
mr
; i++)

469 
j
 = 1; j <ğ
Ä
; j++)

470 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 
	`dli¡_»f
(&
M
->deg»es, 
i
è+ dli¡_»f(&
N
->deg»es, 
j
));

471 
i
 = 1; i <ğ
mc
; i++)

472 
j
 = 1; j <ğ
nc
; j++)

473 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 
	`dli¡_»f
(&
M
->degg’s, 
i
è+ dli¡_»f(&
N
->degg’s, 
j
));

475 
jc
 = 1; jø<ğ
mc
; jc++)

477 
f
 = 
	`exŒ1
(
	`¶i¡_»f
(&
M
->
g’s
, 
jc
), 1, 1);

478 
ic
 = 1; iø<ğ
nc
; ic++)

480 
g
 = 
	`¶i¡_»f
(&
N
->
g’s
, 
ic
);

481 
h
 = 
	`p_muÉ
(
f
, 
g
);

483 
jr
 = 2; j¸<ğ
mr
; jr++)

485 
a
 = 
	`exŒ1
(
	`¶i¡_»f
(&
M
->
g’s
, 
jc
), 
jr
, 1);

486 
b
 = 
	`p_muÉ
(
a
, 
g
);

487 
	`p_kl
(&
a
);

488 
c
 = 
	`compshiá
(
b
, (
jr
 - 1è* 
Ä
);

489 
	`p_kl
(&
b
);

490 
	`p_add
(&
h
, &
c
);

492 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
h
);

494 
	`p_kl
(&
f
);

496  
»suÉ
;

497 
	}
}

499 
	$pow”p
(
gm©rix
 
M
, gm©rix 
»suÉ
, 
pŞy
 
f
, 
Ï¡n
, 
pow
)

501 
i
;

502 
pŞy
 
g
;

504 ià(
pow
 == 0)

506 
	`gmIn£¹
(
»suÉ
, 
f
);

510 
i
 = 
Ï¡n
; i <ğ
	`ncŞs
(
M
); i++)

512 
g
 = 
	`p_muÉ
(
f
, 
	`¶i¡_»f
(&
M
->
g’s
, 
i
));

513 
	`pow”p
(
M
, 
»suÉ
, 
g
, 
i
, 
pow
 - 1);

515 
	`p_kl
(&
f
);

517 
	}
}

519 
gm©rix
 
	$gm_pow”
(
gm©rix
 
M
, 
n
)

521 
gm©rix
 
»suÉ
;

522 
pŞy
 
f
;

524 
»suÉ
 = 
	`mod_š™
();

525 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 0);

526 
f
 = 
	`e_sub_i
(1);

527 
	`pow”p
(
M
, 
»suÉ
, 
f
, 1, 
n
);

528  
»suÉ
;

529 
	}
}

531 
gm©rix
 
	$gm_diff
(
gm©rix
 
M
, gm©rix 
N
, 
boŞ—n
 
u£cÛf
)

533 
i
, 
j
;

534 
gm©rix
 
»suÉ
;

535 
pŞy
 
x
, 
f
, 
g
, 
h
;

537 
»suÉ
 = 
	`mod_š™
();

538 
	`dl_cİy
(&
M
->
degg’s
, &
»suÉ
->
deg»es
);

540 
j
 = 1; j <ğ
	`ncŞs
(
N
); j++)

542 
g
 = 
	`¶i¡_»f
(&
N
->
g’s
, 
j
);

543 
f
 = 
NULL
;

544 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

546 
x
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

547 
h
 = 
	`p_cÚŒaù
(
x
, 
g
, 
u£cÛf
, 
i
);

548 
	`p_add
(&
f
, &
h
);

550 
	`gmIn£¹
(
»suÉ
, 
f
);

552  
»suÉ
;

553 
	}
}

555 
gm©rix
 
	$gm_¿ndom
(
r
, 
c
)

557 
i
, 
j
, 
n
;

558 
gm©rix
 
»suÉ
;

559 
pŞy
 
f
, 
g
;

560 
f›ld
 
a
;

562 
»suÉ
 = 
	`mod_š™
();

563 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 
r
);

565 
i
 = 1; i <ğ
c
; i++)

567 
f
 = 
NULL
;

568 
j
 = 1; j <ğ
r
; j++)

570 
n
 = 
	`¿nd
();

571 
a
 = 
	`nÜm®ize
(
n
);

572 ià(
a
 == 0)

574 
g
 = 
	`e_sub_i
(
j
);

575 
g
->
cÛf
 = 
a
;

576 
	`p_add
(&
f
, &
g
);

578 
	`qrgReduû
(&
f
);

579 
	`gmIn£¹
(
»suÉ
, 
f
);

581  
»suÉ
;

582 
	}
}

584 
gm©rix
 
	$gm_com´ess
(
gm©rix
 
M
)

586 
gm©rix
 
»suÉ
;

587 
i
;

588 
pŞy
 
f
;

590 
»suÉ
 = 
	`mod_š™
();

591 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

593 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

595 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

596 ià(
f
 !ğ
NULL
)

597 
	`gmIn£¹
(
»suÉ
, 
	`p_cİy
(
f
));

599  
»suÉ
;

600 
	}
}

602 
gm©rix
 
	$gm_v¬s
()

604 
gm©rix
 
»suÉ
;

605 
i
;

607 
»suÉ
 = 
	`mod_š™
();

608 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 0);

609 
i
 = 0; i < 
numv¬s
; i++)

610 
	`gmIn£¹
(
»suÉ
, 
	`p_xjei
(
i
, 1));

611  
»suÉ
;

612 
	}
}

	@gmatrix.h

5 
Äows
(
gm©rix
 
g
);

6 
ncŞs
(
gm©rix
 
g
);

7 
gmIn£¹
(
gm©rix
 
g
, 
pŞy
 
f
);

8 
pŞy
 
gm_–em
(
gm©rix
 
g
, 
i
, 
j
, 
comp
);

9 
gm©rix
 
gm_add
(gm©rix 
f
, gm©rix 
g
);

10 
gm©rix
 
gm_sub
(gm©rix 
f
, gm©rix 
g
);

11 
gm©rix
 
gm_Œª¥o£
(gm©rix 
f
);

12 
gm©rix
 
gm_muÉ
(gm©rix 
f
, gm©rix 
g
);

13 
gm©rix
 
gm_smuÉ
(gm©rix 
M
, 
pŞy
 
f
);

14 
gm_dsum
(
gm©rix
 
»suÉ
, gm©rix 
M
);

15 
gm©rix
 
gm_id’
(
n
);

16 
gm©rix
 
gm_dŸg
(gm©rix 
M
);

17 
gm©rix
 
gm_subm©
(gm©rix 
g
, 
dli¡
* 
drows
, dli¡* 
dcŞs
);

18 
gm©rix
 
gm_wedge
(gm©rix 
g
, 
p
);

19 
gm©rix
 
gm_pçff4
(gm©rix 
g
);

20 
gm©rix
 
gm_æ©‹n
(gm©rix 
g
);

21 
gm©rix
 
gm_g’M©
(
dli¡
* 
rows
, dli¡* 
cŞs
, 
fœ¡v¬
);

22 
gm©rix
 
gm_jacobŸn
(gm©rix 
g
, 
ex±”m
 
v¬s
);

23 
gm_cÚÿt
(
gm©rix
 
»suÉ
, gm©rix 
g
);

24 
gm©rix
 
gm_liá
(gm©rix 
M
, gm©rix 
N
);

25 
gm_»duû
(
gm©rix
 
M
, gm©rix 
N
, gm©rix* 
»dN
, gm©rix* 
liáN
);

26 
gm©rix
 
gm_Œaû
(gm©rix 
M
);

27 
gm©rix
 
gm_‹nsÜ
(gm©rix 
M
, gm©rix 
N
);

28 
gm©rix
 
gm_ou‹r
(gm©rix 
M
, gm©rix 
N
);

29 
pow”p
(
gm©rix
 
M
, gm©rix 
»suÉ
, 
pŞy
 
f
, 
Ï¡n
, 
pow
);

30 
gm©rix
 
gm_pow”
(gm©rix 
M
, 
n
);

31 
gm©rix
 
gm_diff
(gm©rix 
M
, gm©rix 
N
, 
boŞ—n
 
u£cÛf
);

32 
gm©rix
 
gm_¿ndom
(
r
, 
c
);

33 
gm©rix
 
gm_com´ess
(gm©rix 
M
);

34 
gm©rix
 
gm_v¬s
();

	@help.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~"sh¬ed.h
"

7 
	~"h–p.h
"

8 
	~"£t.h
"

9 
	~"sh–l.h
"

10 
	~"mac.h
"

11 
	~"cmdÇmes.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"humª_io.h
"

14 
	~"šput.h
"

17 
cÚ¡ex´
 
	gFIRST
[] = "@";

18 
cÚ¡ex´
 
	gFIRSTC
 = '@';

19 
cÚ¡ex´
 
	gSECOND
[] = "~";

20 
cÚ¡ex´
 
	gSECONDC
 = '~';

22 
boŞ—n
 
	$di¥ÏyI‹m
(
FILE
* 
h–pf
)

24 
¡r
[100];

26 !
	`ãof
(
h–pf
))

28 ià(
	`fg‘s
(
¡r
, 100, 
h–pf
è=ğ
NULL
)

30 ià(
	`¡ºcmp
(
¡r
, 
FIRST
, 1) == 0)

31  
TRUE
;

32 ià(
	`¡ºcmp
(
¡r
, 
SECOND
, 1) == 0)

33  
TRUE
;

34 
	`åršŠew
(
outfe
, "%s", 
¡r
);

36  (
FALSE
);

37 
	}
}

39 
	$di¥ÏyTİic
(
FILE
* 
h–pf
, 
£ú
, 
tİn
)

41 
¡r
[100];

42 
boŞ—n
 
found
;

44 ià((
£ú
 =ğ0è|| (
tİn
 == 0))

46 
	`»wšd
(
h–pf
);

47 
found
 = 
FALSE
;

48 !
	`ãof
(
h–pf
))

50 ià(
	`fg‘s
(
¡r
, 100, 
h–pf
è=ğ
NULL
)

52 ià(
	`¡ºcmp
(
¡r
, 
FIRST
, 1) == 0)

53 
£ú
--;

54 ià((
	`¡ºcmp
(
¡r
, 
SECOND
, 1è=ğ0è&& (
£ú
 == 0))

56 
tİn
--;

57 ià(
tİn
 == 0)

59 
	`åršt
(
outfe
, "\n");

60 
	`åršŠew
(
outfe
, "%s", 
¡r
 + 1);

61 
	`di¥ÏyI‹m
(
h–pf
);

62 
found
 = 
TRUE
;

66 ià(!
found
)

67 
	`´”rÜ
(";‚o help onhisopic\n");

68 
	}
}

74 
	$fšdTİic
(
FILE
* 
h–pf
, * 
tİic
, * 
£ú
, * 
tİn
)

76 
¡r
[100];

78 *
£ú
 = 0;

79 *
tİn
 = 0;

80 !
	`ãof
(
h–pf
))

82 ià(
	`fg‘s
(
¡r
, 100, 
h–pf
è=ğ
NULL
)

84 ià(*
¡r
 =ğ
FIRSTC
)

86 (*
£ú
)++;

87 *
tİn
 = 0;

89 ià(*
¡r
 =ğ
SECONDC
)

90 (*
tİn
)++;

93 ià(
	`¡ºcmp
(
¡r
 + 1, 
tİic
, 
	`¡¾’
(topic)) == 0)

96 
	}
}

98 
boŞ—n
 
	$ÃxtI‹m
(
FILE
* 
h–pf
, * 
¡r
, cÚ¡ * 
h—d”¡r
)

100 !
	`ãof
(
h–pf
))

102 ià(
	`fg‘s
(
¡r
, 100, 
h–pf
è=ğ
NULL
)

104 ià(
	`¡ºcmp
(
¡r
, 
h—d”¡r
, 
	`¡¾’
(headerstr)) == 0)

105  (
TRUE
);

106 ià(
	`¡ºcmp
(
¡r
, 
FIRST
, 1) == 0)

107  (
FALSE
);

109  (
FALSE
);

110 
	}
}

112 
	$toSeùiÚ
(
FILE
* 
h–pf
, * 
¡r
, 
£ú
)

114 
	`»wšd
(
h–pf
);

115 
£ú
 > 0)

117 
	`ÃxtI‹m
(
h–pf
, 
¡r
, 
FIRST
);

118 
£ú
--;

120 
	}
}

122 
	$m’uMaš
(
FILE
* 
h–pf
, cÚ¡ * 
Ëv–
)

124 
n™ems
, 
n
;

125 
s
[100];

127 
n™ems
 = 0;

128 
	`ÃxtI‹m
(
h–pf
, 
s
, 
Ëv–
))

130 
n™ems
++;

131 
	`åršŠew
(
outfe
, "(%dè%s", 
n™ems
, 
s
 + 1);

133 
	`åršŠew
(
outfe
, "\n");

135 
n
 = 
	`g‘_defšt
("which item (give its‚umber, <return>o†eave help)", 0);

136 ià((
n
 < 0è|| (À> 
n™ems
))

138 
	`´”rÜ
(";opic‚umber out of„ange\n");

141  (
n
);

142 
	}
}

144 
	$m’uTİics
(
FILE
* 
h–pf
, 
£ú
)

146 
tİn
;

147 
¡r
[100];

149 ià(
£ú
 == 0)

151 
	`toSeùiÚ
(
h–pf
, 
¡r
, 
£ú
);

152 
	`´šŠew
("tİic: %s\n", 
¡r
 + 1);

153 
tİn
 = 
	`m’uMaš
(
h–pf
, 
SECOND
);

154  (
tİn
);

155 
	}
}

157 
	$h–p_cmd
(
¬gc
, * 
¬gv
[])

159 
FILE
* 
h–pf
;

160 
£ú
, 
tİn
;

162 
h–pf
 = 
	`tİ’
(
h–pFe
, "r");

163 ià(
h–pf
 =ğ
NULL
)

165 
	`´”rÜ
("; Sorry, but I can't findhe help file...\n");

169 ià(
¬gc
 == 1)

171 
£ú
 = 
	`m’uMaš
(
h–pf
, 
FIRST
);

172 
tİn
 = 
	`m’uTİics
(
h–pf
, 
£ú
);

173 
	`di¥ÏyTİic
(
h–pf
, 
£ú
, 
tİn
);

174 
	`fşo£
(
h–pf
);

177 
	`fšdTİic
(
h–pf
, 
¬gv
[1], &
£ú
, &
tİn
);

178 ià(
£ú
 == 0)

180 
	`´”rÜ
(";‚o help onhatopic\n");

181 
	`fşo£
(
h–pf
);

184 ià(
tİn
 == 0)

185 
tİn
 = 
	`m’uTİics
(
h–pf
, 
£ú
);

186 
	`di¥ÏyTİic
(
h–pf
, 
£ú
, 
tİn
);

187 
	`fşo£
(
h–pf
);

188 
	}
}

192 
	$commªds_cmd
()

194 
ÃËms
, 
maxËngth
, 
n
, 
m
, 
i
, 
j
;

195 
Æšes
, 
ncŞumns
;

196 cÚ¡ * 
s
;

197 
¡r
[30];

199 ià(
´comm’t
 > 0)

200 
lšesize
 -= 2;

201 
ÃËms
 = 0;

202 
maxËngth
 = 0;

203 
i
 = 0; *(
s
 = 
cmd_li¡
[i].
Çme
) != '\0'; i++)

205 
n
 = ()
	`¡¾’
(
s
);

206 ià(
n
 > 
maxËngth
)

207 
maxËngth
 = 
n
;

208 
ÃËms
++;

210 
ncŞumns
 = 
lšesize
 / (
maxËngth
 + 1);

211 ià(
ncŞumns
 == 0)

212 
ncŞumns
 = 1;

213 
Æšes
 = (
ÃËms
 - 1è/ 
ncŞumns
 + 1;

215 
i
 = 0; i < 
Æšes
; i++)

217 
	`´št
("\n");

218 
	`Ãwlše
();

219 
j
 = 0; j < 
ncŞumns
; j++)

221 
m
 = 
i
 + 
Æšes
 * 
j
;

222 ià(
m
 >ğ
ÃËms
)

224 
	`¥rštf
(
¡r
, "%-* ", 
maxËngth
, 
cmd_li¡
[
m
].
Çme
);

225 
	`´št
("%s", 
¡r
);

228 
	`´št
("\n");

229 ià(
´comm’t
 > 0)

230 
lšesize
 += 2;

231 
	}
}

233 
	$h–pfe_cmd
(
¬gc
, * 
¬gv
[])

235 
s
[120];

236 
FILE
* 
f
;

238 ià(
¬gc
 != 2)

240 
	`´šŠew
("help_file <file‚ame>\n");

244 
f
 = 
	`tİ’
(
¬gv
[1], "r");

245 ià(
f
 =ğ
NULL
)

247 
	`´”rÜ
("; f% nÙ found\n", 
¬gv
[1]);

251 
	`ÃxtI‹m
(
f
, 
s
, ";;;"))

252 
	`åršŠew
(
outfe
, "%s", 
s
 + 3);

254 
	`fşo£
(
f
);

255 
	}
}

	@help.h

5 
h–p_cmd
(
¬gc
, * 
¬gv
[]);

6 
commªds_cmd
();

7 
h–pfe_cmd
(
¬gc
, * 
¬gv
[]);

	@hilb.c

4 
	~<¡dio.h
>

5 
	~"sh¬ed.h
"

6 
	~"hb.h
"

7 
	~"¡ash.h
"

8 
	~"mÚ™Ü.h
"

9 
	~"¬¿y.h
"

10 
	~"‹rm.h
"

11 
	~"ršg.h
"

12 
	~"¶i¡.h
"

13 
	~"sh–l.h
"

15 
	gg’fun
[
GFSIZE
] = {1, 0, 0};

16 *
	gh—dSsh
;

17 *
	gmÚSsh
;

18 *
	g·»nSsh
;

19 *
	g·œSsh
;

23 
	$putmÚli¡
(
¬row
 
h—d
)

25 
i
, 
’
, 
´’
;

26 
¬row
 
p
, 
loc
;

28 
´’
 = 
h—d
->
umh
.
m´’
;

29 
	`´št
("\nheader");

30 
i
 = 0; i < 
´’
; ++i)

31 
	`´št
(" %d", 
h—d
->
umh
.
m¡ack
[
i
].
m´e
);

32 
	`´št
(" %d\n", 
h—d
->
umh
.
m´ed
);

33 
	`´št
(" mii=%dƒq=", 
h—d
->
umh
.
mii
);

34 
i
 = 0; i <ğ
h—d
->
umh
.
mii
; ++i)

35 
	`´št
(" %d", 
h—d
->
umh
.
m¡ack
[
i
].
mi
);

36 
	`´št
("\n");

37 
p
 = 
h—d
;

38 
’
 = 
h—d
->
umh
.
mn
;

39 
loc
 = 
h—d
->
umh
.
mloc
;

42 
p
 =…->
uld
.
lda
[
FOW
];

43 ià(
p
 =ğ
loc
)

44 
	`´št
("* ");

45 
p
->
uld
.
ldkšd
)

48 
i
 = 0; i < 
’
; ++i)

49 
	`´št
(" %d", 
p
->
umn
.
mexp
[
i
]);

50 
	`´št
("\n");

54 
	`´št
("·»À%c, coÜ = %d\n", 
p
->
uld
.
ldkšd
,…->
ump
.
mËv
);

57 
	`´št
("header\n\n");

59 } 
p
->
uld
.
ldkšd
 != 'h');

60 
	}
}

62 
	$mÚRemNode
(
¬row
 
p
)

64 
c
;

66 
c
 = 
p
->
uld
.
ldkšd
;

67 ià(
c
 == 'h')

68 
	`ä“_¦ug
((
¡ash
 *)
h—dSsh
, (
¦ug
 *)
p
);

69 ià(
c
 == 'm')

70 
	`ä“_¦ug
((
¡ash
 *)
mÚSsh
, (
¦ug
 *)
p
);

72 
	`ä“_¦ug
((
¡ash
 *)
·»nSsh
, (
¦ug
 *)
p
);

73 
	}
}

75 
	$mÚ»fund
(
¬row
 
h
)

77 
¬row
 
p
, 
q
;

79 
p
 = 
h
;

82 
q
 = 
p
->
uld
.
lda
[
FOW
];

83 
	`mÚRemNode
(
p
);

84 
p
 = 
q
;

85 } 
p
 !ğ
h
);

86 
	}
}

88 
¬row
 
	$mÚadv
(
¬row
 
h—d
, 
cha£
)

90 
i
, 
imš
;

91 
¬row
 
p
;

93 
i
 = 
h—d
->
umh
.
mii
;

94 
p
 = 
h—d
->
umh
.
mloc
;

95 
imš
 = 
cha£
 ? 
i
 : 
h—d
->
umh
.
mimš
;

96 
TRUE
)

98 
p
 =…->
uld
.
lda
[
FOW
];

99 
p
->
uld
.
ldkšd
)

102 
h—d
->
umh
.
mii
 = 
i
;

103 
h—d
->
umh
.
mimš
 = 
imš
;

104  
h—d
->
umh
.
mloc
 = 
p
;

106 ++
i
;

109 --
i
;

110 
imš
 = 
	`mš_št
(
i
, imin);

113  
p
;

116 
	}
}

118 
¬row
 
	$mÚb»ed
(
¬row
 
h—d
, 
¡İ
)

120 
ex±”m
 
Ãxp
;

121 
i
, 
ow
, 
mii
, 
mimš
;

122 
’
, 
´’ew
, 
´eŞd
, 
´’
, 
deg
;

123 *
exp
;

124 
¬row
 
mloc
, 
Ãwh
, 
’d
, 
p
;

126 
mloc
 = 
h—d
->
umh
.mloc;

127 
mii
 = 
h—d
->
umh
.mii;

128 
mimš
 = 
h—d
->
umh
.mimin;

129 ià(
¡İ
)

131 
´’ew
 = 1 + 
mimš
;

132 
´eŞd
 = 
h—d
->
umh
.
m´’
;

133 
´’
 = 
´’ew
 + 
´eŞd
;

134 
’
 = 
h—d
->
umh
.
mn
 - 
´’ew
;

135 
Ãwh
 = 
	`mÚÃwh—d
(
	`max_št
(
’
, 
´’
 + 1));

136 
Ãwh
->
umh
.
mn
 = 
’
;

137 
Ãwh
->
umh
.
m´’
 = 
´’
;

138 
i
 = 0; i < 
´eŞd
; ++i)

139 
Ãwh
->
umh
.
m¡ack
[
i
].
m´e
 = 
h—d
->umh.mstack[i].mpre;

140 
exp
 = 
mloc
->
umn
.
mexp
;

141 
deg
 = 
h—d
->
umh
.
m´ed
;

142 
i
 = 0; i < 
´’ew
; ++i)

143 
deg
 +ğ
Ãwh
->
umh
.
m¡ack
[
i
 + 
´eŞd
].
m´e
 = ()
exp
[i];

144 
exp
 +ğ
´’ew
;

145 
Ãwh
->
umh
.
m´ed
 = 
deg
;

146 
’d
 = 
mloc
;

150 
´’ew
 = 0;

151 
’
 = 
h—d
->
umh
.
mn
;

152 
Ãwh
 = 
	`mÚÃwh—d
(
’
);

153 
exp
 = 
mloc
->
umn
.
mexp
;

154 
’d
 = 
h—d
;

156 
h—d
->
umh
.
mloc
 = head;

157 
h—d
->
umh
.
mii
 = 0;

158 (
p
 = 
	`mÚadv
(
h—d
, 
TRUE
)è!ğ
’d
)

160 
ow
 = 
	`max_št
(
h—d
->
umh
.
mimš
 - 
´’ew
, 0);

161 
i
 = 
ow
; i < 
’
; ++i)

162 
Ãxp
[
i
] = 
	`max_št
(
exp
[i], 
p
->
umn
.
mexp
[˜+ 
´’ew
]);

163 ià(
p
 !ğ
mloc
)

164 
	`mÚadjoš
(
Ãwh
, 
Ãxp
, 
NULL
);

166 
h—d
->
umh
.
mloc
 = mloc;

167 
h—d
->
umh
.
mii
 = mii;

168 
h—d
->
umh
.
mimš
 = mimin;

169  
Ãwh
;

170 
	}
}

172 
	$mobfœ¡
(
¬row
 
h—d
, 
h‹Î_func
 
h‹Î_cb
)

174 
¬row
 
Ãwh
;

176 (*
h‹Î_cb
)(
h—d
, 
FALSE
);

177 
Ãwh
 = 
	`mÚb»ed
(
h—d
, 
FALSE
);

178 ià(
Ãwh
->
umh
.
mloc
 !=‚ewh)

179 
	`mob»cur£
(
Ãwh
, 
h‹Î_cb
, 
TRUE
);

180 
	`mÚ»fund
(
Ãwh
);

181 
	}
}

183 
	$mob»cur£
(
¬row
 
h—d
, 
h‹Î_func
 
h‹Î_cb
, 
¶us
)

185 
¬row
 
Ãwh
;

186 
agaš
 = 
FALSE
;

188 
h—d
->
umh
.
mloc
 = head;

189 
h—d
->
umh
.
mii
 = 0;

190 
	`mÚadv
(
h—d
, 
FALSE
) != head)

192 (*
h‹Î_cb
)(
h—d
, 
¶us
);

193 ià(
agaš
)

195 
Ãwh
 = 
	`mÚb»ed
(
h—d
, 
TRUE
);

196 
	`mob»cur£
(
Ãwh
, 
h‹Î_cb
, !
¶us
);

197 
	`mÚ»fund
(
Ãwh
);

201 
agaš
 = 
TRUE
;

202 
h—d
->
umh
.
mimš
 = h—d->umh.
mii
;

205 
	}
}

207 
	$h‹Î
(
¬row
 
h—d
, 
¶us
)

209 
i
, 
deg
, 
’
;

210 *
a
;

212 
deg
 = 
h—d
->
umh
.
m´ed
;

213 
’
 = 
h—d
->
umh
.
mn
;

214 
a
 = 
h—d
->
umh
.
mloc
->
umn
.
mexp
;

215 
i
 = 0; i < 
’
; ++i)

216 
deg
 +ğ
a
[
i
];

217 ià(
deg
 >ğ
GFSIZE
)

219 
	`´št
("\n");

220 
	`´”rÜ
("; hilb htell: degree boundƒxceeded!\n");

221 
	`to_sh–l
();

223 ià(
¶us
)

224 
g’fun
[
deg
]++;

226 
g’fun
[
deg
]--;

227 
	}
}

230 
šlše
 
	$g‘dif
(*
dif
, 
v®
, 
idx
, 
ex±”m
 
Ãxp
, 
backw¬d
)

232 *
dif
 = 
v®
 - 
Ãxp
[
idx
];

233 ià(
backw¬d
)

234 *
dif
 = -*dif;

235 
	}
}

237 
šlše
 
	$iålus
(
dif
, 
cÚd
, *
dÚe
, 
¬row
 *
p
,‡¼ow 
h—d
, *
i
)

239 ià(
dif
 > 0)

241 ià(
cÚd
)

242 *
dÚe
 = 1;

245 --(*
i
);

246 *
p
 = 
h—d
->
umh
.
m¡ack
[*
i
].
ma
;

249 
	}
}

251 
	$mÚ£¬ch
(
¬row
 
h—d
, 
backw¬d
, 
ex±”m
 
Ãxp
)

253 
¬row
 
p
;

254 
agaš
 = 0, 
dÚe
 = 0, 
divides
 = 0;

255 
i
, 
j
;

256 
dif
, 
equ
, 
fow
, 
Í¬
, 
½¬
, 
kšd
, 
’
;

258 
p
 = 
h—d
->
umh
.
mloc
;

259 
i
 = 
h—d
->
umh
.
mii
;

260 
’
 = 
h—d
->
umh
.
mn
;

261 ià(
backw¬d
)

262 (
fow
 = 
BAK
, 
Í¬
 = ')', 
½¬
 = '(');

264 (
fow
 = 
FOW
, 
Í¬
 = '(', 
½¬
 = ')');

267 ià(
agaš
)

268 
p
 =…->
uld
.
lda
[
fow
];

270 
agaš
 = 1;

271 
kšd
 = 
p
->
uld
.
ldkšd
;

272 ià(
kšd
 == 'm')

274 
equ
 = 
h—d
->
umh
.
m¡ack
[
i
].
mi
;

275 
	`g‘dif
(&
dif
, 
p
->
umn
.
mexp
[
i
], i, 
Ãxp
, 
backw¬d
);

276 
	`iålus
(
dif
, 
equ
, &
dÚe
, &
p
, 
h—d
, &
i
);

277 ià(
dif
 <= 0)

279 ià(
equ
 && 
dif
 < 0)

280 
equ
 = 0;

281 
j
 = 
i
 + 1; j < 
’
; ++j)

283 
	`g‘dif
(&
dif
, 
p
->
umn
.
mexp
[
j
], j, 
Ãxp
, 
backw¬d
);

284 ià(
dif
 > 0)

286 ià(
equ
)

287 
dÚe
 = 1;

290 ià(
equ
 && 
dif
 < 0)

291 
equ
 = 0;

293 ià(
j
 =ğ
’
)

294 
divides
 = 1;

297 ià(
kšd
 =ğ
Í¬
)

299 
	`g‘dif
(&
dif
, 
p
->
ump
.
mËv
, 
i
, 
Ãxp
, 
backw¬d
);

300 
	`iålus
(
dif
, 
h—d
->
umh
.
m¡ack
[
i
].
mi
, &
dÚe
, &
p
, head, &i);

301 ià(
dif
 <= 0)

303 
h—d
->
umh
.
m¡ack
[
i
++].
ma
 = 
p
->
uld
.
ldc
.
ÿ
;

304 
h—d
->
umh
.
m¡ack
[
i
].
mi
 = h—d->umh.m¡ack[˜- 1].m˜&& 
dif
 == 0 ? 1 : 0;

307 ià(
kšd
 =ğ
½¬
)

309 ià(
h—d
->
umh
.
m¡ack
[
i
].
mi
)

310 
dÚe
 = 1;

312 --
i
;

315 
dÚe
 = 1;

316 } !(
dÚe
 || 
divides
));

317 
h—d
->
umh
.
mloc
 = 
p
;

318 
h—d
->
umh
.
mii
 = 
i
;

319  
divides
;

320 
	}
}

322 
	$šlškduk
(
¬row
 
p
,‡¼ow 
q
)

324 
p
->
uld
.
lda
[
FOW
] = 
q
;

325 
p
->
uld
.
lda
[
BAK
] = 
q
->uld.lda[BAK];

326 
q
->
uld
.
lda
[
BAK
] = 
p
;

327 
p
->
uld
.
lda
[
BAK
]->uld.lda[
FOW
] =…;

328 
	}
}

330 
	$uÆškduk
(
¬row
 
p
)

332 
p
->
uld
.
lda
[
FOW
]->uld.lda[
BAK
] =…->uld.lda[BAK];

333 
p
->
uld
.
lda
[
BAK
]->uld.lda[
FOW
] =…->uld.lda[FOW];

334 
	`mÚRemNode
(
p
);

335 
	}
}

338 
šlše
 
	$eq‹¡
(
¬row
 
q
, 
dœ
, 
j
, 
exp
)

340  
q
->
uld
.
lda
[
dœ
]->uld.
ldkšd
 =ğ'm' && q->uld.lda[dœ]->
umn
.
mexp
[
j
] =ğ
exp
;

341 
	}
}

343 
šlše
 
	$pu¬’
(
¬row
 *
a
,‡¼ow 
b
, 
c
, 
exp
, *
·»nSsh
)

345 *
a
 = (
¬row
)(*)
	`g‘_¦ug
((
¡ash
 *)
·»nSsh
);

346 (*
a
)->
uld
.
ldkšd
 = 
c
;

347 (*
a
)->
ump
.
mËv
 = 
exp
;

348 
	`šlškduk
(*
a
, 
b
);

349 
	}
}

351 
	$mÚš£¹
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
)

353 
¬row
 
p
, 
ql
, 
qr
, 
qËf
, 
qrih
;

354 
¬row
 
q
;

355 
exp
, 
j
;

356 
’
, 
i
;

358 
’
 = 
h—d
->
umh
.
mn
;

359 
i
 = 
h—d
->
umh
.
mii
;

360 
p
 = 
h—d
->
umh
.
mloc
;

361 
q
 = 
h—d
->
umh
.
mloc
 = (
¬row
)(*)
	`g‘_¦ug
((
¡ash
 *)
mÚSsh
);

362 
q
->
uld
.
ldkšd
 = 'm';

363 
j
 = 0; j < 
’
; ++j)

364 
q
->
umn
.
mexp
[
j
] = 
Ãxp
[j];

365 
	`šlškduk
(
q
, 
p
);

366 
j
 = 
i
; j < 
’
 - 2; ++j)

368 
exp
 = 
Ãxp
[
j
];

369 
qËf
 = 
NULL
;

370 ià(
	`eq‹¡
(
q
, 
FOW
, 
j
, 
exp
))

372 
qËf
 = 
q
;

373 
qrih
 = 
q
->
uld
.
lda
[
FOW
]->uld.lda[FOW];

375 ià(
	`eq‹¡
(
q
, 
BAK
, 
j
, 
exp
))

377 
qËf
 = 
q
->
uld
.
lda
[
BAK
];

378 
qrih
 = 
q
->
uld
.
lda
[
FOW
];

380 ià(
qËf
 =ğ
NULL
)

382 
	`pu¬’
(&
ql
, 
qËf
, '(', 
exp
, 
·»nSsh
);

383 
	`pu¬’
(&
qr
, 
qrih
, ')', 
exp
, 
·»nSsh
);

384 
ql
->
uld
.
ldc
.
ÿ
 = 
qr
;

385 
qr
->
uld
.
ldc
.
ÿ
 = 
ql
;

387 
	}
}

389 
	$mÚd–‘e
(
¬row
 
h—d
)

391 
¬row
 
p
;

392 
¬row
 
q
;

393 
Œy·»ns
 = 0, 
backw¬d
 = 1;

395 
p
 = 
h—d
->
umh
.
mloc
;

396 
q
 = 
p
->
uld
.
lda
[
FOW
];

397 
	`uÆškduk
(
p
);

398 ià(
q
->
uld
.
ldkšd
 == 'm')

400 
Œy·»ns
 = 1;

402 ià(
q
->
uld
.
lda
[
BAK
]->uld.
ldkšd
 == 'm')

404 
Œy·»ns
 = 1;

405 
backw¬d
 = 0;

406 
q
 = q->
uld
.
lda
[
BAK
];

408 ià(
Œy·»ns
)

409 
q
->
uld
.
lda
[
BAK
]->uld.
ldkšd
 =ğ'(' && q->uld.lda[
FOW
]->uld.ldkind == ')')

411 
	`uÆškduk
(
q
->
uld
.
lda
[
BAK
]);

412 
	`uÆškduk
(
q
->
uld
.
lda
[
FOW
]);

413 --
h—d
->
umh
.
mii
;

415 ià(
backw¬d
)

416 
q
 = q->
uld
.
lda
[
BAK
];

417 
h—d
->
umh
.
mloc
 = 
q
;

418 
	}
}

420 
¬row
 
	$mÚÃwh—d
(
’
)

422 
¬row
 
h—d
;

424 
h—d
 = (
¬row
)(*)
	`g‘_¦ug
((
¡ash
 *)
h—dSsh
);

425 
h—d
->
uld
.
lda
[0] = h—d->uld.lda[1] = h—d->
umh
.
mloc
 = head;

426 
h—d
->
uld
.
ldkšd
 = 'h';

427 
h—d
->
umh
.
mii
 = 0;

428 
h—d
->
umh
.
mn
 = 
’
;

429 
h—d
->
umh
.
m´’
 = h—d->umh.
m´ed
 = 0;

430 
h—d
->
umh
.
m¡ack
[0].
mi
 = 1;

431  
h—d
;

432 
	}
}

434 
	$mÚ»£t
(
¬row
 
h—d
, 
backw¬d
)

436 
h—d
->
umh
.
mloc
 = h—d->
uld
.
lda
[
backw¬d
 ? 
BAK
 : 
FOW
];

437 
h—d
->
umh
.
mii
 = 0;

438 
	}
}

440 
	$mÚadjoš
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
, 
h‹Î_func
 
h‹Î_cb
)

442 
divides
;

443 
¬row
 
Ãw
;

445 
	`mÚ»£t
(
h—d
, 
FOW
);

446 
divides
 = 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
Ãxp
);

447 ià(!
divides
)

449 
	`mÚš£¹
(
h—d
, 
Ãxp
);

450 ià(
h‹Î_cb
 !ğ
NULL
)

451 
	`mobfœ¡
(
h—d
, 
h‹Î_cb
);

452 
Ãw
 = 
h—d
->
umh
.
mloc
;

453 
	`mÚ»£t
(
h—d
, 
BAK
);

454 
TRUE
)

456 
	`mÚ£¬ch
(
h—d
, 
BAK
, 
Ãxp
);

457 ià(
Ãw
 =ğ
h—d
->
umh
.
mloc
)

460 
	`mÚd–‘e
(
h—d
);

463  
divides
;

464 
	}
}

466 
	$mÚbagadjoš
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
, *
bag
)

468 
divides
;

469 
¬row
 
Ãw
;

471 
	`mÚ»£t
(
h—d
, 
FOW
);

472 
divides
 = 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
Ãxp
);

473 ià(!
divides
)

475 
	`mÚš£¹
(
h—d
, 
Ãxp
);

476 
Ãw
 = 
h—d
->
umh
.
mloc
;

477 
Ãw
->
uld
.
ldc
.
ÿ
 = (
®l
 *)(*)
bag
;

478 
	`mÚ»£t
(
h—d
, 
BAK
);

479 
TRUE
)

481 
	`mÚ£¬ch
(
h—d
, 
BAK
, 
Ãxp
);

482 ià(
Ãw
 =ğ
h—d
->
umh
.
mloc
)

485 
	`mÚd–‘e
(
h—d
);

488  
divides
;

489 
	}
}

491 
	$i_g’fun
()

493 
i
;

495 
g’fun
[0] = 1;

496 
i
 = 1; i < 
GFSIZE
; i++)

497 
g’fun
[
i
] = 0;

498 
	}
}

500 
	$mn_´št
(
gm©rix
 
M
)

502 
i
, 
d
, 
Ën
;

503 
mn_syzes
 *
b
;

504 
mn_·œ
 *
p
;

506 
b
 = &
M
->
mÚsyz
;

507 
d
 = 
M
->
mn_lodeg
;

508 
Ën
 = 
	`Ëngth
(
b
);

509 
	`´št
("mn_´št:†’ = %d,†odeg = %d\n", 
Ën
, 
d
);

510 
i
 = 1; i <ğ
Ën
; ++i)

512 
	`´št
("deg»%d: ", 
i
 + 
d
);

513 
p
 = *(
mn_·œ
 **)
	`»f
(
b
, 
i
);

514 
p
 !ğ
NULL
)

516 
	`´št
("[%d,%d] ", 
p
->
id1
,…->
id2
);

517 
p
 =…->
mµ
;

519 
	`´št
("\n");

521 
	}
}

523 
	$mn_lcm
(
¬row
 
h—d
,‡¼ow *
Ãwh
, 
ex±”m
 
m
)

525 
¬row
 
p
, 
Ãwh—d
;

526 
i
;

527 
ex±”m
 
Ãxp
;

529 ià((
h—d
 !ğ
NULL
è&& (h—d !ğh—d->
uld
.
lda
[
FOW
]))

531 
h—d
->
umh
.
mloc
 = head;

532 
h—d
->
umh
.
mii
 = 0;

533 ià(*
Ãwh
 =ğ
NULL
)

534 *
Ãwh
 = 
	`mÚÃwh—d
(
numv¬s
);

535 
Ãwh—d
 = *
Ãwh
;

536 (
p
 = 
	`mÚadv
(
h—d
, 
TRUE
)) != head)

538 
i
 = 
h—d
->
umh
.
mimš
; i < 
numv¬s
; ++i)

539 
Ãxp
[
i
] = 
	`max_št
(
m
[i], 
p
->
umn
.
mexp
[i]);

540 ià(!
	`mÚadjoš
(
Ãwh—d
, 
Ãxp
, 
NULL
))

541 
Ãwh—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
 = 
p
->uld.ldc.ca;

544 
	}
}

546 
	$mn_š£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, *
bag
)

548 
ex±”m
 
m
;

549 
c
, 
d
, 
Ën
, 
i
;

550 
mn_bË
 *
a
;

551 
mn_syzes
 *
b
;

552 
¬row
 *
µ
, 
h—d
, 
Ãwh
, 
p
;

553 
mn_·œ
 *
q
, **
r
;

555 
a
 = &
M
->
mÚb
;

556 
b
 = &
M
->
mÚsyz
;

557 
c
 = 
	`tm_compÚ’t
(
m1
);

558 
	`sToExp
(
m1
, 
m
);

559 ià(
M
->
mn_lodeg
 =ğ
MAXNEG
)

560 
	`dl_lohi
(&
M
->
deg»es
, &M->
mn_lodeg
, &
i
);

561 
Ën
 = 
	`Ëngth
(
a
);

562 ià(
Ën
 < 
c
)

563 
i
 = 
Ën
 + 1; i <ğ
c
; ++i)

564 *((**)
	`šs_¬¿y
(
a
)èğ
NULL
;

565 
µ
 = (
¬row
 *)
	`»f
(
a
, 
c
);

566 ià(*
µ
 =ğ
NULL
)

567 *
µ
 = 
	`mÚÃwh—d
(
numv¬s
);

568 
h—d
 = *
µ
;

570 
Ãwh
 = 
NULL
;

571 
	`mn_lcm
(
h—d
, &
Ãwh
, 
m
);

572 
	`mn_lcm
(
Rid—l
, &
Ãwh
, 
m
);

573 ià(
Ãwh
 !ğ
NULL
)

575 
Ãwh
->
umh
.
mloc
 =‚ewh;

576 (
p
 = 
	`mÚadv
(
Ãwh
, 
TRUE
)) !=‚ewh)

578 
q
 = (
mn_·œ
 *)(*)
	`g‘_¦ug
((
¡ash
 *)
·œSsh
);

579 
d
 = 
	`dli¡_»f
(&
M
->
deg»es
, 
c
è- M->
mn_lodeg
;

580 
d
 +ğ
	`exp_deg»e
(
p
->
umn
.
mexp
);

581 
q
->
id1
 = 
bag
;

582 
q
->
id2
 = (*)
p
->
uld
.
ldc
.
ÿ
;

583 
Ën
 = 
	`Ëngth
(
b
);

584 ià(
Ën
 < 
d
)

585 
i
 = 
Ën
 + 1; i <ğ
d
; ++i)

586 *((**)
	`šs_¬¿y
(
b
)èğ
NULL
;

587 
r
 = (
mn_·œ
 **)
	`»f
(
b
, 
d
);

588 
q
->
mµ
 = *
r
;

589 *
r
 = 
q
;

591 
	`mÚ»fund
(
Ãwh
);

593 
	`mÚ»£t
(
h—d
, 
FOW
);

594 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
m
);

595 
	`mÚš£¹
(
h—d
, 
m
);

596 
h—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
 = (
®l
 *)(*)
bag
;

597 
	}
}

602 
	$mn_¡dš£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, *
bag
)

604 
ex±”m
 
m
;

605 
c
, 
Ën
, 
i
;

606 
mn_bË
 *
a
;

607 
¬row
 *
µ
, 
h—d
;

609 
a
 = &
M
->
mÚb
;

610 
c
 = 
	`tm_compÚ’t
(
m1
);

611 
	`sToExp
(
m1
, 
m
);

612 ià(
M
->
mn_lodeg
 =ğ
MAXNEG
)

613 
	`dl_lohi
(&
M
->
deg»es
, &M->
mn_lodeg
, &
i
);

614 
Ën
 = 
	`Ëngth
(
a
);

615 ià(
Ën
 < 
c
)

616 
i
 = 
Ën
 + 1; i <ğ
c
; ++i)

617 *((**)
	`šs_¬¿y
(
a
)èğ
NULL
;

618 
µ
 = (
¬row
 *)
	`»f
(
a
, 
c
);

619 ià(*
µ
 =ğ
NULL
)

620 *
µ
 = 
	`mÚÃwh—d
(
numv¬s
);

621 
h—d
 = *
µ
;

623 
	`mÚ»£t
(
h—d
, 
FOW
);

624 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
m
);

625 
	`mÚš£¹
(
h—d
, 
m
);

626 
h—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
 = (
®l
 *)(*)
bag
;

627 
	}
}

629 
boŞ—n
 
	$mn_rdiv
(
‹rm
 
m1
, **
b
,”m 
m2
)

631 
i
;

632 *
n
, 
c
;

633 
ex±”m
 
Ãxp
;

635 ià(
Rid—l
 !ğ
NULL
)

637 
c
 = 
	`tm_compÚ’t
(
m1
);

638 
	`sToExp
(
m1
, 
Ãxp
);

639 
	`mÚ»£t
(
Rid—l
, 
FOW
);

640 ià(
	`mÚ£¬ch
(
Rid—l
, 
FOW
, 
Ãxp
))

642 *
b
 = (*)
Rid—l
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
;

643 
n
 = 
Rid—l
->
umh
.
mloc
->
umn
.
mexp
;

644 
i
 = 0; i < 
numv¬s
; ++i)

645 
Ãxp
[
i
] -ğ
n
[i];

646 
	`expToS
(
Ãxp
, 
c
, 
m2
);

647  
TRUE
;

650  (
FALSE
);

651 
	}
}

653 
boŞ—n
 
	$mn_fšd_div
(
mn_bË
 *
a
, 
‹rm
 
m1
, **
b
,”m 
m2
)

655 
ex±”m
 
Ãxp
;

656 
c
, 
Ën
, 
i
;

657 
¬row
 
h—d
;

658 *
n
;

660 
c
 = 
	`tm_compÚ’t
(
m1
);

661 ià(
Rid—l
 !ğ
NULL
)

663 
	`sToExp
(
m1
, 
Ãxp
);

664 
	`mÚ»£t
(
Rid—l
, 
FOW
);

665 ià(
	`mÚ£¬ch
(
Rid—l
, 
FOW
, 
Ãxp
))

667 *
b
 = (*)
Rid—l
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
;

668 
n
 = 
Rid—l
->
umh
.
mloc
->
umn
.
mexp
;

669 
i
 = 0; i < 
numv¬s
; ++i)

670 
Ãxp
[
i
] -ğ
n
[i];

671 
	`expToS
(
Ãxp
, 
c
, 
m2
);

672  
TRUE
;

675 
Ën
 = 
	`Ëngth
(
a
);

676 ià(
Ën
 < 
c
)

677  
FALSE
;

678 
h—d
 = *(
¬row
 *)
	`»f
(
a
, 
c
);

679 ià(
h—d
 =ğ
NULL
)

680  
FALSE
;

681 
	`mÚ»£t
(
h—d
, 
FOW
);

682 ià(
Rid—l
 =ğ
NULL
)

683 
	`sToExp
(
m1
, 
Ãxp
);

684 ià(!
	`mÚ£¬ch
(
h—d
, 
FOW
, 
Ãxp
))

685  
FALSE
;

686 *
b
 = (*)
h—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
;

687 
n
 = 
h—d
->
umh
.
mloc
->
umn
.
mexp
;

688 
i
 = 0; i < 
numv¬s
; ++i)

689 
Ãxp
[
i
] -ğ
n
[i];

690 
	`expToS
(
Ãxp
, 0, 
m2
);

691  
TRUE
;

692 
	}
}

694 
	$mn_ršg
(
ršg
 
R
)

696 
nv¬s
;

697 
size
;

699 
nv¬s
 = 
R
->nvars;

700 
size
 = ()(
mÚh—d
) +

701 ()(
nv¬s
 - 
NVARS
è* ()(
m¡k
);

702 ià(
nv¬s
 == 1)

703 
size
 +ğ()(
m¡k
);

704 
R
->
h—dSsh
 = 
	`İ’_¡ash
(()
size
, "monables: monom heads");

705 
size
 = ()(
mmÚom
è+ ()(
nv¬s
 - 
NVARS
) * ()();

706 
R
->
mÚSsh
 = 
	`İ’_¡ash
(()
size
, "monables: monomials");

708 
R
->
·»nSsh
 = 
	`İ’_¡ash
(()(
mÚ·»n
), "monables:…arens");

709 
	}
}

711 
	$mn_uÄšg
(
ršg
 
R
)

713 
	`’dof_¡ash
((
¡ash
 *)
R
->
h—dSsh
);

714 
	`’dof_¡ash
((
¡ash
 *)
R
->
mÚSsh
);

715 
	`’dof_¡ash
((
¡ash
 *)
R
->
·»nSsh
);

716 
	}
}

718 
	$mn_š™
(
gm©rix
 
M
)

720 
M
->
mn_lodeg
 = 
MAXNEG
;

721 
	`š™_¬¿y
(&
M
->
mÚb
, (*));

722 
	`š™_¬¿y
(&
M
->
mÚsyz
, (*));

723 
	}
}

725 
	$mn_kl
(
gm©rix
 
M
)

727 
i
, 
Ën
;

728 
mn_bË
 *
a
;

729 
mn_syzes
 *
b
;

730 
¬row
 
p
;

731 
mn_·œ
 *
q
, *
r
;

733 
a
 = &
M
->
mÚb
;

734 
Ën
 = 
	`Ëngth
(
a
);

735 
i
 = 1; i <ğ
Ën
; ++i)

737 
p
 = *(
¬row
 *)
	`»f
(
a
, 
i
);

738 ià(
p
 !ğ
NULL
)

739 
	`mÚ»fund
(
p
);

741 
	`ä“_¬¿y
(
a
);

743 
b
 = &
M
->
mÚsyz
;

744 
Ën
 = 
	`Ëngth
(
b
);

745 
i
 = 1; i <ğ
Ën
; ++i)

747 
q
 = *(
mn_·œ
 **)
	`»f
(
b
, 
i
);

748 
q
 !ğ
NULL
)

750 
r
 = 
q
->
mµ
;

751 
	`ä“_¦ug
((
¡ash
 *)
·œSsh
, (
¦ug
 *)
q
);

752 
q
 = 
r
;

755 
	`ä“_¬¿y
(
b
);

756 
	}
}

758 
	$mn_fœ¡
()

760 
·œSsh
 = 
	`İ’_¡ash
((
mn_·œ
), "monomial syzygies");

761 
	}
}

763 
boŞ—n
 
	$mn_iscom¶‘e
(
gm©rix
 
M
)

765 
i
, 
Ën
;

766 
mn_syzes
 *
b
;

768 
b
 = &
M
->
mÚsyz
;

769 
Ën
 = 
	`Ëngth
(
b
);

770 
i
 = 1; i <ğ
Ën
; i++)

771 ià(*(
mn_·œ
 **)
	`»f
(
b
, 
i
è!ğ
NULL
)

773  (
FALSE
);

775  (
TRUE
);

776 
	}
}

778 
	$mn_Ãxt_·œ
(
gm©rix
 
M
, 
deg
, **
i1
, **
i2
)

780 
mn_·œ
 **
p
, *
q
;

781 
mn_syzes
 *
b
;

783 
deg
 -ğ
M
->
mn_lodeg
;

784 
b
 = &
M
->
mÚsyz
;

785 ià(
deg
 <ğ0 || deg > 
	`Ëngth
(
b
))

786  
FALSE
;

787 
p
 = (
mn_·œ
 **)
	`»f
(
b
, 
deg
);

788 
q
 = *
p
;

789 ià(
q
 !ğ
NULL
)

791 *
i1
 = 
q
->
id1
;

792 *
i2
 = 
q
->
id2
;

793 *
p
 = 
q
->
mµ
;

794 
	`ä“_¦ug
((
¡ash
 *)
·œSsh
, (
¦ug
 *)
q
);

795  
TRUE
;

797  
FALSE
;

798 
	}
}

	@hilb.h

5 (*
	th‹Î_func
)(
	t¬row
 
	th—d
, 
	t¶us
);

6 
¬¿y
 
	tmn_bË
;

7 
¬¿y
 
	tmn_syzes
;

10 
g’fun
[
GFSIZE
];

11 * 
h—dSsh
;

12 * 
mÚSsh
;

13 * 
·»nSsh
;

14 * 
·œSsh
;

17 
	`i_g’fun
();

18 
	`mn_fœ¡
();

19 
	`mn_ršg
(
ršg
 
R
);

20 
	`mn_uÄšg
(
ršg
 
R
);

21 
	`mn_š™
(
gm©rix
 
M
);

22 
	`mn_kl
(
gm©rix
 
M
);

25 
¬row
 
	`mÚÃwh—d
(
’
);

26 
¬row
 
	`mÚadv
×¼ow 
h—d
, 
cha£
);

27 
¬row
 
	`mÚb»ed
×¼ow 
h—d
, 
¡İ
);

28 
	`mÚadjoš
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
, 
h‹Î_func
 
h‹Î_cb
);

29 
	`mÚbagadjoš
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
, * 
bag
);

30 
	`mÚ»£t
(
¬row
 
h—d
, 
backw¬d
);

31 
	`mÚ£¬ch
(
¬row
 
h—d
, 
backw¬d
, 
ex±”m
 
Ãxp
);

32 
	`mÚš£¹
(
¬row
 
h—d
, 
ex±”m
 
Ãxp
);

33 
	`mÚd–‘e
(
¬row
 
h—d
);

34 
	`mÚ»fund
(
¬row
 
h
);

35 
	`mÚRemNode
(
¬row
 
p
);

38 
	`mobfœ¡
(
¬row
 
h—d
, 
h‹Î_func
 
h‹Î_cb
);

39 
	`mob»cur£
(
¬row
 
h—d
, 
h‹Î_func
 
h‹Î_cb
, 
¶us
);

40 
	`h‹Î
(
¬row
 
h—d
, 
¶us
);

43 
	`mn_lcm
(
¬row
 
h—d
,‡¼ow* 
Ãwh
, 
ex±”m
 
m
);

44 
	`mn_š£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, * 
bag
);

45 
	`mn_¡dš£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, * 
bag
);

46 
boŞ—n
 
	`mn_rdiv
(
‹rm
 
m1
, ** 
b
,”m 
m2
);

47 
boŞ—n
 
	`mn_fšd_div
(
mn_bË
* 
a
, 
‹rm
 
m1
, ** 
b
,”m 
m2
);

48 
boŞ—n
 
	`mn_iscom¶‘e
(
gm©rix
 
M
);

49 
	`mn_Ãxt_·œ
(
gm©rix
 
M
, 
deg
, ** 
i1
, ** 
i2
);

52 
	`putmÚli¡
(
¬row
 
h—d
);

53 
	`mn_´št
(
gm©rix
 
M
);

54 
	`šlškduk
(
¬row
 
p
,‡¼ow 
q
);

55 
	`uÆškduk
(
¬row
 
p
);

	@hilb2.c

4 
	~"sh¬ed.h
"

9 
®l
 *
	mlda
[2];

10 
ÿrgo
 
	mldc
;

11 
	mldkšd
;

12 
mÚh—d
 
	mumh
;

13 } 
	t¬row_acûss
;

15 
	~"hb2.h
"

16 
	~"hb.h
"

17 
	~"mÚid—l.h
"

19 
	~"gm©rix.h
"

20 
	~"v¬s.h
"

21 
	~"cmds.h
"

22 
	~"ršg.h
"

23 
	~"pŞy.h
"

24 
	~"¶i¡.h
"

25 
	~"‹rm.h
"

26 
	~"mÚ™Ü.h
"

27 
	~"sh–l.h
"

28 
	~"ch¬p.h
"

29 
	~"£t.h
"

30 
	~"¡dcmds.h
"

31 
	~"rm­.h
"

32 
	~"qršg.h
"

33 
	~"humª_io.h
"

34 
	~"gm_pŞy.h
"

35 
	~"g’”ic.h
"

42 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
g
, 
¬gc
, **
¬gv
, 
i
)

44 ià(
i
 >ğ
¬gc
)

45  
çl£
;

46 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

47  (*
g
 !ğ
NULL
);

48 
	}
}

50 
šlše
 
boŞ
 
	$Ãw_mod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

52 ià(
i
 >ğ
¬gc
)

53  
çl£
;

54 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

55  (*
p
 !ğ
NULL
);

56 
	}
}

58 
	$h_š™
(
hbFunc
 *
hf
, 
deg0
)

60 
i
;

62 
hf
->
codim
 = 0;

63 
hf
->
deg0
 = deg0;

64 
hf
->
deg»e
 = 0;

65 
i
 = 0; i < 
GFSIZE
; i++)

66 
hf
->
g’fun
[
i
] = 0;

67 
	}
}

69 
	$h_addto
(
hbFunc
 *
hf
, 
gf
[], 
deg0
)

71 
diff
, 
i
;

75 ià(
deg0
 < 
hf
->deg0)

77 
	`´”rÜ
("\n;internalƒrror: hilb‡ddto: deg0oo small\n");

78 
	`to_sh–l
();

80 ià(
hf
->
codim
 != 0)

82 
	`´”rÜ
("\n;internalƒrror: hilb‡ddto: codim‚ot zero\n");

83 
	`to_sh–l
();

86 
diff
 = 
deg0
 - 
hf
->deg0;

87 
i
 = 0; i < 
GFSIZE
 - 
diff
; i++)

89 
hf
->
g’fun
[
diff
 + 
i
] +ğ
gf
[i];

90 
hf
->
deg»e
 +ğ
gf
[
i
];

92 
i
 < 
GFSIZE
)

93 ià(
gf
[
i
++] != 0)

95 
	`´”rÜ
("\n;error: hilb‡ddto: degree boundƒxceeded!\n");

96 
	`to_sh–l
();

98 
	}
}

100 
	$h_divAÎ
(
hbFunc
 *
hf
)

102 
hf
->
deg»e
 == 0)

103 
	`h_div
(
hf
);

104 
	}
}

106 
	$h_div
(
hbFunc
 *
hf
)

108 
j
, 
lo
;

109 
lo
 = 
hf
->
codim
;

110 
hf
->
deg»e
 +ğhf->
g’fun
[
GFSIZE
 - 1] *= -1;

111 
j
 = 
GFSIZE
 - 2; j >ğ
lo
; j--)

113 
hf
->
g’fun
[
j
] = hf->genfun[j + 1] - hf->genfun[j];

114 
hf
->
deg»e
 +ğhf->
g’fun
[
j
];

116 
hf
->
codim
++;

117 
	}
}

119 
	$h_di¥Ïy
(
hbFunc
 *
hf
)

121 
i
;

123 
	`åršt
(
outfe
, "\n");

124 
i
 = 
hf
->
codim
; i < 
GFSIZE
; ++i)

125 ià(
hf
->
g’fun
[
i
] != 0)

127 
	`âewlše
(
outfe
);

128 
	`åršt
(
outfe
, "%7ld %2d\n", 
hf
->
g’fun
[
i
], i + hf->
deg0
 - hf->
codim
);

130 ià(
hf
->
deg»e
 != 0)

132 
	`åršt
(
outfe
, "\n");

133 
	`âewlše
(
outfe
);

134 
	`åršt
(
outfe
, "codim’siÚ = %d\n", 
hf
->
codim
);

135 
	`âewlše
(
outfe
);

136 
	`åršt
(
outfe
, "deg» = %ld\n", 
hf
->
deg»e
);

138 
	}
}

140 
	$h_g’us
(
hbFunc
 *
hf
)

142 
i
;

143 
n
, 
g’us
;

144 
lo
;

146 
g’us
 = 1;

147 
lo
 = 
hf
->
codim
;

148 
i
 = 
lo
; i < 
GFSIZE
; i++)

149 ià((
n
 = 
hf
->
g’fun
[
i
]) != 0)

150 
g’us
 +ğ(
i
 - 
lo
 - 1è* 
n
;

151  
g’us
;

152 
	}
}

154 
boŞ—n
 
	$hb
(
hbFunc
 *
hf
, 
gm©rix
 
M
)

156 
lodeg
, 
hideg
;

157 
comp
;

158 
¬row
 
h—d
;

160 
	`dl_lohi
(&
M
->
deg»es
, &
lodeg
, &
hideg
);

161 
	`h_š™
(
hf
, 
lodeg
);

162 
comp
 = 
	`Äows
(
M
); comp >= 1; comp--)

164 ià(
v”bo£
 > 0)

165 
	`štæush
("[%d] ", 
comp
);

166 
	`i_g’fun
();

167 ià((
h—d
 = 
	`mÚhb
(
M
, 
comp
, 
h‹Î
)è=ğ
NULL
)

168  
FALSE
;

170 
	`h_addto
(
hf
, (*)(*)
g’fun
, 
	`dli¡_»f
(&
M
->
deg»es
, 
comp
));

171 
	`mÚ»fund
(
h—d
);

173 ià(
v”bo£
 > 0)

174 
	`´št
("\n");

175  
TRUE
;

176 
	}
}

178 
	$hbDi¥Ïy
(
hbFunc
 *
hf
, 
gm©rix
 
M
)

180 ià(!
	`hb
(
hf
, 
M
))

182 
	`h_di¥Ïy
(
hf
);

183 
	`h_divAÎ
(
hf
);

184 
	`h_di¥Ïy
(
hf
);

185 
	`âewlše
(
outfe
);

186 
	`åršt
(
outfe
, "g’u  = %ld\n", 
	`h_g’us
(
hf
));

187 
	}
}

189 
	$hb_cmd
(
¬gc
, *
¬gv
[])

191 
gm©rix
 
M
;

192 
hbFunc
 
hf
;

194 ià(
¬gc
 != 2)

196 
	`´šŠew
("hilb <standard basis>\n");

199 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

201 
	`¡dW¬nšg
(
M
);

202 
	`hbDi¥Ïy
(&
hf
, 
M
);

204 
	}
}

206 
	snum”_»c


208 
gm©rix
 
	mrm­
;

209 
v¬ŸbË
 *
	mR
, *
	mS
;

210 
	mcomp
;

211 
pŞy
 
	m»suÉ
;

212 } 
	gnu
;

214 
	$num”_‹Î
(
¬row
 
h—d
, 
¶us
)

216 
i
, 
j
, 
’
;

217 *
a
;

218 
exp
[
NVARS
];

219 
pŞy
 
f
, 
g
;

222 
’
 = ((
¬row_acûss
 *)
h—d
)->
umh
.
mn
;

223 
a
 = ((
¬row_acûss
 *)
h—d
)->
umh
.
mloc
->
umn
.
mexp
;

224 
i
 = 0, 
j
 = 
numv¬s
 - 
’
; i <ƒn; ++i, ++j)

225 
exp
[
j
] = 
a
[
i
];

228 
	`vrg_š¡®l
(
nu
.
R
);

229 
f
 = 
	`p_mÚom
(
fd_Úe
);

230 
	`expToS
(
exp
, 
nu
.
comp
, 
	`pŞy_š™Ÿl
(
f
));

233 
g
 = 
	`chªge1_v¬s
(
nu
.
rm­
,‚u.
R
,‚u.
S
, 
f
);

236 
	`vrg_š¡®l
(
nu
.
S
);

237 ià(
¶us
)

238 
	`p_add
(&
nu
.
»suÉ
, &
g
);

240 
	`p_sub
(&
nu
.
»suÉ
, &
g
);

241 
	`p_kl
(&
g
);

242 
	`vrg_š¡®l
(
nu
.
R
);

243 
	`p_kl
(&
f
);

245 ià(
v”bo£
 > 1)

247 
	`´št
("%ø(", 
¶us
 ? '+' : '-');

248 
i
 = 0; i < 
numv¬s
; ++i)

250 
	`´št
("%s%d", 
i
 ? ", " : "", 
exp
[i]);

252 
	`´št
(")\n");

254 
	}
}

256 
boŞ—n
 
	$hb_num”
(
gm©rix
 
M
)

258 
comp
;

259 
¬row
 
h—d
;

260 
pŞy
 
f
;

262 
nu
.
»suÉ
 = 
NULL
;

263 
comp
 = 
	`Äows
(
M
); comp >= 1; comp--)

265 
	`vrg_š¡®l
(
nu
.
S
);

266 
f
 = 
	`e_sub_i
(
comp
);

267 
	`p_add
(&
nu
.
»suÉ
, &
f
);

268 
	`p_kl
(&
f
);

270 
	`vrg_š¡®l
(
nu
.
R
);

271 
nu
.
comp
 = comp;

272 ià(
v”bo£
 > 0)

273 
	`štæush
("[%d] ", 
comp
);

274 ià((
h—d
 = 
	`mÚhb
(
M
, 
comp
, ((*)(
¬row
, ))
num”_‹Î
)è=ğ
NULL
)

275  
FALSE
;

276 
	`mÚ»fund
(
h—d
);

278 ià(
v”bo£
 > 0)

279 
	`´št
("\n");

280  
TRUE
;

281 
	}
}

283 
	$hb_num”_cmd
(
¬gc
, *
¬gv
[])

285 
gm©rix
 
M
, 
N
;

286 
v¬ŸbË
 *
p
;

288 ià(
¬gc
 != 4)

290 
	`´šŠew
("hilb_numer <standard basis> <ideal> <result>\n");

294 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

296 
	`¡dW¬nšg
(
M
);

297 
nu
.
R
 = 
	`vg‘_ršg
(
NULL
);

298 ià(
nu
.
R
 =ğ
NULL
)

300 ià(!
	`g‘_mod
(&
nu
.
rm­
, 
¬gc
, 
¬gv
, 2))

302 
nu
.
S
 = 
	`vg‘_ršg
(
NULL
);

303 ià(
nu
.
S
 =ğ
NULL
)

305 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

307 
	`hb_num”
(
M
);

309 
	`vrg_š¡®l
(
nu
.
S
);

310 
N
 = 
	`mod_š™
();

311 
	`dl_cİy
(&
M
->
deg»es
, &
N
->degrees);

312 
	`gmIn£¹
(
N
, 
nu
.
»suÉ
);

313 
	`£t_v®ue
(
p
, 
N
);

315 
	}
}

317 
pŞy
 
	$mÚom_´od
(
exp
[], 
n
, 
gm©rix
 
rm­
)

320 
pŞy
 
f
, 
g
, 
h
;

321 
i
, 
j
;

323 
f
 = 
	`e_sub_i
(1);

324 
i
 = 0; i < 
n
; ++i)

325 ià(
exp
[
i
] > 0)

327 
g
 = 
	`¶i¡_»f
(&
rm­
->
g’s
, 
i
 + 1);

328 
j
 = 0; j < 
exp
[
i
]; ++j)

330 
h
 = 
	`p_muÉ
(
g
, 
f
);

331 
	`p_kl
(&
f
);

332 
f
 = 
h
;

335 
	`qrgReduû
(&
f
);

336  
f
;

337 
	}
}

339 
	$mÚoms_cmd
(
¬gc
, *
¬gv
[])

341 ià(
¬gc
 != 4)

343 
	`´šŠew
("monoms <matrix> <ideal> <result>\n");

347 *
¬gv
[0] = '\0';

348 
	`bšoms_cmd
(
¬gc
, 
¬gv
);

350 
	}
}

352 
	$bšoms_cmd
(
¬gc
, *
¬gv
[])

355 
gm©rix
 
M
, 
N
, 
rm­
;

356 
v¬ŸbË
 *
R
, *
S
, *
p
;

357 
pŞy
 
f
, 
g
;

358 
exp1
[
NVARS
], 
exp2
[NVARS];

359 
n
, 
i
, 
j
, 
comp
, 
bÙh
;

360 
f›ld
 
cÛf
;

362 ià(
¬gc
 != 4)

364 
	`´šŠew
("binoms <matrix> <ideal> <result>\n");

367 
bÙh
 = *
¬gv
[0] != '\0';

369 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

371 
R
 = 
	`vg‘_ršg
(
NULL
);

372 ià(
R
 =ğ
NULL
)

374 
n
 = 
	`Äows
(
M
);

376 ià(!
	`g‘_mod
(&
rm­
, 
¬gc
, 
¬gv
, 2))

378 
S
 = 
	`vg‘_ršg
(
NULL
);

379 ià(
S
 =ğ
NULL
)

381 ià(
n
 > 
	`ncŞs
(
rm­
))

383 
	`´”rÜ
(";oo fewƒlements in <ideal>\n");

387 ià(!
	`Ãw_mod
(&
p
, 
¬gc
, 
¬gv
, 3))

390 
	`vrg_š¡®l
(
S
);

391 
N
 = 
	`mod_š™
();

392 
	`£tz”odegs
(
N
, 1);

394 
	`vrg_š¡®l
(
R
);

395 
i
 = 1; i <ğ
	`ncŞs
(
M
); ++i)

397 
j
 = 0; j < 
n
; ++j)

398 
exp1
[
j
] = 0;

399 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

400 
f
 !ğ
NULL
)

402 
cÛf
 = 
f
->coef;

403 
comp
 = 
	`g‘_comp
(
f
);

404 
exp1
[
comp
 - 1] +ğ
cÛf
;

405 
f
 = f->
Ãxt
;

407 
j
 = 0; j < 
n
; ++j)

409 ià(
exp1
[
j
] < 0)

411 
exp2
[
j
] = -
exp1
[j];

412 
exp1
[
j
] = 0;

415 
exp2
[
j
] = 0;

418 
	`vrg_š¡®l
(
S
);

419 
f
 = 
	`mÚom_´od
(
exp1
, 
n
, 
rm­
);

420 ià(
bÙh
)

422 
g
 = 
	`mÚom_´od
(
exp2
, 
n
, 
rm­
);

423 
	`p_sub
(&
f
, &
g
);

424 
	`p_kl
(&
g
);

426 
	`gmIn£¹
(
N
, 
f
);

427 
	`vrg_š¡®l
(
R
);

429 
	`vrg_š¡®l
(
S
);

430 
	`£t_v®ue
(
p
, 
N
);

432 
	}
}

	@hilb2.h

7 
	mcodim
;

8 
	mdeg0
;

9 
	mdeg»e
;

10 
	mg’fun
[
GFSIZE
];

11 } 
	thbFunc
;

14 
h_š™
(
hbFunc
* 
hf
, 
deg0
);

15 
h_addto
(
hbFunc
* 
hf
, 
gf
[], 
deg0
);

16 
h_divAÎ
(
hbFunc
* 
hf
);

17 
h_div
(
hbFunc
* 
hf
);

18 
h_di¥Ïy
(
hbFunc
* 
hf
);

19 
h_g’us
(
hbFunc
* 
hf
);

20 
boŞ—n
 
hb
(
hbFunc
* 
hf
, 
gm©rix
 
M
);

21 
hbDi¥Ïy
(
hbFunc
* 
hf
, 
gm©rix
 
M
);

22 
hb_cmd
(
¬gc
, * 
¬gv
[]);

23 
num”_‹Î
(
¬row
 
h—d
, 
¶us
);

24 
boŞ—n
 
hb_num”
(
gm©rix
 
M
);

25 
hb_num”_cmd
(
¬gc
, * 
¬gv
[]);

26 
pŞy
 
mÚom_´od
(
exp
[], 
n
, 
gm©rix
 
rm­
);

27 
mÚoms_cmd
(
¬gc
, * 
¬gv
[]);

28 
bšoms_cmd
(
¬gc
, * 
¬gv
[]);

	@hulb.c

4 
	~<¡dio.h
>

5 
	~"sh¬ed.h
"

6 
	~"hulb.h
"

7 
	~"koszul.h
"

8 
	~"cmds.h
"

9 
	~"mac.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"¡dcmds.h
"

12 
	~"·r£.h
"

13 
	~"hb.h
"

14 
	~"mÚid—l.h
"

17 
	gtuÎexp
[
NVARS
];

18 
	gdeg
;

20 
	$i_tuÎ
(
nv¬s
, 
d
)

22 
i
;

24 
i
 = 0; i < 
nv¬s
; i++)

25 
tuÎexp
[
i
] = 0;

26 
deg
 = 
d
;

27 
	}
}

29 
	$tuÎ
(
¬row
 
h—d
, 
¶us
)

31 
i
, 
j
, 
d
, 
e
, 
n
, 
n2
, 
c1
, 
c2
, 
s
;

32 * 
a
;

34 
d
 = 
h—d
->
umh
.
m´ed
;

35 
n
 = 
h—d
->
umh
.
mn
;

36 
n2
 = 
h—d
->
umh
.
m´’
;

37 
a
 = 
h—d
->
umh
.
mloc
->
umn
.
mexp
;

38 
i
 = 0; i < 
n
; ++i)

39 
d
 +ğ
a
[
i
];

40 ià(
d
 > 
deg
)

43 
e
 = 
deg
 - 
d
;

44 
c1
 = 
	`bšom
(
numv¬s
 - 1 + 
e
,ƒ);

45 
c2
 = (
e
 =ğ0 ? 0 : 
	`bšom
(
numv¬s
 - 1 +ƒ,ƒ - 1));

46 
s
 = (
¶us
 ? -1 : 1);

47 
i
 = 0, 
j
 = 0; i < 
n2
; ++i, ++j)

48 
tuÎexp
[
j
] +ğ
s
 * (
c1
 * 
h—d
->
umh
.
m¡ack
[
i
].
m´e
 + 
c2
);

49 
i
 = 0; i < 
n
; ++i, ++
j
)

50 
tuÎexp
[
j
] +ğ
s
 * (
c1
 * 
a
[
i
] + 
c2
);

51 
	}
}

53 
boŞ—n
 
	$hulb
(
gm©rix
 
M
, 
d
)

56 
¬row
 
h—d
;

58 
	`i_tuÎ
(
numv¬s
, 
d
);

59 ià((
h—d
 = 
	`mÚhb
(
M
, 1, 
tuÎ
)è=ğ
NULL
)

60  
FALSE
;

61 
	`mÚ»fund
(
h—d
);

62  
TRUE
;

63 
	}
}

89 
	$hulb_cmd
(
¬gc
, * 
¬gv
[])

91 
gm©rix
 
M
;

92 
i
, 
d
;

94 ià(
¬gc
 != 3)

96 
	`´št
("hulb <standard basis> <deg>\n");

99 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

101 
	`´št
("Error: invalid module\n");

104 
d
 = 
	`g‘IÁ
(
¬gv
[2]);

105 
	`¡dW¬nšg
(
M
);

106 
	`hulb
(
M
, 
d
);

107 
i
 = 0; i < 
numv¬s
; i++)

108 
	`´št
("%ld ", 
tuÎexp
[
i
]);

109 
	`´št
("\n");

110 
	}
}

	@hulb.h

7 
i_tuÎ
(
nv¬s
, 
d
);

10 
tuÎ
(
¬row
 
h—d
, 
¶us
);

13 
boŞ—n
 
hulb
(
gm©rix
 
M
, 
d
);

16 
hulb_cmd
(
¬gc
, * 
¬gv
[]);

19 
tuÎexp
[
NVARS
];

20 
deg
;

	@human_io.c

4 
	~<ùy³.h
>

5 
	~<¡dio.h
>

6 
	~<¡ršg.h
>

7 
	~<£tjmp.h
>

13 
	~"sh¬ed.h
"

14 
	~"humª_io.h
"

15 
	~"ch¬p.h
"

16 
	~"cmds.h
"

17 
	~"gm©rix.h
"

18 
	~"šput.h
"

19 
	~"mac.h
"

20 
	~"mÚ™Ü.h
"

21 
	~"¶i¡.h
"

22 
	~"pŞy.h
"

23 
	~"qršg.h
"

24 
	~"£t.h
"

25 
	~"‹rm.h
"

26 
	~"·r£.h
"

27 
	~"gm_dli¡.h
"

28 
	~"·r£pŞy.h
"

30 
cÚ¡ex´
 
	gPR_POLY
 = 100;

32 
	$hu_abs
(
m
)

34 ià(
m
 < 0)

35  (-
m
);

37  (
m
);

38 
	}
}

51 
	$g‘_št
(cÚ¡ * 
s
)

53 
n
, 
¬gc
;

54 ** 
¬gv
;

56 ià(*
s
 != '\0')

57 
	`´šput
("%s", 
s
);

58 
	`g‘_lše
(&
¬gc
, &
¬gv
);

59 
¬gc
 != 1)

62 
	`´šput_”rÜ
("Wh©? %s", 
s
);

63 
	`g‘_lše
(&
¬gc
, &
¬gv
);

65 
n
 = 
	`g‘IÁ
(
¬gv
[0]);

66  (
n
);

67 
	}
}

69 
	$g‘_defšt
(cÚ¡ * 
s
, 
n
)

71 
¬gc
;

72 ** 
¬gv
;

74 ià(*
s
 != '\0')

75 
	`´šput
("%s", 
s
);

76 
	`g‘_lše
(&
¬gc
, &
¬gv
);

78 ià(
¬gc
 != 1)

79  (
n
);

80 
n
 = 
	`g‘IÁ
(
¬gv
[0]);

81  (
n
);

82 
	}
}

84 *
	$g‘_¡r
(cÚ¡ * 
s
)

86 
¬gc
;

87 ** 
¬gv
;

89 ià(*
s
 != '\0')

90 
	`´šput
("%s", 
s
);

91 
	`g‘_lše
(&
¬gc
, &
¬gv
);

92 
¬gc
 != 1)

94 
	`´šput_”rÜ
("Wh©? %s", 
s
);

95 
	`g‘_lše
(&
¬gc
, &
¬gv
);

97  (
¬gv
[0]);

98 
	}
}

100 
boŞ—n
 
	$g‘_cÚt¡r
(cÚ¡ * 
s
, ** 
¡r
)

102 
¬gc
;

103 ** 
¬gv
;

105 
TRUE
)

107 
	`g‘_lše
(&
¬gc
, &
¬gv
);

108 *
¡r
 = 
¬gv
[0];

109 ià(
¬gc
 == 1)

110  (
FALSE
);

111 ià((
¬gc
 =ğ2è&& (*(
¬gv
[1]) == '\\'))

112  (
TRUE
);

113 
	`´šput_”rÜ
("Wh©? %s", 
s
);

115 
	}
}

117 
boŞ—n
 
	$g‘_ch¬
(
c
)

119 
¬gc
;

120 ** 
¬gv
;

122 
	`g‘_lše
(&
¬gc
, &
¬gv
);

123 ià(
¬gc
 != 1)

124  (
FALSE
);

125 ià(*
¬gv
[0] !ğ
c
)

126  (
FALSE
);

127 ià(
¬gv
[0][1] != '\0')

128  (
FALSE
);

129  (
TRUE
);

130 
	}
}

132 
	$št_sÿn
(** 
¡r
)

134 
sum
 = 0;

136 ià(!
	`isdig™
(**
¡r
))

137 
sum
 = 1;

141 
sum
 = 10 * sum + (**
¡r
) - '0';

142 (*
¡r
)++;

143 } 
	`isdig™
(**
¡r
));

144  (
sum
);

145 
	}
}

147 
	$št_µršt
(
FILE
* 
f
, 
m
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
)

149 ià(
m
 < 0)

150 
	`åršt
(
f
, "-");

151 ià(
p_¶us
)

152 
	`åršt
(
f
, "+");

154 
m
 = 
	`hu_abs
(m);

155 ià((
m
 =ğ1è&& (!
p_Úe
))

157 
	`åršt
(
f
, "%d", 
m
);

158 
	}
}

160 
	$št_size
(
m
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
)

162 
sum
 = 0;

163 ià(
m
 < 0)

164 
sum
++;

165 ià(
p_¶us
)

166 
sum
++;

167 
m
 = 
	`hu_abs
(m);

168 ià((
m
 =ğ1è&& (!
p_Úe
))

169  (
sum
);

170 ; 
m
 >ğ10; (
sum
++), m = m / 10)

172 
sum
++;

173  (
sum
);

174 
	}
}

176 
f›ld
 
	$fd_sÿn
(** 
¡r
)

178 
c
;

179 
f›ld
 
ªs
;

180 
f›ld
 
num”
, 
d’om
;

181 
Ãg
;

183 
c
 = *((*
¡r
)++);

184 
Ãg
 = 1;

185 ià(
c
 == '-')

186 
Ãg
 = -1;

187 ià(
c
 != '+')

188 (*
¡r
)--;

189 
num”
 = (
f›ld
)(
Ãg
 * 
	`št_sÿn
(
¡r
));

190 
d’om
 = 1;

191 ià(**
¡r
 == '?')

192 (*
¡r
)++;

193 ià(**
¡r
 == '/')

195 (*
¡r
)++;

196 
d’om
 = (
f›ld
)
	`št_sÿn
(
¡r
);

198 
	`fd_div
(
num”
, 
d’om
, &
ªs
);

199  (
ªs
);

200 
	}
}

202 
	$fd_µršt
(
FILE
* 
f
, 
f›ld
 
a
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
)

204 
n
, 
m
;

206 ià(
´_ch¬p
 > 0)

208 
	`št_µršt
(
f
, 
a
, 
p_Úe
, 
p_¶us
);

211 
	`liá
(
ch¬ac
, 
a
, &
n
, &
m
);

212 ià(
n
 == 0)

214 
	`št_µršt
(
f
, 
a
, 
p_Úe
, 
p_¶us
);

218 ià(
n
 < 0)

220 
n
 = -n;

221 
m
 = -m;

223 ià(
n
 == 1)

224 
	`št_µršt
(
f
, 
m
, 
p_Úe
, 
p_¶us
);

227 
	`št_µršt
(
f
, 
m
, 
TRUE
, 
p_¶us
);

228 
	`åršt
(
f
, "/");

229 
	`št_µršt
(
f
, 
n
, 
FALSE
, FALSE);

231 
	}
}

233 
	$fd_size
(
f›ld
 
a
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
)

235 
n
, 
m
;

236 
sum
 = 0;

238 ià(
´_ch¬p
 > 0)

240 
sum
 = 
	`št_size
(
a
, 
p_Úe
, 
p_¶us
);

241  (
sum
);

243 
	`liá
(
ch¬ac
, 
a
, &
n
, &
m
);

244 ià(
n
 == 0)

246 
sum
 = 
	`št_size
(
a
, 
p_Úe
, 
p_¶us
);

247  (
sum
);

249 ià(
n
 < 0)

251 
n
 = -n;

252 
m
 = -m;

254 ià(
n
 == 1)

255 
sum
 = 
	`št_size
(
m
, 
p_Úe
, 
p_¶us
);

258 
sum
 = 
	`št_size
(
m
, 
TRUE
, 
p_¶us
);

259 
sum
++;

260 
sum
 +ğ
	`št_size
(
n
, 
FALSE
, FALSE);

262  (
sum
);

263 
	}
}

289 
	$p_µršt
(
FILE
* 
f
, 
pŞy
 
f
, 
comp
)

291 
boŞ—n
 
z
, 
´š‹d_ªy
;

292 
psize
, 
tsize
, 
rowsize
;

293 
boŞ—n
 
dÚewlše
;

295 
dÚewlše
 = ((
f
 =ğ
¡dout
è&& (
´comm’t
 > 0));

297 
rowsize
 = (
dÚewlše
 ? 
lšesize
 - 2 :†inesize);

299 
psize
 = 0;

300 
´š‹d_ªy
 = 
FALSE
;

301 
f
 !ğ
NULL
)

303 ià(
	`tm_compÚ’t
(
	`pŞy_š™Ÿl
(
f
)è=ğ
comp
)

305 
z
 = 
	`tm_isz”o
(
	`pŞy_š™Ÿl
(
f
));

306 
tsize
 = 
	`fd_size
(
f
->
cÛf
, 
z
, 
´š‹d_ªy
);

307 
tsize
 +ğ
	`tm_size
(
	`pŞy_š™Ÿl
(
f
));

308 ià(
tsize
 > 
rowsize
 - 1 - 
psize
)

310 
	`åršt
(
f
, " \\\n");

311 ià(
dÚewlše
)

312 
	`âewlše
(
f
);

313 
	`åršt
(
f
, " ");

314 
psize
 = 4;

316 
	`fd_µršt
(
f
, 
f
->
cÛf
, 
z
, 
´š‹d_ªy
);

317 
	`tm_µršt
(
f
, 
	`pŞy_š™Ÿl
(
f
));

318 
´š‹d_ªy
 = 
TRUE
;

319 
psize
 +ğ
tsize
;

321 
f
 = f->
Ãxt
;

323 ià(!
´š‹d_ªy
)

324 
	`åršt
(
f
, "0");

325 
	}
}

327 
	$pdeb
(
pŞy
 
f
, 
comp
)

329 
	`p_µršt
(
¡dout
, 
f
, 
comp
);

330 
	}
}

332 
	$p_size
(
pŞy
 
f
, 
comp
)

334 
boŞ—n
 
z
, 
´š‹d_ªy
;

335 
sum
 = 0;

337 
´š‹d_ªy
 = 
FALSE
;

338 
f
 !ğ
NULL
)

340 ià(
	`tm_compÚ’t
(
	`pŞy_š™Ÿl
(
f
)è=ğ
comp
)

342 
z
 = 
	`tm_isz”o
(
	`pŞy_š™Ÿl
(
f
));

343 
sum
 +ğ
	`fd_size
(
f
->
cÛf
, 
z
, 
´š‹d_ªy
);

344 
sum
 +ğ
	`tm_size
(
	`pŞy_š™Ÿl
(
f
));

345 
´š‹d_ªy
 = 
TRUE
;

347 
f
 = f->
Ãxt
;

349 ià(!
´š‹d_ªy
)

350 
sum
 = 1;

351  (
sum
);

352 
	}
}

357 
	$¶_sÿn
(
¶i¡
* 
¶
, 
numcŞs
, 
numrows
)

359 
i
, 
j
;

360 
pŞy
 
f
, 
g
;

362 
	`¶i¡_š™
(
¶
);

363 
i
 = 1; i <ğ
numcŞs
; i++)

365 
f
 = 
NULL
;

366 
j
 = 1; j <ğ
numrows
; j++)

368 
	`´šput
("(%d,%d)", 
j
, 
i
);

369 
g
 = 
	`rdPŞy
(
j
);

370 
	`p_add
(&
f
, &
g
);

372 
	`¶i¡_š£¹
(
¶
, 
f
);

374 
	}
}

376 
	$¶S·r£_sÿn
(
¶i¡
* 
¶
, 
numcŞs
, 
numrows
)

378 
i
, 
r
, 
c
, 
¬gc
;

379 ** 
¬gv
;

380 
pŞy
 
f
;

382 
	`¶i¡_š™
(
¶
);

383 
i
 = 1; i <ğ
numcŞs
; i++)

384 
	`¶i¡_š£¹
(
¶
, 
NULL
);

385 
TRUE
)

387 
	`´šput
("row column value ");

388 
	`g‘_lše
(&
¬gc
, &
¬gv
);

389 ià((
¬gc
 < 3) || (argc > 4))

391 
r
 = 
	`g‘IÁ
(
¬gv
[0]);

392 
c
 = 
	`g‘IÁ
(
¬gv
[1]);

393 ià((
r
 < 1è|| (¸> 
numrows
è|| (
c
 < 1è|| (ø> 
numcŞs
))

395 
	`´”rÜ
(";ƒntry ignored, index out of„ange\n");

398 
f
 = 
	`rdPŞySŒ
(
¬gc
 - 2, 
¬gv
 + 2, 
r
);

399 
pŞy
* 
´ef_±r
 = (pŞy*)
	`»f
((
¬¿y
*)
¶
, 
c
);

400 
	`p_add
(
´ef_±r
, &
f
);

402 
	}
}

404 
	$putm©
(
FILE
* 
f
, 
gm©rix
 
M
)

406 
i
, 
j
;

407 
boŞ—n
 
dÚewlše
;

409 
dÚewlše
 = (
f
 =ğ
¡dout
);

410 ià(
dÚewlše
)

411 
	`âewlše
(
f
);

412 
	`åršt
(
f
, "%d\n", 
	`Äows
(
M
));

413 ià(
dÚewlše
)

414 
	`âewlše
(
f
);

415 
	`åršt
(
f
, "%d\n", 
	`ncŞs
(
M
));

416 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

417 
j
 = 1; j <ğ
	`Äows
(
M
); j++)

419 ià(
dÚewlše
)

420 
	`âewlše
(
f
);

421 
	`p_µršt
(
f
, 
	`¶i¡_»f
(&
M
->
g’s
, 
i
), 
j
);

422 
	`åršt
(
f
, "\n");

424 
	}
}

426 
	$´_size
(
pŞy
 
f
, 
maxcomp
)

428 
i
, 
d
, 
»suÉ
 = 0;

429 
i
 = 1; i <ğ
maxcomp
; i++)

430 ià((
d
 = 
	`p_size
(
f
, 
i
)è> 
»suÉ
)

431 
»suÉ
 = 
d
;

432  (
»suÉ
);

433 
	}
}

435 
boŞ—n
 
	$´štsoçr
(
FILE
* 
f
, 
¶i¡
* 
¶
, 
sizes
[], 
fœ¡
, 
Ï¡
,

436 
numrows
)

438 
c
, 
r
, 
s
, 
j
;

440 ià(
fœ¡
 != 1)

441 
	`åršt
(
f
, "\n");

442 
r
 = 1;„ <ğ
numrows
;„++)

444 
	`âewlše
(
f
);

445 
c
 = 
fœ¡
; c <ğ
Ï¡
; c++)

447 
	`p_µršt
(
f
, 
	`¶i¡_»f
(
¶
, 
c
), 
r
);

448 
s
 = 
	`p_size
(
	`¶i¡_»f
(
¶
, 
c
), 
r
);

449 
j
 = 0; j < 
sizes
[
c
 - 
fœ¡
] - 
s
; j++)

450 
	`åršt
(
f
, " ");

452 
	`åršt
(
f
, "\n");

453 ià(
	`have_šŒ
())

454  (
FALSE
);

456  (
TRUE
);

457 
	}
}

459 
	$¶_µršt
(
FILE
* 
f
, 
¶i¡
* 
¶
, 
numrows
, 
rowsize
)

461 
sizes
[
PR_POLY
];

462 
tÙ®
, 
s
;

463 
fœ¡
, 
i
;

464 
boŞ—n
 
isšŒ
;

466 ià(
´comm’t
 > 0)

467 
rowsize
 -= 2;

468 
tÙ®
 = 0;

469 
fœ¡
 = 1;

470 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
¶
); i++)

472 
s
 = 
	`´_size
(
	`¶i¡_»f
(
¶
, 
i
), 
numrows
) + 1;

473 ià(((
s
 + 
tÙ®
è> 
rowsize
è&& (
i
 > 
fœ¡
))

475 
isšŒ
 = 
	`´štsoçr
(
f
, 
¶
, 
sizes
, 
fœ¡
, 
i
 - 1, 
numrows
);

476 ià(!
isšŒ
)

478 
tÙ®
 = 0;

479 
fœ¡
 = 
i
;

481 
tÙ®
 +ğ
s
;

482 
sizes
[
i
 - 
fœ¡
] = 
s
;

484 ià(
tÙ®
 > 0)

485 
	`´štsoçr
(
f
, 
¶
, 
sizes
, 
fœ¡
, 
	`¬¿y_Ëngth
((
¬¿y
*íl), 
numrows
);

486 
	}
}

488 
	$dl_µršt
(
FILE
* 
f
, 
dli¡
* 
dl
)

490 
this
, 
num
, 
i
;

492 ià(
	`¬¿y_Ëngth
((
¬¿y
*)
dl
) == 0)

494 
this
 = 
	`dli¡_»f
(
dl
, 1);

495 
num
 = 1;

496 
i
 = 2; i <ğ
	`¬¿y_Ëngth
((
¬¿y
*)
dl
); i++)

497 ià(
this
 =ğ
	`dli¡_»f
(
dl
, 
i
))

498 
num
++;

501 
	`åršt
(
f
, "%d [%d] ", 
this
, 
num
);

502 
this
 = 
	`dli¡_»f
(
dl
, 
i
);

503 
num
 = 1;

505 
	`åršt
(
f
, "%d [%d]\n", 
this
, 
num
);

506 
	}
}

508 
boŞ—n
 
	$check_homog
(
gm©rix
 
M
)

510 
i
, 
d
;

511 
pŞy
 
f
;

513 
i
 = 1; i <ğ
	`¬¿y_Ëngth
(&
M
->
g’s
); i++)

515 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

516 
d
 = 
	`dli¡_»f
(&
M
->
degg’s
, 
i
);

517 
f
 !ğ
NULL
)

519 ià(
d
 !ğ
	`deg»e
(
M
, 
f
))

520  (
FALSE
);

521 
f
 = f->
Ãxt
;

524  (
TRUE
);

525 
	}
}

527 
	$£tdegg’s
(
gm©rix
 
M
)

529 
i
, 
c
;

530 
pŞy
 
f
;

531 
¬gc
;

532 ** 
¬gv
;

534 
	`´šput
("deg»e fÜƒach cŞumÀ(1hru %d, deçuÉ=compu‹ from„ows)", 
	`ncŞs
(
M
));

535 
c
 = 
	`ncŞs
(
M
);

536 
	`dl_kl
(&
M
->
degg’s
);

537 
	`dli¡_š™
(&
M
->
degg’s
);

539 
	`g‘_lše
(&
¬gc
, &
¬gv
);

540 ià(
¬gc
 > 0)

542 
	`dlCÚsume
(&
M
->
degg’s
, 
¬gc
, 
¬gv
, 
c
, 0);

543 ià(!
	`check_homog
(
M
))

544 
	`´št
("; warning: module isn't homogeneous\n");

548 
i
 = 1; i <ğ
	`¬¿y_Ëngth
(&
M
->
g’s
); i++)

549 ià((
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
)è=ğ
NULL
)

551 
	`dli¡_š£¹
(&
M
->
degg’s
, 0);

554 
	`dli¡_š£¹
(&
M
->
degg’s
, 
	`deg»e
(M, 
f
));

555 ià(!
	`check_homog
(
M
))

556 
	`´št
("; warning: module isn't homogeneous\n");

557 
	}
}

559 
	$£tdegs
(
gm©rix
 
M
)

561 
r
;

563 
	`´šput
("deg»e fÜƒach„ow (1hru %d, deçuÉ=0's)", 
	`Äows
(
M
));

564 
r
 = 
	`Äows
(
M
);

565 
	`dl_kl
(&
M
->
deg»es
);

566 
	`dli¡_š™
(&
M
->
deg»es
);

567 
	`dlSÿn
(&
M
->
deg»es
, 
r
, 0);

568 
	`£tdegg’s
(
M
);

569 
	}
}

571 
	$£tz”odegs
(
gm©rix
 
M
, 
numrows
)

573 
i
, 
numcŞs
;

574 
pŞy
 
f
;

576 
numcŞs
 = 
	`¬¿y_Ëngth
(&
M
->
g’s
);

577 
i
 = 1; i <ğ
numrows
; i++)

578 
	`dli¡_š£¹
(&
M
->
deg»es
, 0);

579 
i
 = 1; i <ğ
numcŞs
; i++)

581 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
i
);

582 ià(
f
 =ğ
NULL
)

584 
	`dli¡_š£¹
(&
M
->
degg’s
, 0);

588 
	`dli¡_š£¹
(&
M
->
degg’s
, 
	`deg»e
(M, 
f
));

591 
	}
}

593 
gm©rix
 
	$m©_sÿn
()

595 
numrows
, 
numcŞs
;

596 
gm©rix
 
M
;

598 
numrows
 = 
	`g‘_defšt
("number of„ows ", 0);

599 
numcŞs
 = 
	`g‘_defšt
("number of columns", 0);

600 
M
 = 
	`mod_š™
();

602 
	`¶_sÿn
(&
M
->
g’s
, 
numcŞs
, 
numrows
);

603 
	`£tz”odegs
(
M
, 
numrows
);

604  (
M
);

605 
	}
}

607 
gm©rix
 
	$¥¬£_sÿn
()

609 
numrows
, 
numcŞs
;

610 
gm©rix
 
M
;

612 
numrows
 = 
	`g‘_defšt
("number of„ows ", 0);

613 
numcŞs
 = 
	`g‘_defšt
("number of columns", 0);

614 
M
 = 
	`mod_š™
();

616 
	`¶S·r£_sÿn
(&
M
->
g’s
, 
numcŞs
, 
numrows
);

617 
	`£tz”odegs
(
M
, 
numrows
);

618  (
M
);

619 
	}
}

621 
gm©rix
 
	$id—l_sÿn
()

623 
numg’s
;

624 
gm©rix
 
M
;

626 
M
 = 
	`mod_š™
();

627 
numg’s
 = 
	`g‘_št
("number of generators");

629 
	`¶_sÿn
(&
M
->
g’s
, 
numg’s
, 1);

630 
	`£tz”odegs
(
M
, 1);

631  (
M
);

632 
	}
}

634 
gm©rix
 
	$pŞy_sÿn
(
¬gc
, * 
¬gv
[])

636 
gm©rix
 
M
;

637 
pŞy
 
f
;

639 
M
 = 
	`mod_š™
();

640 
f
 = 
	`rdPŞySŒ
(
¬gc
, 
¬gv
, 1);

641 
	`£tz”odegs
(
M
, 1);

642 
	`gmIn£¹
(
M
, 
f
);

643  (
M
);

644 
	}
}

	@human_io.h

5 
g‘_št
(cÚ¡ * 
s
);

6 
g‘_defšt
(cÚ¡ * 
s
, 
n
);

7 *
g‘_¡r
(cÚ¡ * 
s
);

8 
boŞ—n
 
g‘_cÚt¡r
(cÚ¡ * 
s
, ** 
¡r
);

9 
boŞ—n
 
g‘_ch¬
(
c
);

10 
št_sÿn
(** 
¡r
);

11 
št_µršt
(
FILE
* 
f
, 
m
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
);

12 
št_size
(
m
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
);

13 
f›ld
 
fd_sÿn
(** 
¡r
);

14 
fd_µršt
(
FILE
* 
f
, 
f›ld
 
a
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
);

15 
fd_size
(
f›ld
 
a
, 
boŞ—n
 
p_Úe
, boŞ—À
p_¶us
);

16 
p_µršt
(
FILE
* 
f
, 
pŞy
 
f
, 
comp
);

17 
pdeb
(
pŞy
 
f
, 
comp
);

18 
p_size
(
pŞy
 
f
, 
comp
);

19 
¶_sÿn
(
¶i¡
* 
¶
, 
numcŞs
, 
numrows
);

20 
¶S·r£_sÿn
(
¶i¡
* 
¶
, 
numcŞs
, 
numrows
);

21 
putm©
(
FILE
* 
f
, 
gm©rix
 
M
);

22 
´_size
(
pŞy
 
f
, 
maxcomp
);

23 
¶_µršt
(
FILE
* 
f
, 
¶i¡
* 
¶
, 
numrows
, 
rowsize
);

24 
dl_µršt
(
FILE
* 
f
, 
dli¡
* 
dl
);

25 
boŞ—n
 
check_homog
(
gm©rix
 
M
);

26 
£tdegg’s
(
gm©rix
 
M
);

27 
£tdegs
(
gm©rix
 
M
);

28 
£tz”odegs
(
gm©rix
 
M
, 
numrows
);

29 
gm©rix
 
m©_sÿn
();

30 
gm©rix
 
¥¬£_sÿn
();

31 
gm©rix
 
id—l_sÿn
();

32 
gm©rix
 
pŞy_sÿn
(
¬gc
, * 
¬gv
[]);

	@inhomog.c

4 
	~"sh¬ed.h
"

5 
	~"šhomog.h
"

6 
	~"mÚ™Ü.h
"

7 
	~"mac.h
"

8 
	~"¡ªd¬d.h
"

9 
	~"gm©rix.h
"

10 
	~"pŞy.h
"

11 
	~"hb.h
"

12 
	~"‹rm.h
"

13 
	~"¡ash.h
"

14 
	~"mÚoms.h
"

15 
	~"box´ocs.h
"

16 
	~"£t.h
"

17 
	~"mem.h
"

19 
	$IHÜig_g’s
(
gm©rix
 
M
, 
štv®
, 
v¬ŸbË
 *
B
)

21 
i
;

22 
pŞy
 
f
, 
k
, 
h
, 
h»p
;

24 
i
 = 1; i <ğ
	`Ëngth
(&
M
->
g’s
); i++)

26 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&
M
->
g’s
, 
i
));

27 
	`divisiÚ
(
M
, &
f
, &
h»p
, &
h
);

28 ià((
štv®
 < 0è|| (štv® >ğ
i
))

30 
k
 = 
	`e_sub_i
(
i
);

31 
	`p_add
(&
h»p
, &
k
);

33 
	`IH£nd_off
(
M
, 
B
, 
h
, 
h»p
);

35 
	}
}

37 
boŞ—n


38 
	$IHÿlc_¡ªd¬d
(
gm©rix
 
M
, 
v¬ŸbË
 *
B
)

40 
mn_¡ªd¬d
 
i
, 
j
, 
p
;

41 
pŞy
 
h
, 
h»p
, 
f
, 
»p
;

42 
boŞ—n
 
nÙdÚe
;

44 ià(
	`ncŞs
(
M
) > 0)

45 
	`´æush
(".");

46 
	`mo_»£t
(
M
, (**)&
i
, (**)&
j
);

49 
nÙdÚe
 = 
FALSE
;

50 
	`IHmo_Ãxt_·œ
(
M
, &
i
, &
j
))

52 
	`ÿlc_s_·œ
(
M
, 
i
, 
j
, &
h
, &
h»p
);

53 
	`IH£nd_off
(
M
, 
B
, 
h
, 
h»p
);

54 
nÙdÚe
 = 
TRUE
;

56 
M
->
¡dbasis
 !ğ
NULL
)

58 
p
 = 
M
->
¡dbasis
;

59 
f
 = 
p
->
¡ªd¬d
;

60 
h»p
 = 
p
->
chªge
;

61 
M
->
¡dbasis
 = 
p
->
Ãxt
;

62 
	`ä“_¦ug
((
¡ash
 *)
¡d_¡ash
, (
¦ug
 *)
p
);

63 
	`divisiÚ
(
M
, &
f
, &
»p
, &
h
);

64 
	`p_sub
(&
h»p
, &
»p
);

65 
	`IH£nd_off
(
M
, 
B
, 
h
, 
h»p
);

66 
nÙdÚe
 = 
TRUE
;

68 } 
nÙdÚe
);

69  (
TRUE
);

70 
	}
}

72 
	$IH£nd_off
(
gm©rix
 
M
, 
v¬ŸbË
 *
B
, 
pŞy
 
h
,…Şy 
h»p
)

74 ià(
h
 !ğ
NULL
)

76 
	`IHšs_–em
(
M
, 
h
, 
h»p
);

77 ià(
v”bo£
 > 0)

78 
	`´æush
("m");

80 ià(
h»p
 !ğ
NULL
)

82 #´agm¨
GCC
 
dŸgno¡ic
 
push


83 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

84 
	`£nd_pŞy
(
B
, 
h»p
, 0);

85 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


86 ià(
v”bo£
 > 0)

87 
	`´æush
("s");

89 ià(
v”bo£
 > 0)

90 
	`´æush
("o");

91 
	`šŒ_sh–l
();

92 
	}
}

94 
	$IHšs_–em
(
gm©rix
 
M
, 
pŞy
 
h
,…Şy 
h»p
)

96 
mn_¡ªd¬d
 
i
;

98 
	`make2_mÚic
(&
h
, &
h»p
);

99 
i
 = (
mn_¡ªd¬d
)(*)
	`g‘_¦ug
((
¡ash
 *)
¡d_¡ash
);

100 
i
->
¡ªd¬d
 = 
h
;

101 
i
->
chªge
 = 
h»p
;

102 
i
->
ismš
 = ()
TRUE
;

103 
i
->
Ãxt
 = 
NULL
;

104 
i
->
deg»e
 = 0;

105 
	`IHmo_š£¹
(
M
, 
	`pŞy_š™Ÿl
(
h
), 
i
);

106 
	}
}

108 
	$IHmn_adjoš
(
gm©rix
 
M
, 
¬row
 
h—d
, 
ex±”m
 
Ãxp
, *
bag
)

110 
¬row
 
p
, 
Ãw
;

111 
mn_¡ªd¬d
 
q
;

113 
	`mÚ»£t
(
h—d
, 
FOW
);

114 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
Ãxp
);

115 
	`mÚš£¹
(
h—d
, 
Ãxp
);

116 
M
->
n¡ªd¬d
++;

117 
M
->
modty³
 = 
MISTD
;

118 
Ãw
 = 
h—d
->
umh
.
mloc
;

119 
Ãw
->
uld
.
ldc
.
ÿ
 = (
®l
 *)(*)
bag
;

120 
	`mÚ»£t
(
h—d
, 
BAK
);

121 
TRUE
)

123 
	`mÚ£¬ch
(
h—d
, 
BAK
, 
Ãxp
);

124 
p
 = 
h—d
->
umh
.
mloc
;

125 ià(
Ãw
 =ğ
p
)

129 
q
 = (
mn_¡ªd¬d
)
p
->
uld
.
ldc
.
ÿ
;

130 
q
->
Ãxt
 = 
M
->
¡dbasis
;

131 
q
->
ismš
 = ()
FALSE
;

132 
M
->
n¡ªd¬d
--;

133 
M
->
¡dbasis
 = 
q
;

134 
	`mÚd–‘e
(
h—d
);

137 
	}
}

139 
	$IHmn_lcm
(
¬row
 
h—d
,‡¼ow *
Ãwh
, 
ex±”m
 
m
,‡¼ow 
mloc
)

141 
¬row
 
p
, 
Ãwh—d
;

142 
i
;

143 
ex±”m
 
Ãxp
;

145 ià((
h—d
 !ğ
NULL
è&& (h—d !ğh—d->
uld
.
lda
[
FOW
]))

147 
h—d
->
umh
.
mloc
 = head;

148 
h—d
->
umh
.
mii
 = 0;

149 ià(*
Ãwh
 =ğ
NULL
)

150 *
Ãwh
 = 
	`mÚÃwh—d
(
numv¬s
);

151 
Ãwh—d
 = *
Ãwh
;

152 (
p
 = 
	`mÚadv
(
h—d
, 
TRUE
)) != head)

154 ià(
p
 =ğ
mloc
)

157 
i
 = 0; i < 
numv¬s
; ++i)

158 
Ãxp
[
i
] = 
	`max_št
(
m
[i], 
p
->
umn
.
mexp
[i]);

159 ià(!
	`mÚadjoš
(
Ãwh—d
, 
Ãxp
, 
NULL
))

160 
Ãwh—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
 = 
p
->uld.ldc.ca;

163 
	}
}

165 
	$IHmo_š£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, 
mn_¡ªd¬d
 
bag
)

167 
ex±”m
 
m
;

168 
c
, 
Ën
, 
i
;

169 
¬¿y
 *
a
;

170 
¬¿y
 *
b
;

171 
¬row
 *
µ
, 
h—d
, 
Ãwh
, 
p
, 
Ãw–em
;

172 
mn_·œ
 *
q
, **
r
;

174 
a
 = &
M
->
mÚb
;

175 
b
 = &
M
->
mÚsyz
;

176 
c
 = 
	`tm_compÚ’t
(
m1
);

177 
	`sToExp
(
m1
, 
m
);

178 
Ën
 = 
	`Ëngth
(
a
);

179 ià(
Ën
 < 
c
)

180 
i
 = 
Ën
 + 1; i <ğ
c
; ++i)

181 *((**)
	`šs_¬¿y
(
a
)èğ
NULL
;

182 
µ
 = (
¬row
 *)
	`»f
(
a
, 
c
);

183 ià(*
µ
 =ğ
NULL
)

184 *
µ
 = 
	`mÚÃwh—d
(
numv¬s
);

185 
h—d
 = *
µ
;

187 
	`IHmn_adjoš
(
M
, 
h—d
, 
m
, (*)
bag
);

188 
Ãwh
 = 
NULL
;

189 
Ãw–em
 = 
h—d
->
umh
.
mloc
;

190 ià(
M
->
n¡ªd¬d
 > 1)

191 
	`IHmn_lcm
(
h—d
, &
Ãwh
, 
m
, 
Ãw–em
);

192 
	`IHmn_lcm
(
Rid—l
, &
Ãwh
, 
m
, 
Ãw–em
);

193 ià(
Ãwh
 !ğ
NULL
)

195 ià(
	`Ëngth
(
b
) == 0)

197 
r
 = (
mn_·œ
 **)
	`šs_¬¿y
(
b
);

198 *
r
 = 
NULL
;

201 
r
 = (
mn_·œ
 **)
	`»f
(
b
, 1);

202 
Ãwh
->
umh
.
mloc
 =‚ewh;

203 (
p
 = 
	`mÚadv
(
Ãwh
, 
TRUE
)) !=‚ewh)

205 
q
 = (
mn_·œ
 *)(*)
	`g‘_¦ug
((
¡ash
 *)
·œSsh
);

206 
q
->
id1
 = (*)
bag
;

207 
q
->
id2
 = (*)
p
->
uld
.
ldc
.
ÿ
;

208 
q
->
mµ
 = *
r
;

209 *
r
 = 
q
;

211 
	`mÚ»fund
(
Ãwh
);

213 
	}
}

215 
boŞ—n
 
	$IHmo_Ãxt_·œ
(
gm©rix
 
M
, 
mn_¡ªd¬d
 *
i
, mn_¡ªd¬d *
j
)

217 
¬¿y
 *
b
;

218 
mn_·œ
 **
p
, *
q
;

220 
b
 = &
M
->
mÚsyz
;

221 ià(
	`Ëngth
(
b
) == 0)

222  (
FALSE
);

223 
p
 = (
mn_·œ
 **)
	`»f
(
b
, 1);

224 (
q
 = *
p
è!ğ
NULL
)

226 #´agm¨
GCC
 
dŸgno¡ic
 
push


227 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-align"

228 *
i
 = (
mn_¡ªd¬d
)
q
->
id1
;

229 *
j
 = (
mn_¡ªd¬d
)
q
->
id2
;

230 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


231 *
p
 = 
q
->
mµ
;

232 
	`ä“_¦ug
((
¡ash
 *)
·œSsh
, (
¦ug
 *)
q
);

233 ià(!(((*
i
)->
ismš
è&& ((*
j
)->ismin)))

235  (
TRUE
);

237  (
FALSE
);

238 
	}
}

	@inhomog.h

5 
IHÜig_g’s
(
gm©rix
 
M
, 
štv®
, 
v¬ŸbË
* 
B
);

8 
boŞ—n
 
IHÿlc_¡ªd¬d
(
gm©rix
 
M
, 
v¬ŸbË
* 
B
);

11 
IH£nd_off
(
gm©rix
 
M
, 
v¬ŸbË
* 
B
, 
pŞy
 
h
,…Şy 
h»p
);

14 
IHšs_–em
(
gm©rix
 
M
, 
pŞy
 
h
,…Şy 
h»p
);

17 
IHmn_adjoš
(
gm©rix
 
M
, 
¬row
 
h—d
, 
ex±”m
 
Ãxp
, * 
bag
);

18 
IHmn_lcm
(
¬row
 
h—d
,‡¼ow* 
Ãwh
, 
ex±”m
 
m
,‡¼ow 
mloc
);

19 
IHmo_š£¹
(
gm©rix
 
M
, 
‹rm
 
m1
, 
mn_¡ªd¬d
 
bag
);

20 
boŞ—n
 
IHmo_Ãxt_·œ
(
gm©rix
 
M
, 
mn_¡ªd¬d
* 
i
, mn_¡ªd¬d* 
j
);

	@input.c

4 
	~<ùy³.h
>

5 
	~<¡dio.h
>

6 
	~<¡dlib.h
>

7 
	~<¡ršg.h
>

8 
	~<uni¡d.h
>

9 
	~"sh¬ed.h
"

10 
	~"šput.h
"

12 
	~"sh–l.h
"

13 
	~"mac.h
"

14 
	~"¡ash.h
"

15 
	~"mÚ™Ü.h
"

16 
	~"·r£.h
"

17 
	~"£t.h
"

18 
	~"dÙ_âs.h
"

19 
	~"d‘ach.h
"

22 
cÚ¡ex´
 
	gNVOICES
 = 50;

23 
cÚ¡ex´
 
	gNLEVELS
 = 12;

24 
cÚ¡ex´
 
	gNARGS
 = 40;

25 
cÚ¡ex´
 
	gNCHARS
 = 200;

26 
cÚ¡ex´
 
	gNNAMES
 = 200;

27 
cÚ¡ex´
 
	gVNAMES
 = 600;

28 
cÚ¡ex´
 
	gPROMPT1
 = '%';

29 
cÚ¡ex´
 
	gPROMPT2
 = '?';

32 
šlše
 
boŞ
 
	$eŞn
(
c
)

34  (
c
 == '\n' || c == '\r');

35 
	}
}

37 
šlše
 
boŞ
 
	$visibË
(
c
)

39  (
c
 > ' ' && c <= '~');

40 
	}
}

43 
	glšebuf
[
NCHARS
];

44 *
	g¬gv
[
NARGS
];

45 
	gcmd
 = 0, 
	gŞd_Ëv–
 = -1, 
	gcur_voiû
 = -1;

46 
	gvoiû
[
NLEVELS
];

47 
FILE
 *
	gfd
;

48 
FILE
 *
	gfj
;

49 
	gjf
;

50 
FILE
 *
	gf¡ack
[
NVOICES
];

51 
FILE
 *
	gj¡ack
[
NVOICES
];

52 
	gdÙæag
[
NVOICES
];

53 
	gjæag
[
NVOICES
];

54 
	gšam
, 
	gÂam
, 
	gšames
[
NVOICES
], 
	gÂames
[NVOICES], 
	gšdÇmes
[
NNAMES
];

55 
	gÇme¥aû
[
VNAMES
];

56 
	gtİ
, 
	g¢iff
;

58 
	gcom
 = 0;

59 
	g»mnuÎ
 = 0;

62 #ifdeà
MPWC


63 
	gcŞÚ
 = ':', 
	gcomma
 = ',';

65 
	gcŞÚ
 = '/', 
	gcomma
 = ':';

84 
	$£t_·th
(*
·th
)

86 
size_t
 
Ën
;

87 *
Şd
;

89 ià(
·th
 !ğ
NULL
)

91 
Şd
 = 
MşyP©h
;

92 ià(*
·th
 =ğ
comma
)

94 
Ën
 = 
	`¡¾’
(
·th
);

95 ià(
Ën
 > 1)

97 
Ën
 +ğ1 + 
	`¡¾’
(
Şd
);

98 
MşyP©h
 = 
	`gimmy
(()
Ën
);

99 
	`¥rštf
(
MşyP©h
, "%s%s", 
Şd
, 
·th
);

102 ià(*
·th
 != '\0')

104 
Ën
 = 1 + 
	`¡¾’
(
·th
);

105 
MşyP©h
 = 
	`gimmy
(()
Ën
);

106 
	`¥rštf
(
MşyP©h
, "%s", 
·th
);

109 
	}
}

111 
	$£t_cdœ
(*
cdœ
)

113 
size_t
 
Ën
;

115 ià(
cdœ
 !ğ
NULL
)

117 ià(
cdœ
[0] == '\0'

118 #ifdeà
MPWC


119 || (
cdœ
[0] == ':' && cdir[1] == '\0'))

121 || (
cdœ
[0] == '.' && cdir[1] == '\0'))

123 
MşyCdœ
 = 
NULL
;

126 
Ën
 = 1 + 
	`¡¾’
(
cdœ
);

127 
MşyCdœ
 = 
	`gimmy
(()
Ën
);

128 
	`¥rštf
(
MşyCdœ
, "%s", 
cdœ
);

131 
	}
}

133 
	$š™_·th
()

135 
cÚ¡ex´
 
NN
 = 1024;

136 *
·th
, *
cdœ
, 
·ths
[
NN
];

137 
FILE
 *
å
;

138 
c
, 
i
, 
m
;

140 
·th
 = 
	`g‘’v
("MacaulayPath");

141 
	`£t_·th
(
·th
);

143 
cdœ
 = 
	`g‘’v
("MacaulayCdir");

144 
	`£t_cdœ
(
cdœ
);

146 
å
 = 
	`tİ’
("Macaulay.path", "r");

147 ià(
å
 !ğ
NULL
)

149 
i
 = 0, 
m
 = 0; (
c
 = 
	`fg‘c
(
å
)è!ğ
EOF
;)

151 ià(
i
 =ğ
NN
 - 1)

153 
	`´”rÜ
(";…athruncated");

156 ià(
c
 == '\n')

157 
c
 = 
comma
;

158 ià(
c
 !ğ
comma
)

159 
m
 = 
i
;

160 ià(
i
 =ğ
m
 || i == m + 1)

161 
·ths
[
i
++] = ()
c
;

163 
·ths
[
m
 + 1] = '\0';

164 
	`£t_·th
(
·ths
);

165 
	`fşo£
(
å
);

168 
å
 = 
	`tİ’
("Macaulay.cdir", "r");

169 ià(
å
 !ğ
NULL
)

171 
i
 = 0; (
c
 = 
	`fg‘c
(
å
)è!ğ
EOF
; ++i)

173 ià(
i
 =ğ
NN
 - 1)

175 
	`´”rÜ
("; cdirruncated");

178 ià(
c
 == '\n')

180 
·ths
[
i
] = ()
c
;

182 
·ths
[
i
] = '\0';

183 
	`£t_cdœ
(
·ths
);

184 
	`fşo£
(
å
);

186 
	}
}

188 
	$·th_cmd
(
¬gc
, *
av
[])

190 
·th
[1024], *
s
;

192 ià(
¬gc
 != 2)

194 
	`´šŠew
("path <path> (to„eplace)\n");

195 #ifdeà
MPWC


196 
	`´šŠew
("path <,path> (to‡ppend)\n");

198 
	`´šŠew
("path <:path> (to‡ppend)\n");

202 
	`£t_·th
(
av
[1]);

205 ià(
MşyP©h
 !ğ
NULL
)

207 ià(
¬gc
 != 2)

208 
	`´št
("\n");

209 
	`¡ºıy
(
·th
, 
MşyP©h
, 1023);

210 
·th
[1023] = '\0';

211 
s
 = 
·th
; *s != '\0'; ++s)

212 ià(*
s
 =ğ
comma
)

213 *
s
 = '\n';

214 
	`´št
("%s\n", 
·th
);

216 
	}
}

218 
	$cdœ_cmd
(
¬gc
, *
av
[])

220 ià(
¬gc
 != 2)

222 
	`´šŠew
("cdir <prefix> (to set)\n");

223 #ifdeà
MPWC


224 
	`´šŠew
("cdir : (to clear)\n");

226 
	`´šŠew
("cdir . (to clear)\n");

228 ià(
MşyCdœ
 !ğ
NULL
)

229 
	`´št
("\n%s\n", 
MşyCdœ
);

232 
	`£t_cdœ
(
av
[1]);

233 
	}
}

235 *
	$fe_Çme
(cÚ¡ *
Çme
, cÚ¡ *
´efix
, 
´–’
)

237 
size_t
 
Çm–’
;

238 *
fuÎÇme
;

240 
Çm–’
 = 
	`¡¾’
(
Çme
);

241 
fuÎÇme
 = 
	`gimmy
(()(
´–’
 + ()
Çm–’
 + 2));

242 #ifdeà
MPWC


243 ià(
´–’
 > 1)

245 
	`¡ºıy
(
fuÎÇme
, 
´efix
, (
size_t
)
´–’
);

246 
	`¡ºıy
(
fuÎÇme
 + 
´–’
, 
Çme
, 
Çm–’
 + 1);

249 ià(
´–’
 > 0)

251 
	`¡ºıy
(
fuÎÇme
, 
´efix
, (
size_t
)
´–’
);

252 
fuÎÇme
[
´–’
] = 
cŞÚ
;

253 
	`¡ºıy
(
fuÎÇme
 + 
´–’
 + 1, 
Çme
, 
Çm–’
 + 1);

258 
	`¡ºıy
(
fuÎÇme
, 
Çme
, 
Çm–’
 + 1);

260  
fuÎÇme
;

261 
	}
}

263 
FILE
 *
	$tİ’
(cÚ¡ *
feName
, cÚ¡ *
mode
)

265 #ifdeà
MPWC


268 
pos
, 
Úû
;

269 
FILE
 *
å
;

270 *
·th
, *
âame
, *
¥os
;

272 
å
 = 
NULL
;

273 
Úû
 = 0;

274 ià(
MşyCdœ
 !ğ
NULL
 && 
	`¡rchr
(
feName
, 
cŞÚ
) == NULL)

276 
pos
 = ()
	`¡¾’
(
MşyCdœ
);

277 
âame
 = 
	`fe_Çme
(
feName
, 
MşyCdœ
, 
pos
);

278 
å
 = 
	`fİ’
(
âame
, 
mode
);

279 
	`ungimmy
(
âame
);

280 
Úû
 = 1;

282 ià(
å
 =ğ
NULL
)

284 ià(*
mode
 =ğ'r' && 
MşyP©h
 !ğ
NULL
 && *MclyPath != '\0' &&

285 
	`¡rchr
(
feName
, 
cŞÚ
è=ğ
NULL
)

288 
·th
 = 
MşyP©h
;

291 ià(*
·th
 == '\0')

293 
¥os
 = 
	`¡rchr
(
·th
, 
comma
);

294 ià(
¥os
 =ğ
NULL
)

295 
pos
 = ()
	`¡¾’
(
·th
);

297 
pos
 = ()(
¥os
 - 
·th
);

298 
âame
 = 
	`fe_Çme
(
feName
, 
·th
, 
pos
);

299 
å
 = 
	`fİ’
(
âame
, 
mode
);

300 
	`ungimmy
(
âame
);

301 
Úû
 = 1;

302 ià(
å
 !ğ
NULL
 || 
·th
[
pos
] == '\0')

304 
·th
 +ğ
pos
 + 1;

307 ià(!
Úû
)

309 
å
 = 
	`fİ’
(
feName
, 
mode
);

313 #ifdeà
MPWC


316  
å
;

317 
	}
}

319 
	$¢iff_´Ëv–
(*
lb
)

321 
´Ëv
[] = "set…rlevel 1";

324 ià(
	`¡rcmp
(
lb
, 
´Ëv
è=ğ0 || (
	`¡ºcmp
(lb, "incr", 4) == 0 && strcmp(lb + 5,…rlev) == 0))

326 
¢iff
 = 1;

327 ++
´Ëv–
;

330 
¢iff
 = 0;

331 
	}
}

333 
	$un¢iff_´Ëv–
()

335 ià(
¢iff
 == 1)

336 --
´Ëv–
;

337 
	}
}

340 
	$b»ak_voiû
()

342 ià(
cur_voiû
 > 0)

343 
	`drİ_voiû
();

344 
	}
}

346 
	$drİ_voiû
()

348 ià(
cur_voiû
 > 0)

350 ià(
fd
 !ğ
¡dš
)

351 
	`fşo£
(
fd
);

352 ià(
fj
 !ğ
NULL
)

353 
	`fşo£
(
fj
);

354 
voiû
[
Ëv–
] = --
cur_voiû
;

355 
fd
 = 
f¡ack
[
cur_voiû
];

356 
fj
 = 
j¡ack
[
cur_voiû
];

357 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
];

358 
jf
 = 
jæag
[
cur_voiû
];

359 
šam
 = 
šames
[
cur_voiû
];

360 
Âam
 = 
Âames
[
cur_voiû
];

364 
	`´št
("end of file ($)„eceived,ƒxiting Macaulay\n");

365 
	`ex™MaÿuÏy
();

367 
	}
}

369 
	$chªge_Ëv–
()

371 
i
;

373 ià(
Ëv–
 >ğ
NLEVELS
)

375 ià(
Ëv–
 < 0)

377 
i
 = 0; i <ğ
cur_voiû
; ++i)

379 ià(
f¡ack
[
i
] !ğ
¡dš
)

380 
	`fşo£
(
f¡ack
[
i
]);

381 ià(
j¡ack
[
i
] !ğ
NULL
)

382 
	`fşo£
(
j¡ack
[
i
]);

384 
Şd_Ëv–
 = -1;

385 
cur_voiû
 = -1;

388 ià(
Ëv–
 < 
Şd_Ëv–
)

390 
i
 = 
voiû
[
Ëv–
] + 1; i <ğ
cur_voiû
; ++i)

392 ià(
f¡ack
[
i
] !ğ
¡dš
)

393 
	`fşo£
(
f¡ack
[
i
]);

394 ià(
j¡ack
[
i
] !ğ
NULL
)

395 
	`fşo£
(
j¡ack
[
i
]);

397 
cur_voiû
 = 
voiû
[
Ëv–
];

398 
fd
 = 
f¡ack
[
cur_voiû
];

399 
fj
 = 
j¡ack
[
cur_voiû
];

400 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
];

401 
jf
 = 
jæag
[
cur_voiû
];

402 
šam
 = 
šames
[
cur_voiû
];

403 
Âam
 = 
Âames
[
cur_voiû
];

405 ià(
Ëv–
 > 
Şd_Ëv–
)

407 
voiû
[
Ëv–
] = ++
cur_voiû
;

408 
fd
 = 
f¡ack
[
cur_voiû
] = 
¡dš
;

409 
fj
 = 
j¡ack
[
cur_voiû
] = 
NULL
;

410 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
] = 0;

411 
jf
 = 
jæag
[
cur_voiû
] = 0;

412 ià(
Ëv–
 == 0)

413 
šam
 = 
šames
[
cur_voiû
] = 0;

415 
šam
 = 
šames
[
cur_voiû
] = iÇm + 
Âam
;

416 
Âam
 = 
Âames
[
cur_voiû
] = 0;

418 
Şd_Ëv–
 = 
Ëv–
;

420 
	}
}

422 
	$´om±
()

424 
i
;

426 ià(!
com
)

427 
i
 = 1; i <ğ
Æšes
; i++)

428 
	`´št
("\n");

429 
i
 = 0; i <ğ
Ëv–
; ++i)

431 ià(
dÙæag
[
voiû
[
i
]])

433 ià(
dÙæag
[
voiû
[
i
]] == 1)

434 
	`´št
(".");

436 
	`´št
("?");

438 ià(
voiû
[
i
] > 0)

439 
	`´št
("%d", 
voiû
[
i
]);

440 
	`´št
("%% ");

442 
	`fæush
(
¡dout
);

443 
	}
}

445 
	$g‘_ch¬s
(
FILE
 *
å
, *
a
)

449 
c
, 
i
 = 0, 
æag
 = 0;

450 
comm’t
 = 0, 
dŞÏr
 = 0;

452 
c
 = 
	`g‘c
(
å
), !
	`eŞn
(()c))

454 ià(
c
 == '$')

455 
dŞÏr
 = 1;

456 ià(
c
 == ';')

457 
comm’t
 = 1;

458 ià(!
comm’t
 && (
c
 =ğ
PROMPT1
 || c =ğ
PROMPT2
))

460 
i
 = 0;

461 
æag
 = 1;

464 ià(
i
 =ğ0 && (
c
 == ' ' || c == '\t'))

466 ià(
i
 < 
NCHARS
 - 1)

467 
a
[
i
++] = ()
c
;

469 ià((
c
 =ğ
EOF
 && 
i
 =ğ0è|| (
dŞÏr
 == 1))

470 
i
 = 0, 
a
[i++] = '$';

471 
a
[
i
] = '\0';

472  
æag
;

473 
	}
}

475 
	$¿w_lše
()

477 
i
, 
Ãw
 = 1;

478 #ifdeà
MPWC


479 
pæag
;

481 
u£rch¬s
[
NCHARS
], *
p
;

483 
begšnšg
:

486 ià(
Ãw
 == 0)

487 
	`drİ_voiû
();

488 
Ãw
 = 0;

489 ià(
cmd
 && 
fd
 =ğ
¡dš
 && !
»mnuÎ
)

490 
	`´om±
();

491 #ifdeà
MPWC


492 
pæag
 = 
	`g‘_ch¬s
(
fd
, 
lšebuf
);

494 
	`g‘_ch¬s
(
fd
, 
lšebuf
);

496 
»mnuÎ
 = (
cmd
 && 
lšebuf
[0] == '\0') ? 1 : 0;

497 #ifdeà
MPWC


498 #iâdeà
SIOW


499 ià(
pæag
 == 0)

501 ià(
fd
 =ğ
¡dš
 && !
»mnuÎ
)

502 
	`´št
("%s\n", 
lšebuf
);

506 } 
lšebuf
[0] == '$');

507 
	`¢iff_´Ëv–
(
lšebuf
);

508 ià(
fj
 !ğ
NULL
 && !
»mnuÎ
)

509 
	`åršt
(
fj
, "%s\n", 
lšebuf
);

510 
	`subs_Çmes
();

511 ià(
lšebuf
[0] =ğ'?' && (lšebuf[1] =ğ'\0' || 
	`is¥aû
(linebuf[1])))

513 ià(
cmd
)

514 
	`´om±
();

516 
	`´šput
("?");

517 
	`g‘_ch¬s
(
¡dš
, 
lšebuf
);

518 
	`subs_Çmes
();

520 ià(
fd
 !ğ
¡dš
)

522 ià(
cmd
 && !
»mnuÎ
)

524 ià(
lšebuf
[0] != ';')

525 
	`´om±
();

526 ià(!
com
)

527 
i
 = 1; i <ğ
Æšes
; i++)

528 
	`´št
("\n");

530 ià(!
»mnuÎ
)

531 
	`´št
("%s", 
lšebuf
);

532 ià(
jf
 && 
lšebuf
[0] != '\0' &&†inebuf[0] != ';')

534 
	`´št
(" ");

535 
	`g‘_ch¬s
(
¡dš
, 
u£rch¬s
);

536 
p
 = 
u£rch¬s
;…[1] != '\0'; ++p)

538 ià(*
p
 == '$')

539 
begšnšg
;

540 ià(*
p
 == '&')

541 
	`debug_voiû
();

542 ià(*
p
 == '!')

543 
jf
 = 
jæag
[
cur_voiû
] = 0;

545 ià(!
»mnuÎ
)

546 
	`´št
("\n");

548 ià(
fd
 =ğ
¡dš
)

550 ià(
echo
 > 0)

552 ià(!
»mnuÎ
)

554 
	`´št
("%s\n", 
lšebuf
);

556 ià(!
	`i§‰y
(
	`f’o
(
¡dš
)))

558 
	`u¦“p
(100000);

563 #ifdeà
MPWC


564 ià(
pæag
 == 1)

565 
	`mÚ´št
("%s\n", 
lšebuf
);

567 
	`mÚ´št
("%s\n", 
lšebuf
);

571 
	`un¢iff_´Ëv–
();

572 
	}
}

574 
	$g‘_lše
(*
·rgc
, ***
·rgv
)

576 
i
;

577 *
s
;

579 
	`¿w_lše
();

580 
i
 = 0, 
s
 = 
lšebuf
; i < 
NARGS
;)

582 !
	`visibË
(*
s
) && *s != '\0')

583 ++
s
;

584 ià(*
s
 == '\0' || *s == ';')

586 
¬gv
[
i
++] = 
s
++;

587 
	`visibË
(*
s
))

588 ++
s
;

589 ià(*
s
 == '\0')

591 *
s
++ = '\0';

593 *
·rgc
 = 
i
;

594 *
·rgv
 = 
¬gv
;

595 
	}
}

597 
	$İ’_jouº®
(*
s
)

599 
FILE
 *
Ãwfj
;

601 ià(
voiû
[
Ëv–
] =ğ
NVOICES
 - 1)

603 
	`´”rÜ
("; >>% ignÜed, ouˆoàšpuˆvoiûs\n", 
s
);

606 
Ãwfj
 = 
	`tİ’
(
s
, "w");

607 ià(
Ãwfj
 =ğ
NULL
)

609 
	`´”rÜ
("; >>% ignÜed,ƒ¼Ü iÀİ’šg fe\n", 
s
);

612 
voiû
[
Ëv–
] = ++
cur_voiû
;

613 
fd
 = 
f¡ack
[
cur_voiû
] = 
¡dš
;

614 
fj
 = 
j¡ack
[
cur_voiû
] = 
Ãwfj
;

615 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
] = 0;

616 
jf
 = 
jæag
[
cur_voiû
] = 0;

617 
šam
 = 
šames
[
cur_voiû
] = iÇm + 
Âam
;

618 
Âam
 = 
Âames
[
cur_voiû
] = 0;

620 
	}
}

622 
	$debug_voiû
()

624 ià(
voiû
[
Ëv–
] =ğ
NVOICES
 - 1)

626 
	`´št
("< ignored, out of input voices\n");

629 
voiû
[
Ëv–
] = ++
cur_voiû
;

630 
fd
 = 
f¡ack
[
cur_voiû
] = 
¡dš
;

631 
fj
 = 
j¡ack
[
cur_voiû
] = 
NULL
;

632 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
] = 0;

633 
jf
 = 
jæag
[
cur_voiû
] = 0;

634 
šam
 = 
šames
[
cur_voiû
] = iÇm + 
Âam
;

635 
Âam
 = 
Âames
[
cur_voiû
] = 0;

637 
	}
}

639 
	$İ’_tour
(cÚ¡ *
s
)

641 
FILE
 *
Ãwfd
;

642 
Ãwjf
;

644 ià(
voiû
[
Ëv–
] =ğ
NVOICES
 - 1)

646 
	`´”rÜ
("; <% ignÜed, ouˆoàšpuˆvoiûs\n", 
s
);

649 
Ãwjf
 = (*
s
 == '<') ? 1 : 0;

650 
Ãwjf
 = 
jf
 ? 1 :‚ewjf;

651 ià(*
s
 == '<')

652 ++
s
;

653 
Ãwfd
 = 
	`tİ’
(
s
, "r");

654 ià(
Ãwfd
 =ğ
NULL
)

656 
	`´”rÜ
("; <% ignÜed,ƒ¼Ü iÀİ’šg fe\n", 
s
);

659 
voiû
[
Ëv–
] = ++
cur_voiû
;

660 
fd
 = 
f¡ack
[
cur_voiû
] = 
Ãwfd
;

661 
fj
 = 
j¡ack
[
cur_voiû
] = 
NULL
;

662 
š_dÙ_cmd_mode
 = 
dÙæag
[
cur_voiû
] = 0;

663 
jf
 = 
jæag
[
cur_voiû
] = 
Ãwjf
;

664 
šam
 = 
šames
[
cur_voiû
] = iÇm + 
Âam
;

665 
Âam
 = 
Âames
[
cur_voiû
] = 0;

667 
	}
}

669 
	$£t_Çmes
(
ac
, **
av
)

671 
i
, 
Ën
;

673 ià(
cur_voiû
 == 0)

674 
tİ
 = 0;

677 
tİ
 = 
šames
[
cur_voiû
 - 1] + 
Âames
[cur_voice - 1];

678 ià(
tİ
 > 0)

679 
tİ
 = 
šdÇmes
[tİ - 1] + ()
	`¡¾’
(
Çme¥aû
 + indnames[top - 1]) + 1;

681 
i
 = 1; i < 
ac
; ++i)

683 
Ën
 = ()
	`¡¾’
(
av
[
i
]);

684 ià(
tİ
 >ğ
VNAMES
 - 
Ën
 - 1 || 
šam
 + 
Âam
 >ğ
NNAMES
)

686 
	`´št
("Ouˆoà¥aû; ignÜšg %s\n", 
av
[
i
]);

689 
šdÇmes
[
šam
 + 
Âam
++] = 
tİ
;

690 
	`¡rıy
(
Çme¥aû
 + 
tİ
, 
av
[
i
]);

691 
tİ
 +ğ
Ën
 + 1;

693 
Âames
[
cur_voiû
] = 
Âam
;

694 
	}
}

696 
	$subs_Çmes
()

698 
Ën
, 
i
, 
še
, 
two
;

699 *
p
, *
q
, *
r
, *
s
, 
·rm
[
NCHARS
], 
©
[6];

701 
p
 = 
lšebuf
; *p != '\0'; ++p)

703 ià((*
p
 == '@') &&

704 !(
p
 - 
lšebuf
 >ğ3 &&…[-3] =ğ'@' && 
	`isdig™
(p[-2]) && isdigit(p[-1])) &&

705 !(
	`¡¾’
(
p
è>ğ3 &&…[3] =ğ'@' && 
	`isdig™
(p[2]) && isdigit(p[1])))

707 
Ën
 = 4;

708 
še
 = ()
	`¡¾’
(
lšebuf
);

709 ià(
še
 >ğ
NCHARS
 - 
Ën
 + 1)

711 
	`´št
("out of space; ");

712 
	`´št
("no substitution made for @\n");

715 
r
 = 
lšebuf
 + 
še
, 
s
 =„ + 
Ën
 - 1;„ !ğ
p
; --r, --s)

716 *
s
 = *
r
;

717 ià(
fd
 =ğ
¡dš
 && 
fj
 =ğ
NULL
)

719 ià(
voiû
[
Ëv–
] > 0)

720 
	`¢´štf
(
©
, ×t), "@%02d@", (
voiû
[
Ëv–
] - 1) % 100);

722 
	`¢´štf
(
©
, ×t), "@%02d@", (
voiû
[
Ëv–
] + 1) % 100);

725 
	`¢´štf
(
©
, ×t), "@%02d@", 
voiû
[
Ëv–
] % 100);

726 
q
 = 
©
;

727 ; *
q
 !ğ'\0'; ++
p
, ++q)

728 *
p
 = *
q
;

729 --
p
;

733 
cÚ¡ex´
 
ZIP
 = -31991;

734 
p
 = 
lšebuf
; *p != '\0'; ++p)

736 ià(*
p
 == '#')

738 ià(
	`isdig™
(
p
[1]))

740 
i
 = 
p
[1] - '0';

741 ià(
i
 == 0)

742 
i
 = 
ZIP
;

743 
two
 = 2;

745 ià(
p
[1] == '(')

747 
i
 = 0, 
q
 = 
p
 + 2, 
r
 = 
·rm
; (*q != '\0') && (i > 0 || *q != ')'); ++q, ++r)

749 ià(*
q
 == '(')

750 ++
i
;

751 ià(*
q
 == ')')

752 --
i
;

753 *
r
 = *
q
;

755 ià(*
q
 == '\0')

756 --
q
;

757 *
r
 = '\0';

758 
r
 = 
·rm
;

759 
i
 = 
	`·r£IÁ
(&
r
);

760 
two
 = ()(
q
 - 
p
 + 1);

764 
r
 = 
p
 + 1;

765 
i
 = 
	`·r£IÁ
(&
r
);

766 
two
 = ()(
r
 - 
p
);

769 ià(
i
 =ğ
ZIP
)

772 
	`¥rštf
(
·rm
, "%d", 
Âam
);

773 
q
 = 
·rm
;

775 ià(
i
 > 
Âam
)

777 
·rm
[0] = '\0';

778 
q
 = 
·rm
;

780 ià(
i
 < 1)

785 
q
 = 
Çme¥aû
 + 
šdÇmes
[
šam
 + 
i
 - 1];

787 
Ën
 = ()
	`¡¾’
(
q
);

788 ià(
Ën
 < 
two
)

790 
r
 = 
p
 + 
two
, 
s
 =… + 
Ën
; *s = *r, *r != '\0'; ++r, ++s)

793 ià(
Ën
 > 
two
)

795 
še
 = ()
	`¡¾’
(
lšebuf
);

796 ià(
še
 + 
Ën
 - 
two
 >ğ
NCHARS
)

798 
	`´št
("out of space; ");

799 
	`´št
("nØsub¡™utiÚ madfÜ #%d\n", 
i
);

802 
r
 = 
lšebuf
 + 
še
, 
s
 =„ + 
Ën
 - 
two
;„ !ğ
p
; --r, --s)

803 *
s
 = *
r
;

805 ; *
q
 !ğ'\0'; ++
p
, ++q)

806 *
p
 = *
q
;

807 --
p
;

810 
	}
}

812 
	$g‘_cmd_lše
(*
·rgc
, ***
·rgv
, **
poutfe
)

814 
i
, 
ac
;

815 *
s
, **
av
;

816 
go_agaš
;

818 
cmd
 = 1;

819 *
poutfe
 = 
NULL
;

822 
	`g‘_lše
(&
ac
, &
av
);

825 ià(
ac
 > 0 && 
av
[0][
	`¡¾’
(av[0]) - 1] == ':')

827 --
ac
;

828 ++
av
;

831 
com
 = 
lšebuf
[0] == ';' ? 1 : 0;

832 ià(
ac
 == 0)

834 ià(
av
[0][0] == '>' &&‡v[0][1] == '>')

836 ià(
	`İ’_jouº®
(
av
[0] + 2))

837 
	`£t_Çmes
(
ac
, 
av
);

838 
ac
 = 0;

842 
go_agaš
 = 0;

843 
i
 = 0; i < 
ac
; ++i)

845 ià(
av
[
i
][0] == '<')

847 ià(
	`İ’_tour
(
av
[
i
] + 1))

848 
	`£t_Çmes
(
ac
 - 
i
, 
av
 + i);

849 
ac
 = 
i
;

850 
go_agaš
 = 1;

853 ià(
av
[
i
][0] == '>' &&‡v[i][1] == '>')

855 ià(
	`İ’_jouº®
(
av
[
i
] + 2))

856 
	`£t_Çmes
(
ac
 - 
i
, 
av
 + i);

857 
ac
 = 
i
;

858 
go_agaš
 = 1;

862 ià(
go_agaš
)

865 
s
 = 
av
[
ac
 - 1];

866 ià(*
s
 == '>')

868 --
ac
;

869 *
poutfe
 = ++
s
;

871 } 
ac
 == 0);

872 
cmd
 = 0;

874 *
·rgc
 = 
ac
;

875 *
·rgv
 = 
av
;

876 
	}
}

878 
	$b¿nch
(*
Ïb–
)

881 
size_t
 
Ën
;

882 
buf
[
NCHARS
], *
p
;

884 
Ën
 = 
	`¡¾’
(
Ïb–
);

885 
	`f£ek
(
fd
, 0L, 0);

888 ià(
	`fg‘s
(
buf
, 
NCHARS
 - 1, 
fd
è=ğ
NULL
)

890 
p
 = 
buf
; 
	`is¥aû
(*p); ++p)

892 ià(
p
[
Ën
] =ğ':' && 
	`¡ºcmp
(
Ïb–
,…,†en) == 0)

894 
Ën
 = 
	`¡¾’
(
buf
);

897 
	`f£ek
(
fd
, -()
Ën
, 1);

901 
	}
}

903 
	$if_cmd
(
¬gc
, *
av
[])

905 
‹¡
;

907 ià(
¬gc
 < 3 ||‡rgc > 4)

909 
	`´šŠew
("if <integer> <label1> [<label2>]\n");

910 
	`´šŠew
("if integer != 0hen jumpo†abel1: [else jumpo†abel2: ]\n");

912 ià(
fd
 =ğ
¡dš
)

913 
	`´šŠew
("if statements onlyakeƒffect inside scripts\n");

916 
‹¡
 = 
	`g‘IÁ
(
av
[1]);

917 ià(
‹¡
 != 0)

918 
	`b¿nch
(
av
[2]);

919 ià(
¬gc
 == 4)

920 
	`b¿nch
(
av
[3]);

922 
	}
}

924 
	$jump_cmd
(
¬gc
, *
av
[])

926 ià(
¬gc
 != 2)

928 
	`´šŠew
("jump <label>\n");

929 
	`´šŠew
("jumpo†abel: in current input script\n");

931 ià(
fd
 =ğ
¡dš
)

932 
	`´šŠew
("jump statements onlyakeƒffect inside scripts\n");

934 
	`b¿nch
(
av
[1]);

935 
	}
}

	@input.h

5 
š™_·th
();

6 
·th_cmd
(
¬gc
, *
¬gv
[]);

7 
cdœ_cmd
(
¬gc
, *
¬gv
[]);

8 
FILE
 *
tİ’
(cÚ¡ *
feName
, cÚ¡ *
mode
);

9 
g‘_lše
(*
·rgc
, ***
·rgv
);

10 
g‘_cmd_lše
(*
·rgc
, ***
·rgv
, **
poutfe
);

11 
¿w_lše
();

12 
g‘_ch¬s
(
FILE
 *
å
, *
a
);

13 
´om±
();

14 
chªge_Ëv–
();

15 
drİ_voiû
();

16 
b»ak_voiû
();

17 
İ’_jouº®
(*
s
);

18 
İ’_tour
(cÚ¡ *
s
);

19 
debug_voiû
();

20 
£t_Çmes
(
ac
, **
av
);

21 
subs_Çmes
();

22 
b¿nch
(*
Ïb–
);

23 
if_cmd
(
¬gc
, *
¬gv
[]);

24 
jump_cmd
(
¬gc
, *
¬gv
[]);

25 
¢iff_´Ëv–
(*
lb
);

26 
un¢iff_´Ëv–
();

29 
lšebuf
[];

30 *
¬gv
[];

31 
cmd
;

32 
com
;

33 
»mnuÎ
;

34 
FILE
 *
fd
;

35 
FILE
 *
fj
;

36 
jf
;

37 
cur_voiû
;

38 
dÙæag
[];

	@intersect.c

4 
	~"sh¬ed.h
"

5 
	~"š‹r£ù.h
"

6 
	~"cmds.h
"

7 
	~"gm©rix.h
"

8 
	~"gm_pŞy.h
"

9 
	~"humª_io.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"¶i¡.h
"

12 
	~"pŞy.h
"

13 
	~"»scmds.h
"

14 
	~"£t.h
"

15 
	~"v¬s.h
"

16 
	~"gm_dli¡.h
"

17 
	~"g’”ic.h
"

22 
gm©rix
 
	$mkš‹r£ù
(
dli¡
* 
dl
)

24 
gm©rix
 
»suÉ
;

25 
i
;

27 
»suÉ
 = 
	`mod_š™
();

28 
	`dl_cİy
(
dl
, &
»suÉ
->
degg’s
);

29 
i
 = 1; i <ğ
	`Ëngth
(
dl
); i++)

30 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
NULL
);

31  
»suÉ
;

32 
	}
}

34 
	$addš‹r£ù
(
gm©rix
 
»suÉ
, gm©rix 
M
, 
dli¡
* 
dl
)

36 
i
, 
shiáv®
;

37 
pŞy
 
f
, 
g
;

39 
shiáv®
 = 
	`Äows
(
»suÉ
);

41 
i
 = 1; i <ğ
	`Ëngth
(
dl
); i++)

43 
	`dli¡_š£¹
(&
»suÉ
->
deg»es
, 
	`dli¡_»f
(
dl
, 
i
));

44 
f
 = 
	`¶i¡_»f
(&
»suÉ
->
g’s
, 
i
);

45 
g
 = 
	`e_sub_i
(
shiáv®
 + 
i
);

46 
	`p_add
(&
f
, &
g
);

47 *
	`¶i¡_»f_±r
(&
»suÉ
->
g’s
, 
i
èğ
f
;

50 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

51 
	`gmIn£¹
(
»suÉ
, 
	`compshiá
(
	`¶i¡_»f
(&
M
->
g’s
, 
i
), 
shiáv®
));

52 
	}
}

54 
gm©rix
 
	$mkquÙ›Á
()

56 
gm©rix
 
»suÉ
;

58 
»suÉ
 = 
	`mod_š™
();

59 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 0);

60 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
NULL
);

61  
»suÉ
;

62 
	}
}

64 
	$addquÙ›Á
(
gm©rix
 
»suÉ
, gm©rix 
I
, gm©rix 
J
, 
n
)

66 
i
, 
j
, 
k
, 
shiáv®
;

67 
pŞy
 
f
, 
g
;

69 
i
 = 1; i <ğ
	`ncŞs
(
J
); i++)

71 
shiáv®
 = 
	`Äows
(
»suÉ
);

72 
f
 = 
	`¶i¡_»f
(&
J
->
g’s
, 
i
);

73 
k
 = 1; k <ğ
n
; k++)

75 
g
 = 
	`compshiá
(
f
, 
shiáv®
 + 
k
 - 1);

76 
	`p_add
(
	`¶i¡_»f_±r
(&
»suÉ
->
g’s
, 
k
), &
g
);

78 
	`dl_addto
(&
»suÉ
->
deg»es
, -
	`deg»e
(
J
, 
f
), &
I
->degrees);

79 
j
 = 1; j <ğ
	`ncŞs
(
I
); j++)

80 
	`gmIn£¹
(
»suÉ
, 
	`compshiá
(
	`¶i¡_»f
(&
I
->
g’s
, 
j
), 
shiáv®
));

82 
	}
}

84 
	$š‹r_cmd
(
¬gc
, * 
¬gv
[])

86 
v¬ŸbË
* 
p
;

87 
gm©rix
 
M
, 
g
;

88 
i
, 
n
;

89 
dli¡
* 
dl
;

91 ià(
¬gc
 < 3)

93 
	`´šŠew
("intersect <mat 1> ... <mat‚> <result computation>\n");

96 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

98 
	`´šŠew
("Error: invalid module\n");

101 
n
 = 
	`Äows
(
M
);

102 
dl
 = &
M
->
deg»es
;

103 
i
 = 1; i < 
¬gc
 - 1; i++)

105 ià((
M
 = 
	`vg‘_rgmod
(
¬gv
[
i
])è=ğ
NULL
)

107 
	`´šŠew
("Error: invalid module\n");

110 ià(
n
 < 
	`Äows
(
M
))

112 
	`´”rÜ
("; matrices have different‚umbers of„ows\n");

116 
g
 = 
	`mkš‹r£ù
(
dl
);

117 
i
 = 1; i < 
¬gc
 - 1; i++)

119 ià((
M
 = 
	`vg‘_rgmod
(
¬gv
[
i
])è=ğ
NULL
)

121 
	`´šŠew
("Error: invalid module\n");

124 
	`addš‹r£ù
(
g
, 
M
, 
dl
);

129 ià(!
	`check_homog
(
g
))

131 
	`´”rÜ
(";ƒither degrees of„ows‡re‚othe same forƒach matrix ");

132 
	`´”rÜ
("or one ofhese is‚ot homogeneous\n");

133 
	`´”rÜ
("; setting ");

134 
	`´”rÜ
(
¬gv
[
¬gc
 - 1]);

135 
	`´”rÜ
("o‡uxiliary matrix\n");

136 
p
 = 
	`make_v¬
(
¬gv
[
¬gc
 - 1], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

137 
	`£t_v®ue
(
p
, 
g
);

141 ()
	`syz
(
¬gv
[
¬gc
 - 1], 
g
, 
n
);

142 
	`doAutoÿlc
(
¬gv
[
¬gc
 - 1]);

143 
	}
}

145 
boŞ—n
 
	$isId—l
(
gm©rix
 
g
)

147 ià(
	`Äows
(
g
) != 1)

148  
çl£
;

149 ià(
	`dli¡_»f
(&
g
->
deg»es
, 1) != 0)

150  
çl£
;

151  
Œue
;

152 
	}
}

154 
	$quÙ_cmd
(
¬gc
, * 
¬gv
[])

156 
gm©rix
 
I
, 
J
, 
g
;

157 
n
;

158 
v¬ŸbË
* 
p
;

160 ià(
¬gc
 != 4)

162 
	`´šŠew
("quotient <matrix I> <matrix J> <result computation I:J>\n");

166 ià((
I
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

168 
	`´šŠew
("Error: invalid module\n");

171 ià((
J
 = 
	`vg‘_rgmod
(
¬gv
[2])è=ğ
NULL
)

173 
	`´šŠew
("Error: invalid module\n");

176 ià(
	`isId—l
(
J
))

178 
n
 = 
	`Ëngth
(&
I
->
deg»es
);

179 
g
 = 
	`mkš‹r£ù
(&
I
->
deg»es
);

183 
n
 = 1;

184 
g
 = 
	`mkquÙ›Á
();

186 
	`addquÙ›Á
(
g
, 
I
, 
J
, 
n
);

193 ià(!
	`check_homog
(
g
))

195 
	`´”rÜ
(";ƒither degrees of„ows‡re‚othe same forƒach matrix ");

196 
	`´”rÜ
("or one ofhese is‚ot homogeneous\n");

197 
	`´”rÜ
("; setting ");

198 
	`´”rÜ
(
¬gv
[3]);

199 
	`´”rÜ
("o‡uxiliary matrix\n");

200 
p
 = 
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

201 
	`£t_v®ue
(
p
, 
g
);

205 ()
	`syz
(
¬gv
[
¬gc
 - 1], 
g
, 
n
);

206 
	`doAutoÿlc
(
¬gv
[
¬gc
 - 1]);

207 
	}
}

	@intersect.h

7 
gm©rix
 
mkš‹r£ù
(
dli¡
* 
dl
);

8 
gm©rix
 
mkquÙ›Á
();

11 
addš‹r£ù
(
gm©rix
 
»suÉ
, gm©rix 
M
, 
dli¡
* 
dl
);

12 
addquÙ›Á
(
gm©rix
 
»suÉ
, gm©rix 
I
, gm©rix 
J
, 
n
);

15 
boŞ—n
 
isId—l
(
gm©rix
 
g
);

18 
š‹r_cmd
(
¬gc
, * 
¬gv
[]);

19 
quÙ_cmd
(
¬gc
, * 
¬gv
[]);

	@koszul.c

4 
	~<¡dio.h
>

5 
	~<£tjmp.h
>

6 
	~"sh¬ed.h
"

7 
	~"koszul.h
"

8 
	~"pŞy.h
"

9 
	~"gm_pŞy.h
"

10 
	~"¶i¡.h
"

11 
	~"d‘.h
"

12 
	~"ršg.h
"

13 
	~"gm©rix.h
"

14 
	~"·r£.h
"

15 
	~"v¬s.h
"

16 
	~"mÚ™Ü.h
"

19 
cÚ¡ex´
 
	gMODTYPE
 = 6;

22 
šlše
 
boŞ
 
	$Ãw_mod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

24 ià(
i
 >ğ
¬gc
)

25  
çl£
;

26 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 1, 
MODTYPE
, (
v¬ŸbË
 *)
cu¼’t_ršg
);

27  (*
p
 !ğ
NULL
);

28 
	}
}

30 
boŞ—n
 
	$memb”
(
e
, 
p
, *
t
)

32 
i
;

34 
i
 = 0; i < 
p
; i++)

35 ià(
e
 =ğ
t
[
i
])

36  
TRUE
;

37  
FALSE
;

38 
	}
}

42 
boŞ—n
 
	$sub£t
(
p1
, *
t1
, 
p2
, *
t2
)

44 
i
;

46 ià(
p1
 > 
p2
)

47  
FALSE
;

48 
i
 = 0; i < 
p1
; i++)

49 ià(!
	`memb”
(
t1
[
i
], 
p2
, 
t2
))

50  
FALSE
;

51  
TRUE
;

52 
	}
}

56 
	$k»move
(
p
, *
t
, 
i
, *
ŒesuÉ
)

58 
j
;

60 
ŒesuÉ
++;

61 
j
 = 1; j < 
i
; j++)

62 *
ŒesuÉ
++ = 
t
[
j
];

63 
j
 = 
i
 + 1; j <ğ
p
; j++)

64 *
ŒesuÉ
++ = 
t
[
j
];

65 
	}
}

67 
	$bšom
(
n
, 
p
)

69 
i
, 
»suÉ
;

71 
»suÉ
 = 1;

72 
i
 = 0; i < 
p
; i++)

73 
»suÉ
 =„esuÉ * (
n
 - 
i
) / (i + 1);

74  
»suÉ
;

75 
	}
}

77 
	$loc
(
p
, 
n
, *
t
)

79 
sum
, 
i
;

81 ià(
p
 == 0)

83 
sum
 = 0;

84 
t
++;

85 
i
 = 1; i <ğ
n
; i++)

86 ià(*
t
 =ğ
i
)

88 
t
++;

89 
p
--;

90 ià(
p
 == 0)

91  
sum
;

95 
sum
 +ğ
	`bšom
(
n
 - 
i
, 
p
 - 1);

98 
	}
}

103 
	$kz_g‘deg
(
gm©rix
 
M
, 
p
, *
tcŞ
)

105 
sum
, 
i
;

107 
sum
 = 0;

108 ià(
M
 !ğ
NULL
)

110 
i
 = 1; i <ğ
p
; i++)

111 
sum
 +ğ
	`dli¡_»f
(&
M
->
degg’s
, 
tcŞ
[
i
]);

115 
i
 = 1; i <ğ
p
; i++)

116 
sum
 +ğ
	`v¬Weight
(
	`v¬_g‘_ršg
(
cu¼’t_ršg
), 
tcŞ
[
i
] - 1);

118  
sum
;

119 
	}
}

124 
	$kz_£Œowdegs
(
dli¡
 *
dl
, 
gm©rix
 
M
, 
n
, 
p
)

126 
tcŞ
[100];

127 
acŞ
, 
junk
;

128 
sum
;

130 
	`dli¡_š™
(
dl
);

131 
	`pš™_¬¿y
(
p
 - 1, 
n
, 
tcŞ
, &
acŞ
, &
junk
);

134 
sum
 = 
	`kz_g‘deg
(
M
, 
p
 - 1, 
tcŞ
);

135 
	`dli¡_š£¹
(
dl
, 
sum
);

136 } 
	`pšü_¬¿y
(
p
 - 1, 
n
, 
tcŞ
, &
acŞ
, &
junk
));

137 
	}
}

139 
pŞy
 
	$kosz_row
(
gm©rix
 
M
, 
p
, 
n
, *
tcŞ
)

141 
pŞy
 
»suÉ
, 
f
;

142 
sign
, 
j
, 
m
;

143 
ŒesuÉ
[100];

145 
»suÉ
 = 
NULL
;

146 
sign
 = 1;

147 
j
 = 
p
; j > 0; j--)

149 
	`k»move
(
p
, 
tcŞ
, 
j
, 
ŒesuÉ
);

150 
m
 = 1 + 
	`loc
(
p
 - 1, 
n
, 
ŒesuÉ
);

151 ià(
M
 =ğ
NULL
)

152 
f
 = 
	`p_xjei
(
tcŞ
[
j
] - 1, 
m
);

154 
f
 = 
	`exŒ1
(
	`¶i¡_»f
(&
M
->
g’s
, 
tcŞ
[
j
]), 1, 
m
);

155 ià(
sign
 == -1)

156 
	`p_sub
(&
»suÉ
, &
f
);

158 
	`p_add
(&
»suÉ
, &
f
);

159 
sign
 = -sign;

161  
»suÉ
;

162 
	}
}

164 
gm©rix
 
	$gm_koszul
(
gm©rix
 
M
, 
n
, 
p
)

166 
sum
, 
acŞ
, 
junk
;

167 
tcŞ
[100];

168 
gm©rix
 
»suÉ
;

169 
pŞy
 
f
;

171 
»suÉ
 = 
	`mod_š™
();

172 ià((
p
 <ğ0è|| (°> 
n
))

173  
»suÉ
;

174 
	`kz_£Œowdegs
(&
»suÉ
->
deg»es
, 
M
, 
n
, 
p
);

176 
	`pš™_¬¿y
(
p
, 
n
, 
tcŞ
, &
acŞ
, &
junk
);

179 
f
 = 
	`kosz_row
(
M
, 
p
, 
n
, 
tcŞ
);

180 
sum
 = 
	`kz_g‘deg
(
M
, 
p
, 
tcŞ
);

181 
	`¶i¡_š£¹
(&
»suÉ
->
g’s
, 
f
);

182 
	`dli¡_š£¹
(&
»suÉ
->
degg’s
, 
sum
);

183 } 
	`pšü_¬¿y
(
p
, 
n
, 
tcŞ
, &
acŞ
, &
junk
));

184  
»suÉ
;

185 
	}
}

187 
	$koszul_cmd
(
¬gc
, *
¬gv
[])

189 
p
, 
n
;

190 
v¬ŸbË
 *
»suÉ
, *
q
;

191 
gm©rix
 
M
;

192 
id’t
[100], *
t
;

194 ià(
¬gc
 != 4)

196 
	`´šŠew
("koszul <int‚, or matrix> <p> <result matrix>\n");

199 
p
 = 
	`g‘IÁ
(
¬gv
[2]);

204 ià(
	`ÿnS¹V¬
(
¬gv
[1][0]))

206 
t
 = 
¬gv
[1];

207 
	`g‘Id’tif›r
(&
t
, 
id’t
);

208 
q
 = 
	`fšd_v¬
(
id’t
);

209 ià(
q
 =ğ
NULL
)

211 ià(
q
->
b_®Ÿs
 !ğ
NULL
)

212 
q
 = q->
b_®Ÿs
;

213 ià(
	`is_a_moduË
(
q
))

215 
	`vrg_š¡®l
(
q
->
b_ršg
);

216 
M
 = 
	`v¬_g‘_moduË
(
q
);

217 
n
 = 
	`ncŞs
(
M
);

218 ià(!
	`Ãw_mod
(&
»suÉ
, 
¬gc
, 
¬gv
, 3))

220 
	`£t_v®ue
(
»suÉ
, (
ADDRESS
)
	`gm_koszul
(
M
, 
n
, 
p
));

227 
M
 = 
NULL
;

228 
n
 = 
	`g‘IÁ
(
¬gv
[1]);

229 
n
 = 
	`mš_št
Ò, 
numv¬s
);

230 ià(!
	`Ãw_mod
(&
»suÉ
, 
¬gc
, 
¬gv
, 3))

232 
	`£t_v®ue
(
»suÉ
, (
ADDRESS
)
	`gm_koszul
(
M
, 
n
, 
p
));

233 
	}
}

	@koszul.h

5 
boŞ—n
 
memb”
(
e
, 
p
, * 
t
);

6 
boŞ—n
 
sub£t
(
p1
, * 
t1
, 
p2
, * 
t2
);

7 
k»move
(
p
, * 
t
, 
i
, * 
ŒesuÉ
);

8 
bšom
(
n
, 
p
);

9 
loc
(
p
, 
n
, * 
t
);

10 
kz_g‘deg
(
gm©rix
 
M
, 
p
, * 
tcŞ
);

11 
kz_£Œowdegs
(
dli¡
* 
dl
, 
gm©rix
 
M
, 
n
, 
p
);

12 
pŞy
 
kosz_row
(
gm©rix
 
M
, 
p
, 
n
, * 
tcŞ
);

13 
gm©rix
 
gm_koszul
(gm©rix 
M
, 
n
, 
p
);

14 
koszul_cmd
(
¬gc
, * 
¬gv
[]);

	@mac.c

4 
	~<sigÇl.h
>

5 
	~<time.h
>

6 
	~"sh¬ed.h
"

7 
	~"mac.h
"

8 
	~"mÚ™Ü.h
"

9 
	~"sh–l.h
"

10 
	~"£t.h
"

16 #´agm¨
GCC
 
dŸgno¡ic
 
push


17 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

18 * 
	gMşyP©h
 = (*)".";

19 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


22 * 
	gMşyCdœ
 = 
NULL
;

26 #´agm¨
GCC
 
dŸgno¡ic
 
push


27 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

28 * 
	gh–pFe
 = (*)"Macaulay.help";

29 * 
	gÃwFe
 = (*)"Macaulay.new";

30 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


33 
	g¡¬tTime
;

36 vŞ©
sig_©omic_t
 
	gštFÏg
 = 0;

38 
	$hªdË_sigÇl
(
sig
)

40 ()
sig
;

41 
štFÏg
 = 1;

42 
	}
}

44 
	$¥ec_š™
()

46 
štFÏg
 = 0;

47 
	`sigÇl
(
SIGINT
, 
hªdË_sigÇl
);

48 
	}
}

50 
	$šŒ_sh–l
()

52 ià(
štFÏg
)

54 
štFÏg
 = 0;

55 
	`´št
("\n");

56 
	`sh–l
();

57 
štFÏg
 = 0;

59 
	}
}

61 
boŞ—n
 
	$have_šŒ
()

63 ià(
štFÏg
)

65 
	`rmmou£
();

66  
TRUE
;

68  
FALSE
;

69 
	}
}

71 
	$rmmou£
()

73 
štFÏg
 = 0;

74 
	}
}

77 
	$m¬kTime
()

79 
¡¬tTime
 = ()
	`şock
();

80 
	}
}

82 
	$nSecÚds
()

84 
–­£d
 = ()
	`şock
(è- 
¡¬tTime
;

85  ()((
şock_t
)
–­£d
 / 
CLOCKS_PER_SEC
);

86 
	}
}

88 
	$g‘_ticks
()

90  ()
	`şock
();

91 
	}
}

94 
	$´Time
(cÚ¡ * 
¡r
)

96 
tÙ
, 
s
, 
m
;

98 ià(
tim”
 <= 0)

100 
tÙ
 = 
	`nSecÚds
();

101 ià(
tÙ
 == 0)

103 
s
 = 
tÙ
 % 60;

104 
m
 = 
tÙ
 / 60;

105 
	`Ãwlše
();

106 
	`´št
("% ", 
¡r
);

107 ià(
m
 > 1)

108 
	`´št
("%ld mšu‹ ªd ", 
m
);

109 ià(
m
 == 1)

110 
	`´št
("1 minute‡nd ");

111 ià(
s
 != 1)

112 
	`´št
("%ld secÚds\n", 
s
);

114 
	`´št
("1 second\n");

115 
	}
}

118 
	$£tTextSize
(
n
)

120 ()
n
;

121 
	}
}

124 
	$´£tup
()

126 
	}
}

	@mac.h

5 * 
MşyP©h
;

6 * 
MşyCdœ
;

7 * 
h–pFe
;

8 * 
ÃwFe
;

11 
¡¬tTime
;

14 
¥ec_š™
();

17 
šŒ_sh–l
();

18 
boŞ—n
 
have_šŒ
();

19 
rmmou£
();

22 
m¬kTime
();

23 
nSecÚds
();

24 
g‘_ticks
();

25 
´Time
(cÚ¡ * 
¡r
);

28 
£tTextSize
(
n
);

29 
´£tup
();

	@mem.c

4 
	~"sh¬ed.h
"

5 
	~"mem.h
"

6 
	~"¡ash.h
"

9 #ifdeà
SPARC


10 
cÚ¡ex´
 
	gWORD
 = 4;

12 
cÚ¡ex´
 
	gWORD
 = 2;

14 
cÚ¡ex´
 
	gBLOCKSIZE
 = 4400;

18 *
	gmod_¡ash
;

19 *
	g¡d_¡ash
;

22 *
	gsm®l_±r
;

23 *
	gsm®l_¡ash
;

24 
	gamt_Ëá
;

26 
	$i_¡ashes
()

28 
mod_¡ash
 = 
	`İ’_¡ash
((
mod»c
), "modules");

29 
¡d_¡ash
 = 
	`İ’_¡ash
((
mn_¡d»c
), "std bases");

30 
sm®l_¡ash
 = 
	`İ’_¡ash
(
BLOCKSIZE
, "small memory");

31 
amt_Ëá
 = 0;

32 
	}
}

34 *
	$mkPŞySsh
(
nblocks
)

39 
size
 =

40 ()(
pŞ
è+ ()
nblocks
 * ()(
sm®lmÚ
);

41  
	`İ’_¡ash
(()
size
, "polys in„ing");

42 
	}
}

44 
gm©rix
 
	$Ãw_mod
()

46  (
gm©rix
)(*)
	`g‘_¦ug
((
¡ash
 *)
mod_¡ash
);

47 
	}
}

49 *
	$g‘_sm®l
(
size
)

51 *
p
;

53 ià(
size
 == 0)

54  
NULL
;

56 
size
 % 
WORD
 != 0)

57 ++
size
;

58 ià(
size
 > 
BLOCKSIZE
)

59  
NULL
;

60 ià(
size
 > 
amt_Ëá
)

62 
sm®l_±r
 = 
	`g‘_¦ug
((
¡ash
 *)
sm®l_¡ash
);

63 
amt_Ëá
 = 
BLOCKSIZE
;

65 
p
 = 
sm®l_±r
;

66 
sm®l_±r
 +ğ
size
;

67 
amt_Ëá
 -ğ
size
;

68  
p
;

69 
	}
}

	@mem.h

5 
i_¡ashes
();

6 *
mkPŞySsh
(
nblocks
);

7 
gm©rix
 
Ãw_mod
();

8 *
g‘_sm®l
(
size
);

11 * 
mod_¡ash
;

12 * 
¡d_¡ash
;

	@monideal.c

4 
	~<¡ršg.h
>

5 
	~"sh¬ed.h
"

6 
	~"mÚid—l.h
"

7 
	~"mÚoms.h
"

8 
	~"¡dcmds.h
"

9 
	~"¡ªd¬d.h
"

10 
	~"pŞy.h
"

11 
	~"‹rm.h
"

12 
	~"gm©rix.h
"

13 
	~"¶i¡.h
"

14 
	~"mÚ™Ü.h
"

15 
	~"mac.h
"

16 
	~"v¬s.h
"

17 
	~"¡ash.h
"

18 
	~"ch¬p.h
"

19 
	~"£t.h
"

20 
	~"ršg.h
"

21 
	~"qršg.h
"

22 
	~"cmds.h
"

23 
	~"gm_pŞy.h
"

24 
	~"hb.h
"

26 
	~"humª_io.h
"

27 
	~"g’”ic.h
"

35 
cÚ¡ex´
 
	gIDSIZE
 = 50;

40 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
g
, 
¬gc
, **
¬gv
, 
i
)

42 ià(
i
 >ğ
¬gc
)

43  
çl£
;

44 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

45  (*
g
 !ğ
NULL
);

46 
	}
}

48 
šlše
 
boŞ
 
	$Ãw_mod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

50 ià(
i
 >ğ
¬gc
)

51  
çl£
;

52 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

53  (*
p
 !ğ
NULL
);

54 
	}
}

56 
šlše
 
boŞ
 
	$Ãw_§vmod
(
v¬ŸbË
 **
p
, *
s
)

58 *
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

59  (*
p
 !ğ
NULL
);

60 
	}
}

71 
ass_´ime_func
 
	ggÙAss
;

73 
¬row
 
	$mÚÃxt
(
¬row
 
p
)

75 
TRUE
)

77 
p
 =…->
uld
.
lda
[
FOW
];

78 ià(
p
->
uld
.
ldkšd
 == 'h')

79  
NULL
;

80 ià(
p
->
uld
.
ldkšd
 != 'm')

82  
p
;

84 
	}
}

90 
¬row
 
mÚmake
(
gm©rix
 
M
, 
comp
, (*
fú
)(
ex±”m
))

92 
¬row
 
p
, 
h—d
;

93 
i
;

94 
pŞy
 
f
;

95 
ex±”m
 
Ãxp
;

96 
modg’
 
mg
;

98 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

99 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

100 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
NULL
)

102 ià(
comp
 !ğ
	`g‘_comp
(
f
))

104 
	`sToExp
(
	`pŞy_š™Ÿl
(
f
), 
Ãxp
);

105 (*
fú
)(
Ãxp
);

106 
	`mÚbagadjoš
(
h—d
, 
Ãxp
, 
NULL
);

109 ià(
Rid—l
 !ğ
NULL
)

111 
p
 = 
Rid—l
;

112 (
p
 = 
	`mÚÃxt
Õ)è!ğ
NULL
)

114 
i
 = 0; i < 
numv¬s
; i++)

115 
Ãxp
[
i
] = 
p
->
umn
.
mexp
[i];

116 (*
fú
)(
Ãxp
);

117 
	`mÚbagadjoš
(
h—d
, 
Ãxp
, 
NULL
);

120  
h—d
;

121 
	}
}

129 
¬row
 
mÚhb
(
gm©rix
 
M
, 
comp
, (*
fú
)(arrow, ))

131 
¬row
 
p
, 
h—d
;

132 
pŞy
 
f
;

133 
ex±”m
 
Ãxp
;

134 
modg’
 
mg
;

136 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

137 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

138 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
NULL
)

140 ià(
comp
 !ğ
	`g‘_comp
(
f
))

142 ià(
	`have_šŒ
())

144 
	`mÚ»fund
(
h—d
);

145 
	`´št
("\n");

146  
NULL
;

148 
	`sToExp
(
	`pŞy_š™Ÿl
(
f
), 
Ãxp
);

149 
	`mÚadjoš
(
h—d
, 
Ãxp
, 
fú
);

150 ià(
v”bo£
 > 0)

151 
	`´æush
(".");

154 ià(
Rid—l
 !ğ
NULL
)

156 
p
 = 
Rid—l
;

157 (
p
 = 
	`mÚÃxt
Õ)è!ğ
NULL
)

159 ià(
	`have_šŒ
())

161 
	`mÚ»fund
(
h—d
);

162 
	`´št
("\n");

163  
NULL
;

165 
	`mÚadjoš
(
h—d
, 
p
->
umn
.
mexp
, 
fú
);

166 ià(
v”bo£
 > 0)

167 
	`´æush
(".");

170  
h—d
;

171 
	}
}

173 
	$tm_¿diÿl
(
ex±”m
 
Ãxp
)

175 
j
;

177 
j
 = 0; j < 
numv¬s
; j++)

178 ià(
Ãxp
[
j
] > 0)

179 
Ãxp
[
j
] = 1;

180 
	}
}

182 
¬row
 
	$mÚ¿diÿl
(
gm©rix
 
M
, 
comp
)

184  
	`mÚmake
(
M
, 
comp
, 
tm_¿diÿl
);

185 
	}
}

187 *
	gmÚdivExp
;

190 
	$tm_mdivide
(
ex±”m
 
Ãxp
)

192 
j
, 
k
;

194 
k
 = 0;

195 
j
 = 0; j < 
numv¬s
; j++)

196 ià(
mÚdivExp
[
j
] == 1)

197 
Ãxp
[
k
++] =‚exp[
j
];

198 ; 
k
 < 
numv¬s
; k++)

199 
Ãxp
[
k
] = 0;

200 
	}
}

202 
¬row
 
	$mÚdivide
(
gm©rix
 
M
, 
comp
, *
exp
)

204 
mÚdivExp
 = 
exp
;

205  
	`mÚmake
(
M
, 
comp
, 
tm_mdivide
);

206 
	}
}

211 
	$tm_mdiv
(
ex±”m
 
Ãxp
)

213 
j
;

215 
j
 = 0; j < 
numv¬s
; j++)

216 ià(
mÚdivExp
[
j
] != 1)

217 
Ãxp
[
j
] = 0;

218 
	}
}

220 
¬row
 
	$mÚdiv
(
gm©rix
 
M
, 
comp
, 
ex±”m
 
v¬s
)

222 
mÚdivExp
 = 
v¬s
;

223  
	`mÚmake
(
M
, 
comp
, 
tm_mdiv
);

224 
	}
}

232 
	$»dExp
(*
t
, *
exp
)

234 
boŞ—n
 
isOÃ
;

235 
i
;

237 
isOÃ
 = 
TRUE
;

238 
i
 = 0; i < 
numv¬s
; i++)

240 ià(
t
[
i
] > 0)

242 ià(
exp
[
i
] == 1)

244 ià(
exp
[
i
] == 0)

245 
isOÃ
 = 
FALSE
;

248 ià(
isOÃ
)

251 
	}
}

253 
	gtİCodim
;

255 
	$fšdAssPrimes
(
¬row
 
p
, *
exp1
, 
codim
)

257 
i
;

258 
ex±”m
 
exp
;

259 *
Ãxp
;

261 ià(
codim
 > 
tİCodim
)

265 
i
 = 0; i < 
numv¬s
; i++)

266 
exp
[
i
] = 
exp1
[i];

267 
TRUE
)

269 ià(
p
 =ğ
NULL
)

271 (*
gÙAss
)(
codim
, 
exp
);

274 
Ãxp
 = 
p
->
umn
.
mexp
;

275 
	`»dExp
(
Ãxp
, 
exp
))

278 
p
 = 
	`mÚÃxt
(p);

283 
i
 = 0; i < 
numv¬s
; i++)

285 ià((
Ãxp
[
i
] > 0è&& (
exp
[i] == 0))

287 
exp
[
i
] = 1;

288 
	`fšdAssPrimes
(
	`mÚÃxt
(
p
), 
exp
, 
codim
 + 1);

289 
exp
[
i
] = -1;

295 
	}
}

297 
	$wrAss
(*
exp
, 
codim
)

299 
i
;

301 
	`Ãwlše
();

302 
	`´št
("[%d] ", 
codim
);

303 
i
 = 0; i < 
numv¬s
; i++)

304 ià(
exp
[
i
] == 1)

305 
	`´št
("1 ");

307 
	`´št
("0 ");

308 
	`´æush
("\n");

309 
	}
}

311 
	$mÚdi¥Ïy
(
¬row
 
h—d
)

313 
¬row
 
p
;

314 
i
;

315 *
Ãxp
;

317 
p
 = 
h—d
;

318 (
p
 = 
	`mÚÃxt
Õ)è!ğ
NULL
)

320 
Ãxp
 = 
p
->
umn
.
mexp
;

321 
	`Ãwlše
();

322 
i
 = 0; i < 
numv¬s
; i++)

323 
	`´št
("%d ", 
Ãxp
[
i
]);

324 
	`´št
("\n");

326 
	}
}

331 
	$codimGÙAss
(
codim
, *
exp
)

333 ià(
codim
 <ğ
tİCodim
)

335 ià(
v”bo£
 > 0)

336 
	`wrAss
(
exp
, 
codim
);

337 
tİCodim
 = 
codim
;

339 
	}
}

341 
	$codim
(
gm©rix
 
M
)

343 
ncomps
;

344 
i
, 
j
;

345 
ex±”m
 
exp
;

346 
¬row
 
h—d
;

348 
ncomps
 = 
	`Äows
(
M
);

349 
tİCodim
 = 
numv¬s
 + 1;

350 
gÙAss
 = 
codimGÙAss
;

351 
i
 = 1; i <ğ
ncomps
; i++)

353 ià(
v”bo£
 > 0)

355 
	`Ãwlše
();

356 
	`´št
("compÚ’ˆ%d:\n", 
i
);

358 
h—d
 = 
	`mÚ¿diÿl
(
M
, 
i
);

359 
j
 = 0; j < 
numv¬s
; j++)

360 
exp
[
j
] = 0;

361 
	`fšdAssPrimes
(
	`mÚÃxt
(
h—d
), 
exp
, 0);

362 
	`mÚ»fund
(
h—d
);

364  
tİCodim
;

365 
	}
}

367 
	$codim_cmd
(
¬gc
, *
¬gv
[])

369 
gm©rix
 
M
;

370 
cod
;

372 ià((
¬gc
 < 2) || (argc > 3))

374 
	`´šŠew
("codim <standard basis> [integer„esult]\n");

377 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

379 
	`¡dW¬nšg
(
M
);

380 
cod
 = 
	`codim
(
M
);

381 
	`doIÁCmd
(
¬gv
[2], 
cod
, (
¬gc
 == 3), "codimension");

383 
	}
}

388 
ch“k
 *
	gch“ks
;

390 *
	gmÚ´imes_¡ash
;

391 
gm©rix
 
	gmÚ´imes_N
;

393 
	$mÚ´imesGÙAss
(
codim
, *
exp
)

395 
i
;

396 
ch“k
 *
p
;

398 
p
 = (
ch“k
 *)(*)
	`g‘_¦ug
((
¡ash
 *)
mÚ´imes_¡ash
);

399 
p
->
Ãxt
 = 
ch“ks
;

400 
ch“ks
 = 
p
;

401 
i
 = 0; i < 
numv¬s
; i++)

403 ià(
exp
[
i
] == 1)

404 
p
->
exp
[
i
] = 1;

406 
p
->
exp
[
i
] = 0;

408 
	}
}

410 
	$mÚ´imes
(
gm©rix
 
M
)

412 
ncomps
;

413 
i
, 
j
;

414 
ex±”m
 
exp
;

415 
¬row
 
h—d
;

417 
ncomps
 = 
	`Äows
(
M
);

418 
tİCodim
 = 
numv¬s
 + 1;

419 
gÙAss
 = 
mÚ´imesGÙAss
;

420 
i
 = 1; i <ğ
ncomps
; i++)

422 
h—d
 = 
	`mÚ¿diÿl
(
M
, 
i
);

423 
j
 = 0; j < 
numv¬s
; j++)

424 
exp
[
j
] = 0;

425 
	`fšdAssPrimes
(
	`mÚÃxt
(
h—d
), 
exp
, 0);

426 
	`mÚ»fund
(
h—d
);

428 
	}
}

430 
	$mÚ´imes_cmd
(
¬gc
, *
¬gv
[])

432 
gm©rix
 
M
;

433 
v¬ŸbË
 *
z
;

434 
pŞy
 
f
, 
g
;

435 
i
;

436 
ch“k
 *
p
, *
q
;

438 ià(
¬gc
 != 3)

440 
	`´šŠew
("monprimes <standard basis> <result>\n");

443 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

445 ià(!
	`Ãw_mod
(&
z
, 
¬gc
, 
¬gv
, 2))

447 
mÚ´imes_N
 = 
	`mod_š™
();

448 
	`£tz”odegs
(
mÚ´imes_N
, 
numv¬s
);

450 
mÚ´imes_¡ash
 =

451 
	`İ’_¡ash
(()((
ch“k
è+ (
size_t
)(
numv¬s
 - 1) * ()), "cheek");

452 
ch“ks
 = 
NULL
;

454 
	`mÚ´imes
(
M
);

455 
p
 = 
ch“ks
;… !ğ
NULL
;… =…->
Ãxt
)

457 
q
 = 
ch“ks
; q !ğ
NULL
; q = q->
Ãxt
)

459 ià(
q
 =ğ
p
)

461 
i
 = 0; i < 
numv¬s
; ++i)

462 ià(
p
->
exp
[
i
] =ğ0 && 
q
->exp[i] != 0)

464 ià(
i
 =ğ
numv¬s
)

467 ià(
q
 !ğ
NULL
)

470 
f
 = 
NULL
;

471 
i
 = 0; i < 
numv¬s
; ++i)

472 ià(
p
->
exp
[
i
] == 1)

474 
g
 = 
	`e_sub_i
(
i
 + 1);

475 
	`p_add
(&
f
, &
g
);

476 
	`p_kl
(&
g
);

478 
	`gmIn£¹
(
mÚ´imes_N
, 
f
);

480 
	`’dof_¡ash
((
¡ash
 *)
mÚ´imes_¡ash
);

482 
	`£t_v®ue
(
z
, 
mÚ´imes_N
);

484 
	}
}

490 
ex±”m
 
	gMDmÚ
;

491 
¬row
 
	gMDh—d
;

492 
	gMDnv¬s
;

493 
	gMDdeg
;

495 
	$mÚdeg»e
(
¬row
 
h—d
, 
nv¬s
)

497 
i
;

499 
i
 = 0; i < 
nv¬s
; i++)

500 
MDmÚ
[
i
] = 0;

501 
MDh—d
 = 
h—d
;

502 
MDnv¬s
 = 
nv¬s
;

503 
MDdeg
 = 1;

504 
	`’umMÚs
(0);

505  
MDdeg
;

506 
	}
}

508 
	$’umMÚs
(
Ï¡v®
)

510 
i
;

512 
i
 = 
Ï¡v®
; i < 
MDnv¬s
; i++)

514 
MDmÚ
[
i
]++;

515 
	`mÚ»£t
(
MDh—d
, 
FOW
);

516 ià(!
	`mÚ£¬ch
(
MDh—d
, 
FOW
, 
MDmÚ
))

518 
MDdeg
++;

519 
	`’umMÚs
(
i
);

521 
MDmÚ
[
i
]--;

523 
	}
}

528 
gm©rix
 
	gDDm©
;

529 
	gDDcodim
;

530 
	gDDcomp
;

531 
	gDDdeg»e
;

533 
	$degGÙAss
(
codim
, *
exp
)

535 
¬row
 
h—d
;

537 ià(
codim
 =ğ
DDcodim
)

539 
h—d
 = 
	`mÚdivide
(
DDm©
, 
DDcomp
, 
exp
);

540 
DDdeg»e
 +ğ
	`mÚdeg»e
(
h—d
, 
DDcodim
);

541 ià(
v”bo£
 > 0)

542 
	`štæush
("%ld.", ()
DDdeg»e
);

543 
	`mÚ»fund
(
h—d
);

545 
	}
}

547 
	$modDeg»e
(
gm©rix
 
M
, 
thisCodim
)

549 
j
;

550 
ncomps
;

551 
¬row
 
h—d
;

552 
ex±”m
 
exp
;

554 
ncomps
 = 
	`Äows
(
M
);

555 
DDdeg»e
 = 0;

556 
DDm©
 = 
M
;

557 
DDcodim
 = 
thisCodim
;

558 
gÙAss
 = 
degGÙAss
;

559 
DDcomp
 = 1; DDcom°<ğ
ncomps
; DDcomp++)

561 
h—d
 = 
	`mÚ¿diÿl
(
M
, 
DDcomp
);

562 
j
 = 0; j < 
numv¬s
; j++)

563 
exp
[
j
] = 0;

564 
	`fšdAssPrimes
(
	`mÚÃxt
(
h—d
), 
exp
, 0);

565 
	`mÚ»fund
(
h—d
);

567 ià(
v”bo£
 > 0)

568 
	`´æush
("\n");

569  
DDdeg»e
;

570 
	}
}

572 
	$deg»e_cmd
(
¬gc
, *
¬gv
[])

574 
gm©rix
 
M
;

575 
cod
;

576 
deg
;

577 
ŞdV”bo£
;

579 ià((
¬gc
 < 2) || (argc > 4))

581 
	`´šŠew
("degree <standard basis> [integer codim] [integer degree]\n");

585 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

587 
	`¡dW¬nšg
(
M
);

588 
ŞdV”bo£
 = 
v”bo£
;

589 
v”bo£
 = 
FALSE
;

590 
cod
 = 
	`codim
(
M
);

591 
	`doIÁCmd
(
¬gv
[2], 
cod
, (
¬gc
 >= 3), "codimension");

592 
v”bo£
 = 
ŞdV”bo£
;

593 
deg
 = 
	`modDeg»e
(
M
, 
cod
);

594 
	`doIÁCmd
(
¬gv
[3], ()
deg
, (
¬gc
 == 4), "degree ");

596 
	}
}

603 
gm©rix
 
	gMA»suÉ
;

604 
¬row
 
	gMAh—d
;

605 *
	gMAmÚ
;

606 
	gMAcomp
;

607 
	gMAcompDeg
;

608 
	gMAlo
, 
	gMAhi
;

609 *
	gMAv¬s
;

611 
	$accumMÚs
(
Ï¡v®
)

613 
i
, 
d
, 
e
;

614 
pŞy
 
f
;

616 
i
 = 
Ï¡v®
; i < 
numv¬s
; i++)

618 ià(
MAv¬s
[
i
] != 1)

620 
MAmÚ
[
i
]++;

621 
e
 = 
	`exp_deg»e
(
MAmÚ
);

622 
d
 = 
MAcompDeg
 + 
e
;

623 ià((
d
 > 
MAhi
è|| (
e
 > 
maxdeg»e
))

626 
MAmÚ
[
i
]--;

629 
	`mÚ»£t
(
MAh—d
, 
FOW
);

630 ià(!
	`mÚ£¬ch
(
MAh—d
, 
FOW
, 
MAmÚ
))

632 ià(
d
 >ğ
MAlo
)

634 
f
 = 
	`p_mÚom
(
fd_Úe
);

635 
	`expToS
(
MAmÚ
, 
MAcomp
, 
	`pŞy_š™Ÿl
(
f
));

636 
	`gmIn£¹
(
MA»suÉ
, 
f
);

638 
	`accumMÚs
(
i
);

640 
MAmÚ
[
i
]--;

642 
	}
}

644 
gm©rix
 
	$gm_basis
(
gm©rix
 
M
, 
ex±”m
 
v¬s
, 
lo
, 
hi
, 
boŞ—n
 
isbasis
)

646 
i
;

647 
ex±”m
 
exp
;

649 
MA»suÉ
 = 
	`mod_š™
();

650 
	`dl_cİy
(&
M
->
deg»es
, &
MA»suÉ
->degrees);

651 
MAlo
 = 
lo
;

652 
MAhi
 = 
hi
;

653 
MAv¬s
 = 
v¬s
;

654 
MAcomp
 = 1; MAcom°<ğ
	`Äows
(
M
); MAcomp++)

656 
MAcompDeg
 = 
	`dli¡_»f
(&
M
->
deg»es
, 
MAcomp
);

657 ià((
MAcompDeg
 > 
hi
è&& (
isbasis
))

659 
MAh—d
 = 
	`mÚdiv
(
M
, 
MAcomp
, 
v¬s
);

660 
i
 = 0; i < 
numv¬s
; i++)

661 
exp
[
i
] = 0;

662 
MAmÚ
 = 
exp
;

664 
	`mÚ»£t
(
MAh—d
, 
FOW
);

665 ià(!
	`mÚ£¬ch
(
MAh—d
, 
FOW
, 
MAmÚ
))

666 ià(
MAcompDeg
 >ğ
lo
)

667 
	`gmIn£¹
(
MA»suÉ
, 
	`e_sub_i
(
MAcomp
));

669 ià(
MAcompDeg
 <ğ
hi
)

670 
	`accumMÚs
(0);

671 
	`mÚ»fund
(
MAh—d
);

673  
MA»suÉ
;

674 
	}
}

681 
	$basis_cmd
(
¬gc
, *
¬gv
[])

683 
ex±”m
 
v¬s
;

684 
gm©rix
 
M
;

685 
v¬ŸbË
 *
p
;

686 
lo
, 
hi
;

687 
s
[
IDSIZE
];

689 ià(
¬gc
 < 3)

691 
	`´šŠew
("k_basis <matrix> <result matrix> [variable†ist]\n");

694 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

696 
	`¡rıy
(
s
, 
¬gv
[2]);

697 ià(!(
	`g‘V¬Li¡
(
¬gc
 - 3, (cÚ¡ **)(*)(
¬gv
 + 3), 
v¬s
)))

699 
lo
 = 
	`g‘_defšt
("lowest degree (default=no†owest degree) ", -5000);

700 
hi
 = 
	`g‘_defšt
("highest degree (default=no high degree) ", 5000);

701 
	`¡dW¬nšg
(
M
);

702 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

704 
	`£t_v®ue
(
p
, 
	`gm_basis
(
M
, 
v¬s
, 
lo
, 
hi
, 
TRUE
));

706 
	}
}

721 
	$Œunÿ‹_cmd
(
¬gc
, *
¬gv
[])

723 
ex±”m
 
v¬s
;

724 
gm©rix
 
M
;

725 
v¬ŸbË
 *
p
;

726 
lo
;

727 
s
[
IDSIZE
];

729 ià(
¬gc
 < 3)

731 
	`´šŠew
("truncate <matrix> <result matrix> [variable†ist]\n");

734 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

736 
	`¡rıy
(
s
, 
¬gv
[2]);

737 ià(!(
	`g‘V¬Li¡
(
¬gc
 - 3, (cÚ¡ **)(*)(
¬gv
 + 3), 
v¬s
)))

739 
lo
 = 
	`g‘_defšt
("lowest degree (default=0) ", 0);

740 
	`¡dW¬nšg
(
M
);

741 ià(!
	`Ãw_§vmod
(&
p
, 
s
))

743 
	`£t_v®ue
(
p
, 
	`gm_basis
(
M
, 
v¬s
, 
lo
,†o, 
FALSE
));

745 
	}
}

	@monideal.h

5 (*
	tass_´ime_func
)(, *);

6 
	sch“k_»c


8 
ch“k_»c
* 
Ãxt
;

9 
exp
[];

10 } 
	tch“k
;

13 
¬row
 
	`mÚÃxt
×¼ow 
p
);

14 
¬row
 
	`mÚmake
(
gm©rix
 
M
, 
comp
, (*
fú
)(
ex±”m
));

15 
¬row
 
	`mÚhb
(
gm©rix
 
M
, 
comp
, (*
fú
)(arrow, ));

16 
	`tm_¿diÿl
(
ex±”m
 
Ãxp
);

17 
¬row
 
	`mÚ¿diÿl
(
gm©rix
 
M
, 
comp
);

18 
	`tm_mdivide
(
ex±”m
 
Ãxp
);

19 
¬row
 
	`mÚdivide
(
gm©rix
 
M
, 
comp
, * 
exp
);

20 
	`tm_mdiv
(
ex±”m
 
Ãxp
);

21 
¬row
 
	`mÚdiv
(
gm©rix
 
M
, 
comp
, 
ex±”m
 
v¬s
);

22 
	`»dExp
(* 
t
, * 
exp
);

23 
	`fšdAssPrimes
(
¬row
 
p
, * 
exp1
, 
codim
);

24 
	`wrAss
(* 
exp
, 
codim
);

25 
	`mÚdi¥Ïy
(
¬row
 
h—d
);

26 
	`codim
(
gm©rix
 
M
);

27 
	`codim_cmd
(
¬gc
, * 
¬gv
[]);

28 
	`mÚ´imes
(
gm©rix
 
M
);

29 
	`mÚ´imes_cmd
(
¬gc
, * 
¬gv
[]);

30 
	`mÚdeg»e
(
¬row
 
h—d
, 
nv¬s
);

31 
	`’umMÚs
(
Ï¡v®
);

32 
	`modDeg»e
(
gm©rix
 
M
, 
thisCodim
);

33 
	`deg»e_cmd
(
¬gc
, * 
¬gv
[]);

34 
	`accumMÚs
(
Ï¡v®
);

35 
gm©rix
 
	`gm_basis
(gm©rix 
M
, 
ex±”m
 
v¬s
, 
lo
, 
hi
, 
boŞ—n
 
isbasis
);

36 
	`basis_cmd
(
¬gc
, * 
¬gv
[]);

37 
	`Œunÿ‹_cmd
(
¬gc
, * 
¬gv
[]);

40 
ass_´ime_func
 
gÙAss
;

41 * 
mÚdivExp
;

42 
tİCodim
;

43 * 
mÚ´imes_¡ash
;

44 
gm©rix
 
mÚ´imes_N
;

45 
ch“k
* 
ch“ks
;

46 
ex±”m
 
MDmÚ
;

47 
¬row
 
MDh—d
;

48 
MDnv¬s
;

49 
MDdeg
;

50 
gm©rix
 
DDm©
;

51 
DDcodim
;

52 
DDcomp
;

53 
DDdeg»e
;

54 
gm©rix
 
MA»suÉ
;

55 
¬row
 
MAh—d
;

56 * 
MAmÚ
;

57 
MAcomp
;

58 
MAcompDeg
;

59 
MAlo
, 
MAhi
;

60 * 
MAv¬s
;

	@monitor.c

4 
	~<¡d¬g.h
>

5 
	~<¡dio.h
>

6 
	~<¡dlib.h
>

7 
	~<¡ršg.h
>

8 
	~"sh¬ed.h
"

9 
	~"mÚ™Ü.h
"

10 
	~"sh–l.h
"

11 
	~"mac.h
"

12 
	~"´štf.h
"

13 
	~"šput.h
"

14 
	~"£t.h
"

16 
FILE
 *
	gmÚfe
;

17 
	gam_mÚ™Üšg
 = 0;

19 
	gæushnum
;

23 
	$doPr
(cÚ¡ *
fmt
, 
va_li¡
 *
­
, 
FILE
 *
f
)

25 ià((
f
 =ğ
¡dout
è&& (
´Ëv–
 > 0))

27 
	`doPršt
(
fmt
, 
­
, 
f
);

28 
	}
}

30 
	$åršt
(
FILE
 *
f
, cÚ¡ *
fmt
, ...)

32 
va_li¡
 
­
;

34 
	`va_¡¬t
(
­
, 
fmt
);

35 
	`doPr
(
fmt
, &
­
, 
f
);

36 
	`va_’d
(
­
);

37 
	}
}

39 
	$´št
(cÚ¡ *
fmt
, ...)

41 
va_li¡
 
­
;

43 
	`va_¡¬t
(
­
, 
fmt
);

44 
	`doPr
(
fmt
, &
­
, 
¡dout
);

45 
	`va_’d
(
­
);

46 
	}
}

48 
	$åršŠew
(
FILE
 *
f
, cÚ¡ *
fmt
, ...)

50 
va_li¡
 
­
;

52 
	`va_¡¬t
(
­
, 
fmt
);

53 
	`âewlše
(
f
);

54 
	`doPr
(
fmt
, &
­
, 
f
);

55 
	`va_’d
(
­
);

56 
	}
}

58 
	$´šŠew
(cÚ¡ *
fmt
, ...)

60 
va_li¡
 
­
;

62 
	`va_¡¬t
(
­
, 
fmt
);

63 
	`Ãwlše
();

64 
	`doPr
(
fmt
, &
­
, 
¡dout
);

65 
	`va_’d
(
­
);

66 
	}
}

68 
	$´šput
(cÚ¡ *
fmt
, ...)

70 
va_li¡
 
­
;

72 
	`va_¡¬t
(
­
, 
fmt
);

73 
	`´št
("! ");

74 
	`doPr
(
fmt
, &
­
, 
¡dout
);

75 
	`´št
(" ? ");

76 
	`va_’d
(
­
);

77 
	}
}

79 
	$´šput_”rÜ
(cÚ¡ *
fmt
, ...)

81 
va_li¡
 
­
;

82 
Şd_´Ëv–
;

84 
	`va_¡¬t
(
­
, 
fmt
);

86 
Şd_´Ëv–
 = 
´Ëv–
;

87 
´Ëv–
 = 0;

88 
	`´št
("! ");

89 
	`doPr
(
fmt
, &
­
, 
¡dout
);

90 
	`´št
(" ? ");

91 
´Ëv–
 = 
Şd_´Ëv–
;

92 
	`va_’d
(
­
);

93 
	}
}

95 
	gcmd_”rÜ
;

97 
	$´”rÜ
(cÚ¡ *
fmt
, ...)

99 
va_li¡
 
­
;

100 
Şd_´Ëv–
;

102 
	`va_¡¬t
(
­
, 
fmt
);

104 
Şd_´Ëv–
 = 
´Ëv–
;

105 
´Ëv–
 = 0;

106 
	`doPr
(
fmt
, &
­
, 
¡dout
);

107 
´Ëv–
 = 
Şd_´Ëv–
;

108 
cmd_”rÜ
 = 1;

109 
	`va_’d
(
­
);

110 
	}
}

112 
	$štæush
(cÚ¡ *
fmt
, 
num
)

116 
buf
[128];

118 #´agm¨
GCC
 
dŸgno¡ic
 
push


119 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wformat-nonliteral"

120 
	`¥rštf
(
buf
, 
fmt
, 
num
);

121 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


122 
	`´æush
("%s", 
buf
);

123 
	}
}

127 
	gÏ¡_fæush
 = 0;

129 
	$´æush
(cÚ¡ *
fmt
, ...)

131 
va_li¡
 
­
;

132 
ticks
;

135 
Ën
;

137 
	`va_¡¬t
(
­
, 
fmt
);

140 
‹mp
[1024];

141 
	`v¢´štf
(
‹mp
, Ñemp), 
fmt
, 
­
);

142 
Ën
 = ()
	`¡¾’
(
‹mp
);

144 
æushnum
 +ğ
Ën
;

145 ià(
æushnum
 > 
lšesize
)

147 
	`´št
("\n");

148 
æushnum
 = 
Ën
;

149 
	`Ãwlše
();

153 
	`va_’d
(
­
);

154 
	`va_¡¬t
(
­
, 
fmt
);

155 
	`doPr
(
fmt
, &
­
, 
¡dout
);

157 ià((
ticks
 = 
	`g‘_ticks
()è> 
Ï¡_fæush
 + 
iod–ay
)

159 
Ï¡_fæush
 = 
ticks
;

160 
	`fæush
(
¡dout
);

162 
	`va_’d
(
­
);

163 
	}
}

165 
	$debug´
(cÚ¡ *
fmt
, ...)

167 
va_li¡
 
­
;

168 
¬gc
;

169 **
¬gv
;

171 
	`va_¡¬t
(
­
, 
fmt
);

172 
	`doPr
(
fmt
, &
­
, 
¡dout
);

173 
	`´št
(" = ");

174 
	`g‘_lše
(&
¬gc
, &
¬gv
);

175 ià(
¬gc
 > 0)

176 
	`ex™
(0);

177 
	`va_’d
(
­
);

178 
	}
}

180 
	$Ãwlše
()

182 ià(
´comm’t
 > 0)

184 
	`´št
("; ");

185 
æushnum
 += 2;

187 
	}
}

189 
	$âewlše
(
FILE
 *
f
)

191 ià(
´comm’t
 > 0)

193 
	`åršt
(
f
, "; ");

194 
æushnum
 += 2;

196 
	}
}

198 
	$mÚ´št
(cÚ¡ *
fmt
, ...)

200 
va_li¡
 
­
;

202 
	`va_¡¬t
(
­
, 
fmt
);

203 ià(
am_mÚ™Üšg
 == 1)

204 
	`doPršt
(
fmt
, &
­
, 
mÚfe
);

205 
	`va_’d
(
­
);

206 
	}
}

208 
	$mÚ_cmd
(
¬gc
, *
¬gv
[])

210 ià(
¬gc
 != 2)

212 
	`´št
("monitor <file>\n");

215 ià(
am_mÚ™Üšg
 == 1)

217 
	`´št
("monitoring is‡lready being done\n");

220 
mÚfe
 = 
	`tİ’
(
¬gv
[1], "w");

221 ià(
mÚfe
 =ğ
NULL
)

223 
	`´št
("ÿn'ˆİ’ %s\n", 
¬gv
[1]);

226 
am_mÚ™Üšg
 = 1;

227 
	}
}

229 
	$’d_mÚ™Ü
()

231 
v®
;

233 
am_mÚ™Üšg
 = 0;

234 
v®
 = 
	`fşo£
(
mÚfe
);

235 ià(
v®
 != 0)

236 
	`´št
("error writing monitor file\n");

237 
	}
}

	@monitor.h

7 
´št
(cÚ¡ * 
fmt
, ...);

8 
åršt
(
FILE
* 
f
, cÚ¡ * 
fmt
, ...);

9 
´šŠew
(cÚ¡ * 
fmt
, ...);

10 
åršŠew
(
FILE
* 
f
, cÚ¡ * 
fmt
, ...);

11 
´šput
(cÚ¡ * 
fmt
, ...);

12 
´šput_”rÜ
(cÚ¡ * 
fmt
, ...);

13 
´”rÜ
(cÚ¡ * 
fmt
, ...);

14 
´æush
(cÚ¡ * 
fmt
, ...);

15 
štæush
(cÚ¡ * 
fmt
, 
num
);

16 
debug´
(cÚ¡ * 
fmt
, ...);

19 
mÚ´št
(cÚ¡ * 
fmt
, ...);

20 
mÚ_cmd
(
¬gc
, * 
¬gv
[]);

21 
’d_mÚ™Ü
();

24 
Ãwlše
();

25 
âewlše
(
FILE
* 
f
);

28 
FILE
* 
mÚfe
;

29 
am_mÚ™Üšg
;

30 
æushnum
;

31 
cmd_”rÜ
;

	@monoms.c

4 
	~"sh¬ed.h
"

5 
	~"mÚoms.h
"

6 
	~"hb.h
"

7 
	~"‹rm.h
"

14 
	$mo_š™
(
gm©rix
 
M
)

16 
	`mn_š™
(
M
);

17 
	}
}

19 
	$mo_kl
(
gm©rix
 
M
)

21 
	`mn_kl
(
M
);

22 
	}
}

24 
	$mo_š£¹
(
gm©rix
 
M
, 
‹rm
 
t
, * 
i
)

26 
	`mn_š£¹
(
M
, 
t
, 
i
);

27 
	}
}

29 
	$mo_rg_š£¹
(
‹rm
 
t
, * 
i
)

32 ()
t
;

33 ()
i
;

34 
	}
}

36 
boŞ—n
 
	$mo_iscom¶‘e
(
gm©rix
 
M
, 
deg
)

38 ()
deg
;

39  
	`mn_iscom¶‘e
(
M
);

40 
	}
}

42 
	$mo_»£t
(
gm©rix
 
M
, ** 
i
, ** 
j
)

45 ()
M
;

46 ()
i
;

47 ()
j
;

48 
	}
}

50 
	$mo_rg»£t
(** 
i
, ** 
j
, 
jmax
)

53 ()
i
;

54 ()
j
;

55 ()
jmax
;

56 
	}
}

58 
boŞ—n
 
	$mo_Ãxt_·œ
(
gm©rix
 
M
, 
deg
, ** 
i
, ** 
j
)

60  
	`mn_Ãxt_·œ
(
M
, 
deg
, 
i
, 
j
);

61 
	}
}

63 
boŞ—n
 
	$mo_rg_·œ
(
gm©rix
 
M
, 
deg
, ** 
i
, ** 
j
)

65 ()
M
;

66 ()
deg
;

67 ()
i
;

68 ()
j
;

70 
	}
}

72 
	$tdeg»e
(
gm©rix
 
M
, 
‹rm
 
t
)

74 
»suÉ
;

76 
»suÉ
 = 
	`dli¡_»f
(&(
M
->
deg»es
), 
	`tm_compÚ’t
(
t
)è+ 
	`tm_deg»e
(t);

77  
»suÉ
;

78 
	}
}

80 
boŞ—n
 
	$mo_fšd_div
(
gm©rix
 
M
, 
‹rm
 
t
, ** 
i
,”m 
s
)

82  
	`mn_fšd_div
(&
M
->
mÚb
, 
t
, 
i
, 
s
);

83 
	}
}

85 
boŞ—n
 
	$mo_rg_div
(
¶i¡
* 
¶
, 
‹rm
 
t
, ** 
i
,”m 
s
)

87 ()
¶
;

88 ()
t
;

89 ()
i
;

90 ()
s
;

92 
	}
}

	@monoms.h

5 
mo_š™
(
gm©rix
 
M
);

6 
mo_kl
(
gm©rix
 
M
);

9 
mo_š£¹
(
gm©rix
 
M
, 
‹rm
 
t
, * 
i
);

10 
mo_rg_š£¹
(
‹rm
 
t
, * 
i
);

13 
boŞ—n
 
mo_iscom¶‘e
(
gm©rix
 
M
, 
deg
);

14 
tdeg»e
(
gm©rix
 
M
, 
‹rm
 
t
);

17 
mo_»£t
(
gm©rix
 
M
, ** 
i
, ** 
j
);

18 
mo_rg»£t
(** 
i
, ** 
j
, 
jmax
);

19 
boŞ—n
 
mo_Ãxt_·œ
(
gm©rix
 
M
, 
deg
, ** 
i
, ** 
j
);

20 
boŞ—n
 
mo_rg_·œ
(
gm©rix
 
M
, 
deg
, ** 
i
, ** 
j
);

23 
boŞ—n
 
mo_fšd_div
(
gm©rix
 
M
, 
‹rm
 
t
, ** 
i
,”m 
s
);

24 
boŞ—n
 
mo_rg_div
(
¶i¡
* 
¶
, 
‹rm
 
t
, ** 
i
,”m 
s
);

	@parse.c

4 
	~<ùy³.h
>

5 
	~<¡ršg.h
>

6 
	~<£tjmp.h
>

7 
	~<¡dšt.h
>

8 
	~"sh¬ed.h
"

9 
	~"·r£.h
"

10 
	~"v¬s.h
"

11 
	~"mÚ™Ü.h
"

14 
cÚ¡ex´
 
	gLXEOI
 = 0;

15 
cÚ¡ex´
 
	gLXINT
 = 1;

16 
cÚ¡ex´
 
	gLXPOLY
 = 2;

17 
cÚ¡ex´
 
	gLXLT
 = 3;

18 
cÚ¡ex´
 
	gLXLE
 = 4;

19 
cÚ¡ex´
 
	gLXGT
 = 5;

20 
cÚ¡ex´
 
	gLXGE
 = 6;

21 
cÚ¡ex´
 
	gLXEQ
 = 7;

22 
cÚ¡ex´
 
	gLXNE
 = 8;

23 
cÚ¡ex´
 
	gLXOR
 = 9;

24 
cÚ¡ex´
 
	gLXAND
 = 10;

25 
cÚ¡ex´
 
	gLXPLUS
 = 11;

26 
cÚ¡ex´
 
	gLXMINUS
 = 12;

27 
cÚ¡ex´
 
	gLXMULT
 = 13;

28 
cÚ¡ex´
 
	gLXDIV
 = 14;

29 
cÚ¡ex´
 
	gLXMOD
 = 15;

30 
cÚ¡ex´
 
	gLXEXP
 = 16;

31 
cÚ¡ex´
 
	gLXLP
 = 17;

32 
cÚ¡ex´
 
	gLXRP
 = 18;

33 
cÚ¡ex´
 
	gLXUMINUS
 = 19;

34 
cÚ¡ex´
 
	gLXUPLUS
 = 20;

35 
cÚ¡ex´
 
	gLXNOT
 = 21;

38 
cÚ¡ex´
 
	gNSTACK
 = 50;

39 
cÚ¡ex´
 
	gNARGS
 = 2;

42 
	s¡ack_¡ruù


44 
	mtos
;

45 *
	mv®s
[
NSTACK
];

46 } 
	t¡ack
;

49 
	gå»c
[] = {0, 11, 11, 4, 4, 4, 4, 4, 4, 3, 3, 6, 6, 8, 8, 8, 8, 1, 13, 8, 8, 8};

50 
	gg´ec
[] = {0, 10, 10, 3, 3, 3, 3, 3, 3, 2, 2, 5, 5, 7, 7, 7, 9, 11, 1, 10, 10, 10};

52 
	gÇrgs
[] = {0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 1, 0, 1};

56 
	gthi¡ok
;

57 
	gthisv®
;

58 
	g·»Æev–
;

60 
¡ack
 
	gİSck
;

61 
¡ack
 
	gv®Sck
;

63 *
	gbegšSŒ
;

64 
jmp_buf
 
	gjmµ¬£
;

65 
	gamP¬sšg
 = 0;

69 
boŞ—n
 
	$em±ySck
(
¡ack
 *
¡
)

71  (
¡
->
tos
 == -1);

72 
	}
}

74 
	$š™Sck
(
¡ack
 *
¡
)

76 
¡
->
tos
 = -1;

77 
	}
}

79 *
	$pİ
(
¡ack
 *
¡
)

81 *
v®
;

83 
v®
 = 
¡
->
v®s
[¡->
tos
];

84 
¡
->
tos
--;

85  
v®
;

86 
	}
}

88 
	$push
(
¡ack
 *
¡
, *
v®
)

90 
¡
->
tos
++;

91 
¡
->
v®s
[¡->
tos
] = 
v®
;

92 
	}
}

94 *
	$tos
(
¡ack
 *
¡
)

96  
¡
->
v®s
[¡->
tos
];

97 
	}
}

101 
boŞ—n
 
	$isuÇry
(
tok
)

103  ((
tok
 !ğ
LXRP
è&& (tok !ğ
LXINT
è&& (tok !ğ
LXPOLY
));

104 
	}
}

106 
	$cŞËùIÁ
(
c
, **
¡r
)

108 
n
;

110 
n
 = 
c
 - '0';

111 
	`isdig™
(
c
 = *(*
¡r
)++))

112 
n
 = 10 *‚ + 
c
 - '0';

113 (*
¡r
)--;

114  
n
;

115 
	}
}

117 
	$g‘2
(**
¡r
, 
ch
, 
tok1
, 
tok2
)

119 
c
;

121 
c
 = *(*
¡r
)++;

122 ià(
c
 =ğ
ch
)

123  
tok1
;

126 (*
¡r
)--;

127  
tok2
;

129 
	}
}

131 
boŞ—n
 
	$isBšOp
(
tok
)

133  ((
tok
 >ğ
LXPLUS
è&& (tok <ğ
LXEXP
));

134 
	}
}

136 
boŞ—n
 
	$isO³¿tÜ
(
tok
)

138  (
	`isBšOp
(
tok
è|| (tok =ğ
LXUMINUS
));

139 
	}
}

141 
	$·r£E¼
(*
’d
, cÚ¡ *
mess
)

143 
c
;

145 
c
 = *
’d
;

146 *
’d
 = '\0';

147 
	`´”rÜ
("; % ©: %s\n", 
mess
, 
begšSŒ
);

148 *
’d
 = 
c
;

149 
	`lÚgjmp
(
jmµ¬£
, -1);

150 
	}
}

152 
boŞ—n
 
	$checkE¼Ü
(
Ï¡tok
, 
tok
, *
’d
)

154 ià(((
Ï¡tok
 =ğ
LXINT
è|| (Ï¡tok =ğ
LXRP
)è&& ((
tok
 =ğLXINTè|| (tok =ğ
LXLP
)))

156 
	`·r£E¼
(
’d
, "missing operator");

157  
TRUE
;

159 ià(((
	`isO³¿tÜ
(
Ï¡tok
)è|| (Ï¡tok =ğ
LXLP
)è&& ((
	`isBšOp
(
tok
)è|| (tok =ğ
LXRP
)))

161 
	`·r£E¼
(
’d
, "missing operand");

162  
TRUE
;

164  
FALSE
;

165 
	}
}

167 
	$g‘Next
(**
¡r
)

169 
c
;

170 
Ï¡tok
;

171 
id’t
[100];

173 
Ï¡tok
 = 
thi¡ok
;

174 
c
 = *(*
¡r
)++;

176 ià(
c
 == '*')

178 ià(**
¡r
 == '*')

180 (*
¡r
)++;

181 
thi¡ok
 = 
LXEXP
;

184 
thi¡ok
 = 
LXMULT
;

186 ià(
c
 == '/')

187 
thi¡ok
 = 
LXDIV
;

188 ià(
c
 == '|')

189 
thi¡ok
 = 
	`g‘2
(
¡r
, '|', 
LXOR
, 
LXEOI
);

190 ià(
c
 == '&')

191 
thi¡ok
 = 
	`g‘2
(
¡r
, '&', 
LXAND
, 
LXMOD
);

192 ià(
c
 == '^')

193 
thi¡ok
 = 
LXEXP
;

194 ià(
c
 == '(')

196 
·»Æev–
++;

197 
thi¡ok
 = 
LXLP
;

199 ià(
c
 == ')')

201 ià(
·»Æev–
 == 0)

203 
thi¡ok
 = 
LXEOI
;

204 (*
¡r
)--;

208 
·»Æev–
--;

209 
thi¡ok
 = 
LXRP
;

212 ià(
c
 == '+')

214 ià(
	`isuÇry
(
thi¡ok
))

215 
thi¡ok
 = 
LXUPLUS
;

217 
thi¡ok
 = 
LXPLUS
;

219 ià(
c
 == '-')

221 ià(
	`isuÇry
(
thi¡ok
))

222 
thi¡ok
 = 
LXUMINUS
;

224 
thi¡ok
 = 
LXMINUS
;

226 ià(
c
 == '>')

227 
thi¡ok
 = 
	`g‘2
(
¡r
, '=', 
LXGE
, 
LXGT
);

228 ià(
c
 == '<')

229 
thi¡ok
 = 
	`g‘2
(
¡r
, '=', 
LXLE
, 
LXLT
);

230 ià(
c
 == '=')

231 
thi¡ok
 = 
	`g‘2
(
¡r
, '=', 
LXEQ
, LXEQ);

232 ià(
c
 == '!')

233 
thi¡ok
 = 
	`g‘2
(
¡r
, '=', 
LXNE
, 
LXNOT
);

234 ià(
	`isdig™
(
c
))

236 
thisv®
 = 
	`cŞËùIÁ
(
c
, 
¡r
);

237 
thi¡ok
 = 
LXINT
;

239 ià(
	`ÿnS¹V¬
(
c
))

241 (*
¡r
)--;

242 
	`g‘Id’tif›r
(
¡r
, 
id’t
);

243 
thi¡ok
 = 
LXINT
;

244 
thisv®
 = 
	`g‘IdV®
(
id’t
);

248 (*
¡r
)--;

249 
thi¡ok
 = 
LXEOI
;

251 
	`checkE¼Ü
(
Ï¡tok
, 
thi¡ok
, *
¡r
);

252 
	}
}

256 
	$doAùiÚ
(
İ
, *
·r£SŒ
)

258 
i
, 
n
, 
v®
;

259 
¬gs
[
NARGS
];

261 
n
 = 
Çrgs
[
İ
];

262 
i
 = 0; i < 
n
; i++)

263 ià(
	`em±ySck
(&
v®Sck
))

265 
	`·r£E¼
(
·r£SŒ
, "too few operands");

266 
¬gs
[
i
] = 0;

269 
¬gs
[
i
] = ()(
šŒ_t
)
	`pİ
(&
v®Sck
);

271 
İ
)

273 
LXEOI
:

274 
LXLP
:

275 
LXRP
:

276 
LXUPLUS
:

278 
LXEQ
:

279 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] ==‡rgs[0]));

281 
LXOR
:

282 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] ||‡rgs[0]));

284 
LXAND
:

285 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] &&‡rgs[0]));

287 
LXNE
:

288 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] !=‡rgs[0]));

290 
LXGT
:

291 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] >‡rgs[0]));

293 
LXGE
:

294 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] >=‡rgs[0]));

296 
LXLT
:

297 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] <‡rgs[0]));

299 
LXLE
:

300 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] <=‡rgs[0]));

302 
LXNOT
:

303 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(!
¬gs
[0]));

305 
LXPLUS
:

306 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] +‡rgs[0]));

308 
LXMINUS
:

309 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] -‡rgs[0]));

311 
LXMULT
:

312 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] *‡rgs[0]));

314 
LXDIV
:

315 ià(
¬gs
[0] == 0)

317 
	`´”rÜ
(";‡ttempto divide by zero\n");

318 
	`push
(&
v®Sck
, (*)(
šŒ_t
)0);

321 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] /‡rgs[0]));

323 
LXMOD
:

324 ià(
¬gs
[0] == 0)

326 
	`´”rÜ
(";‡ttempto divide by zero\n");

327 
	`push
(&
v®Sck
, (*)(
šŒ_t
)
¬gs
[1]);

330 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(
¬gs
[1] %‡rgs[0]));

332 
LXEXP
:

333 
v®
 = 1;

334 
i
 = 1; i <ğ
¬gs
[0]; i++)

335 
v®
 *ğ
¬gs
[1];

336 
	`push
(&
v®Sck
, (*)(
šŒ_t
)
v®
);

338 
LXUMINUS
:

339 
	`push
(&
v®Sck
, (*)(
šŒ_t
)(-
¬gs
[0]));

342 
	`´”rÜ
(";internalƒrror: shouldn't get here\n");

344 
	}
}

350 
	$—tIÁ
(**
¡r
)

352 
a
, 
Ï¡İ
;

354 
·»Æev–
 = 0;

355 
thi¡ok
 = 
LXEOI
;

356 
	`š™Sck
(&
İSck
);

357 
	`push
(&
İSck
, (*)(
šŒ_t
)
LXEOI
);

358 
	`š™Sck
(&
v®Sck
);

360 
begšSŒ
 = *
¡r
;

361 
	`g‘Next
(
¡r
);

362 
TRUE
)

364 
a
 = ()(
šŒ_t
)
	`tos
(&
İSck
);

365 ià((
thi¡ok
 =ğ
LXEOI
è&& (
a
 == LXEOI))

367 ià(
	`em±ySck
(&
v®Sck
))

369 
	`´”rÜ
("; missing operand\n");

373  ()(
šŒ_t
)
	`pİ
(&
v®Sck
);

375 ià(
thi¡ok
 =ğ
LXINT
)

377 
	`push
(&
v®Sck
, (*)(
šŒ_t
)
thisv®
);

378 
	`g‘Next
(
¡r
);

380 ià(
å»c
[
a
] <ğ
g´ec
[
thi¡ok
])

382 
	`push
(&
İSck
, (*)(
šŒ_t
)
thi¡ok
);

383 
	`g‘Next
(
¡r
);

389 
Ï¡İ
 = ()(
šŒ_t
)
	`pİ
(&
İSck
);

390 
	`doAùiÚ
(
Ï¡İ
, *
¡r
);

391 } 
å»c
[()(
šŒ_t
)
	`tos
(&
İSck
)] >ğ
g´ec
[
Ï¡İ
]);

394 
	}
}

396 
	$·r£IÁ
(**
¡r
)

398 
n
;

400 ià(
amP¬sšg
 == 0)

402 
amP¬sšg
 = 1;

403 
begšSŒ
 = *
¡r
;

404 ià(
	`£tjmp
(
jmµ¬£
))

406 
amP¬sšg
 = 0;

409 
n
 = 
	`—tIÁ
(
¡r
);

410 
amP¬sšg
 = 0;

411  
n
;

413 
n
 = 
	`—tIÁ
(
¡r
);

414  
n
;

415 
	}
}

417 
	$g‘IÁ
(cÚ¡ *
s
)

420 
buf
[256];

421 
	`¡ºıy
(
buf
, 
s
, (buf) - 1);

422 
buf
[(buf) - 1] = '\0';

423 *
¡r
 = 
buf
;

424  
	`·r£IÁ
(&
¡r
);

425 
	}
}

427 
	$»adIÁ
(**
¡r
)

429 
n
;

431 
n
 = 
	`·r£IÁ
(
¡r
);

432 ià(**
¡r
 != '\0')

433 
	`´”rÜ
(";…rematureƒnd ofƒxpression\n");

434  
n
;

435 
	}
}

	@parse.h

4 
	~<£tjmp.h
>

7 
¡ack_¡ruù
 
	t¡ack
;

10 
·r£IÁ
(**
¡r
);

11 
g‘IÁ
(cÚ¡ *
s
);

12 
»adIÁ
(**
¡r
);

13 
boŞ—n
 
em±ySck
(
¡ack
 *
¡
);

14 
š™Sck
(
¡ack
 *
¡
);

15 *
pİ
(
¡ack
 *
¡
);

16 
push
(
¡ack
 *
¡
, *
v®
);

17 *
tos
(
¡ack
 *
¡
);

18 
cŞËùIÁ
(
c
, **
¡r
);

19 
—tIÁ
(**
¡r
);

20 
·r£E¼
(*
’d
, cÚ¡ *
mess
);

23 
å»c
[];

24 
g´ec
[];

25 
Çrgs
[];

26 
jmp_buf
 
jmµ¬£
;

27 *
begšSŒ
;

28 
amP¬sšg
;

	@parsepoly.c

4 
	~<ùy³.h
>

5 
	~<£tjmp.h
>

6 
	~<¡dšt.h
>

7 
	~"sh¬ed.h
"

8 
	~"·r£pŞy.h
"

9 
	~"·r£.h
"

10 
	~"pŞy.h
"

11 
	~"mÚ™Ü.h
"

12 
	~"rv¬.h
"

13 
	~"v¬s.h
"

14 
	~"gm_pŞy.h
"

15 
	~"humª_io.h
"

24 
cÚ¡ex´
 
	gNSTACK
 = 100;

25 
	s¡ack_¡ruù


27 
	mtİ
;

28 *
	mv®s
[
NSTACK
];

32 
cÚ¡ex´
 
	gNARGS
 = 10;

39 #iâdeà
LXEOI


40 
cÚ¡ex´
 
	gLXEOI
 = 0;

41 
cÚ¡ex´
 
	gLXINT
 = 1;

42 
cÚ¡ex´
 
	gLXPOLY
 = 2;

43 
cÚ¡ex´
 
	gLXLP
 = 3;

44 
cÚ¡ex´
 
	gLXRP
 = 4;

45 
cÚ¡ex´
 
	gLXLB
 = 5;

46 
cÚ¡ex´
 
	gLXRB
 = 6;

47 
cÚ¡ex´
 
	gLXPLUS
 = 7;

48 
cÚ¡ex´
 
	gLXMINUS
 = 8;

49 
cÚ¡ex´
 
	gLXMULT
 = 9;

50 
cÚ¡ex´
 
	gLXDIV
 = 10;

51 
cÚ¡ex´
 
	gLXMOD
 = 11;

52 
cÚ¡ex´
 
	gLXEXP
 = 12;

53 
cÚ¡ex´
 
	gLXEQUAL
 = 13;

54 
cÚ¡ex´
 
	gLXSEMI
 = 14;

55 
cÚ¡ex´
 
	gLXCOMMA
 = 15;

56 
cÚ¡ex´
 
	gLXUPLUS
 = 16;

57 
cÚ¡ex´
 
	gLXUMINUS
 = 17;

61 
šlše
 
boŞ
 
	$isuÇry
(
tok
)

63  (
tok
 =ğ
LXEOI
è|| (tok =ğ
LXLP
è|| (tok =ğ
LXLB
è|| (tok >ğ
LXPLUS
 &&ok <ğ
LXEXP
) ||

64 (
tok
 =ğ
LXEQUAL
è|| (tok =ğ
LXSEMI
è|| (tok =ğ
LXCOMMA
);

65 
	}
}

67 
šlše
 
boŞ
 
	$isO³¿tÜ
(
tok
)

69  (
tok
 >ğ
LXPLUS
 &&ok <ğ
LXUMINUS
);

70 
	}
}

72 
šlše
 
boŞ
 
	$isBšOp
(
tok
)

74  (
tok
 >ğ
LXPLUS
 &&ok <ğ
LXEXP
);

75 
	}
}

88 
	g±hi¡ok
;

89 
pŞy
 
	g±hisv®
;

90 
	g™hisv®
;

92 
	gpCompÚ’t
;

94 
¡ack
 
	gpOpSck
;

95 
¡ack
 
	gpV®Sck
;

97 
	gpP¬’Ëv–
;

106 
	$pG‘Next
(**
¡r
)

108 
Ï¡tok
, 
v¬num
;

109 
c
;

110 
id’t
[100];

112 
Ï¡tok
 = 
±hi¡ok
;

113 
c
 = *(*
¡r
)++;

116 ià(((
c
 =ğ'('è|| (ø=ğ'{'è|| (
	`v®idV¬
(c))) &&

117 ((
Ï¡tok
 =ğ
LXINT
è|| (Ï¡tok =ğ
LXRP
è|| (Ï¡tok =ğ
LXPOLY
)))

120 (*
¡r
)--;

121 
±hi¡ok
 = 
LXMULT
;

126 ià((
	`isdig™
(
c
)è&& ((
Ï¡tok
 =ğ
LXRP
è|| (Ï¡tok =ğ
LXPOLY
)))

129 (*
¡r
)--;

130 
±hi¡ok
 = 
LXEXP
;

136 ià(
Ï¡tok
 =ğ
LXEXP
)

138 ià(
c
 == '(')

140 
™hisv®
 = 
	`—tIÁ
(
¡r
);

141 ià(**
¡r
 != ')')

142 
	`·r£E¼
(*
¡r
, "missing„ight…arenthesis");

143 (*
¡r
)++;

145 ià(
	`ÿnS¹V¬
(
c
))

147 (*
¡r
)--;

148 
	`g‘Id’tif›r
(
¡r
, 
id’t
);

149 
™hisv®
 = 
	`g‘IdV®
(
id’t
);

151 ià(
	`isdig™
(
c
))

153 
™hisv®
 = 
	`cŞËùIÁ
(
c
, 
¡r
);

156 
	`·r£E¼
(*
¡r
, "badƒxponent");

157 
±hi¡ok
 = 
LXINT
;

161 ià(
c
 == '*')

163 ià(**
¡r
 == '*')

165 (*
¡r
)++;

166 
±hi¡ok
 = 
LXEXP
;

169 
±hi¡ok
 = 
LXMULT
;

171 ià(
c
 == '/')

172 
±hi¡ok
 = 
LXDIV
;

173 ià(
c
 == '&')

174 
±hi¡ok
 = 
LXMOD
;

175 ià(
c
 == '^')

176 
±hi¡ok
 = 
LXEXP
;

177 ià(
c
 == '(')

179 
pP¬’Ëv–
++;

180 
±hi¡ok
 = 
LXLP
;

182 ià(
c
 == ')')

184 ià(
pP¬’Ëv–
 == 0)

186 
±hi¡ok
 = 
LXEOI
;

187 (*
¡r
)--;

191 
pP¬’Ëv–
--;

192 
±hi¡ok
 = 
LXRP
;

195 ià(
c
 == '+')

197 ià(
	`isuÇry
(
±hi¡ok
))

198 
±hi¡ok
 = 
LXUPLUS
;

200 
±hi¡ok
 = 
LXPLUS
;

202 ià(
c
 == '-')

204 ià(
	`isuÇry
(
±hi¡ok
))

205 
±hi¡ok
 = 
LXUMINUS
;

207 
±hi¡ok
 = 
LXMINUS
;

209 ià(
	`v®idV¬
(
c
))

211 (*
¡r
)--;

212 
v¬num
 = 
	`·r£V¬
(
¡r
);

213 ià(
v¬num
 == -1)

215 
	`´”rÜ
(";„ing variable‚ot defined\n");

216 
±hisv®
 = 
nuÎ±r
;

220 
±hisv®
 = 
	`p_xjei
(
v¬num
, 
pCompÚ’t
);

222 
±hi¡ok
 = 
LXPOLY
;

224 ià(
	`isdig™
(
c
))

226 
±hisv®
 = 
	`p_šŞy
(
	`cŞËùIÁ
(
c
, 
¡r
), 
pCompÚ’t
);

227 
±hi¡ok
 = 
LXPOLY
;

229 ià(
	`ÿnS¹V¬
(
c
))

231 (*
¡r
)--;

232 
	`g‘Id’tif›r
(
¡r
, 
id’t
);

233 
±hisv®
 = 
	`g‘PŞyId
(
id’t
, 
pCompÚ’t
);

234 
±hi¡ok
 = 
LXPOLY
;

238 (*
¡r
)--;

239 
±hi¡ok
 = 
LXEOI
;

241 
	`pCheckE¼Ü
(
Ï¡tok
, 
±hi¡ok
, *
¡r
);

242 
	}
}

244 
	$pCheckE¼Ü
(
Ï¡tok
, 
thi¡ok
, *
’d
)

246 ià(((
	`isO³¿tÜ
(
Ï¡tok
)è|| (Ï¡tok =ğ
LXLP
)è&& ((
	`isBšOp
(
thi¡ok
)è|| (thi¡ok =ğ
LXRP
)))

249 
	`·r£E¼
(
’d
, "missing operand");

250  (
TRUE
);

252  (
FALSE
);

253 
	}
}

255 
	$pDoAùiÚ
(
İ
, *
·r£SŒ
)

257 
pŞy
 
f
, 
g
;

258 
i
, 
n
;

259 
pŞy
 
¬gs
[
NARGS
];

261 ià(
İ
 =ğ
LXEXP
)

262 
n
 = 1;

264 
n
 = 
Çrgs
[
İ
];

265 
i
 = 0; i < 
n
; i++)

267 ià(
	`em±ySck
(&
pV®Sck
))

269 
	`·r£E¼
(
·r£SŒ
, "too few operands");

270 
¬gs
[
i
] = 
NULL
;

274 
¬gs
[
i
] = (
pŞy
)
	`pİ
(&
pV®Sck
);

278 
İ
)

280 
LXPLUS
:

281 
	`p_add
(
¬gs
,‡rgs + 1);

282 
	`push
(&
pV®Sck
, 
¬gs
[0]);

284 
LXMINUS
:

285 
	`p_sub
(
¬gs
 + 1,‡rgs);

286 
	`push
(&
pV®Sck
, 
¬gs
[1]);

288 
LXMULT
:

289 
f
 = 
	`p_muÉ
(
¬gs
[0],‡rgs[1]);

290 
	`push
(&
pV®Sck
, 
f
);

291 
	`p_kl
(
¬gs
);

292 
	`p_kl
(
¬gs
 + 1);

294 
LXDIV
:

295 
f
 = 
	`p_div
(&
¬gs
[1],‡rgs[0]);

296 
	`push
(&
pV®Sck
, 
f
);

297 
	`p_kl
(
¬gs
);

299 
LXMOD
:

300 
f
 = 
	`p_mod
(&
¬gs
[1],‡rgs[0]);

301 
	`push
(&
pV®Sck
, 
f
);

302 
	`p_kl
(
¬gs
);

304 
LXEXP
:

305 
n
 = 
™hisv®
;

306 
f
 = 
	`e_sub_i
(
pCompÚ’t
);

307 
i
 = 1; i <ğ
n
; i++)

309 
g
 = 
	`p_muÉ
(
f
, 
¬gs
[0]);

310 
	`p_kl
(&
f
);

311 
f
 = 
g
;

313 
	`p_kl
(
¬gs
);

314 
	`push
(&
pV®Sck
, 
f
);

316 
LXUMINUS
:

317 
	`p_Ãg©e
(
¬gs
);

318 
	`push
(&
pV®Sck
, 
¬gs
[0]);

320 
LXEOI
:

321 
LXLP
:

322 
LXRP
:

323 
LXUPLUS
:

326 
	`´”rÜ
(";internalƒrror: shouldn't get here\n");

328 
	}
}

330 
pŞy
 
	$—tPŞy
(**
¡r
, 
comp
)

332 
a
, 
Ï¡İ
;

334 
pCompÚ’t
 = 
comp
;

336 
pP¬’Ëv–
 = 0;

337 
±hi¡ok
 = 
LXEOI
;

338 
	`š™Sck
(&
pOpSck
);

339 
	`push
(&
pOpSck
, (*)(
šŒ_t
)
LXEOI
);

340 
	`š™Sck
(&
pV®Sck
);

342 
	`pG‘Next
(
¡r
);

343 
TRUE
)

345 
a
 = ()(
šŒ_t
)
	`tos
(&
pOpSck
);

346 ià((
±hi¡ok
 =ğ
LXEOI
è&& (
a
 == LXEOI))

348 ià(
	`em±ySck
(&
pV®Sck
))

350 
	`´”rÜ
("; missing operand\n");

351  (
NULL
);

354  ((
pŞy
)
	`pİ
(&
pV®Sck
));

356 ià(
±hi¡ok
 =ğ
LXPOLY
)

358 
	`push
(&
pV®Sck
, 
±hisv®
);

359 
	`pG‘Next
(
¡r
);

361 ià(
±hi¡ok
 =ğ
LXINT
)

362 
	`pG‘Next
(
¡r
);

363 ià(
å»c
[
a
] <ğ
g´ec
[
±hi¡ok
])

365 
	`push
(&
pOpSck
, (*)(
šŒ_t
)
±hi¡ok
);

366 
	`pG‘Next
(
¡r
);

372 
Ï¡İ
 = ()(
šŒ_t
)
	`pİ
(&
pOpSck
);

373 
	`pDoAùiÚ
(
Ï¡İ
, *
¡r
);

374 } 
å»c
[()(
šŒ_t
)
	`tos
(&
pOpSck
)] >ğ
g´ec
[
Ï¡İ
]);

377 
	}
}

379 
pŞy
 
	$·r£PŞy
(**
¡r
, 
comp
)

381 
pŞy
 
f
;

383 
amP¬sšg
 = 1;

384 ià(
	`£tjmp
(
jmµ¬£
))

386 
amP¬sšg
 = 0;

387  (
NULL
);

389 
begšSŒ
 = *
¡r
;

390 
f
 = 
	`—tPŞy
(
¡r
, 
comp
);

391 ià(**
¡r
 != '\0')

392 
	`´”rÜ
(";…rematureƒnd ofƒxpression\n");

393 
amP¬sšg
 = 0;

394  (
f
);

395 
	}
}

397 
pŞy
 
	$»adPŞy
(**
¡r
, 
comp
)

399 
pŞy
 
f
;

401 
f
 = 
	`·r£PŞy
(
¡r
, 
comp
);

402 ià(**
¡r
 != '\0')

403 
	`´”rÜ
(";…rematureƒnd ofƒxpression\n");

404  (
f
);

405 
	}
}

407 
pŞy
 
	$g‘PŞy
(*
s
, 
comp
)

409  (
	`·r£PŞy
(&
s
, 
comp
));

410 
	}
}

412 
pŞy
 
	$rdPŞy
(
whichComp
)

414 
pŞy
 
f
, 
g
;

415 *
¡r
;

417 
f
 = 
NULL
;

418 
	`g‘_cÚt¡r
("", &
¡r
))

420 
g
 = 
	`g‘PŞy
(
¡r
, 
whichComp
);

421 
	`p_add
(&
f
, &
g
);

423 
g
 = 
	`g‘PŞy
(
¡r
, 
whichComp
);

424 
	`p_add
(&
f
, &
g
);

425  (
f
);

426 
	}
}

428 
pŞy
 
	$rdPŞySŒ
(
¬gc
, **
¬gv
, 
whichComp
)

430 
pŞy
 
f
, 
g
;

431 *
¡r
;

433 
f
 = 
	`g‘PŞy
(
¬gv
[0], 
whichComp
);

434 ià(
¬gc
 == 1)

435  (
f
);

436 
	`g‘_cÚt¡r
("", &
¡r
))

438 
g
 = 
	`g‘PŞy
(
¡r
, 
whichComp
);

439 
	`p_add
(&
f
, &
g
);

441 
g
 = 
	`g‘PŞy
(
¡r
, 
whichComp
);

442 
	`p_add
(&
f
, &
g
);

443  (
f
);

444 
	}
}

	@parsepoly.h

5 
¡ack_¡ruù
 
	t¡ack
;

10 
pŞy
 
·r£PŞy
(** 
¡r
, 
comp
);

11 
pŞy
 
»adPŞy
(** 
¡r
, 
comp
);

12 
pŞy
 
g‘PŞy
(* 
s
, 
comp
);

13 
pŞy
 
rdPŞy
(
whichComp
);

14 
pŞy
 
rdPŞySŒ
(
¬gc
, ** 
¬gv
, 
whichComp
);

17 
pG‘Next
(** 
¡r
);

18 
pCheckE¼Ü
(
Ï¡tok
, 
thi¡ok
, * 
’d
);

19 
pDoAùiÚ
(
İ
, * 
·r£SŒ
);

20 
pŞy
 
—tPŞy
(** 
¡r
, 
comp
);

23 
±hi¡ok
;

24 
pŞy
 
±hisv®
;

25 
™hisv®
;

26 
pCompÚ’t
;

27 
¡ack
 
pOpSck
;

28 
¡ack
 
pV®Sck
;

29 
pP¬’Ëv–
;

	@plist.c

4 
	~"sh¬ed.h
"

5 
	~"¶i¡.h
"

6 
	~"mem.h
"

7 
	~"pŞy.h
"

8 
	~"‹rm.h
"

9 
	~"mÚoms.h
"

10 
	~"¡ash.h
"

12 
	$dl_cİy
(
dli¡
 *
dl1
, dli¡ *
dl2
)

14 
i
;

16 
	`dli¡_š™
(
dl2
);

17 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
 *)
dl1
); i++)

18 
	`dli¡_š£¹
(
dl2
, 
	`dli¡_»f
(
dl1
, 
i
));

19 
	}
}

21 
	$¶_cİy
(
¶i¡
 *
¶1
,…li¡ *
¶2
)

23 
i
;

25 
	`¶i¡_š™
(
¶2
);

26 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
 *)
¶1
); i++)

27 
	`¶i¡_š£¹
(
¶2
, 
	`p_cİy
(
	`¶i¡_»f
(
¶1
, 
i
)));

28 
	}
}

30 
	$¶_kl
(
¶i¡
 *
¶
)

32 
i
;

33 
pŞy
 *
p
;

35 
i
 = 1; i <ğ
	`¬¿y_Ëngth
((
¬¿y
 *)
¶
); i++)

37 
p
 = (
pŞy
 *)
	`»f
((
¬¿y
 *)
¶
, 
i
);

38 
	`p_kl
(
p
);

40 
	`ä“_¬¿y
((
¬¿y
 *)
¶
);

41 
	}
}

43 
	$dl_kl
(
dli¡
 *
dl
)

45 
	`ä“_¬¿y
((
¬¿y
 *)
dl
);

46 
	}
}

48 
	$dl_lohi
(
dli¡
 *
dl
, *
lo
, *
hi
)

50 
i
, 
d
;

52 ià(
	`¬¿y_Ëngth
((
¬¿y
 *)
dl
) == 0)

54 *
lo
 = 0;

55 *
hi
 = 0;

58 *
lo
 = 
	`dli¡_»f
(
dl
, 1);

59 *
hi
 = *
lo
;

60 
i
 = 2; i <ğ
	`¬¿y_Ëngth
((
¬¿y
 *)
dl
); i++)

62 
d
 = 
	`dli¡_»f
(
dl
, 
i
);

63 ià(
d
 < *
lo
)

64 *
lo
 = 
d
;

65 ià(
d
 > *
hi
)

66 *
hi
 = 
d
;

68 
	}
}

70 
gm©rix
 
	$mod_š™
()

72 
gm©rix
 
M
;

74 
M
 = 
	`Ãw_mod
();

75 
M
->
Ãxt
 = 
NULL
;

76 
M
->
modty³
 = 
MMAT
;

77 
	`dli¡_š™
(&(
M
->
deg»es
));

78 
	`dli¡_š™
(&(
M
->
degg’s
));

79 
	`¶i¡_š™
(&(
M
->
g’s
));

80 
M
->
n¡ªd¬d
 = 0;

81 
M
->
¡dbasis
 = 
NULL
;

82 
	`mo_š™
(
M
);

83  (
M
);

84 
	}
}

86 
gm©rix
 
	$m©_cİy
(
gm©rix
 
M
)

88 
gm©rix
 
»suÉ
;

90 
»suÉ
 = 
	`Ãw_mod
();

91 
»suÉ
->
Ãxt
 = 
NULL
;

92 
»suÉ
->
modty³
 = 
MMAT
;

93 
	`dl_cİy
(&(
M
->
deg»es
), &(
»suÉ
->degrees));

94 
	`dl_cİy
(&(
M
->
degg’s
), &(
»suÉ
->deggens));

95 
	`¶_cİy
(&(
M
->
g’s
), &(
»suÉ
->gens));

96 
»suÉ
->
n¡ªd¬d
 = 0;

97 
»suÉ
->
¡dbasis
 = 
NULL
;

98 
	`mo_š™
(
»suÉ
);

99  (
»suÉ
);

100 
	}
}

102 
	$¡d_kl
(
mn_¡ªd¬d
 
p
)

104 
mn_¡ªd¬d
 
‹mp
;

106 
p
 !ğ
NULL
)

108 
‹mp
 = 
p
;

109 
p
 =…->
Ãxt
;

110 
	`p_kl
(&
‹mp
->
¡ªd¬d
);

111 
	`p_kl
(&
‹mp
->
chªge
);

112 
	`ä“_¦ug
((
¡ash
 *)
¡d_¡ash
, (
¦ug
 *)
‹mp
);

114 
	}
}

116 
	$mod_kl
(
gm©rix
 
M
)

118 ià(
M
 =ğ
NULL
)

120 
	`dl_kl
(&(
M
->
deg»es
));

121 
	`dl_kl
(&(
M
->
degg’s
));

122 
	`¶_kl
(&(
M
->
g’s
));

123 
	`¡d_kl
(
M
->
¡dbasis
);

124 
M
->
n¡ªd¬d
 = 0;

125 
	`mo_kl
(
M
);

126 
	`ä“_¦ug
((
¡ash
 *)
mod_¡ash
, (
¦ug
 *)
M
);

127 
	}
}

129 
	$deg»e
(
gm©rix
 
M
, 
pŞy
 
f
)

131 ià(
f
 =ğ
NULL
)

133  (
	`tm_deg»e
(
	`pŞy_š™Ÿl
(
f
)è+ 
	`dli¡_»f
(&
M
->
deg»es
, 
	`tm_compÚ’t
(poly_initial(f))));

134 
	}
}

	@plist.h

5 
dl_cİy
(
dli¡
* 
dl1
, dli¡* 
dl2
);

6 
¶_cİy
(
¶i¡
* 
¶1
,…li¡* 
¶2
);

7 
¶_kl
(
¶i¡
* 
¶
);

8 
dl_kl
(
dli¡
* 
dl
);

9 
dl_lohi
(
dli¡
* 
dl
, * 
lo
, * 
hi
);

12 
gm©rix
 
mod_š™
();

13 
gm©rix
 
m©_cİy
(gm©rix 
M
);

14 
mod_kl
(
gm©rix
 
M
);

15 
¡d_kl
(
mn_¡ªd¬d
 
p
);

18 
deg»e
(
gm©rix
 
M
, 
pŞy
 
f
);

	@poly.c

4 
	~"sh¬ed.h
"

5 
	~"pŞy.h
"

6 
	~"mem.h
"

7 
	~"¡ash.h
"

8 
	~"ch¬p.h
"

9 
	~"‹rm.h
"

10 
	~"qršg.h
"

11 
	~"ršg.h
"

12 #ifdeà
STATISTICS


13 
	~"¡©s.h
"

18 
pŞy
 
	gaddnode
;

20 
pŞy
 
	$p_li¡h—d
()

22 
pŞy
 
»suÉ
;

23 *
±r
;

25 
±r
 = 
	`g‘_sm®l
((
pŞ
));

26 
»suÉ
 = (
pŞy
)
±r
;

27  (
»suÉ
);

28 
	}
}

30 
	$š™_pŞys
()

32 
addnode
 = 
	`p_li¡h—d
();

33 
	}
}

37 
pŞy
 
	$p_mÚom
(
f›ld
 
a
)

39 
pŞy
 
»suÉ
;

40 *
±r
;

41 
size_t
 
off£t
;

42 
‹rm
 
t
;

43 
i
;

45 
±r
 = 
	`g‘_¦ug
((
¡ash
 *)
pSsh
);

46 
»suÉ
 = (
pŞy
)
±r
;

47 
»suÉ
->
cÛf
 = 
	`fd_cİy
(
a
);

48 
»suÉ
->
Ãxt
 = 
NULL
;

52 
off£t
 = (
pŞ
);

54 
off£t
 = (offset + () - 1) & ~(() - 1);

55 
»suÉ
->
mÚom
 = (*)
±r
 + 
off£t
;

58 
t
 = (
‹rm
)
»suÉ
->
mÚom
;

59 
i
 = 0; i < 
nblocks
; i++)

60 
t
[
i
] = 0;

62  (
»suÉ
);

63 
	}
}

65 
pŞy
 
	$p_š™Ÿl
(
pŞy
 
f
)

67 
pŞy
 
»suÉ
;

69 
»suÉ
 = 
	`p_mÚom
(
f
->
cÛf
);

70 
	`tm_cİy
(
	`š™Ÿl
(
f
), in™Ÿl(
»suÉ
));

71  (
»suÉ
);

72 
	}
}

74 
	$p_kl
(
pŞy
 *
f
)

76 
pŞy
 
‹mp
;

77 
pŞy
 
wf
;

79 
wf
 = *
f
;

80 
wf
 !ğ
NULL
)

82 
‹mp
 = 
wf
;

83 
wf
 = wf->
Ãxt
;

84 
	`ä“_¦ug
((
¡ash
 *)
pSsh
, (
¦ug
 *)
‹mp
);

86 *
f
 = 
NULL
;

87 
	}
}

89 
pŞy
 
	$e_sub_i
(
i
)

91 
pŞy
 
»suÉ
;

93 
»suÉ
 = 
	`p_mÚom
(
fd_Úe
);

94 
	`‹rm_i
(
i
, 
	`š™Ÿl
(
»suÉ
));

95  (
»suÉ
);

96 
	}
}

98 
pŞy
 
	$p_šŞy
(
n
, 
comp
)

100 
pŞy
 
»suÉ
;

101 
f›ld
 
a
;

103 
a
 = 
	`nÜm®ize
(
n
);

104 ià(
a
 == 0)

105  (
NULL
);

106 
»suÉ
 = 
	`p_mÚom
(
a
);

107 
	`‹rm_i
(
comp
, 
	`š™Ÿl
(
»suÉ
));

108  (
»suÉ
);

109 
	}
}

111 
pŞy
 
	$p_xjei
(
j
, 
i
)

113 
pŞy
 
»suÉ
;

115 
»suÉ
 = 
	`p_mÚom
(
fd_Úe
);

116 
	`tm_xjei
(
j
, 
i
, 
	`š™Ÿl
(
»suÉ
));

117 
	`qrgReduû
(&
»suÉ
);

118  (
»suÉ
);

119 
	}
}

121 
pŞy
 
	$p_cİy
(
pŞy
 
f
)

123 
pŞy
 
š»suÉ
;

125 
š»suÉ
 = 
addnode
;

126 
addnode
->
Ãxt
 = 
NULL
;

127 
f
 !ğ
NULL
)

129 
š»suÉ
->
Ãxt
 = 
	`p_š™Ÿl
(
f
);

130 
f
 = f->
Ãxt
;

131 
š»suÉ
 = iÄesuÉ->
Ãxt
;

133  (
addnode
->
Ãxt
);

134 
	}
}

136 
pŞy
 
	$p_š
(
pŞy
 
f
, 
n
)

138 
‹rm
 
t
;

139 
pŞy
 
š»suÉ
;

141 ià(
f
 =ğ
NULL
)

142  (
NULL
);

143 
t
 = (
‹rm
)
	`š™Ÿl
(
f
);

144 
š»suÉ
 = 
addnode
;

145 
addnode
->
Ãxt
 = 
NULL
;

146 (
f
 !ğ
NULL
è&& (
	`tm_šEq
(
t
, 
	`š™Ÿl
(f), 
n
)))

148 
š»suÉ
->
Ãxt
 = 
	`p_š™Ÿl
(
f
);

149 
f
 = f->
Ãxt
;

150 
š»suÉ
 = iÄesuÉ->
Ãxt
;

152  (
addnode
->
Ãxt
);

153 
	}
}

155 
	$p_add
(
pŞy
 *
f1
,…Şy *
g1
)

157 
pŞy
 
š»suÉ
, 
f
, 
g
;

158 
pŞy
 
‹mp1
, 
‹mp2
;

160 
š»suÉ
 = 
addnode
;

161 
f
 = *
f1
;

162 
g
 = *
g1
;

163 *
g1
 = 
NULL
;

165 
TRUE
)

167 ià(
f
 =ğ
NULL
)

169 
š»suÉ
->
Ãxt
 = 
g
;

170 *
f1
 = 
addnode
->
Ãxt
;

173 ià(
g
 =ğ
NULL
)

175 
š»suÉ
->
Ãxt
 = 
f
;

176 *
f1
 = 
addnode
->
Ãxt
;

180 
	`tm_com·»
(
	`š™Ÿl
(
f
), in™Ÿl(
g
)))

182 
GT
:

183 
š»suÉ
->
Ãxt
 = 
f
;

184 
š»suÉ
 = 
f
;

185 
f
 = f->
Ãxt
;

187 
LT
:

188 
š»suÉ
->
Ãxt
 = 
g
;

189 
š»suÉ
 = 
g
;

190 
g
 = g->
Ãxt
;

192 
EQ
:

193 
‹mp1
 = 
f
;

194 
‹mp2
 = 
g
;

195 
f
 = f->
Ãxt
;

196 
g
 = g->
Ãxt
;

197 
‹mp1
->
Ãxt
 = 
NULL
;

198 
‹mp2
->
Ãxt
 = 
NULL
;

199 
	`fd_add
(
‹mp1
->
cÛf
, 
‹mp2
->coef, &(temp1->coef));

200 
	`p_kl
(&
‹mp2
);

201 ià(
	`fd_isz”o
(
‹mp1
->
cÛf
))

202 
	`p_kl
(&
‹mp1
);

205 
š»suÉ
->
Ãxt
 = 
‹mp1
;

206 
š»suÉ
 = 
‹mp1
;

211 
	}
}

213 
	$p_Ãg©e
(
pŞy
 *
g
)

215 
pŞy
 
‹mp
;

217 
‹mp
 = (*
g
);em°!ğ
NULL
;em°ğ‹mp->
Ãxt
)

218 
	`fd_Ãg©e
(&(
‹mp
->
cÛf
));

219 
	}
}

221 
	$p_sub
(
pŞy
 *
f
,…Şy *
g
)

223 
	`p_Ãg©e
(
g
);

224 
	`p_add
(
f
, 
g
);

225 
	}
}

227 
pŞy
 
	$p1_muÉ
(
f›ld
 
a
, 
‹rm
 
t
, 
pŞy
 
f
)

229 
pŞy
 
š»suÉ
;

230 
f›ld
 
b
;

231 
big‹rm
 
big
;

233 ià(
f
 =ğ
NULL
)

234  (
NULL
);

235 
š»suÉ
 = 
addnode
;

236 
š»suÉ
->
Ãxt
 = 
NULL
;

237 
	`sToBig
(
t
, 
big
);

238 
f
 !ğ
NULL
)

240 
	`fd_muÉ
(
a
, 
f
->
cÛf
, &
b
);

241 
š»suÉ
->
Ãxt
 = 
	`p_mÚom
(
b
);

242 
š»suÉ
 = iÄesuÉ->
Ãxt
;

243 
	`tm_add
(
	`š™Ÿl
(
f
), 
big
, in™Ÿl(
š»suÉ
));

244 
f
 = f->
Ãxt
;

246  (
addnode
->
Ãxt
);

247 
	}
}

249 
pŞy
 
	$p_muÉ
(
pŞy
 
f
,…Şy 
g
)

251 
pŞy
 
»suÉ
, 
‹mp
;

253 
»suÉ
 = 
NULL
;

254 
f
 !ğ
NULL
)

256 
‹mp
 = 
	`p1_muÉ
(
f
->
cÛf
, 
	`š™Ÿl
(f), 
g
);

257 
	`p_add
(&
»suÉ
, &
‹mp
);

258 
f
 = f->
Ãxt
;

260 
	`qrgReduû
(&
»suÉ
);

261  (
»suÉ
);

262 
	}
}

268 
	$¥ecŸl_sub
(
pŞy
 *
f
, 
f›ld
 
a
, 
‹rm
 
t
,…Şy 
h
)

270 
pŞy
 
g
;

272 #ifdeà
STATISTICS


273 
¡¥ecŸl
++;

275 
g
 = 
	`p1_muÉ
(
a
, 
t
, 
h
);

276 
	`p_sub
(
f
, &
g
);

277 
	}
}

281 
pŞy
 
	$muÉ_sub
(
‹rm
 
s1
, 
pŞy
 
g1
,”m 
s2
,…Şy 
g2
)

283 
pŞy
 
h1
, 
h2
;

285 
h1
 = 
	`p1_muÉ
(
fd_Úe
, 
s1
, 
g1
);

286 
h2
 = 
	`p1_muÉ
(
fd_Úe
, 
s2
, 
g2
);

287 
	`p_sub
(&
h1
, &
h2
);

288  (
h1
);

289 
	}
}

293 
	$make1_mÚic
(
pŞy
 *
f
)

295 
f›ld
 
a
;

296 
pŞy
 
p
;

297 
a
 = 
	`fd_cİy
((*
f
)->
cÛf
);

298 
	`fd_»c
(&
a
);

299 
p
 = (*
f
);… !ğ
NULL
;… =…->
Ãxt
)

300 
	`fd_muÉ
(
a
, 
p
->
cÛf
, &(p->coef));

301 
	}
}

303 
	$make2_mÚic
(
pŞy
 *
f
,…Şy *
ä•
)

305 
f›ld
 
a
;

306 
pŞy
 
p
;

308 
a
 = 
	`fd_cİy
((*
f
)->
cÛf
);

309 
	`fd_»c
(&
a
);

310 
p
 = (*
f
);… !ğ
NULL
;… =…->
Ãxt
)

311 
	`fd_muÉ
(
a
, 
p
->
cÛf
, &(p->coef));

312 
p
 = (*
ä•
);… !ğ
NULL
;… =…->
Ãxt
)

313 
	`fd_muÉ
(
a
, 
p
->
cÛf
, &(p->coef));

314 
	}
}

	@poly.h

5 
pŞy
 
p_li¡h—d
();

6 
š™_pŞys
();

7 
pŞy
 
p_mÚom
(
f›ld
 
a
);

8 
pŞy
 
p_š™Ÿl
ÕŞy 
f
);

9 
p_kl
(
pŞy
* 
f
);

10 
pŞy
 
e_sub_i
(
i
);

11 
pŞy
 
p_šŞy
(
n
, 
comp
);

12 
pŞy
 
p_xjei
(
j
, 
i
);

13 
pŞy
 
p_cİy
ÕŞy 
f
);

14 
pŞy
 
p_š
ÕŞy 
f
, 
n
);

15 
p_add
(
pŞy
* 
f1
,…Şy* 
g1
);

16 
p_Ãg©e
(
pŞy
* 
g
);

17 
p_sub
(
pŞy
* 
f
,…Şy* 
g
);

18 
pŞy
 
p1_muÉ
(
f›ld
 
a
, 
‹rm
 
t
,…Şy 
f
);

19 
pŞy
 
p_muÉ
ÕŞy 
f
,…Şy 
g
);

20 
¥ecŸl_sub
(
pŞy
* 
f
, 
f›ld
 
a
, 
‹rm
 
t
,…Şy 
h
);

21 
pŞy
 
muÉ_sub
(
‹rm
 
s1
,…Şy 
g1
,”m 
s2
,…Şy 
g2
);

22 
make1_mÚic
(
pŞy
* 
f
);

23 
make2_mÚic
(
pŞy
* 
f
,…Şy* 
ä•
);

26 
pŞy
 
addnode
;

	@printf.c

4 
	~<ùy³.h
>

5 
	~<¡d¬g.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	~"sh¬ed.h
"

10 
	~"´štf.h
"

11 
	~"mÚ™Ü.h
"

14 *
	goutbuf
 = 
NULL
;

15 
size_t
 
	goutbuf_size
 = 0;

17 cÚ¡ *
	gdig™s
 = "0123456789ABCDEF";

20 
	$’su»_outbuf
(
size_t
 
Ãeded
)

22 ià(
Ãeded
 > 
outbuf_size
)

25 
size_t
 
Ãw_size
 = 
outbuf_size
 * 3 / 2;

26 ià(
Ãw_size
 < 
Ãeded
)

27 
Ãw_size
 = 
Ãeded
;

28 ià(
Ãw_size
 < 256)

29 
Ãw_size
 = 256;

31 *
Ãw_buf
 = 
	`»®loc
(
outbuf
, 
Ãw_size
);

32 ià(!
Ãw_buf
)

34 
	`årštf
(
¡d”r
, "Memory‡llocation failed in…rintf module\n");

35 
	`ex™
(1);

37 
outbuf
 = 
Ãw_buf
;

38 
outbuf_size
 = 
Ãw_size
;

40 
	}
}

42 
	$i_¢iff
()

45 
	`’su»_outbuf
(256);

46 
	}
}

48 
	$™ß
(
n
, *
s
, 
ba£
)

50 
a
 = ()
n
;

51 
	`Éß
(
a
, 
s
, 
ba£
);

52 
	}
}

54 
	$Éß
(
n
, *
s
, 
ba£
)

56 
a
;

58 ià((
n
 < 0è&& (
ba£
 == 10))

60 *
s
++ = '-';

61 
a
 = ()(-
n
);

64 
a
 = ()
n
;

65 
	`´šŠ
(&
s
, 
a
, 
ba£
);

66 *
s
 = '\0';

67 
	}
}

69 
	$´šŠ
(**
s
, 
a
, 
ba£
)

71 
b
;

72 
»m
;

74 
b
 = 
a
 / ()
ba£
;

75 ià(
b
 != 0)

76 
	`´šŠ
(
s
, 
b
, 
ba£
);

77 
»m
 = ()(
a
 % ()
ba£
);

78 ià(
»m
 < 0)

79 
»m
 +ğ
ba£
;

80 *(*
s
)++ = 
dig™s
[
»m
];

81 
	}
}

83 
	$put™
(*
buf
, 
FILE
 *
¡»am
)

85 
	`åuts
(
buf
, 
¡»am
);

87 ià((
¡»am
 =ğ
¡dout
è|| (¡»am =ğ
¡d”r
))

88 ià(
am_mÚ™Üšg
 == 1)

90 
	`åuts
(
buf
, 
mÚfe
);

91 
	`fæush
(
mÚfe
);

93 
	}
}

95 
	$doPršt
(cÚ¡ *
fmt
, 
va_li¡
 *
­
, 
FILE
 *
¡»am
)

97 
c
, 
n
, 
i
;

98 
boŞ—n
 
Ëá
;

99 
ašt
;

100 
®Úg
;

101 *
a¡r
;

102 
size_t
 
fmt_chunk_size
 = 256;

104 
Œue
)

107 
i
 = 0;

109 cÚ¡ *
tmp_fmt
 = 
fmt
;

110 *
tmp_fmt
 && *tmp_fmt != '%')

112 
tmp_fmt
++;

113 
i
++;

117 
	`’su»_outbuf
((
size_t
)(
i
 + 1));

120 
i
 = 0;

121 (
c
 = *
fmt
++) != '%')

123 
outbuf
[
i
++] = ()
c
;

124 ià(
c
 == '\0')

126 
	`put™
(
outbuf
, 
¡»am
);

130 
outbuf
[
i
] = '\0';

131 
	`put™
(
outbuf
, 
¡»am
);

133 
c
 = *
fmt
++;

134 ià(
c
 == '-')

136 
c
 = *
fmt
++;

137 
Ëá
 = 
Œue
;

140 
Ëá
 = 
çl£
;

142 
n
 = 0; 
	`isdig™
(
c
); c = *
fmt
++)

143 
n
 = 10 *‚ + (
c
 - '0');

145 
c
)

148 
ašt
 = 
	`va_¬g
(*
­
, );

149 
	`’su»_outbuf
(2);

150 
outbuf
[0] = ()(
ašt
 & 0x7F);

151 
outbuf
[1] = '\0';

154 
ašt
 = 
	`va_¬g
(*
­
, );

155 
	`’su»_outbuf
(32);

156 
	`™ß
(
ašt
, 
outbuf
, 10);

159 
ašt
 = 
	`va_¬g
(*
­
, );

160 
	`’su»_outbuf
(32);

161 
	`™ß
(
ašt
, 
outbuf
, 8);

164 
ašt
 = 
	`va_¬g
(*
­
, );

165 
	`’su»_outbuf
(32);

166 
	`™ß
(
ašt
, 
outbuf
, 16);

169 
®Úg
 = 
	`va_¬g
(*
­
, );

170 
	`’su»_outbuf
(64);

171 
	`Éß
(
®Úg
, 
outbuf
, 10);

172 
fmt
++;

175 
a¡r
 = 
	`va_¬g
(*
­
, *);

177 
size_t
 
Ën
 = 
	`¡¾’
(
a¡r
);

178 
	`’su»_outbuf
(
Ën
 + 1);

179 
	`¡rıy
(
outbuf
, 
a¡r
);

183 
	`årštf
(
¡d”r
, "internal warning: 'r' used in…rinting --‡‚o‚o\n");

186 
	`’su»_outbuf
(2);

187 
outbuf
[0] = ()
c
;

188 
outbuf
[1] = '\0';

192 ià(
Ëá
)

194 
i
 = ()
	`¡¾’
(
outbuf
);

195 ià(
n
 > 
i
)

197 
	`’su»_outbuf
((
size_t
)(
n
 + 1));

198 ; 
i
 < 
n
; i++)

199 
outbuf
[
i
] = ' ';

200 
outbuf
[
i
] = '\0';

203 ià(
n
 > (
i
 = ()
	`¡¾’
(
outbuf
)))

205 
	`’su»_outbuf
((
size_t
)(
n
 + 1));

206 
outbuf
[
n
] = '\0';

207 --
i
, --
n
; i >= 0; --n, --i)

208 
outbuf
[
n
] = outbuf[
i
];

209 ; 
n
 >= 0; --n)

210 
outbuf
[
n
] = ' ';

213 
	`put™
(
outbuf
, 
¡»am
);

215 
	}
}

	@printf.h

5 
i_¢iff
();

6 
™ß
(
n
, *
s
, 
ba£
);

7 
Éß
(
n
, *
s
, 
ba£
);

8 
´šŠ
(**
s
, 
a
, 
ba£
);

9 
put™
(*
buf
, 
FILE
 *
¡»am
);

10 
doPršt
(cÚ¡ *
fmt
, 
va_li¡
 *
­
, 
FILE
 *
¡»am
);

13 cÚ¡ *
dig™s
;

	@prpoly.c

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~"sh¬ed.h
"

7 
	~"´pŞy.h
"

8 
	~"ch¬p.h
"

9 
	~"cmds.h
"

10 
	~"gm©rix.h
"

11 
	~"humª_io.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"ršg.h
"

14 
	~"sh–l.h
"

15 
	~"‹rm.h
"

17 
	gmax‹rms
 = 10;

18 
	gÁ”ms
;

19 
	gÃxps
;

23 
	$fd_wr
(
FILE
* 
f
, 
f›ld
 
a
, 
boŞ—n
 
p_Úe
)

25 
n
, 
m
;

26 
boŞ—n
 
p_¶us
;

28 
p_¶us
 = (
Á”ms
 > 0);

29 
	`liá
(
ch¬ac
, 
a
, &
n
, &
m
);

30 ià(
n
 == 0)

32 
m
 = 
a
;

33 
n
 = 1;

35 ià(
n
 < 0)

37 
n
 = -n;

38 
m
 = -m;

40 ià(
n
 == 1)

42 ià((
	`abs
(
m
è!ğ1è|| 
p_Úe
)

43 
Ãxps
++;

44 
	`št_µršt
(
f
, 
m
, 
p_Úe
, 
p_¶us
);

48 
Ãxps
++;

49 
	`št_µršt
(
f
, 
m
, 
Œue
, 
p_¶us
);

50 
	`åršt
(
f
, "/");

51 
	`št_µršt
(
f
, 
n
, 
çl£
, false);

53 
	}
}

55 
	$tm_wr
(
FILE
* 
f
, 
‹rm
 
t
)

57 
i
, 
a
;

58 
ex±”m
 
exp
;

60 
	`sToExp
(
t
, 
exp
);

61 
i
 = 0; i < 
numv¬s
; i++)

63 
a
 = 
exp
[
i
];

64 ià(
a
 > 0)

66 ià(
Ãxps
 > 0)

67 
	`åršt
(
f
, "*");

68 
	`åršt
(
f
, "%s", 
v¬Çmes
[
i
]);

69 
Ãxps
++;

71 ià(
a
 > 1)

73 
	`åršt
(
f
, "^");

74 
	`št_µršt
(
f
, 
a
, 
çl£
, false);

77 
	}
}

79 
	$p_wr
(
FILE
* 
f
, 
pŞy
 
f
, 
comp
)

81 
boŞ—n
 
z
;

83 
Á”ms
 = 0;

84 
f
 !ğ
NULL
)

86 ià(
	`tm_compÚ’t
(
	`pŞy_š™Ÿl
(
f
)è=ğ
comp
)

88 
z
 = 
	`tm_isz”o
(
	`pŞy_š™Ÿl
(
f
));

89 ià(
Á”ms
 % 
max‹rms
 == (maxterms - 1))

90 
	`åršt
(
f
, "\n ");

91 
Ãxps
 = 0;

92 
	`fd_wr
(
f
, 
f
->
cÛf
, 
z
);

93 
	`tm_wr
(
f
, 
	`pŞy_š™Ÿl
(
f
));

94 
Á”ms
++;

96 
f
 = f->
Ãxt
;

98 ià(
Á”ms
 == 0)

99 
	`åršt
(
f
, "0");

100 
	}
}

102 
	$m©_wr
(
FILE
* 
f
, 
gm©rix
 
M
)

104 
i
, 
j
;

106 
	`åršt
(
f
, "{\n");

107 
i
 = 1; i <ğ
	`Äows
(
M
); i++)

109 
	`åršt
(
f
, " {");

110 
j
 = 1; j <ğ
	`ncŞs
(
M
); j++)

112 
	`p_wr
(
f
, 
	`¶i¡_»f
(&
M
->
g’s
, 
j
), 
i
);

113 ià(
j
 < 
	`ncŞs
(
M
))

114 
	`åršt
(
f
, ",\n ");

116 
	`åršt
(
f
, "}");

117 ià(
i
 < 
	`Äows
(
M
))

118 
	`åršt
(
f
, ",\n");

120 
	`åršt
(
f
, "\n}\n");

121 
	}
}

123 
	$´m©_cmd
(
¬gc
, * 
¬gv
[])

125 
gm©rix
 
M
;

127 ià(
¬gc
 != 2)

129 
	`´šŠew
("prmat <matrix>\n");

132 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

134 
	`m©_wr
(
outfe
, 
M
);

135 
	}
}

	@prpoly.h

5 
max‹rms
;

8 
fd_wr
(
FILE
* 
f
, 
f›ld
 
a
, 
boŞ—n
 
p_Úe
);

9 
tm_wr
(
FILE
* 
f
, 
‹rm
 
t
);

10 
p_wr
(
FILE
* 
f
, 
pŞy
 
f
, 
comp
);

11 
m©_wr
(
FILE
* 
f
, 
gm©rix
 
M
);

12 
´m©_cmd
(
¬gc
, * 
¬gv
[]);

	@qring.c

4 
	~<¡dio.h
>

5 
	~<¡dšt.h
>

6 
	~<¡ddef.h
>

7 
	~<¡dboŞ.h
>

8 
	~"sh¬ed.h
"

9 
	~"qršg.h
"

10 
	~"¡ash.h
"

11 
	~"mem.h
"

13 
	~"mÚid—l.h
"

14 
	~"pŞy.h
"

15 
	~"‹rm.h
"

16 
	~"¡ªd¬d.h
"

17 
	~"ršg.h
"

18 
	~"v¬s.h
"

19 
	~"g’”ic.h
"

20 
	~"¶i¡.h
"

21 
	~"mÚ™Ü.h
"

22 
	~"gm_pŞy.h
"

23 
	~"gm©rix.h
"

24 
	~"cmds.h
"

25 
	~"rm­.h
"

26 
	~"¡dcmds.h
"

27 
	~"hb.h
"

28 
	~"humª_io.h
"

31 
šlše
 
‹rm
 
	$INITIAL
(
pŞy
 
f
)

33  (
‹rm
)(
f
->
mÚom
);

34 
	}
}

36 
šlše
 
f›ld
 
	$LEAD_COEF
(
pŞy
 
g
)

38  
g
->
cÛf
;

39 
	}
}

41 
šlše
 
ršg
 
	$VAR_RING
(
v¬ŸbË
 *
v
)

43  (
ršg
)(
v
->
v®ue
);

44 
	}
}

46 
šlše
 
	$dl_š£¹
(
dli¡
 *
dl
, 
i
)

48 
	`dli¡_š£¹
(
dl
, 
i
);

49 
	}
}

58 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
m
, 
¬gc
, **
¬gv
, 
i
)

60 ià(
i
 >ğ
¬gc
)

61  
çl£
;

62 *
m
 = 
	`vg‘_mod
(
¬gv
[
i
]);

63  (*
m
 !ğ
NULL
);

64 
	}
}

66 
šlše
 
boŞ
 
	$g‘_vršg
(
v¬ŸbË
 **
v
, 
¬gc
, **
¬gv
, 
i
)

68 ià(
i
 >ğ
¬gc
)

69  
çl£
;

70 *
v
 = (
v¬ŸbË
 *)
	`vg‘_ršg
(
¬gv
[
i
]);

71  (*
v
 !ğ
NULL
);

72 
	}
}

74 
šlše
 
boŞ
 
	$Ãw_vmod
(
v¬ŸbË
 **
p
, 
¬gc
, **
¬gv
, 
i
)

76 ià(
i
 >ğ
¬gc
)

77  
çl£
;

78 *
p
 = 
	`make_v¬
("", 0, 
VMODULE
, 
NULL
);

79  (*
p
 !ğ
NULL
);

80 
	}
}

82 
¬row
 
	gRid—l
;

84 
	$qrgIn£¹
(
¬row
 
h—d
, 
mn_¡ªd¬d
 *
r¡d
, 
pŞy
 
f
)

86 
ex±”m
 
exp
;

87 
mn_¡ªd¬d
 
q
;

89 
q
 = (
mn_¡ªd¬d
)(*)
	`g‘_¦ug
((
¡ash
 *)
¡d_¡ash
);

90 
q
->
¡ªd¬d
 = 
f
;

91 
q
->
chªge
 = 
NULL
;

92 
q
->
Ãxt
 = *
r¡d
;

93 ià(
f
 !ğ
NULL
)

94 
q
->
deg»e
 = 
	`tm_deg»e
(
	`INITIAL
(
f
));

96 
q
->
deg»e
 = 0;

97 (*
r¡d
èğ
q
;

99 
	`sToExp
(
	`INITIAL
(
f
), 
exp
);

100 
	`mÚ»£t
(
h—d
, 
FOW
);

101 
	`mÚ£¬ch
(
h—d
, 
FOW
, 
exp
);

102 
	`mÚš£¹
(
h—d
, 
exp
);

103 
h—d
->
umh
.
mloc
->
uld
.
ldc
.
ÿ
 = (
®l
 *)
q
;

104 
	}
}

106 
	$qrgAddId—l
(
¬row
 
h—d
, 
mn_¡ªd¬d
 *
r¡d
, 
gm©rix
 
M
)

108 
modg’
 
mg
;

109 
pŞy
 
f
, 
g
;

111 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

112 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
NULL
)

114 
f
 = 
	`p_cİy
(f);

116 
	`make1_mÚic
(&
f
);

117 
g
 = 
f
; g !ğ
NULL
; g = g->
Ãxt
)

118 
	`£t_comp
(
g
, 0);

119 
	`qrgIn£¹
(
h—d
, 
r¡d
, 
f
);

121 
	}
}

123 
	$qrgAddMÚoms
(
¬row
 
h—d
, 
mn_¡ªd¬d
 *
r¡d
,‡¼ow 
rid—l
)

125 
¬row
 
p
;

126 
pŞy
 
f
;

128 ià(
rid—l
 =ğ
NULL
)

130 
p
 = 
rid—l
;

131 (
p
 = 
	`mÚÃxt
Õ)è!ğ
NULL
)

133 
f
 = ((
mn_¡ªd¬d
)
p
->
uld
.
ldc
.
ÿ
)->
¡ªd¬d
;

134 
f
 = 
	`p_cİy
(f);

135 
	`qrgIn£¹
(
h—d
, 
r¡d
, 
f
);

137 
	}
}

143 
	$qrgToRšg
(
¬row
 
h—d
, 
mn_¡ªd¬d
 *
r¡d
,‡¼ow 
rid—l
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
)

145 
¬row
 
p
;

146 
gm©rix
 
m­
;

147 
pŞy
 
f
;

149 ià(
rid—l
 =ğ
NULL
)

151 
m­
 = 
	`im­
(
R
, 
S
, 0);

152 
p
 = 
rid—l
;

153 (
p
 = 
	`mÚÃxt
Õ)è!ğ
NULL
)

155 
f
 = 
	`chªge_v¬s
(
m­
, 
R
, 
S
, ((
mn_¡ªd¬d
)
p
->
uld
.
ldc
.
ÿ
)->
¡ªd¬d
);

156 
	`vrg_š¡®l
(
S
);

157 
	`qrgIn£¹
(
h—d
, 
r¡d
, 
f
);

159 
	`mod_kl
(
m­
);

160 
	}
}

164 
ršg
 
	$qrgSum
(
v¬ŸbË
 *
R1
, v¬ŸbË *
R2
, v¬ŸbË *
S
)

166 
ršg
 
r1
, 
r2
, 
s
, 
»suÉ
;

167 
¬row
 
h—d
;

168 
mn_¡ªd¬d
 
r¡d
;

170 
	`vrg_š¡®l
(
S
);

171 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

172 
r¡d
 = 
NULL
;

174 
r1
 = 
	`VAR_RING
(
R1
);

175 
r2
 = 
	`VAR_RING
(
R2
);

176 
s
 = 
	`VAR_RING
(
S
);

178 
	`qrgToRšg
(
h—d
, &
r¡d
, 
r1
->
Rid—l
, 
R1
, 
S
);

179 
	`qrgToRšg
(
h—d
, &
r¡d
, 
r2
->
Rid—l
, 
R2
, 
S
);

181 
»suÉ
 = (
ršg
)(*)
	`gimmy
((
ršg»c
));

182 *
»suÉ
 = *
s
;

184 
»suÉ
->
Rid—l
 = 
h—d
;

185 
»suÉ
->
R¡d
 = 
r¡d
;

186  
»suÉ
;

187 
	}
}

189 
ršg
 
	$qrgMake
(
gm©rix
 
M
)

191 
ršg
 
»suÉ
;

192 
¬row
 
h—d
;

193 
mn_¡ªd¬d
 
r¡d
;

195 
»suÉ
 = (
ršg
)(*)
	`gimmy
((
ršg»c
));

197 *
»suÉ
 = *
	`VAR_RING
(
cu¼’t_ršg
);

199 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

200 
r¡d
 = 
NULL
;

201 
	`¡dW¬nšg
(
M
);

202 
	`qrgAddId—l
(
h—d
, &
r¡d
, 
M
);

203 
	`qrgAddMÚoms
(
h—d
, &
r¡d
, 
Rid—l
);

204 
»suÉ
->
Rid—l
 = 
h—d
;

205 
»suÉ
->
R¡d
 = 
r¡d
;

206  
»suÉ
;

207 
	}
}

209 
boŞ—n
 
	$isQRšg
(
v¬ŸbË
 *
p
)

211 
ršg
 
R
;

213 
R
 = 
	`VAR_RING
(
p
);

214 ià(
R
 =ğ
NULL
)

216  
R
->
Rid—l
 !ğ
NULL
;

217 
	}
}

219 
	$qrgIn¡®l
(
¬row
 
r
)

221 
Rid—l
 = 
r
;

222 
	}
}

224 
	$qrgKl
(
¬row
 
r
, 
mn_¡ªd¬d
 
r¡d
)

226 
	`mÚ»fund
(
r
);

227 
	`¡d_kl
(
r¡d
);

228 
	}
}

230 
	$qrgDi¥Ïy
(
FILE
 *
f
, 
ršg
 
R
)

232 
mn_¡ªd¬d
 
p
;

234 
	`âewlše
(
f
);

235 
	`åršt
(
f
, "quotient„ing by ideal:\n");

236 
p
 = (
mn_¡ªd¬d
)
R
->
R¡d
;

237 
p
 !ğ
NULL
)

239 
	`âewlše
(
f
);

240 
	`p_µršt
(
f
, 
p
->
¡ªd¬d
, 0);

241 
	`åršt
(
f
, "\n");

242 
p
 =…->
Ãxt
;

244 
	}
}

256 
	$qrgReduû
(
pŞy
 *
f
)

258 
pŞy
 
š»suÉ
;

259 
mn_¡ªd¬d
 
i
;

260 
®loù”m
 
t
;

261 
pŞy
 
g
, 
h
;

263 ià(
Rid—l
 =ğ
NULL
)

265 
g
 = *
f
;

266 
š»suÉ
 = 
divnode
;

267 
g
 !ğ
NULL
)

269 ià(
	`mn_rdiv
(
	`INITIAL
(
g
), (**)&
i
, 
t
))

271 
	`¥ecŸl_sub
(&
g
, 
	`LEAD_COEF
(g), 
t
, 
i
->
¡ªd¬d
);

275 
š»suÉ
->
Ãxt
 = 
g
;

276 
š»suÉ
 = 
g
;

277 
g
 = g->
Ãxt
;

280 
š»suÉ
->
Ãxt
 = 
NULL
;

281 *
f
 = 
divnode
->
Ãxt
;

282 
	}
}

284 
	$qršg_cmd
(
¬gc
, *
¬gv
[])

286 
gm©rix
 
M
;

287 
v¬ŸbË
 *
p
;

289 ià(
¬gc
 != 3)

291 
	`´šŠew
("qring <ideal> <new„ing>\n");

294 ià(!
	`g‘_mod
(&
M
, 
¬gc
, 
¬gv
, 1))

299 
p
 = 
	`make_v¬
(
¬gv
[2], 
MAINVAR
, 
VRING
, 
NULL
);

300 ià(
p
 =ğ
NULL
)

302 
	`£t_v®ue
(
p
, 
	`qrgMake
(
M
));

303 
	`vrg_š¡®l
(
p
);

304 
	`do_ršg_v¬s
();

305 
	}
}

307 
gm©rix
 
	$qrgP»£Á
(
ršg
 
R
, 
mn_¡ªd¬d
 
r¡d
)

309 ()
R
;

312 
mn_¡ªd¬d
 
p
;

313 
pŞy
 
f
;

314 
gm©rix
 
»suÉ
;

316 
»suÉ
 = 
	`mod_š™
();

317 
	`dl_š£¹
(&
»suÉ
->
deg»es
, 0);

318 
p
 = 
r¡d
;

319 
p
 !ğ
NULL
)

321 
f
 = 
	`compshiá
(
p
->
¡ªd¬d
, 1);

322 
	`gmIn£¹
(
»suÉ
, 
f
);

323 
p
 =…->
Ãxt
;

325  
»suÉ
;

326 
	}
}

328 
	$´e£Áršg_cmd
(
¬gc
, *
¬gv
[])

330 
v¬ŸbË
 *
R
, *
p
;

332 ià(
¬gc
 != 3)

334 
	`´šŠew
("present_ring <quotient„ing> <result ideal>\n");

337 ià(!
	`g‘_vršg
(&
R
, 
¬gc
, 
¬gv
, 1))

339 ià(
R
->
b_ršg
 =ğ
NULL
)

341 ià(!
	`Ãw_vmod
(&
p
, 
¬gc
, 
¬gv
, 2))

343 
	`£t_v®ue
(
p
, 
	`qrgP»£Á
(
	`VAR_RING
(
R
), 
NULL
));

347 
	`vrg_š¡®l
(
R
->
b_ršg
);

348 ià(!
	`Ãw_vmod
(&
p
, 
¬gc
, 
¬gv
, 2))

350 
	`£t_v®ue
(
p
, 
	`qrgP»£Á
(
	`VAR_RING
(
R
->
b_ršg
), VAR_RING(R)->
R¡d
));

352 
	}
}

	@qring.h

5 
ršg
 
qrgMake
(
gm©rix
 
M
);

6 
ršg
 
qrgSum
(
v¬ŸbË
* 
R1
, v¬ŸbË* 
R2
, v¬ŸbË* 
S
);

7 
gm©rix
 
qrgP»£Á
(
ršg
 
R
, 
mn_¡ªd¬d
 
r¡d
);

8 
boŞ—n
 
isQRšg
(
v¬ŸbË
* 
p
);

9 
qrgIn¡®l
(
¬row
 
r
);

10 
qrgKl
(
¬row
 
r
, 
mn_¡ªd¬d
 
r¡d
);

11 
qrgDi¥Ïy
(
FILE
* 
f
, 
ršg
 
R
);

12 
qrgReduû
(
pŞy
* 
f
);

13 
qršg_cmd
(
¬gc
, * 
¬gv
[]);

14 
´e£Áršg_cmd
(
¬gc
, * 
¬gv
[]);

15 
qrgIn£¹
(
¬row
 
h—d
, 
mn_¡ªd¬d
* 
r¡d
, 
pŞy
 
f
);

16 
qrgAddId—l
(
¬row
 
h—d
, 
mn_¡ªd¬d
* 
r¡d
, 
gm©rix
 
M
);

17 
qrgAddMÚoms
(
¬row
 
h—d
, 
mn_¡ªd¬d
* 
r¡d
,‡¼ow 
rid—l
);

18 
qrgToRšg
(
¬row
 
h—d
, 
mn_¡ªd¬d
* 
r¡d
,‡¼ow 
rid—l
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
);

21 
¬row
 
Rid—l
;

	@rescmds.c

4 
	~"sh¬ed.h
"

5 
	~"»scmds.h
"

6 
	~<£tjmp.h
>

7 
	~"cmds.h
"

8 
	~"·r£.h
"

9 
	~"humª_io.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"¶i¡.h
"

12 
	~"gm©rix.h
"

13 
	~"pŞy.h
"

14 
	~"v¬s.h
"

15 
	~"box´ocs.h
"

17 
	~"£t.h
"

18 
	~"ršg.h
"

21 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
* 
g
, ** 
¬gv
, 
i
)

23 *
g
 = 
	`vg‘_mod
(
¬gv
[
i
]);

24  (*
g
 !ğ
NULL
);

25 
	}
}

27 
šlše
 
boŞ
 
	$g‘_vmod
(
v¬ŸbË
** 
p
, ** 
¬gv
, 
i
)

29 *
p
 = 
	`vg‘_vmod
(
¬gv
[
i
]);

30  (*
p
 !ğ
NULL
);

31 
	}
}

33 
šlše
 
boŞ
 
	$g‘_rgmod
(
gm©rix
* 
g
, ** 
¬gv
, 
i
)

35 *
g
 = 
	`vg‘_rgmod
(
¬gv
[
i
]);

36  (*
g
 !ğ
NULL
);

37 
	}
}

39 
boŞ—n
 
	$hom_check
(
gm©rix
 
M
, * 
Çme
)

41 ià(!
	`check_homog
(
M
))

43 
	`´”rÜ
("; m©rix % i¢'ˆhomog’eous;ƒ™h” homog’iz™\n", 
Çme
);

44 
	`´”rÜ
("; using 'homog', or change degrees using 'setdegs'\n");

45  
çl£
;

47  
Œue
;

48 
	}
}

50 
	$doAutoÿlc
(* 
s
)

52 
v¬ŸbË
* 
box
;

54 
	`g¬b_cŞËù
();

55 
box
 = 
	`fšd_v¬
(
s
);

57 ià(
autoÿlc
 < 0)

58 
	`ÿlc
(
box
, 
Œue
, 0);

59 ià(
autoÿlc
 > 0)

60 
	`ÿlc
(
box
, 
çl£
, 
autodeg»e
);

61 
	}
}

63 
v¬ŸbË
*
	$»s
(* 
Çme
, 
gm©rix
 
M
, 
d•th
)

65 
v¬ŸbË
* 
»suÉ
;

66 
lo
, 
hi
;

68 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

69 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, 
hi
 - 1, 
lo
 - 2, 1);

70 
	`mkshiá
("", 1);

71 
	`mk»s
("1", -1, 
M
);

72 
	`mk_£v_Äes
(2, 
d•th
 - 1, -1, 0);

73  
»suÉ
;

74 
	}
}

76 
v¬ŸbË
*
	$Äes
(* 
Çme
, 
v¬ŸbË
* 
p
, 
d•th
)

78 
v¬ŸbË
* 
»suÉ
;

79 
lo
, 
hi
;

80 
gm©rix
 
M
;

82 
M
 = 
	`v¬_g‘_moduË
(
p
);

83 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

84 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, 
hi
, 
lo
 - 1, 1);

85 
	`mkem™
("", 
p
);

86 
	`mk_£v_Äes
(1, 
d•th
, -1, 0);

87  
»suÉ
;

88 
	}
}

90 
v¬ŸbË
*
	$¡d
(* 
Çme
, 
v¬ŸbË
* 
p
)

92 
v¬ŸbË
* 
»suÉ
, * 
®Ÿs
;

93 
lo
, 
hi
;

94 
gm©rix
 
M
;

96 
M
 = 
	`v¬_g‘_moduË
(
p
);

97 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

98 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, 
hi
, 
lo
 - 1, 1);

99 
	`mkem™
("", 
p
);

100 
®Ÿs
 = 
	`mk¡d
("1");

101 
	`£t_®Ÿs
(
»suÉ
, 
®Ÿs
);

102  
»suÉ
;

103 
	}
}

105 
v¬ŸbË
*
	$liá_¡d
(* 
Çme
, 
gm©rix
 
M
)

107 
v¬ŸbË
* 
»suÉ
, * 
®Ÿs
;

108 
lo
, 
hi
;

110 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

111 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, 
hi
, 
lo
 - 1, 1);

112 
®Ÿs
 = 
	`mk»s
("1", -1, 
M
);

113 
	`mkŒash
("");

114 
	`£t_®Ÿs
(
»suÉ
, 
®Ÿs
);

115  
»suÉ
;

116 
	}
}

118 
v¬ŸbË
*
	$syz
(* 
Çme
, 
gm©rix
 
M
, 
ncomps
)

120 
v¬ŸbË
* 
»suÉ
, * 
®Ÿs
;

121 
lo
, 
hi
;

123 
	`dl_lohi
(&
M
->
degg’s
, &
lo
, &
hi
);

124 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, 
hi
, 
lo
 - 1, 1);

125 
	`mk»s
("0", 
ncomps
, 
M
);

126 
®Ÿs
 = 
	`mkÄes
("1", 0);

127 
	`£t_®Ÿs
(
»suÉ
, 
®Ÿs
);

128  
»suÉ
;

129 
	}
}

131 
v¬ŸbË
*
	$modulo
(* 
Çme
, 
gm©rix
 
M
, gm©rix 
N
)

133 
gm©rix
 
g
;

134 
i
;

135 
v¬ŸbË
* 
p
;

137 
g
 = 
	`m©_cİy
(
M
);

138 
i
 = 1; i <ğ
	`ncŞs
(
N
); i++)

139 
	`gmIn£¹
(
g
, 
	`p_cİy
(
	`¶i¡_»f
(&
N
->
g’s
, 
i
)));

140 ià(!
	`check_homog
(
g
))

142 
	`´”rÜ
("; concatenating both matrices…roduces‡ matrix which is‚ot\n");

143 
	`´”rÜ
("; homogeneous. Either homogenize, or change degrees using setdegs\n");

144 
	`mod_kl
(
g
);

145  
nuÎ±r
;

147 
p
 = 
	`syz
(
Çme
, 
g
, 
	`ncŞs
(
M
));

148 
	`mod_kl
(
g
);

149  
p
;

150 
	}
}

152 
v¬ŸbË
*
	$i¡d
(* 
Çme
, 
gm©rix
 
M
, 
ncomps
)

154 
v¬ŸbË
* 
»suÉ
, * 
®Ÿs
;

156 
»suÉ
 = 
	`mk¡¬‹r
(
Çme
, -1, -1, 1);

157 
®Ÿs
 = 
	`mki¡d
("1", 
ncomps
, 
M
);

158 ià(
ncomps
 != 0)

159 
	`mkcŞËù
("2");

160 
	`£t_®Ÿs
(
»suÉ
, 
®Ÿs
);

161  
»suÉ
;

162 
	}
}

164 
	$»s_cmd
(
¬gc
, * 
¬gv
[])

166 
gm©rix
 
M
;

167 
maxd•th
;

169 ià((
¬gc
 < 3) || (argc > 4))

171 
	`´šŠew
("res <module> <computation> [max depth]\n");

174 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 1))

176 ià(
¬gc
 >= 4)

177 
maxd•th
 = 
	`g‘IÁ
(
¬gv
[3]);

179 
maxd•th
 = 
	`max_št
(
numv¬s
, 2);

181 ià(!
	`hom_check
(
M
, 
¬gv
[1]))

183 
	`»s
(
¬gv
[2], 
M
, 
maxd•th
);

184 
	`doAutoÿlc
(
¬gv
[2]);

185 
	}
}

187 
	$Äes_cmd
(
¬gc
, * 
¬gv
[])

189 
v¬ŸbË
* 
p
;

190 
gm©rix
 
M
;

191 
maxd•th
;

193 ià((
¬gc
 < 3) || (argc > 4))

195 
	`´šŠew
("nres <module> <computation> [max depth]\n");

198 ià(!
	`g‘_vmod
(&
p
, 
¬gv
, 1))

200 
M
 = 
	`v¬_g‘_moduË
(
p
);

201 ià(
¬gc
 >= 4)

202 
maxd•th
 = 
	`g‘IÁ
(
¬gv
[3]);

204 
maxd•th
 = 
numv¬s
;

206 ià(!
	`hom_check
(
M
, 
¬gv
[1]))

208 
	`Äes
(
¬gv
[2], 
p
, 
maxd•th
);

209 
	`doAutoÿlc
(
¬gv
[2]);

210 
	}
}

212 
	$¡d_cmd
(
¬gc
, * 
¬gv
[])

214 
v¬ŸbË
* 
p
;

215 
gm©rix
 
M
;

217 ià(
¬gc
 != 3)

219 
	`´šŠew
("std <module> <computation>\n");

222 ià(!
	`g‘_vmod
(&
p
, 
¬gv
, 1))

224 
M
 = 
	`v¬_g‘_moduË
(
p
);

225 ià(
M
 =ğ
nuÎ±r
)

227 ià(!
	`hom_check
(
M
, 
¬gv
[1]))

229 
	`¡d
(
¬gv
[2], 
p
);

230 
	`doAutoÿlc
(
¬gv
[2]);

231 
	}
}

233 
	$liá¡d_cmd
(
¬gc
, * 
¬gv
[])

235 
gm©rix
 
M
;

237 ià(
¬gc
 != 3)

239 
	`´šŠew
("lift_std <matrix> <computation>\n");

242 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 1))

244 ià(!
	`hom_check
(
M
, 
¬gv
[1]))

246 
	`liá_¡d
(
¬gv
[2], 
M
);

247 
	`doAutoÿlc
(
¬gv
[2]);

248 
	}
}

250 
	$syz_cmd
(
¬gc
, * 
¬gv
[])

252 
gm©rix
 
M
;

253 
n
;

255 ià(
¬gc
 != 4)

257 
	`´šŠew
("syz <module> <# components(-1=all,0,...)> <computation>\n");

260 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 1))

262 
n
 = 
	`g‘IÁ
(
¬gv
[2]);

263 ià(
n
 < 0)

264 
n
 = -1;

265 ià(!
	`hom_check
(
M
, 
¬gv
[1]))

267 
	`syz
(
¬gv
[3], 
M
, 
n
);

268 
	`doAutoÿlc
(
¬gv
[3]);

269 
	}
}

271 
	$modulo_cmd
(
¬gc
, * 
¬gv
[])

273 
v¬ŸbË
* 
box
;

274 
gm©rix
 
M
, 
N
;

276 ià(
¬gc
 != 4)

278 
	`´šŠew
("modulo <matrix> <matrix> <computation>\n");

281 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 1))

283 ià(!
	`g‘_rgmod
(&
N
, 
¬gv
, 2))

285 
box
 = 
	`modulo
(
¬gv
[3], 
M
, 
N
);

286 ià(
box
 =ğ
nuÎ±r
)

288 
	`doAutoÿlc
(
¬gv
[3]);

289 
	}
}

291 
	$i¡d_cmd
(
¬gc
, * 
¬gv
[])

293 
gm©rix
 
M
;

294 
n
;

296 ià((
¬gc
 < 3) || (argc > 4))

298 
	`´šŠew
("istd <matrix> <computation> [# components, default = 0]\n");

301 ià(!
	`g‘_mod
(&
M
, 
¬gv
, 1))

303 ià(
¬gc
 == 3)

304 
n
 = 0;

307 
n
 = 
	`g‘IÁ
(
¬gv
[3]);

308 ià(
n
 < 0)

309 
n
 = -1;

311 
	`i¡d
(
¬gv
[2], 
M
, 
n
);

312 
	`doAutoÿlc
(
¬gv
[2]);

313 
	}
}

	@rescmds.h

7 
boŞ—n
 
hom_check
(
gm©rix
 
M
, * 
Çme
);

8 
doAutoÿlc
(* 
s
);

11 
v¬ŸbË
*
»s
(* 
Çme
, 
gm©rix
 
M
, 
d•th
);

12 
v¬ŸbË
*
Äes
(* 
Çme
, v¬ŸbË* 
p
, 
d•th
);

13 
v¬ŸbË
*
¡d
(* 
Çme
, v¬ŸbË* 
p
);

14 
v¬ŸbË
*
liá_¡d
(* 
Çme
, 
gm©rix
 
M
);

15 
v¬ŸbË
*
syz
(* 
Çme
, 
gm©rix
 
M
, 
ncomps
);

16 
v¬ŸbË
*
modulo
(* 
Çme
, 
gm©rix
 
M
, gm©rix 
N
);

17 
v¬ŸbË
*
i¡d
(* 
Çme
, 
gm©rix
 
M
, 
ncomps
);

20 
»s_cmd
(
¬gc
, * 
¬gv
[]);

21 
Äes_cmd
(
¬gc
, * 
¬gv
[]);

22 
¡d_cmd
(
¬gc
, * 
¬gv
[]);

23 
liá¡d_cmd
(
¬gc
, * 
¬gv
[]);

24 
syz_cmd
(
¬gc
, * 
¬gv
[]);

25 
modulo_cmd
(
¬gc
, * 
¬gv
[]);

26 
i¡d_cmd
(
¬gc
, * 
¬gv
[]);

	@ring.c

4 
	~<£tjmp.h
>

5 
	~<¡dio.h
>

6 
	~<¡ršg.h
>

7 
	~"sh¬ed.h
"

8 
	~"ršg.h
"

9 
	~"ch¬p.h
"

10 
	~"hb.h
"

11 
	~"šput.h
"

12 
	~"mem.h
"

13 
	~"mÚ™Ü.h
"

14 
	~"qršg.h
"

15 
	~"rv¬.h
"

16 
	~"£t.h
"

17 
	~"sm®É”m.h
"

18 
	~"gm_dli¡.h
"

20 
	~"¶i¡.h
"

21 
	~"¡ash.h
"

22 
	~"humª_io.h
"

25 
dl_£t
(
dli¡
* 
dl
, 
i
, 
v®
);

28 
šlše
 
	$dl_š™
(
dli¡
* 
dl
)

30 
	`dli¡_š™
(
dl
);

31 
	}
}

33 
šlše
 
	$dl_š£¹
(
dli¡
* 
dl
, 
v®
)

35 
	`dli¡_š£¹
(
dl
, 
v®
);

36 
	}
}

38 
	gnumv¬s
;

39 
	gnblocks
;

40 
symmBlock
* 
	gblocks
;

42 
	gcompLoc
;

43 
‹rm
 
	gz”odegs
;

44 ** 
	gv¬Çmes
;

45 
dli¡
 
	grgDegs
;

46 * 
	gpSsh
;

48 
	$š™_ršgs
()

50 
blockLi¡
 = 
NULL
;

51 
	}
}

53 
	$nv¬s
(
ršg
 
R
)

55  (
R
->
nv¬s
);

56 
	}
}

58 
	$g‘RšgV¬
(
ršg
 
R
, * 
s
)

60  (
	`g‘V¬R–
(
R
->
v¬Çmes
, R->
nv¬s
, 
s
));

61 
	}
}

63 *
	$v¬Name
(
ršg
 
R
, 
i
)

65 ià((
i
 < 0è|| (˜>ğ
R
->
nv¬s
))

66  (
NULL
);

67  (
R
->
v¬Çmes
[
i
]);

68 
	}
}

70 
	$v¬Weight
(
ršg
 
R
, 
i
)

72 ià((
i
 < 0è|| (˜>ğ
R
->
nv¬s
))

74  (
	`dli¡_»f
(&
R
->
degs
, 
i
 + 1));

75 
	}
}

77 
	$rgIn¡®l
(
ršg
 
R
)

79 
	`š™_ch¬p
(
R
->
ch¬ac
);

80 
numv¬s
 = 
R
->
nv¬s
;

81 
nblocks
 = 
R
->nblocks;

82 
blocks
 = 
R
->
symm®g
;

83 
compLoc
 = 
R
->compLoc;

84 
z”odegs
 = 
R
->zerodegs;

85 
v¬Çmes
 = 
R
->varnames;

86 
rgDegs
 = 
R
->
degs
;

87 
pSsh
 = 
R
->pStash;

88 
h—dSsh
 = 
R
->headStash;

89 
mÚSsh
 = 
R
->monStash;

90 
·»nSsh
 = 
R
->parenStash;

91 
	`qrgIn¡®l
(
R
->
Rid—l
);

92 
	}
}

94 
	$rgKl
(
ršg
 
R
)

96 ià(
R
 =ğ
NULL
)

98 ià(
R
->
Rid—l
 =ğ
NULL
)

100 ià(
R
->
pSsh
 !ğ
NULL
)

101 
	`’dof_¡ash
(
R
->
pSsh
);

102 
	`dl_kl
(&
R
->
degs
);

103 
	`dl_kl
(&
R
->
mÚÜd”
);

104 
	`dl_kl
(&
R
->
wtfús
);

105 
	`mn_uÄšg
(
R
);

109 
	`qrgKl
(
R
->
Rid—l
, R->
R¡d
);

111 
	}
}

113 
ršg
 
	$rgC»©e
(
ch¬aù”i¡ic
, ** 
vÇmes
, 
dli¡
* 
degs
, dli¡* 
mÚÜd”
, dli¡* 
wtfús
)

115 
ršg
 
»suÉ
;

116 
i
, 
j
, 
n
;

117 * 
d
;

118 
loc
, 
woc
;

120 
»suÉ
 = (
ršg
)(*)
	`gimmy
((
ršg»c
));

122 
»suÉ
->
Rid—l
 = 
NULL
;

123 
»suÉ
->
R¡d
 = 
NULL
;

125 
»suÉ
->
ch¬ac
 = 
ch¬aù”i¡ic
;

126 
»suÉ
->
v¬Çmes
 = 
vÇmes
;

127 
	`dl_cİy
(
degs
, &
»suÉ
->degs);

128 
	`dl_cİy
(
mÚÜd”
, &
»suÉ
->monorder);

129 
	`dl_cİy
(
wtfús
, &
»suÉ
->wtfcns);

130 
»suÉ
->
nv¬s
 = 
	`Ëngth
(
degs
);

131 
»suÉ
->
nblocks
 = 
	`Ëngth
(
mÚÜd”
);

132 
»suÉ
->
compLoc
 = -1;

134 
»suÉ
->
pSsh
 = 
	`mkPŞySsh
ÔesuÉ->
nblocks
);

135 
»suÉ
->
symm®g
 =

136 (
symmBlock
*)(*)
	`gimmy
(()(
»suÉ
->
nblocks
 + 1) * ()(symmBlock));

137 
»suÉ
->
symm®g
[»suÉ->
nblocks
] = 
NULL
;

139 
loc
 = 1;

140 
woc
 = 1;

141 
i
 = 0; i < 
»suÉ
->
nblocks
; i++)

143 
n
 = 
	`dli¡_»f
(
mÚÜd”
, 
i
 + 1);

144 ià(
n
 =ğ
RCOMP
)

146 
»suÉ
->
compLoc
 = 
i
;

147 
»suÉ
->
symm®g
[
i
] = (
symmBlock
)(*)
	`gimmy
((
symblock
));

148 
»suÉ
->
symm®g
[
i
]->
¹yp
 = 
RCOMP
;

150 ià(
n
 =ğ
RWTFCN
)

152 
d
 = (*)(*)
	`gimmy
(()
»suÉ
->
nv¬s
 * ()());

153 
j
 = 0; j < 
»suÉ
->
nv¬s
; j++, 
woc
++)

154 
d
[
j
] = 
	`dli¡_»f
(
wtfús
, 
woc
);

155 
»suÉ
->
symm®g
[
i
] = (
symmBlock
)(*)
	`gimmy
((
symblock
));

156 
»suÉ
->
symm®g
[
i
]->
¹yp
 = 
RWTFCN
;

157 
»suÉ
->
symm®g
[
i
]->
degs
 = 
d
;

161 
d
 = (*)(*)
	`gimmy
(()(
n
 + 1) * ()());

162 
j
 = 0; j < 
n
; j++, 
loc
++)

163 
d
[
j
] = 
	`dli¡_»f
(
degs
, 
loc
);

164 
d
[
n
] = 1;

165 
»suÉ
->
symm®g
[
i
] = 
	`symmC»©e
(
n
, 
d
, 
vÇmes
);

166 
vÇmes
 +ğ
n
;

169 
»suÉ
->
z”odegs
 = (
‹rm
)(*)
	`gimmy
(()(
sm®lmÚ
è* (ìesuÉ->
nblocks
);

170 
i
 = 0; i < 
»suÉ
->
nblocks
; i++)

171 
»suÉ
->
z”odegs
[
i
] = 0;

172 
	`mn_ršg
(
»suÉ
);

173  (
»suÉ
);

174 
	}
}

186 
	$g‘MÚOrd”
(
dli¡
* 
mÚÜd”
, 
nv¬s
)

188 
nv
, 
i
, 
this
, 
nblks
;

189 
boŞ—n
 
dÚe
, 
hascomp
, 
Ãedscomp
;

190 
¬gc
;

191 ** 
¬gv
;

193 
	`dl_š™
(
mÚÜd”
);

196 
dÚe
 = 
TRUE
;

197 
nv
 = 0;

198 
	`dl_kl
(
mÚÜd”
);

199 
	`dl_š™
(
mÚÜd”
);

200 
hascomp
 = 
FALSE
;

202 
	`´šput
("monomial order (if‚ot„ev.†ex.) ");

203 
	`dlS³cS‘
(
v¬U£
);

204 
	`g‘_lše
(&
¬gc
, &
¬gv
);

205 ià((
¬gc
 >ğ1è&& (
¬gv
[0][0] == '-'))

207 
Ãedscomp
 = 
FALSE
;

208 
¬gc
--;

209 
¬gv
++;

212 
Ãedscomp
 = 
TRUE
;

213 
	`dlV¬CÚsume
(
mÚÜd”
, 
¬gc
, 
¬gv
);

214 
	`dlS³cS‘
(
NULL
);

215 
nblks
 = 
	`Ëngth
(
mÚÜd”
);

216 
i
 = 1; i <ğ
nblks
; i++)

218 
this
 = 
	`dli¡_»f
(
mÚÜd”
, 
i
);

219 ià(
this
 =ğ
RCOMP
)

221 ià(
hascomp
 =ğ
TRUE
)

223 
	`´”rÜ
("; only one component‡llowed,ry‡gain\n");

224 
dÚe
 = 
FALSE
;

228 
hascomp
 = 
TRUE
;

230 ià(
this
 !ğ
RWTFCN
)

232 ià(
this
 > 0)

233 
nv
 +ğ
this
;

236 
	`´”rÜ
(";‚egative‚umbers‚ot‡llowed,ry‡gain\n");

237 
dÚe
 = 
FALSE
;

242 ià(
nv
 > 
nv¬s
)

244 
	`´”rÜ
(";oo many variables specified,ry‡gain\n");

245 
dÚe
 = 
FALSE
;

247 } !
dÚe
);

248 ià(
nv¬s
 > 
nv
)

249 
	`dl_š£¹
(
mÚÜd”
, 
nv¬s
 - 
nv
);

250 ià(
Ãedscomp
 && (!
hascomp
))

251 
	`dl_š£¹
(
mÚÜd”
, 
RCOMP
);

252 
	}
}

254 
	$g‘WtFú
(
n
, 
dli¡
* 
wtfús
, dli¡* 
degs
, ** 
v¬s
)

256 
¬gc
, 
–imOrd”
, 
i
, 
Ën
, 
fœ¡
;

257 
a
, 
b
, 
k
;

258 ** 
¬gv
;

260 
fœ¡
 = 
	`Ëngth
(
wtfús
);

261 
Ën
 = 
	`Ëngth
(
degs
);

264 
	`´šput
("weighˆveùÜ #%d ", 
n
);

265 
	`g‘_lše
(&
¬gc
, &
¬gv
);

266 ià(
¬gc
 == 0)

268 
–imOrd”
 = 
	`g‘V¬R–
(
v¬s
, 
Ën
, 
¬gv
[0]);

269 ià(
–imOrd”
 >= 0)

271 
i
 = 0; i <ğ
–imOrd”
; i++)

272 
	`dl_š£¹
(
wtfús
, 
	`dli¡_»f
(
degs
, 
i
 + 1));

273 ; 
i
 < 
Ën
; i++)

274 
	`dl_š£¹
(
wtfús
, 0);

277 
	`dlCÚsume
(
wtfús
, 
¬gc
, 
¬gv
, 
fœ¡
 + 
Ën
, 0);

278 } 
¬gc
 == 0);

283 
k
 = 0;

284 
i
 = 1; i <ğ
	`Ëngth
(
degs
); i++)

286 
a
 = 
	`dli¡_»f
(
wtfús
, 
fœ¡
 + 
i
);

287 
b
 = 
	`dli¡_»f
(
degs
, 
i
);

288 ià(
a
 + 
b
 * 
k
 >= 0)

290 
k
 = (-
a
 - 1è/ 
b
 + 1;

292 ià(
k
 > 0)

294 
i
 = 1; i <ğ
	`Ëngth
(
degs
); i++)

296 
‹mp
 = 
	`dli¡_»f
(
wtfús
, 
fœ¡
 + 
i
è+ 
k
 * dli¡_»f(
degs
, i);

297 
	`dl_£t
(
wtfús
, 
fœ¡
 + 
i
, 
‹mp
);

300 
	}
}

302 
	gn_big´imes
 = 20,

303 
	gbig´imes
[] = { 32749, 32719, 32717, 32713, 32707, 32693, 32687, 32653, 32647, 32633,

306 
	gn_l´imes
 = 26, 
	gl´imes
[] = { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41,

309 
ršg
 
	$rgSÿn
()

311 
chrc
, 
nwtfús
, 
nv
;

312 
i
, 
m
, 
n
;

313 
dli¡
 
mÚÜd”
, 
degs
, 
degs2
, 
wtfús
;

314 
ršg
 
R
;

315 ** 
v¬s
;

317 
	`´šput
("ch¬aù”i¡iø(iànÙ %5dè ", 
LARGE_PRIME
);

318 
chrc
 = 
	`g‘_defšt
("", 
LARGE_PRIME
);

319 ià(
chrc
 > 0 && chrø< 
l´imes
[
n_l´imes
 - 1])

321 
i
 = 0; i < 
n_l´imes
; ++i)

322 ià(
chrc
 =ğ
l´imes
[
i
])

324 ià(
i
 =ğ
n_l´imes
)

325 
chrc
 = 0;

327 ià(
chrc
 < 0 && chrø>ğ-
n_big´imes
)

328 
chrc
 = 
big´imes
[-chrc - 1];

329 ià(
chrc
 <= 0)

331 
	`´”rÜ
("; characteristic must be‡…ositive…rime...\n");

332 
	`´”rÜ
("; s‘tšg ch¬aù”i¡iøtØ%d\n", 
LARGE_PRIME
);

333 
chrc
 = 
LARGE_PRIME
;

336 
	`´šput
("number of variables ");

337 
nv
 = 
	`g‘_št
("");

338 ià((
nv
 <ğ0è|| (nv > 
NVARS
))

340 
	`´”rÜ
(";‚“d b‘w“À1‡nd %d v¬ŸbËs\n", 
NVARS
);

341  (
NULL
);

344 
v¬s
 = 
	`g‘V¬s
(
nv
);

345 ià(
v¬s
 =ğ
NULL
)

346  (
NULL
);

348 
	`´šput
("variable weights (if‚ot‡ll 1) ");

349 
	`dl_š™
(&
degs
);

350 
	`dl_š™
(&
degs2
);

351 
	`dlSÿn
(&
degs2
, 
nv
, 1);

352 
n
 = 
	`dl_mš
(&
degs2
);

353 ià(
n
 <= 0)

354 
m
 = -
n
 + 1;

356 
m
 = 0;

357 
	`dl_addto
(&
degs
, 
m
, &
degs2
);

358 
	`dl_kl
(&
degs2
);

359 
i
 = 1; i <ğ
	`Ëngth
(&
degs
); i++)

360 ià(
	`dli¡_»f
(&
degs
, 
i
è> 
maxdeg»e
)

363 
‹mp
 = 
maxdeg»e
;

364 
	`dl_£t
(&
degs
, 
i
, 
‹mp
);

366 
	`´”rÜ
("; weight mu¡ b<ğ%d\n", 
maxdeg»e
);

370 
	`g‘MÚOrd”
(&
mÚÜd”
, 
nv
);

371 
nwtfús
 = 0;

372 
	`dl_š™
(&
wtfús
);

373 
i
 = 1; i <ğ
	`Ëngth
(&
mÚÜd”
); i++)

374 ià(
	`dli¡_»f
(&
mÚÜd”
, 
i
è=ğ
RWTFCN
)

376 
nwtfús
++;

377 
	`g‘WtFú
(
nwtfús
, &
wtfús
, &
degs
, 
v¬s
);

380 
R
 = 
	`rgC»©e
(
chrc
, 
v¬s
, &
degs
, &
mÚÜd”
, &
wtfús
);

381 
	`dl_kl
(&
mÚÜd”
);

382 
	`dl_kl
(&
degs
);

383 
	`dl_kl
(&
wtfús
);

385 
	`Ãwlše
();

386 
	`´št
("†argest degree of‡ monomial : ");

387 
i
 = 0; i < 
R
->
nblocks
; i++)

388 ià(
R
->
symm®g
[
i
]->
¹yp
 =ğ
RSYMM
)

389 
	`´št
("%d ", 
R
->
symm®g
[
i
]->
maxdeg
);

390 
	`´št
("\n");

391  (
R
);

392 
	}
}

394 
	$rgDi¥Ïy
(
FILE
* 
f
, 
ršg
 
R
)

396 
i
, 
j
, 
loc
;

397 
nsymm
;

399 ià(
R
 =ğ
NULL
)

402 
	`âewlše
(
f
);

403 
	`åršt
(
f
, "ch¬aù”i¡iø : %d\n", 
R
->
ch¬ac
);

404 
	`âewlše
(
f
);

405 
	`åršt
(
f
, "numb” oàv¬ŸbË  : %d\n", 
R
->
nv¬s
);

407 
nsymm
 = 0;

408 
i
 = 0; i < 
R
->
nblocks
; i++)

410 
R
->
symm®g
[
i
]->
¹yp
)

412 
RSYMM
:

413 
nsymm
++;

415 
RWTFCN
:

420 ià(
nsymm
 == 1)

422 
	`âewlše
(
f
);

423 
	`åršt
(
f
, "variables : ");

424 
i
 = 0; i < 
R
->
nv¬s
; i++)

425 
	`åršt
(
f
, "%s", 
R
->
v¬Çmes
[
i
]);

426 
	`åršt
(
f
, "\n");

428 
	`âewlše
(
f
);

429 
	`åršt
(
f
, "weights : ");

430 
i
 = 1; i <ğ
R
->
nv¬s
; i++)

431 
	`åršt
(
f
, "%d ", 
	`dli¡_»f
(&
R
->
degs
, 
i
));

432 
	`åršt
(
f
, "\n");

436 
loc
 = 0;

437 
i
 = 0; i < 
R
->
nblocks
; i++)

439 ià(
R
->
symm®g
[
i
]->
¹yp
 =ğ
RSYMM
)

441 
	`âewlše
(
f
);

442 
	`åršt
(
f
, "%2d v¬ŸbË fÜ block %d : ", 
R
->
symm®g
[
i
]->
nv¬s
, i);

443 
j
 = 0; j < 
R
->
symm®g
[
i
]->
nv¬s
; j++, 
loc
++)

444 
	`åršt
(
f
, "%s", 
R
->
v¬Çmes
[
loc
]);

445 
	`åršt
(
f
, "\n");

449 
loc
 = 1;

450 
i
 = 0; i < 
R
->
nblocks
; i++)

452 ià(
R
->
symm®g
[
i
]->
¹yp
 =ğ
RSYMM
)

454 
	`âewlše
(
f
);

455 
	`åršt
(
f
, "weight fÜ block %d : ", 
i
);

456 
j
 = 1; j <ğ
R
->
symm®g
[
i
]->
nv¬s
; j++, 
loc
++)

457 
	`åršt
(
f
, "%d ", 
	`dli¡_»f
(&
R
->
degs
, 
loc
));

458 
	`åršt
(
f
, "\n");

463 
i
 = 0; i < 
R
->
nblocks
; i++)

465 ià(
R
->
symm®g
[
i
]->
¹yp
 =ğ
RWTFCN
)

467 
	`âewlše
(
f
);

468 
	`åršt
(
f
, "weighˆveùÜ block %d : ", 
i
);

469 
j
 = 0; j < 
R
->
nv¬s
; j++)

470 
	`åršt
(
f
, "%d ", 
R
->
symm®g
[
i
]->
degs
[
j
]);

471 
	`åršt
(
f
, "\n");

475 
	`âewlše
(
f
);

476 
	`åršt
(
f
, "monomial order : ");

477 
i
 = 0; i < 
R
->
nblocks
; i++)

479 
typ
 = 
R
->
symm®g
[
i
]->
¹yp
;

480 ià(
typ
 =ğ
RCOMP
)

481 
	`åršt
(
f
, "c ");

482 ià(
typ
 =ğ
RWTFCN
)

483 
	`åršt
(
f
, "w ");

485 
	`åršt
(
f
, "%d ", 
R
->
symm®g
[
i
]->
nv¬s
);

487 
	`åršt
(
f
, "\n");

489 
	`âewlše
(
f
);

490 
	`åršt
(
f
, "top degree of‡ monomial : ");

491 
i
 = 0; i < 
R
->
nblocks
; i++)

492 ià(
R
->
symm®g
[
i
]->
¹yp
 =ğ
RSYMM
)

493 
	`åršt
(
f
, "%d ", 
R
->
symm®g
[
i
]->
maxdeg
);

494 
	`åršt
(
f
, "\n");

496 ià(
R
->
compLoc
 == -1)

498 
	`âewlše
(
f
);

499 
	`åršt
(
f
, "maximum‚umber of„ows in‡ny matrix is : 1\n");

502 ià(
R
->
Rid—l
 !ğ
NULL
)

503 
	`qrgDi¥Ïy
(
f
, 
R
);

504 
	}
}

506 
	$rgPut
(
FILE
* 
f
, 
ršg
 
R
)

509 ()
f
;

510 ()
R
;

511 
	}
}

513 
ršg
 
	$rgSum
(
ršg
 
R1
,„šg 
R2
)

515 
chrc
;

516 ** 
vÇmes
;

517 
dli¡
 
degs
, 
mÚÜd”
, 
wtfús
;

518 
i
, 
j
, 
n
, 
nv¬s
, 
Æeá
;

519 ** 
s
, ** 
t
;

520 
ršg
 
R
;

522 ià((
R1
 =ğ
NULL
è|| (
R2
 == NULL))

523  (
NULL
);

524 
chrc
 = 
R1
->
ch¬ac
;

525 
nv¬s
 = 
R1
->nv¬ + 
R2
->nvars;

527 
vÇmes
 = (**)(*)
	`gimmy
(()
nv¬s
 * ()(*));

528 
s
 = 
R1
->
v¬Çmes
;

529 
t
 = 
vÇmes
;

530 
i
 = 0; i < 
R1
->
nv¬s
; i++)

531 *
t
++ = *
s
++;

532 
s
 = 
R2
->
v¬Çmes
;

533 
i
 = 0; i < 
R2
->
nv¬s
; i++)

534 *
t
++ = *
s
++;

536 
	`dl_š™
(&
degs
);

537 
	`dl_cÚÿt
(&
degs
, &
R1
->degs, &
R2
->degs);

539 
	`dl_š™
(&
mÚÜd”
);

540 
i
 = 1; i <ğ
	`Ëngth
(&
R1
->
mÚÜd”
); i++)

542 
n
 = 
	`dli¡_»f
(&
R1
->
mÚÜd”
, 
i
);

543 ià(
n
 !ğ
RCOMP
)

544 
	`dl_š£¹
(&
mÚÜd”
, 
n
);

546 
i
 = 1; i <ğ
	`Ëngth
(&
R2
->
mÚÜd”
); i++)

548 
n
 = 
	`dli¡_»f
(&
R2
->
mÚÜd”
, 
i
);

549 
	`dl_š£¹
(&
mÚÜd”
, 
n
);

553 
	`dl_š™
(&
wtfús
);

555 
Æeá
 = 
R1
->
nv¬s
;

556 
i
 = 1; i <ğ
	`Ëngth
(&
R1
->
wtfús
); i++)

558 
	`dl_š£¹
(&
wtfús
, 
	`dli¡_»f
(&
R1
->wtfús, 
i
));

559 
Æeá
--;

560 ià(
Æeá
 == 0)

562 
j
 = 1; j <ğ
R2
->
nv¬s
; j++)

563 
	`dl_š£¹
(&
wtfús
, 0);

565 
Æeá
 = 
R1
->
nv¬s
;

568 
Æeá
 = 0;

569 
i
 = 1; i <ğ
	`Ëngth
(&
R2
->
wtfús
); i++)

571 ià(
Æeá
 == 0)

573 
j
 = 1; j <ğ
R1
->
nv¬s
; j++)

574 
	`dl_š£¹
(&
wtfús
, 0);

576 
Æeá
 = 
R2
->
nv¬s
;

578 
	`dl_š£¹
(&
wtfús
, 
	`dli¡_»f
(&
R2
->wtfús, 
i
));

579 
Æeá
--;

582 
R
 = 
	`rgC»©e
(
chrc
, 
vÇmes
, &
degs
, &
mÚÜd”
, &
wtfús
);

583 
	`dl_kl
(&
degs
);

584 
	`dl_kl
(&
mÚÜd”
);

585 
	`dl_kl
(&
wtfús
);

586  (
R
);

587 
	}
}

589 
ršg
 
	$rgFromDeg»es
(
dli¡
* 
degs
, ** 
v¬s
)

591 
ršg
 
»suÉ
;

592 
dli¡
 
cÜ»ùDegs
, 
mÚÜd”
, 
wtfús
;

593 
n
, 
lo
, 
hi
;

595 
	`dl_lohi
(
degs
, &
lo
, &
hi
);

596 
	`dl_š™
(&
cÜ»ùDegs
);

597 ià(
lo
 <= 0)

598 
n
 = -
lo
 + 1;

600 
n
 = 0;

601 
	`dl_addto
(&
cÜ»ùDegs
, 
n
, 
degs
);

603 
	`dl_š™
(&
mÚÜd”
);

604 
	`dl_š£¹
(&
mÚÜd”
, 
	`Ëngth
(
degs
));

605 
	`dl_š£¹
(&
mÚÜd”
, 
RCOMP
);

606 
	`dl_š™
(&
wtfús
);

608 
»suÉ
 = 
	`rgC»©e
(
ch¬ac
, 
v¬s
, &
cÜ»ùDegs
, &
mÚÜd”
, &
wtfús
);

610 
	`dl_kl
(&
cÜ»ùDegs
);

611 
	`dl_kl
(&
mÚÜd”
);

612 
	`dl_kl
(&
wtfús
);

613  (
»suÉ
);

614 
	}
}

	@ring.h

5 
numv¬s
;

6 
nblocks
;

7 
symmBlock
* 
blocks
;

8 
compLoc
;

9 
‹rm
 
z”odegs
;

10 ** 
v¬Çmes
;

11 
dli¡
 
rgDegs
;

12 * 
pSsh
;

15 
š™_ršgs
();

16 
nv¬s
(
ršg
 
R
);

17 
g‘RšgV¬
(
ršg
 
R
, * 
s
);

18 *
v¬Name
(
ršg
 
R
, 
i
);

19 
v¬Weight
(
ršg
 
R
, 
i
);

20 
rgIn¡®l
(
ršg
 
R
);

21 
rgKl
(
ršg
 
R
);

22 
ršg
 
rgC»©e
(
ch¬ac
, ** 
v¬Çmes
, 
dli¡
* 
degs
, dli¡* 
mÚÜd”
, dli¡* 
wtfús
);

23 
g‘MÚOrd”
(
dli¡
* 
mÚÜd”
, 
numv¬s
);

24 
g‘WtFú
(
n
, 
dli¡
* 
wtfús
, dli¡* 
degs
, ** 
v¬s
);

25 
ršg
 
rgSÿn
();

26 
rgDi¥Ïy
(
FILE
* 
f
, 
ršg
 
R
);

27 
rgPut
(
FILE
* 
f
, 
ršg
 
R
);

28 
ršg
 
rgSum
Ôšg 
R1
,„šg 
R2
);

29 
ršg
 
rgFromDeg»es
(
dli¡
* 
degs
, ** 
v¬s
);

	@rmap.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~"sh¬ed.h
"

7 
	~"rm­.h
"

8 
	~"¬¿y.h
"

9 
	~"ch¬p.h
"

10 
	~"cmds.h
"

11 
	~"¶i¡.h
"

12 
	~"gm_pŞy.h
"

13 
	~"humª_io.h
"

14 
	~"gm©rix.h
"

15 
	~"šput.h
"

16 
	~"·r£pŞy.h
"

17 
	~"mÚ™Ü.h
"

18 
	~"pŞy.h
"

19 
	~"qršg.h
"

20 
	~"ršg.h
"

21 
	~"sh–l.h
"

22 
	~"‹rm.h
"

23 
	~"v¬s.h
"

24 
	~"g’”ic.h
"

25 
	~"gm_dli¡.h
"

26 
	~"rv¬.h
"

29 
šlše
 
ršg
 
	$v¬_ršg
(
v¬ŸbË
 *
v
)

31  (
ršg
)(
v
)->
v®ue
;

32 
	}
}

37 
cÚ¡ex´
 
	gIDSIZE
 = 20;

39 
	$rm­_kl
()

41 
	}
}

52 
pŞy
 
	$chªge1_v¬s
(
gm©rix
 
rm­
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
, 
pŞy
 
f
)

54 
f›ld
 
fcÛf
, 
rcÛf
;

55 
fcomp
, 
tİ
, 
i
, 
j
, 
a
;

56 
pŞy
 
g
, 
½Şy
, 
½
, 
‹mp
;

57 
ex±”m
 
ãxp
, 
»xp
, 
exp
;

61 
	`vrg_š¡®l
(
R
);

62 
fcÛf
 = 
f
->
cÛf
;

63 
	`sToExp
(
	`pŞy_š™Ÿl
(
f
), 
ãxp
);

64 
fcomp
 = 
	`g‘_comp
(
f
);

65 
tİ
 = 
	`mš_št
(
	`ncŞs
(
rm­
), 
numv¬s
);

66 
i
 = 
tİ
; i < 
numv¬s
; i++)

67 ià(
ãxp
[
i
] > 0)

69 
	`vrg_š¡®l
(
S
);

70  (
NULL
);

75 
	`vrg_š¡®l
(
S
);

76 
rcÛf
 = 
	`nÜm®ize
(
fcÛf
);

77 
½Şy
 = 
	`e_sub_i
(
fcomp
);

78 
i
 = 0; i < 
numv¬s
; i++)

79 
»xp
[
i
] = 0;

83 
i
 = 0; i < 
tİ
; i++)

85 ià((
a
 = 
ãxp
[
i
]) == 0)

87 
g
 = 
	`¶i¡_»f
(&
rm­
->
g’s
, 
i
 + 1);

88 ià(
g
 =ğ
NULL
)

90 
	`p_kl
(&
½Şy
);

91  (
NULL
);

93 ià(
g
->
Ãxt
 =ğ
NULL
)

95 
	`sToExp
(
	`pŞy_š™Ÿl
(
g
), 
exp
);

96 
j
 = 1; j <ğ
a
; j++)

97 
	`fd_muÉ
(
rcÛf
, 
g
->
cÛf
, &rcoef);

98 
j
 = 0; j < 
numv¬s
; j++)

99 
»xp
[
j
] +ğ
a
 * 
exp
[j];

104 
j
 = 1; j <ğ
a
; j++)

106 
‹mp
 = 
	`p_muÉ
(
g
, 
½Şy
);

107 
	`p_kl
(&
½Şy
);

108 
½Şy
 = 
‹mp
;

111 ià((
rcÛf
 =ğ0è|| (
½Şy
 =ğ
NULL
))

113 
	`p_kl
(&
½Şy
);

114  (
NULL
);

120 
½
 = 
½Şy
;

121 
½
 !ğ
NULL
)

123 
	`fd_muÉ
(
rcÛf
, 
½
->
cÛf
, &rp->coef);

124 
	`sToExp
(
	`pŞy_š™Ÿl
(
½
), 
exp
);

125 
j
 = 0; j < 
numv¬s
; j++)

126 
exp
[
j
] +ğ
»xp
[j];

127 
	`expToS
(
exp
, 
fcomp
, 
	`pŞy_š™Ÿl
(
½
));

128 
½
 =„p->
Ãxt
;

130 
	`qrgReduû
(&
½Şy
);

131  (
½Şy
);

132 
	}
}

134 
pŞy
 
	$chªge_v¬s
(
gm©rix
 
rm­
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
, 
pŞy
 
f
)

136 
pŞy
 
»suÉ
, 
‹mp
;

138 
»suÉ
 = 
NULL
;

139 
f
 !ğ
NULL
)

141 
‹mp
 = 
	`chªge1_v¬s
(
rm­
, 
R
, 
S
, 
f
);

142 
	`p_add
(&
»suÉ
, &
‹mp
);

143 
f
 = f->
Ãxt
;

145  (
»suÉ
);

146 
	}
}

148 
gm©rix
 
	$m©_­¶y
(
gm©rix
 
rm­
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
, gm©rix 
M
)

150 
i
;

151 
pŞy
 
f
;

152 
gm©rix
 
»suÉ
;

154 
	`vrg_š¡®l
(
S
);

155 
»suÉ
 = 
	`mod_š™
();

156 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

157 
i
 = 1; i <ğ
	`ncŞs
(
M
); i++)

159 
f
 = 
	`chªge_v¬s
(
rm­
, 
R
, 
S
, 
	`¶i¡_»f
(&
M
->
g’s
, 
i
));

160 
	`gmIn£¹
(
»suÉ
, 
f
);

162  (
»suÉ
);

163 
	}
}

165 
gm©rix
 
	$rm­_sÿn
(
v¬ŸbË
 *
R
, v¬ŸbË *
S
)

167 
gm©rix
 
»suÉ
;

168 
i
, 
n
;

169 
ršg
 
RR
;

171 
RR
 = 
	`v¬_ršg
(
R
);

172 
n
 = 
	`nv¬s
(
RR
);

174 
	`vrg_š¡®l
(
S
);

175 
»suÉ
 = 
	`mod_š™
();

176 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 1);

177 
i
 = 0; i < 
n
; i++)

179 
	`´šput
("% --->", 
	`v¬Name
(
RR
, 
i
));

180 
	`gmIn£¹
(
»suÉ
, 
	`rdPŞy
(1));

182  (
»suÉ
);

183 
	}
}

185 
	$rm­_µršt
(
gm©rix
 
rm­
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
)

187 
ršg
 
RR
;

188 
i
, 
n
;

190 
	`âewlše
(
outfe
);

191 
	`åršt
(
outfe
, "m­ : % ---> %s\n", 
R
->
Çme
, 
S
->name);

192 
	`vrg_š¡®l
(
S
);

193 
RR
 = 
	`v¬_ršg
(
R
);

194 
n
 = 
	`nv¬s
(
RR
);

195 
i
 = 0; i < 
n
; i++)

197 
	`âewlše
(
outfe
);

198 
	`åršt
(
outfe
, "% |--> ", 
	`v¬Name
(
RR
, 
i
));

199 ià(
i
 >ğ
	`ncŞs
(
rm­
))

200 
	`åršt
(
outfe
, "0");

202 
	`p_µršt
(
outfe
, 
	`¶i¡_»f
(&
rm­
->
g’s
, 
i
 + 1), 1);

203 
	`åršt
(
outfe
, "\n");

205 
	}
}

207 
gm©rix
 
	$im­
(
v¬ŸbË
 *
R
, v¬ŸbË *
S
, 
boŞ—n
 
Úes
)

209 
ršg
 
RR
;

210 
gm©rix
 
»suÉ
;

211 
v
, 
w
, 
n
;

213 
	`vrg_š¡®l
(
S
);

214 
RR
 = 
	`v¬_ršg
(
R
);

215 
n
 = 
	`nv¬s
(
RR
);

216 
»suÉ
 = 
	`mod_š™
();

217 
	`dl_Ãw
(&
»suÉ
->
deg»es
, 1);

218 
v
 = 0; v < 
n
; v++)

220 
w
 = 
	`g‘V¬
(
	`v¬Name
(
RR
, 
v
));

221 ià(
w
 == -1)

223 ià(
Úes
)

224 
	`gmIn£¹
(
»suÉ
, 
	`e_sub_i
(1));

226 
	`gmIn£¹
(
»suÉ
, 
NULL
);

229 
	`gmIn£¹
(
»suÉ
, 
	`p_xjei
(
w
, 1));

231  (
»suÉ
);

232 
	}
}

234 
	$ed™_rm­
(
gm©rix
 
rm­
, 
v¬ŸbË
 *
R
, v¬ŸbË *
S
)

236 
¬gc
, 
v
;

237 **
¬gv
;

238 
pŞy
 
f
;

240 
	`vrg_š¡®l
(
S
);

241 
Œue
)

243 
	`´šput
("variable,‚ew image");

244 
	`g‘_lše
(&
¬gc
, &
¬gv
);

245 ià(
¬gc
 < 2)

247 
v
 = 1 + 
	`g‘RšgV¬
(
	`v¬_ršg
(
R
), 
¬gv
[0]);

248 ià(
v
 == 0)

250 
	`´”rÜ
("; v¬ŸbË % nÙ defšed\n", 
¬gv
[0]);

253 
f
 = 
	`rdPŞySŒ
(
¬gc
 - 1, 
¬gv
 + 1, 1);

254 
v
 > 
	`ncŞs
(
rm­
))

255 
	`gmIn£¹
(
rm­
, 
NULL
);

256 
pŞy
 *
p
 = 
	`¶i¡_»f_±r
(&
rm­
->
g’s
, 
v
);

257 
	`p_kl
(
p
);

258 *
p
 = 
f
;

260 
	}
}

262 
	$rm­_cmd
(
¬gc
, *
¬gv
[])

264 
v¬ŸbË
 *
R
, *
S
, *
p
;

265 
s
[
IDSIZE
];

266 
gm©rix
 
M
;

268 ià(
¬gc
 != 4)

270 
	`´šŠew
("rmap <result> <R> <S>\n");

273 ià((
R
 = 
	`vg‘_ršg
(
¬gv
[2])è=ğ
NULL
)

275 ià((
S
 = 
	`vg‘_ršg
(
¬gv
[3])è=ğ
NULL
)

277 
	`¡rıy
(
s
, 
¬gv
[1]);

278 
M
 = 
	`rm­_sÿn
(
R
, 
S
);

279 
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
S
);

280 ià(
p
 =ğ
NULL
)

282 
	`£t_v®ue
(
p
, 
M
);

283 
	}
}

285 
	$im­_cmd
(
¬gc
, *
¬gv
[])

287 
v¬ŸbË
 *
R
, *
S
;

288 
v¬ŸbË
 *
p
;

289 
gm©rix
 
f
;

290 
s
[
IDSIZE
];

292 ià((
¬gc
 < 4) || (argc > 5))

294 
	`´šŠew
("imap <new„ing map> <R> <S> [ones, default=zeros]\n");

297 ià((
R
 = 
	`vg‘_ršg
(
¬gv
[2])è=ğ
NULL
)

299 ià((
S
 = 
	`vg‘_ršg
(
¬gv
[3])è=ğ
NULL
)

301 
	`¡rıy
(
s
, 
¬gv
[1]);

302 
f
 = 
	`im­
(
R
, 
S
, (
¬gc
 == 5));

303 
	`ed™_rm­
(
f
, 
R
, 
S
);

304 
p
 = 
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
S
);

305 ià(
p
 =ğ
NULL
)

307 
	`£t_v®ue
(
p
, 
f
);

308 
	}
}

310 
	$ev_cmd
(
¬gc
, *
¬gv
[])

312 
gm©rix
 
M
, 
rm­
;

313 
v¬ŸbË
 *
p
, *
R
, *
S
;

315 ià(
¬gc
 != 4)

317 
	`´šŠew
("ev <ideal> <matrix> <changed matrix>\n");

322 ià((
M
 = 
	`vg‘_mod
(
¬gv
[2])è=ğ
NULL
)

324 
R
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

325 ià(!
R
)

329 ià((
rm­
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

331 
S
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

332 ià(!
S
)

336 ià(((
p
èğ
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VMODULE
, 
S
)è=ğ
NULL
)

338 
	`£t_v®ue
(
p
, 
	`m©_­¶y
(
rm­
, 
R
, 
S
, 
M
));

339 
	}
}

365 
	$ãtch_cmd
(
¬gc
, *
¬gv
[])

367 
v¬ŸbË
 *
S
, *
R
, *
p
;

368 
gm©rix
 
g
, 
M
;

369 
s
[
IDSIZE
];

371 ià((
¬gc
 < 3) || (argc > 4))

373 
	`´šŠew
("fetch <matrix> <result matrix> [ones, default=zeros]\n");

378 
S
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

379 ià(!
S
)

383 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

385 
R
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

386 ià(!
R
)

390 
	`vrg_š¡®l
(
S
);

391 
	`¡rıy
(
s
, 
¬gv
[2]);

392 
g
 = 
	`im­
(
R
, 
S
, (
¬gc
 == 4));

395 ià(((
p
èğ
	`make_v¬
(
s
, 
MAINVAR
, 
VMODULE
, 
S
)è=ğ
NULL
)

397 
	`£t_v®ue
(
p
, 
	`m©_­¶y
(
g
, 
R
, 
S
, 
M
));

398 
	`mod_kl
(
g
);

399 
	}
}

401 
	$modrm­_cmd
(
¬gc
, *
¬gv
[])

403 
v¬ŸbË
 *
R
, *
S
;

404 
gm©rix
 
g
;

406 ià((
¬gc
 < 2) || (argc > 3))

408 
	`´šŠew
("edit_map <ideal> [source„ing]\n");

412 ià(
¬gc
 == 2)

414 
R
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

415 ià(!
R
)

418 ià((
R
 = 
	`vg‘_ršg
(
¬gv
[2])è=ğ
NULL
)

421 ià((
g
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

423 
S
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

424 ià(!
S
)

427 
	`ed™_rm­
(
g
, 
R
, 
S
);

428 
	}
}

430 
	$pm­_cmd
(
¬gc
, *
¬gv
[])

432 
v¬ŸbË
 *
R
, *
S
;

433 
gm©rix
 
g
;

435 ià((
¬gc
 < 2) || (argc > 3))

437 
	`´šŠew
("pmap <ideal> [source„ing]\n");

440 ià(
¬gc
 == 2)

442 
R
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

443 ià(!
R
)

446 ià((
R
 = 
	`vg‘_ršg
(
¬gv
[2])è=ğ
NULL
)

449 ià((
g
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

451 
S
 = 
cu¼’t_ršg
 ? 
	`vg‘_ršg
(""è: 
NULL
;

452 ià(!
S
)

455 
	`rm­_µršt
(
g
, 
R
, 
S
);

456 
	}
}

	@rmap.h

5 
rm­_kl
();

6 
pŞy
 
chªge1_v¬s
(
gm©rix
 
rm­
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
,…Şy 
f
);

7 
pŞy
 
chªge_v¬s
(
gm©rix
 
rm­
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
,…Şy 
f
);

8 
gm©rix
 
m©_­¶y
(gm©rix 
rm­
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
, gm©rix 
M
);

11 
gm©rix
 
rm­_sÿn
(
v¬ŸbË
* 
R
, v¬ŸbË* 
S
);

12 
rm­_µršt
(
gm©rix
 
rm­
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
);

13 
gm©rix
 
im­
(
v¬ŸbË
* 
R
, v¬ŸbË* 
S
, 
boŞ—n
 
Úes
);

14 
ed™_rm­
(
gm©rix
 
rm­
, 
v¬ŸbË
* 
R
, v¬ŸbË* 
S
);

17 
rm­_cmd
(
¬gc
, * 
¬gv
[]);

18 
im­_cmd
(
¬gc
, * 
¬gv
[]);

19 
ev_cmd
(
¬gc
, * 
¬gv
[]);

20 
ãtch_cmd
(
¬gc
, * 
¬gv
[]);

21 
modrm­_cmd
(
¬gc
, * 
¬gv
[]);

22 
pm­_cmd
(
¬gc
, * 
¬gv
[]);

	@rvar.c

4 
	~<ùy³.h
>

5 
	~<£tjmp.h
>

6 
	~<¡ršg.h
>

7 
	~"sh¬ed.h
"

8 
	~"rv¬.h
"

9 
	~"humª_io.h
"

10 
	~"·r£.h
"

11 
	~"¡ash.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"ršg.h
"

15 
jmp_buf
 
	gjmp£q
;

17 
cÚ¡ex´
 
	gNINDICES
 = 10;

18 
cÚ¡ex´
 
	gVSIZE
 = 100;

60 
	mnšdiûs
;

61 
	mšdiûs
[
NINDICES
];

62 } 
	tšd‘
;

64 
	$putPosIÁ
(**
ss
, 
n
)

66 ià(
n
 >= 10)

67 
	`putPosIÁ
(
ss
, 
n
 / 10);

68 *(*
ss
)++ = ()('0' + (
n
 % 10));

69 
	}
}

71 
	$putIÁ
(**
ss
, 
n
)

73 ià(
n
 < 0)

75 *(*
ss
)++ = '-';

76 
n
 = -n;

78 
	`putPosIÁ
(
ss
, 
n
);

79 **
ss
 = '\0';

80 
	}
}

84 
	$g‘IndexV¬
(
šd‘
 *
v
, *
s
)

86 
i
;

88 ià(
v
->
nšdiûs
 < 0)

90 *
s
 = '\0';

93 ià(
v
->
šdiûs
[0] != 0)

94 *
s
++ = ()
v
->
šdiûs
[0];

96 ià(
v
->
nšdiûs
 == 0)

98 *
s
 = '\0';

101 *
s
++ = '[';

102 
i
 = 1; i < 
v
->
nšdiûs
; i++)

104 
	`putIÁ
(&
s
, 
v
->
šdiûs
[
i
]);

105 *
s
++ = ',';

107 
	`putIÁ
(&
s
, 
v
->
šdiûs
[v->
nšdiûs
]);

108 *
s
++ = ']';

109 *
s
 = '\0';

110 
	}
}

112 
boŞ—n
 
	$cŞËùV¬
(**
¡r
, 
šd‘
 *
v
, *
s
)

114 
c
;

116 ià(!
	`v®idV¬
(**
¡r
))

119 ià(**
¡r
 == '|')

121 
v
->
nšdiûs
 = -1;

122 *
s
++ = *(*
¡r
)++;

125 
c
 = *(*
¡r
)++;

126 *
s
++ = 
c
;

127 } (
c
 != '|') && (c != '\0'));

128 *
s
 = '\0';

132 ià(
	`i§Íha
(**
¡r
))

133 
v
->
šdiûs
[0] = *(*
¡r
)++;

135 
v
->
šdiûs
[0] = 0;

137 
v
->
nšdiûs
 = 0;

138 ià(**
¡r
 == '[')

142 (*
¡r
)++;

143 
v
->
nšdiûs
++;

144 
v
->
šdiûs
[v->
nšdiûs
] = 
	`·r£IÁ
(
¡r
);

145 } **
¡r
 == ',');

146 ià(**
¡r
 != ']')

148 
s
[0] = '\0';

152 (*
¡r
)++;

154 
	`g‘IndexV¬
(
v
, 
s
);

156 
	}
}

160 
	$fšdV¬
(**
v¬s
, 
n
, *
s
)

162 
v
;

164 
v
 = 0; v < 
n
; v++)

165 ià(
	`¡rcmp
(
v¬s
[
v
], 
s
) == 0)

166  (
v
);

168 
	}
}

172 
	$šsV¬
(**
v¬s
, *
v
, *
s
)

174 *
p
;

175 
size
;

177 ià(
	`fšdV¬
(
v¬s
, *
v
, 
s
) != -1)

179 
	`´”rÜ
("; cª'ˆdefšv¬ŸbË % twiû\n", 
s
);

182 
size
 = ()
	`¡¾’
(
s
) + 1;

183 ià((
size
 % 2) != 0)

184 
size
++;

185 
p
 = (*)
	`gimmy
(()
size
);

186 
	`¡rıy
(
p
, 
s
);

187 
v¬s
[*
v
] = 
p
;

188 (*
v
)++;

189 
	}
}

191 
šd‘
 *
	g£qv1
, *
	g£qv2
;

192 
šd‘
 
	g£qv
;

193 **
	g£qv¬s
;

194 
	g£qmaxv¬s
;

195 *
	g£qnv¬s
;

196 
	g£qs
[100];

198 
	$£qV¬s
(
loc
)

200 
i
, 
fœ¡
, 
£cÚd
, 
dœeùiÚ
;

202 ià(
loc
 =ğ(1 + 
£qv1
->
nšdiûs
))

204 
	`g‘IndexV¬
(&
£qv
, 
£qs
);

205 
	`šsV¬
(
£qv¬s
, 
£qnv¬s
, 
£qs
);

206 ià(*
£qnv¬s
 =ğ
£qmaxv¬s
)

207 
	`lÚgjmp
(
jmp£q
, -1);

212 
fœ¡
 = 
£qv1
->
šdiûs
[
loc
];

213 
£cÚd
 = 
£qv2
->
šdiûs
[
loc
];

214 
dœeùiÚ
 = (
fœ¡
 > 
£cÚd
);

215 
i
 = 
fœ¡
; ((
dœeùiÚ
 && (˜>ğ
£cÚd
)) || ((!direction) && (i <= second)));

216 (
dœeùiÚ
 ? 
i
-- : i++))

218 
£qv
.
šdiûs
[
loc
] = 
i
;

219 
	`£qV¬s
(
loc
 + 1);

222 
	}
}

224 
boŞ—n
 
	$okSeqV¬s
(
šd‘
 *
v1
, ind‘ *
v2
)

226 ià((
v1
->
nšdiûs
 !ğ
v2
->nindices) || (v1->nindices == -1))

228 ià((
v1
->
šdiûs
[0] =ğ0è&& (
v2
->indices[0] == 0))

230 ià((
	`i¦ow”
(
v1
->
šdiûs
[0])è&& (i¦ow”(
v2
->indices[0])))

232 ià((
	`isuµ”
(
v1
->
šdiûs
[0])è&& (isuµ”(
v2
->indices[0])))

235 
	}
}

237 
	$doSeqV¬s
(**
v¬s
, *
nv¬sSoF¬
, 
šd‘
 *
v1
, ind‘ *
v2
, 
nv¬s
)

239 ià(!
	`okSeqV¬s
(
v1
, 
v2
))

241 
	`´”rÜ
(";‚on-compatible variables can't be sequenced\n");

244 
£qv¬s
 = 
v¬s
;

245 
£qv1
 = 
v1
;

246 
£qv2
 = 
v2
;

247 
£qnv¬s
 = 
nv¬sSoF¬
;

248 
£qv
.
nšdiûs
 = 
v1
->nindices;

249 
£qmaxv¬s
 = 
nv¬s
;

250 ià(
	`£tjmp
(
jmp£q
))

253 
	`£qV¬s
(0);

254 
	}
}

258 
	$ÃxtV¬
(**
¡r
, 
šd‘
 *
v
, *
s
, 
numËá
)

260 !
	`cŞËùV¬
(
¡r
, 
v
, 
s
))

262 ià(
numËá
 == 1)

263 
	`´šput
("one more variable,…lease ");

265 
	`´šput
("%3d mÜv¬ŸbËs,…Ëa£ ", 
numËá
);

266 *
¡r
 = 
	`g‘_¡r
("");

268 
	}
}

274 
boŞ—n
 
	$v®idV¬
(
c
)

276 ià((
c
 =ğ'|'è|| (ø=ğ'['è|| (
	`i§Íha
(c)))

279 
	}
}

281 
	$·r£V¬
(**
¡r
)

283 
šd‘
 
v
;

284 
s
[100];

286 ià(
	`cŞËùV¬
(
¡r
, &
v
, 
s
))

288  (
	`fšdV¬
(
v¬Çmes
, 
numv¬s
, 
s
));

292 
	}
}

294 
	$g‘V¬
(cÚ¡ *
s
)

297 
buf
[256];

298 
	`¡ºıy
(
buf
, 
s
, (buf) - 1);

299 
buf
[(buf) - 1] = '\0';

300 *
¡r
 = 
buf
;

301  (
	`·r£V¬
(&
¡r
));

302 
	}
}

304 
	$g‘V¬R–
(**
vÇmes
, 
Ën
, *
s
)

306 
šd‘
 
v
;

307 
t
[100];

309 ià(
	`cŞËùV¬
(&
s
, &
v
, 
t
))

311  (
	`fšdV¬
(
vÇmes
, 
Ën
, 
t
));

315 
	}
}

317 **
	$g‘V¬s
(
nv¬s
)

319 **
»suÉ
;

320 *
¡r
;

321 
s
[
VSIZE
];

322 
nv
;

323 
šd‘
 
v1
, 
v2
;

325 
»suÉ
 = (**)(*)
	`gimmy
(()
nv¬s
 * ()(*));

326 
	`´šput
("%3d v¬ŸbËs,…Ëa£ ", 
nv¬s
);

327 
¡r
 = 
	`g‘_¡r
("");

328 
nv
 = 0;

330 
v1
.
nšdiûs
 = -1;

331 
nv
 < 
nv¬s
)

333 
	`ÃxtV¬
(&
¡r
, &
v1
, 
s
, 
nv¬s
 - 
nv
);

334 ià(*
¡r
 == '-')

336 
¡r
++;

337 
	`cŞËùV¬
(&
¡r
, &
v2
, 
s
);

338 
	`doSeqV¬s
(
»suÉ
, &
nv
, &
v1
, &
v2
, 
nv¬s
);

341 
	`šsV¬
(
»suÉ
, &
nv
, 
s
);

343 ià(*
¡r
 != '\0')

345 
	`Ãwlše
();

346 
	`´št
("toØmªy v¬ŸbË giv’, ignÜšg %s\n", 
¡r
);

348  (
»suÉ
);

349 
	}
}

	@rvar.h

5 
boŞ—n
 
v®idV¬
(
c
);

6 
·r£V¬
(**
¡r
);

7 
g‘V¬
(cÚ¡ *
s
);

8 
g‘V¬R–
(**
v¬Çmes
, 
Ën
, *
s
);

9 **
g‘V¬s
(
nv¬s
);

12 
jmp_buf
 
jmp£q
;

	@set.c

4 
	~<£tjmp.h
>

5 
	~<¡ršg.h
>

6 
	~"sh¬ed.h
"

7 
	~"£t.h
"

8 
	~"cmds.h
"

9 
	~"mÚ™Ü.h
"

10 
	~"·r£.h
"

11 
	~"sh–l.h
"

13 
cÚ¡ex´
 
	gNSETVARS
 = 16;

14 
	gbaout
;

15 
	glšesize
;

16 
	gv”bo£
;

17 
	g´_ch¬p
;

18 
	g´Ëv–
;

19 
	gtim”
;

20 
	gautoÿlc
;

21 
	gautodeg»e
;

22 
	gmaxdeg»e
;

23 
	gecho
;

24 
	gautoReduû
;

25 
	gÆšes
;

26 
	g´comm’t
;

27 
	gshowmem
;

28 
	gshow·œs
;

29 
	giod–ay
;

31 cÚ¡ *
	g£tNames
[
NSETVARS
 + 1];

32 *
	g£tLocs
[
NSETVARS
];

33 
	g£tDeçuÉs
[
NSETVARS
];

34 cÚ¡ *
	g£tWh©
[
NSETVARS
];

36 
	$i_£tv¬
(
n
, cÚ¡ *
Çme
, *
loc
, 
deçuÉV®
, cÚ¡ *
wh©ami
)

38 
£tNames
[
n
] = 
Çme
;

39 
£tLocs
[
n
] = 
loc
;

40 
£tDeçuÉs
[
n
] = 
deçuÉV®
;

41 
£tWh©
[
n
] = 
wh©ami
;

42 *
loc
 = 
deçuÉV®
;

43 
	}
}

45 
	$i_£t
()

47 
	`i_£tv¬
(0, "abÜt", &
baout
, 0,

49 
	`i_£tv¬
(1, "auto", &
autoReduû
, 0, ">0 means do NOT do‡utoreduction");

50 
	`i_£tv¬
(2, "autoÿlc", &
autoÿlc
, -1,

52 
	`i_£tv¬
(3, "autodeg»e", &
autodeg»e
, 0, "if‡utocalc>0,his is highest degreeo compute");

53 
	`i_£tv¬
(4, "ch¬0", &
´_ch¬p
, 0, ">0 means do NOT (tryo)†ifto„ationals");

54 
	`i_£tv¬
(5, "echo", &
echo
, 0, ">0ells Macaulayoƒcho‡ll input");

55 
	`i_£tv¬
(6, "iod–ay", &
iod–ay
, 0, "delay (in systemicks) for caching verbose output");

56 
	`i_£tv¬
(7, "lšesize", &
lšesize
, 79, "size of†ine for matrix display");

57 
	`i_£tv¬
(8, "maxdeg»e", &
maxdeg»e
, 512,

59 
	`i_£tv¬
(9, "Æšes", &
Æšes
, 1, "number of blank†ines between commands");

60 
	`i_£tv¬
(10, "´comm’t", &
´comm’t
, 0, "if >0 startƒach output†ine with ;");

61 
	`i_£tv¬
(11, "´Ëv–", &
´Ëv–
, 0, ">0 means suppress ALL output,ƒxceptƒrror messages");

62 
	`i_£tv¬
(12, "showmem", &
showmem
, 1, ">0 means„eport memory usage‡tƒach increase");

63 
	`i_£tv¬
(13, "show·œs", &
show·œs
, 0, ">0 means„eport S-pairs†eft during computations");

64 
	`i_£tv¬
(14, "tim”", &
tim”
, 0, ">0 means displayƒxecutionime");

65 
	`i_£tv¬
(15, "v”bo£", &
v”bo£
, 0, ">0 means give verbose output");

66 
£tNames
[
NSETVARS
] = "";

67 
	}
}

69 
	$lookup
(cÚ¡ *
Çmes
[], cÚ¡ *
s
)

71 
i
, 
v®
;

73 
i
 = 0; *(
Çmes
[i]) != '\0'; i++)

75 
v®
 = 
	`issub£q
(
s
, 
Çmes
[
i
]);

76 ià(
v®
 == 0)

77  
i
;

78 ià(
v®
 == -1)

82 
	}
}

84 
	$doS‘
(
¬gc
, *
¬gv
[], 
boŞ—n
 
doInü
)

86 
i
;

88 ià(
¬gc
 == 1)

90 
i
 = 0; i < 
NSETVARS
; i++)

92 
	`Ãwlše
();

93 
	`´št
("%-10 %3d %s\n", 
£tNames
[
i
], *(
£tLocs
[i]), 
£tWh©
[i]);

98 ià(
	`¡rcmp
(
¬gv
[1], "default") == 0)

100 
	`i_£t
();

104 
i
 = 
	`lookup
(
£tNames
, 
¬gv
[1]);

105 ià(
i
 == -1)

107 
	`´”rÜ
(";‚Ø£ˆv¬ŸbË‚amed %s\n", 
¬gv
[1]);

111 ià(
¬gc
 == 2)

112 *(
£tLocs
[
i
]èğ
£tDeçuÉs
[i];

113 ià(
¬gc
 == 3)

115 ià(
doInü
)

116 *(
£tLocs
[
i
]è+ğ
	`g‘IÁ
(
¬gv
[2]);

118 *(
£tLocs
[
i
]èğ
	`g‘IÁ
(
¬gv
[2]);

120 
	}
}

122 
	$šc£t_cmd
(
¬gc
, *
¬gv
[])

124 
	`doS‘
(
¬gc
, 
¬gv
, 
Œue
);

125 
	}
}

127 
	$£t_cmd
(
¬gc
, *
¬gv
[])

129 
	`doS‘
(
¬gc
, 
¬gv
, 
çl£
);

130 
	}
}

132 
	$£tv®ue_cmd
(
¬gc
, *
¬gv
[])

134 
i
, 
v®
;

136 ià((
¬gc
 < 2) || (argc > 3))

138 
	`´šŠew
("set_value <set variable> [result integer]\n");

141 
i
 = 
	`lookup
(
£tNames
, 
¬gv
[1]);

142 ià(
i
 == -1)

144 
	`´”rÜ
(";‚Ø£ˆv¬ŸbË‚amed %s\n", 
¬gv
[1]);

147 
v®
 = *(
£tLocs
[
i
]);

148 
	`doIÁCmd
(
¬gv
[2], 
v®
, (
¬gc
 == 3),‡rgv[1]);

149 
	}
}

	@set.h

7 
baout
;

8 
lšesize
;

9 
v”bo£
;

10 
´_ch¬p
;

11 
´Ëv–
;

12 
tim”
;

13 
autoÿlc
;

14 
autodeg»e
;

15 
maxdeg»e
;

16 
echo
;

17 
autoReduû
;

18 
Æšes
;

19 
´comm’t
;

20 
showmem
;

21 
show·œs
;

22 
iod–ay
;

27 
i_£t
();

30 
£t_cmd
(
¬gc
, * 
¬gv
[]);

31 
šc£t_cmd
(
¬gc
, * 
¬gv
[]);

32 
£tv®ue_cmd
(
¬gc
, * 
¬gv
[]);

35 
i_£tv¬
(
n
, cÚ¡ * 
Çme
, * 
loc
, 
deçuÉV®
, cÚ¡ * 
wh©ami
);

36 
doS‘
(
¬gc
, * 
¬gv
[], 
boŞ—n
 
doInü
);

	@shared.h

4 
	~<ùy³.h
>

5 
	~<¡dboŞ.h
>

6 
	~<¡dšt.h
>

7 
	~<¡dio.h
>

8 
	~<¡dlib.h
>

11 
cÚ¡ex´
 
	gNVARS
 = 20;

12 
cÚ¡ex´
 
	gGFSIZE
 = 200;

13 
cÚ¡ex´
 
	gNCOMS
 = 5000;

14 
cÚ¡ex´
 
	gNDEGS
 = 400;

15 
cÚ¡ex´
 
	gNARRAY
 = 600;

18 
	tboŞ—n
;

19 
cÚ¡ex´
 
	gTRUE
 = -1;

20 
cÚ¡ex´
 
	gFALSE
 = 0;

23 
cÚ¡ex´
 
	gLT
 = -1;

24 
cÚ¡ex´
 
	gEQ
 = 0;

25 
cÚ¡ex´
 
	gGT
 = 1;

28 (*
	tpfi
)();

31 
šlše
 
	$mš_št
(
a
, 
b
)

33  (
a
 < 
b
) ?‡ : b;

34 
	}
}

36 
šlše
 
	$max_št
(
a
, 
b
)

38  (
a
 > 
b
) ?‡ : b;

39 
	}
}

41 
šlše
 
	$mš_lÚg
(
a
, 
b
)

43  (
a
 < 
b
) ?‡ : b;

44 
	}
}

46 
šlše
 
	$max_lÚg
(
a
, 
b
)

48  (
a
 > 
b
) ?‡ : b;

49 
	}
}

52 
šlše
 
	$debug_as£¹
(cÚ¡ * 
msg
, 
boŞ
 
cÚd™iÚ
)

54 #ifdeà
DEBUG


55 ià(!
cÚd™iÚ
)

57 
	`årštf
(
¡d”r
, "As£¹iÚ faed: %s\n", 
msg
);

58 
	`abÜt
();

61 ()
msg
;

62 ()
cÚd™iÚ
;

64 
	}
}

67 
	s¦ab»c


69 
	mv®s
[
NARRAY
];

70 
¦ab»c
* 
	mÃxt
;

71 } 
	t¦ab
;

75 
	mËn
;

76 
	msize
;

77 
	mv®_size
;

78 
¦ab
* 
	m–ems
;

79 } 
	t¬¿y
;

81 
¬¿y
 
	t¶i¡
;

82 
¬¿y
 
	tdli¡
;

85 
	tsm®lmÚ
;

86 
sm®lmÚ
* 
	t‹rm
;

87 
symblock
* 
	tsymmBlock
;

88 
ršg»c
* 
	tršg
;

89 
pŞ
* 
	tpŞy
;

90 
mod»c
* 
	tgm©rix
;

91 
mn_¡d»c
* 
	tmn_¡ªd¬d
;

92 
®l
* 
	t¬row
;

93 * 
	tADDRESS
;

94 
v¬b_»c
 
	tv¬ŸbË
;

97 
cÚ¡ex´
 
	gRSYMM
 = -1;

98 
cÚ¡ex´
 
	gRCOMP
 = -2;

99 
cÚ¡ex´
 
	gRWTFCN
 = -3;

100 
cÚ¡ex´
 
	gLARGE_PRIME
 = 32749;

103 
cÚ¡ex´
 
	gMAXNEG
 = -30000;

104 
cÚ¡ex´
 
	gMNOTHING
 = -1;

105 
cÚ¡ex´
 
	gMMAT
 = 0;

106 
cÚ¡ex´
 
	gMSTD
 = 1;

107 
cÚ¡ex´
 
	gMISTD
 = 2;

110 
cÚ¡ex´
 
	gUSEMAT
 = 0;

111 
cÚ¡ex´
 
	gUSESTD
 = 1;

112 
cÚ¡ex´
 
	gUSECHANGE
 = 2;

115 
cÚ¡ex´
 
	gFOW
 = 0;

116 
cÚ¡ex´
 
	gBAK
 = 1;

119 
	ssymblock


121 
	m¹yp
;

122 
	mnv¬s
;

123 * 
	mdegs
;

124 ** 
	mÇmes
;

125 
sm®lmÚ
* 
	mbË
;

126 
sm®lmÚ
** 
	mcŞs
;

127 
sm®lmÚ
 
	mmaxv®
;

128 
	mw1
;

129 
	mmaxdeg
;

130 
	mdeçuÉmax
;

131 
	mov”
;

132 
	mn1
;

133 
	mdeg»e
;

134 (*
	m¡ob
)();

135 
sm®lmÚ
 (*
btos
)();

136 
sm®lmÚ
 (*
madd
)();

137 
symmBlock
 
	mÃxtBlock
;

141 
	sršg»c


143 
	mch¬ac
;

144 
	mnv¬s
;

145 ** 
	mv¬Çmes
;

146 
dli¡
 
	mdegs
;

147 
dli¡
 
	mmÚÜd”
;

148 
dli¡
 
	mwtfús
;

149 
	mnblocks
;

150 
symmBlock
* 
	msymm®g
;

151 
	mcompLoc
;

152 
‹rm
 
	mz”odegs
;

153 * 
	mpSsh
;

154 * 
	mh—dSsh
;

155 * 
	mmÚSsh
;

156 * 
	m·»nSsh
;

157 * 
	mRid—l
;

158 * 
	mR¡d
;

162 
	spŞ


164 
pŞ
* 
	mÃxt
;

165 
	mcÛf
;

166 * 
	mmÚom
;

170 
	smn_¡d»c


172 
mn_¡ªd¬d
 
	mÃxt
;

173 
pŞy
 
	m¡ªd¬d
;

174 
pŞy
 
	mchªge
;

175 
	mismš
;

176 
	mdeg»e
;

182 
	mmty³
;

183 
	mmis¡d
;

184 
mn_¡ªd¬d
 
	mmp
;

185 
¬row
 
	mmq
;

186 
¬¿y
* 
	mmmÚb
;

187 
	mmi
;

188 
¶i¡
* 
	mmg’s
;

189 } 
	tmodg’
;

192 
	smod»c


194 
mod»c
* 
	mÃxt
;

195 
	mmodty³
;

196 
dli¡
 
	mdeg»es
;

197 
dli¡
 
	mdegg’s
;

198 
¶i¡
 
	mg’s
;

199 
	mn¡ªd¬d
;

200 
mn_¡ªd¬d
 
	m¡dbasis
;

201 
¬¿y
 
	mmÚb
;

202 
¬¿y
 
	mmÚsyz
;

203 
	mmn_lodeg
;

208 
cÚ¡ex´
 
	gREMOVED
 = 0;

209 
cÚ¡ex´
 
	gMAINVAR
 = 1;

210 
cÚ¡ex´
 
	gPARTVAR
 = 2;

213 
	sv¬b_»c


215 
	mexi¡s
;

216 
	mg¬bage
;

217 
	mv¬_num
;

218 * 
	mÇme
;

219 
	mty³
;

220 
v¬ŸbË
* 
	mb_ršg
;

221 
v¬ŸbË
* 
	mb_Ãxt
;

222 
v¬ŸbË
* 
	mb_®Ÿs
;

223 
ADDRESS
 
	mv®ue
;

224 
	mštv®
;

230 * 
	mci
;

231 
®l
* 
	mÿ
;

232 } 
	tÿrgo
;

235 
	slškduk_ba£


237 
®l
* 
	mlda
[2];

238 
ÿrgo
 
	mldc
;

239 
	mldkšd
;

240 } 
	tlškduk_ba£
;

243 
lškduk_ba£
 
	tlškduk
;

246 
	tex±”m
[
NVARS
];

247 
	tf›ld
;

248 
	tbig‹rm
[
NVARS
];

249 
	t®loù”m
[
NVARS
];

250 
¬¿y
 
	tmn_bË
;

251 
¬¿y
 
	tmn_syzes
;

256 
lškduk_ba£
 
	mba£
;

257 
ex±”m
 
	mmexp
;

258 } 
	tmmÚom
;

262 
lškduk_ba£
 
	mba£
;

263 
	mmËv
;

264 } 
	tmÚ·»n
;

266 
	sm¡k


268 
	mmi
, 
	mm´e
;

269 
®l
* 
	mma
;

274 
lškduk_ba£
 
	mba£
;

275 
®l
* 
	mmloc
;

276 
	mmn
, 
	mmii
, 
	mmimš
, 
	mm´’
, 
	mm´ed
;

277 
m¡k
 
	mm¡ack
[
NVARS
 - 1];

278 } 
	tmÚh—d
;

281 
	u®l


283 
	mui
;

284 
®l
* 
	mua
;

285 
ÿrgo
 
	mucg
;

286 
lškduk_ba£
 
	muld
;

287 
mmÚom
 
	mumn
;

288 
mÚ·»n
 
	mump
;

289 
mÚh—d
 
	mumh
;

293 
	smn_´


295 * 
	mid1
, * 
	mid2
;

296 
mn_´
* 
	mmµ
;

297 } 
	tmn_·œ
;

300 * 
¬¿y_¡ash
;

301 
numv¬s
;

302 
¬row
 
Rid—l
;

303 
¬¿y
 
v¬_li¡
;

304 
v¬ŸbË
* 
cu¼’t_ršg
;

307 
¬¿y_š™
();

308 
š™_¬¿y
(
¬¿y
* 
a
, 
–em’t_size
);

309 
ä“_¬¿y
(
¬¿y
* 
a
);

310 
Ëngth
(
¬¿y
* 
a
);

311 *
»f
(
¬¿y
* 
a
, 
i
);

312 *
šs_¬¿y
(
¬¿y
* 
a
);

315 
šlše
 
	$¬¿y_Ëngth
(
¬¿y
* 
a
)

317  
a
->
Ën
;

318 
	}
}

320 
šlše
 
pŞy
 
	$¶i¡_»f
(
¶i¡
* 
¶
, 
i
)

322  *(
pŞy
*)
	`»f
((
¬¿y
*)
¶
, 
i
);

323 
	}
}

325 
šlše
 
	$dli¡_»f
(
dli¡
* 
dl
, 
i
)

327  *(*)
	`»f
((
¬¿y
*)
dl
, 
i
);

328 
	}
}

330 
šlše
 
	$¶i¡_š™
(
¶i¡
* 
¶
)

332 
	`š™_¬¿y
((
¬¿y
*)
¶
, (
pŞy
));

333 
	}
}

335 
šlše
 
	$dli¡_š™
(
dli¡
* 
dl
)

337 
	`š™_¬¿y
((
¬¿y
*)
dl
, ());

338 
	}
}

340 
šlše
 
	$¶i¡_š£¹
(
¶i¡
* 
¶
, 
pŞy
 
f
)

342 *((
pŞy
*)
	`šs_¬¿y
((
¬¿y
*)
¶
)èğ
f
;

343 
	}
}

345 
šlše
 
	$dli¡_š£¹
(
dli¡
* 
dl
, 
i
)

347 *((*)
	`šs_¬¿y
((
¬¿y
*)
dl
)èğ
i
;

348 
	}
}

350 
šlše
 
pŞy
*
	$¶i¡_»f_±r
(
¶i¡
* 
¶
, 
i
)

352  (
pŞy
*)
	`»f
((
¬¿y
*)
¶
, 
i
);

353 
	}
}

355 
šlše
 
	$¶i¡_£t
(
¶i¡
* 
¶
, 
i
, 
pŞy
 
f
)

357 *
	`¶i¡_»f_±r
(
¶
, 
i
èğ
f
;

358 
	}
}

360 
šlše
 
	$dli¡_£t
(
dli¡
* 
dl
, 
i
, 
v®
)

362 *(*)
	`»f
((
¬¿y
*)
dl
, 
i
èğ
v®
;

363 
	}
}

366 
šlše
 
‹rm
 
	$pŞy_š™Ÿl
(
pŞy
 
f
)

368  (
‹rm
)(
f
->
mÚom
);

369 
	}
}

371 
šlše
 
	$pŞy_Ëad_cÛf
(
pŞy
 
f
)

373  
f
->
cÛf
;

374 
	}
}

377 
šlše
 
	$v¬_g‘_št
(
v¬ŸbË
* 
v
)

379  
v
->
štv®
;

380 
	}
}

382 
šlše
 
	$v¬_£t_št
(
v¬ŸbË
* 
v
, 
v®
)

384 
v
->
štv®
 = 
v®
;

385 
	}
}

387 
šlše
 
pŞy
 
	$v¬_g‘_pŞy
(
v¬ŸbË
* 
v
)

389  (
pŞy
)(
v
->
v®ue
);

390 
	}
}

392 
šlše
 
gm©rix
 
	$v¬_g‘_moduË
(
v¬ŸbË
* 
v
)

394  (
gm©rix
)(
v
->
v®ue
);

395 
	}
}

397 
šlše
 
ršg
 
	$v¬_g‘_ršg
(
v¬ŸbË
* 
v
)

399  (
ršg
)(
v
->
v®ue
);

400 
	}
}

402 
šlše
 
v¬ŸbË
*
	$v»f
(
n
)

404  (
v¬ŸbË
*)
	`»f
(&
v¬_li¡
, 
n
);

405 
	}
}

408 
šlše
 
‹rm
 
	$š™Ÿl
(
pŞy
 
f
)

410  (
‹rm
)(
f
->
mÚom
);

411 
	}
}

	@shell.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<£tjmp.h
>

7 
	~"sh¬ed.h
"

8 
	~"sh–l.h
"

9 
	~"cmdÇmes.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"šput.h
"

12 
	~"£t.h
"

13 
	~"mem.h
"

14 
	~"¡ash.h
"

15 
	~"¬¿y.h
"

16 
	~"ršg.h
"

17 
	~"g’”ic.h
"

18 
	~"v¬s.h
"

19 
	~"pŞy.h
"

20 
	~"¡ªd¬d.h
"

21 
	~"dÙ_âs.h
"

22 
	~"mÚoms.h
"

23 
	~"mac.h
"

24 
	~"´štf.h
"

25 
	~"boxcmds.h
"

26 
	~"v”siÚ.h
"

29 
i§‰y
();

30 
f’o
(
FILE
 *);

32 
	gËv–
;

33 
jmp_buf
 
	g’vbuf
;

34 
FILE
 *
	goutfe
;

36 cÚ¡ *
	gg»‘
 = "\n"

50 
	$issub£q
(cÚ¡ *
s
, cÚ¡ *
t
)

52 (*
s
 !ğ'\0'è&& (*
t
 != '\0'))

54 ià(*
s
 > *
t
)

56 ià(*
s
 < *
t
)

58 
s
++;

59 
t
++;

61 ià(*
s
 == '\0')

65 
	}
}

67 #ifdeà
COMMENT


68 
	$cmd_lookup
(*
s
, 
n
)

70 
i
, 
šd
, 
Ën
, 
út
;

71 
cmd_»c
 *
r
;

72 *
t
;

74 
Ën
 = 
	`¡¾’
(
s
);

75 
út
 = 0;

76 
t
 = 
NULL
;

77 
i
 = 0, 
r
 = 
cmd_li¡
; *r->
Çme
 != '\0'; ++i, ++r)

79 ià(
	`¡ºcmp
(
r
->
Çme
, 
s
, 
Ën
) == 0)

81 
šd
 = 
i
;

82 ià(
Ën
 =ğ
	`¡¾’
(
r
->
Çme
))

85 
út
 = 1;

88 ià(
Ën
 >ğ
n
)

91 ++
út
;

93 ià(
út
 > 1)

94 
	`´št
("%s\n", 
t
);

95 
t
 = 
r
->
Çme
;

98 ià(
út
 > 1)

100 
	`´št
("%s\n\n", 
t
);

101 
	`´”rÜ
(";‡mbiguou commªd: %s\n", 
s
);

103 ià(
út
 == 1)

104  
šd
;

105 ià(
út
 > 1)

109 
	}
}

113 
	$m©ch_wÜds
(*
s
, cÚ¡ *
t
)

119 *
p
;

120 cÚ¡ *
q
;

122 ià(*
s
 !ğ*
t
)

124 
p
 = 
s
 + 1, 
q
 = 
t
 + 1; *p != '\0' && *p == *q; ++p, ++q)

126 ià(*
p
 == '\0')

128 ià(*
q
 == '\0')

133 ; *
p
 !ğ'\0' && *
q
 != '\0'; ++p, ++q)

135 *
p
 !ğ*
q
 && *q != '\0')

136 ++
q
;

137 ià(*
q
 == '\0')

140 ià(*
p
 =ğ'\0' && *
q
 == '\0')

144 
	}
}

146 
	$cmd_lookup
(*
s
, 
n
)

148 
i
, 
šd
, 
šd3
, 
út1
, 
út2
, 
út3
, 
m
;

149 
size_t
 
Ën
;

150 
cmd_»c
 *
r
;

152 
Ën
 = 
	`¡¾’
(
s
);

153 
út1
 = 
út2
 = 
út3
 = 0;

154 
šd
 = 
šd3
 = 0;

155 
i
 = 0, 
r
 = 
cmd_li¡
; *r->
Çme
 != '\0'; ++i, ++r)

157 ià((
m
 = 
	`m©ch_wÜds
(
s
, 
r
->
Çme
)) > 0)

159 ià(
m
 == 1)

162 
šd
 = 
i
;

163 
út1
 = 1;

166 ià(
m
 > 0 && 
Ën
 >ğ(
size_t
)
n
)

168 ià(
m
 == 2)

171 
šd
 = 
i
;

172 ++
út2
;

177 
šd3
 = 
i
;

178 ++
út3
;

184 ià(
út1
 =ğ1 || 
út2
 =ğ1 || cÁ2 + 
út3
 == 1)

186 ià(
út1
 + 
út2
 == 0)

187 
šd
 = 
šd3
;

188 ià(
út3
)

189 
	`´št
("%s\n", 
cmd_li¡
[
šd
].
Çme
);

190  
šd
;

192 ià(
út2
 > 1 || 
út3
 > 1)

194 
i
 = 0, 
r
 = 
cmd_li¡
; *r->
Çme
 != '\0'; ++i, ++r)

195 ià(
	`m©ch_wÜds
(
s
, 
r
->
Çme
) > 1)

196 
	`´št
("%s\n", 
r
->
Çme
);

197 
	`´”rÜ
("\n;‡mbiguou commªd: %s\n", 
s
);

202 
	}
}

204 
	$do_š™
()

206 
	`i_£t
();

207 
	`š™_mem
();

208 
	`š™_·th
();

209 
	`i_¡ashes
();

210 
	`¬¿y_š™
();

211 
	`š™_ršgs
();

212 
	`š™_v¬s
();

213 
	`š™_pŞys
();

214 
	`š™_divisiÚ
();

215 
	`š™_dÙ
();

217 
	}
}

219 
	$»£t_cmd
()

221 
	`i_£t
();

222 
	`»£t_mem
();

223 
	`š™_·th
();

224 
	`i_¡ashes
();

225 
	`¬¿y_š™
();

226 
	`š™_ršgs
();

227 
	`š™_v¬s
();

228 
	`š™_pŞys
();

229 
	`š™_divisiÚ
();

230 
	`š™_dÙ
();

232 
	`to_sh–l
();

233 
	}
}

235 
boŞ—n
 
	$doIn™Fe
()

237 
FILE
 *
f
;

239 
f
 = 
	`tİ’
("Macaulay.init", "r");

240 ià(
f
 =ğ
nuÎ±r
)

241  
FALSE
;

242 
	`fşo£
(
f
);

243 
	`İ’_tour
("Macaulay.init");

244  
TRUE
;

245 
	}
}

247 
	$maš
()

249 
	`mem_š™_Úû_Úly
();

250 
	`i_¢iff
();

251 
	`¥ec_š™
();

252 
	`do_š™
();

255 ià(!
	`i§‰y
(
	`f’o
(
¡dš
)))

257 
echo
 = 1;

259 
	`£tbuf
(
¡dout
, 
NULL
);

262 ià(
	`£tjmp
(
’vbuf
))

263 
	`´”rÜ
("; backoheop\n");

265 
Ëv–
 = -1;

266 
	`chªge_Ëv–
();

267 
	`sh–l
();

268 
	`ex™
(0);

270 
	}
}

272 
	$ex™_cmd
(
¬gc
, *
¬gv
[])

274 ()
¬gv
;

275 ià(
¬gc
 > 1)

276 
	`ex™
(0);

279 
Ëv–
--;

280 
	`chªge_Ëv–
();

282 
	}
}

284 
	$cÚtšue_cmd
()

288 ià(
Ëv–
 > 0)

290 
Ëv–
--;

291 
	`chªge_Ëv–
();

293 
	}
}

295 
	$b»ak_cmd
()

297 
	`b»ak_voiû
();

298 
	}
}

300 
	$shout_cmd
(
¬gc
, *
¬gv
[])

302 
i
;

303 
ŞdËv–
;

304 *
p
;

306 ià(
¬gc
 == 1)

308 
	`´šŠew
("shout command‡rg1‡rg2 ...\n");

311 
ŞdËv–
 = 
´Ëv–
;

312 
´Ëv–
 = 0;

314 
p
 = 
¬gv
[1]; *p != '\0'; ++p)

315 ià(*
p
 == '-')

316 *
p
 = '_';

317 
i
 = 
	`cmd_lookup
(
¬gv
[1], 1);

318 ià(
i
 >= 0)

319 (*
cmd_li¡
[
i
].
´oc
)(
¬gc
 - 1, 
¬gv
 + 1);

320 
	`fæush
(
outfe
);

321 
´Ëv–
 = 
ŞdËv–
;

322 
	}
}

324 
	$v”s_cmd
()

326 
	`âewlše
(
outfe
);

327 
	`åršt
(
outfe
, "v”siÚ %s, c»©ed %s\n", 
V”siÚ
, 
D©e
);

328 
	}
}

330 
	$to_sh–l
()

332 
	`lÚgjmp
(
’vbuf
, -1);

333 
	}
}

335 
	$sh–l
()

337 *
ouŠame
, *
p
;

338 
¬gc
;

339 **
¬gv
;

340 
i
, 
thi¦ev–
;

342 
æushnum
 = 0;

343 ià(
Ëv–
 == -1)

345 
Ëv–
 = 0;

346 
	`chªge_Ëv–
();

347 ià(!
	`doIn™Fe
())

348 
	`´št
("%s", 
g»‘
);

349 
	`´št
("MaÿuÏy v”siÚ %s, c»©ed %s\n", 
V”siÚ
, 
D©e
);

350 
	`fæush
(
¡dout
);

354 
Ëv–
++;

355 ià(!
	`chªge_Ëv–
())

357 
	`´”rÜ
("; Sorry,oo many†evels deep. Call first‚extime!\n");

358 
Ëv–
--;

362 
thi¦ev–
 = 
Ëv–
;

363 
thi¦ev–
 =ğ
Ëv–
)

365 
	`g‘_cmd_lše
(&
¬gc
, &
¬gv
, &
ouŠame
);

366 ià(
ouŠame
 =ğ
nuÎ±r
)

367 
outfe
 = 
¡dout
;

370 
outfe
 = 
	`tİ’
(
ouŠame
, "w");

371 ià(
outfe
 =ğ
nuÎ±r
)

373 
	`´”rÜ
("; output file can't be opened\n");

374 
outfe
 = 
¡dout
;

377 
æushnum
 = 0;

378 ià(
š_dÙ_cmd_mode
)

380 
	`rmmou£
();

381 
	`m¬kTime
();

382 
	`dÙ_cmd
(
¬gc
, 
¬gv
);

386 
p
 = 
¬gv
[0]; *p != '\0'; ++p)

387 ià(*
p
 == '-')

388 *
p
 = '_';

389 
i
 = 
	`cmd_lookup
(
¬gv
[0], 1);

390 
	`rmmou£
();

391 
	`m¬kTime
();

392 ià(
i
 >= 0)

393 (*
cmd_li¡
[
i
].
´oc
)(
¬gc
, 
¬gv
);

394 ià(
i
 == -1)

395 
	`´”rÜ
("; commªd‚Ù found: %s\n", 
¬gv
[0]);

397 
	`´Time
("elapsedime : ");

399 ià(
outfe
 !ğ
¡dout
)

400 
	`fşo£
(
outfe
);

401 
	`g¬b_cŞËù
();

403 
	}
}

405 
	$ech_cmd
(
¬gc
, *
¬gv
[])

407 
i
;

409 
i
 = 1; i < 
¬gc
; ++i)

410 
	`åršt
(
outfe
, "% ", 
¬gv
[
i
]);

411 
	`åršt
(
outfe
, "\n");

412 
	}
}

414 
	$şac_cmd
(
¬gc
, *
¬gv
[])

416 
	`Ãwlše
();

417 
	`´št
("calc\n");

418 
	`ÿlc_cmd
(
¬gc
, 
¬gv
);

419 
	}
}

	@shell.h

4 
	~<£tjmp.h
>

7 
Ëv–
;

8 
jmp_buf
 
’vbuf
;

9 
FILE
 *
outfe
;

12 
maš
();

13 
sh–l
();

14 
to_sh–l
();

17 
do_š™
();

18 
»£t_cmd
();

19 
boŞ—n
 
doIn™Fe
();

22 
issub£q
(cÚ¡ *
s
, cÚ¡ *
t
);

23 
m©ch_wÜds
(*
s
, cÚ¡ *
t
);

24 
cmd_lookup
(*
s
, 
n
);

27 
ex™_cmd
(
¬gc
, *
¬gv
[]);

28 
cÚtšue_cmd
();

29 
b»ak_cmd
();

30 
shout_cmd
(
¬gc
, *
¬gv
[]);

31 
v”s_cmd
();

32 
ech_cmd
(
¬gc
, *
¬gv
[]);

33 
şac_cmd
(
¬gc
, *
¬gv
[]);

	@smallterm.c

4 
	~<£tjmp.h
>

5 
	~<lim™s.h
>

6 
	~"sh¬ed.h
"

7 
	~"sm®É”m.h
"

8 
	~"mem.h
"

9 
	~"¡ash.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"sh–l.h
"

12 
	~"£t.h
"

16 
	toff£t
;

19 (*
	t¡ob_func
)();

20 
	$sm®lmÚ
 (*
	tbtos_func
)();

21 
	$sm®lmÚ
 (*
	tmadd_func
)();

23 
symmBlock
 
blockLi¡
;

31 
symmBlock
 
	$fšdBlock
(
n
, * 
degs
)

33 
symmBlock
 
p
 = 
blockLi¡
;

34 
i
;

35 
boŞ—n
 
found
;

37 
p
 !ğ
NULL
)

39 ià(
p
->
deçuÉmax
 =ğ
maxdeg»e
)

41 ià(
n
 =ğ
p
->
nv¬s
)

43 
found
 = 
Œue
;

44 
i
 = 0; i < 
n
; i++)

45 ià(
p
->
degs
[
i
] != degs[i])

47 
found
 = 
çl£
;

50 ià(
found
 =ğ
Œue
)

51  (
p
);

54 
p
 =…->
ÃxtBlock
;

56  (
NULL
);

57 
	}
}

59 
symmBlock
 
	$symmC»©e
(
n
, * 
degs
, ** 
v¬Çmes
)

61 
symmBlock
 
glo
, 
p
;

62 
sm®lmÚ
* 
sÿf
, 
big
, 
x
, 
y
;

63 
sm®lmÚ
** 
cŞs
;

64 
tİ
, 
d
;

65 
i
, 
j
, 
k
;

67 
glo
 = (
symmBlock
)(*)
	`gimmy
((
symblock
));

69 
p
 = 
	`fšdBlock
(
n
, 
degs
);

70 ià(
p
 !ğ
NULL
)

72 *
glo
 = *
p
;

73 
glo
->
Çmes
 = 
v¬Çmes
;

74 
glo
->
deg»e
 = 1;

75  (
glo
);

79 
glo
->
ÃxtBlock
 = 
blockLi¡
;

80 
blockLi¡
 = 
glo
;

82 
glo
->
¹yp
 = 
RSYMM
;

83 
glo
->
nv¬s
 = 
n
;

84 
glo
->
degs
 = degs;

85 
glo
->
Çmes
 = 
v¬Çmes
;

86 
glo
->
deçuÉmax
 = 
maxdeg»e
;

88 
glo
->
n1
 = 
n
 - 1;

89 
glo
->
deg»e
 = 1;

90 
glo
->
w1
 = 
TRUE
;

91 
i
 = 0; i < 
n
; i++)

92 ià(
degs
[
i
] != 1)

93 
glo
->
w1
 = 
FALSE
;

94 ià(
glo
->
w1
)

99 (*
¡ob
)(
symmBlock
, 
sm®lmÚ
, *);

100 (*
g’”ic
)();

101 } 
¡ob_cvt
 = { .
¡ob
 = 
¡ob1
 };

104 
	`sm®lmÚ
 (*
madd
)(
symmBlock
, 
sm®lmÚ
, *);

105 
	`sm®lmÚ
 (*
g’”ic
)();

106 } 
madd_cvt
 = { .
madd
 = 
madd1
 };

107 
glo
->
¡ob
 = 
¡ob_cvt
.
g’”ic
;

108 
glo
->
madd
 = 
madd_cvt
.
g’”ic
;

115 (*
¡ob
)(
symmBlock
, 
sm®lmÚ
, *);

116 (*
g’”ic
)();

117 } 
¡ob_cvt
 = { .
¡ob
 = 
¡ob2
 };

120 
	`sm®lmÚ
 (*
madd
)(
symmBlock
, 
sm®lmÚ
, *);

121 
	`sm®lmÚ
 (*
g’”ic
)();

122 } 
madd_cvt
 = { .
madd
 = 
madd2
 };

123 
glo
->
¡ob
 = 
¡ob_cvt
.
g’”ic
;

124 
glo
->
madd
 = 
madd_cvt
.
g’”ic
;

129 
	`sm®lmÚ
 (*
btos
)(
symmBlock
, *);

130 
	`sm®lmÚ
 (*
g’”ic
)();

131 } 
btos_cvt
 = { .
btos
 = btos };

132 
glo
->
btos
 = 
btos_cvt
.
g’”ic
;

134 
big
 = ~0UL;

135 
tİ
 = 
maxdeg»e
 + 1;

137 
size_t
 
sÿf_size
 = (size_t)
tİ
 * (
sm®lmÚ
);

138 ià(
sÿf_size
 > 
UINT_MAX
)

140 
	`´”rÜ
("; smallterm:‡llocation size overflow\n");

141  
NULL
;

143 
sÿf
 = (
sm®lmÚ
*)(*)
	`gimmy
(()
sÿf_size
);

144 
k
 = 0; k < 
tİ
; ++k)

145 
sÿf
[
k
] = 1;

146 
i
 = 0; i < 
n
; ++i)

148 
d
 = 
degs
[
i
];

149 
j
 = 0; j < 
d
; ++j)

151 
x
 = 
sÿf
[
j
];

152 
k
 = 
j
 + 
d
; k < 
tİ
; k += d)

154 
y
 = 
sÿf
[
k
];

155 ià(
big
 - 
y
 <ğ
x
)

156 
tİ
 = 
k
;

159 
x
 +ğ
y
;

160 
sÿf
[
k
] = 
x
;

165 
glo
->
maxv®
 = 
sÿf
[
tİ
 - 1] - 1;

166 
	`ungimmy
((*)
sÿf
);

167 
glo
->
maxdeg
 = 
tİ
 - 1;

168 
glo
->
ov”
 = 
tİ
;

171 
size_t
 
bË_size
 = (size_t)(1 + 
n
 * 
tİ
è* (
sm®lmÚ
);

172 
size_t
 
cŞs_size
 = (size_t)
n
 * (
sm®lmÚ
*);

173 ià(
bË_size
 > 
UINT_MAX
 || 
cŞs_size
 > UINT_MAX)

175 
	`´”rÜ
("; smallterm:‡llocation size overflow\n");

176  
NULL
;

178 
glo
->
bË
 = (
sm®lmÚ
*)(*)
	`gimmy
(()
bË_size
);

179 
cŞs
 = (
sm®lmÚ
**)(*)
	`gimmy
(()
cŞs_size
);

180 
glo
->
cŞs
 = cols;

181 
i
 = 0; i < 
n
; ++i)

182 
cŞs
[
i
] = 
glo
->
bË
 + i * 
tİ
;

183 
d
 = 
degs
[0];

184 
k
 = 1; k < 
tİ
; ++k)

185 
cŞs
[0][
k
] = 0;

186 
k
 = 0; k < 
tİ
; k +ğ
d
)

187 
cŞs
[0][
k
] = 1;

188 
i
 = 1; i < 
n
; ++i)

190 
d
 = 
degs
[
i
];

191 
j
 = 0; j < 
d
; ++j)

193 
x
 = 
cŞs
[
i
 - 1][
j
];

194 
cŞs
[
i
][
j
] = 
x
;

195 
k
 = 
j
 + 
d
; k < 
tİ
; k += d)

197 
x
 +ğ
cŞs
[
i
 - 1][
k
];

198 
cŞs
[
i
][
k
] = 
x
;

202 
i
 = 0; i < 
n
; ++i)

204 
d
 = 
degs
[
i
 + 1];

205 
j
 = 0; j < 
d
; ++j)

207 
x
 = 0;

208 
k
 = 
j
; k < 
tİ
; k +ğ
d
)

210 
y
 = 
cŞs
[
i
][
k
];

211 
cŞs
[
i
][
k
] = 
x
;

212 
x
 +ğ
y
;

216 
cŞs
[
n
 - 1][
tİ
] = 
big
;

217  (
glo
);

218 
	}
}

220 
	$´SymmBlock
(
symmBlock
 
symm
)

222 
i
, 
j
;

224 
	`´št
("\nsymm block:\n");

225 
	`´št
("#v¬ ğ%d, w1=%d, maxdeg=%d, ov”=%d,‚1=%d, deg»e=%d\n", 
symm
->
nv¬s
, symm->
w1
,

226 
symm
->
maxdeg
, symm->
ov”
, symm->
n1
, symm->
deg»e
);

227 
	`´št
("degrees = ");

228 
i
 = 0; i <ğ
symm
->
nv¬s
; i++)

229 
	`´št
("%d ", 
symm
->
degs
[
i
]);

230 
	`´št
("\n");

232 
i
 = 0; i < 
symm
->
nv¬s
; i++)

234 
j
 = 0; j <ğ
symm
->
maxdeg
; j++)

235 
	`´št
("%lu ", 
symm
->
cŞs
[
i
][
j
]);

236 
	`´št
("\n");

238 
	`´št
("maxv® = %lu\n", 
symm
->
maxv®
);

239 
	}
}

241 
sm®lmÚ
 
	$btos
(
symmBlock
 
glo
, * 
exp
)

243 
sm®lmÚ
 
v
, ** 
t
;

244 
i
, * 
e
;

245 
off£t
 
n1
;

247 
v
 = 0;

248 
e
 = 
exp
;

249 
t
 = 
glo
->
cŞs
;

250 
n1
 = 
glo
->n1;

251 ià(
e
[
n1
] > 
glo
->
maxdeg
)

253 
	`´”rÜ
("; degree boundƒxceeded in monomial operation\n");

254 
	`to_sh–l
();

256 
i
 = 0; i <ğ
n1
; ++i)

257 
v
 +ğ(*
t
++)[*
e
++];

258  
v
;

259 
	}
}

261 
	$¡ob1
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
)

263 
d
, 
i
, 
ov
, * 
e
;

264 
sm®lmÚ
 
v
, * 
t
;

266 
v
 = 
v®
;

267 
	`debug_as£¹
("sm®lmÚ.ø¡ob1: v®uexûed maxv®", 
v
 <ğ
glo
->
maxv®
);

268 
d
 = 
glo
->
deg»e
;

269 
i
 = 
glo
->
n1
;

270 
ov
 = 
glo
->
ov”
;

271 
e
 = 
exp
 + 
i
;

272 
t
 = 
glo
->
cŞs
[
i
] + 
d
;

273 ià(*
t
 <ğ
v
)

276 ++
d
, ++
t
;

277 *
t
 <ğ
v
);

278 
glo
->
deg»e
 = 
d
;

279 --
d
, --
t
;

281 ià(--
d
, *--
t
 > 
v
)

284 --
d
, --
t
;

285 *
t
 > 
v
);

286 
glo
->
deg»e
 = 
d
 + 1;

288 
v
 -ğ*
t
;

289 *
e
-- = 
d
;

290 ià(
i
 != 0)

293 
t
 -ğ
ov
;

294 ià(*
t
 > 
v
)

296 --
d
, --
t
;

297 *
t
 > 
v
);

298 
v
 -ğ*
t
;

299 *
e
-- = 
d
;

300 } --
i
 != 0);

301 
	}
}

303 
sm®lmÚ
 
	$madd1
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
)

305 
d
, 
i
, * 
e
;

306 
sm®lmÚ
 
v
, 
s
, * 
t
;

308 
v
 = 
v®
;

309 
	`debug_as£¹
("sm®lmÚ.ømadd1: v®uexûed maxv®", 
v
 <ğ
glo
->
maxv®
);

310 
d
 = 
glo
->
deg»e
;

311 
s
 = 0;

312 
i
 = 
glo
->
n1
;

313 
e
 = 
exp
 + 
i
;

314 
t
 = 
glo
->
cŞs
[
i
] + 
d
;

315 ià(*
t
 <ğ
v
)

318 ++
d
, ++
t
;

319 *
t
 <ğ
v
);

320 
glo
->
deg»e
 = 
d
;

321 --
d
, --
t
;

323 ià(--
d
, *--
t
 > 
v
)

326 --
d
, --
t
;

327 *
t
 > 
v
);

328 
glo
->
deg»e
 = 
d
 + 1;

330 ià(
d
 + *
e
 > 
glo
->
maxdeg
)

332 
	`´”rÜ
("; degree boundƒxceeded in monomial operation\n");

333 
	`to_sh–l
();

335 
v
 -ğ*
t
;

336 
s
 +ğ
t
[*
e
--];

337 ià(
i
 != 0)

340 
t
 -ğ
glo
->
ov”
;

341 ià(*
t
 > 
v
)

343 --
d
, --
t
;

344 *
t
 > 
v
);

345 
v
 -ğ*
t
;

346 
s
 +ğ
t
[*
e
--];

347 } --
i
 != 0);

348  
s
;

349 
	}
}

351 
	$¡ob2
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
)

353 
d
, * 
dg
, * 
e
;

354 
sm®lmÚ
 
v
, * 
t
;

355 
i
;

357 
v
 = 
v®
;

358 
	`debug_as£¹
("sm®lmÚ.ø¡ob2: v®uexûed maxv®", 
v
 <ğ
glo
->
maxv®
);

359 
d
 = 
glo
->
deg»e
;

361 
off£t
 
n1
 = 
glo
->n1;

362 
dg
 = 
glo
->
degs
 + 
n1
;

363 
e
 = 
exp
 + 
n1
;

364 
t
 = 
glo
->
cŞs
[
n1
] + 
d
;

365 
i
 = ()
n1
;

367 ià(*
t
 <ğ
v
)

370 ++
d
, ++
t
;

371 *
t
 <ğ
v
);

372 
glo
->
deg»e
 = 
d
;

373 --
d
, --
t
;

375 ià(--
d
, *--
t
 > 
v
)

378 --
d
, --
t
;

379 *
t
 > 
v
);

380 
glo
->
deg»e
 = 
d
 + 1;

382 
v
 -ğ*
t
;

383 *
e
-- = 
d
;

384 ià(
i
 != 0)

387 
t
 -ğ
glo
->
ov”
;

388 ià(*
t
 > 
v
)

390 
up
 = *
dg
;

392 
d
 -ğ
up
, 
t
 -= up;

393 *
t
 > 
v
);

395 
v
 -ğ*
t
;

396 *
e
-- = 
d
;

397 --
dg
;

398 } --
i
 != 0);

399 
	}
}

401 
sm®lmÚ
 
	$madd2
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
)

403 
d
, * 
dg
, * 
e
;

404 
sm®lmÚ
 
v
, * 
t
;

405 
sm®lmÚ
 
s
;

406 
i
;

408 
v
 = 
v®
;

409 
	`debug_as£¹
("sm®lmÚ.ømadd2: v®uexûed maxv®", 
v
 <ğ
glo
->
maxv®
);

410 
d
 = 
glo
->
deg»e
;

411 
s
 = 0;

413 
off£t
 
n1
 = 
glo
->n1;

414 
dg
 = 
glo
->
degs
 + 
n1
;

415 
e
 = 
exp
 + 
n1
;

416 
t
 = 
glo
->
cŞs
[
n1
] + 
d
;

417 
i
 = ()
n1
;

419 ià(*
t
 <ğ
v
)

422 ++
d
, ++
t
;

423 *
t
 <ğ
v
);

424 
glo
->
deg»e
 = 
d
;

425 --
d
, --
t
;

427 ià(--
d
, *--
t
 > 
v
)

430 --
d
, --
t
;

431 *
t
 > 
v
);

432 
glo
->
deg»e
 = 
d
 + 1;

434 ià(
d
 + *
e
 > 
glo
->
maxdeg
)

436 
	`´”rÜ
("; degree boundƒxceeded in monomial operation\n");

437 
	`to_sh–l
();

439 
v
 -ğ*
t
;

440 
s
 +ğ
t
[*
e
--];

441 ià(
i
 != 0)

444 
t
 -ğ
glo
->
ov”
;

445 ià(*
t
 > 
v
)

447 
up
 = *
dg
;

449 
d
 -ğ
up
, 
t
 -= up;

450 *
t
 > 
v
);

452 
v
 -ğ*
t
;

453 
s
 +ğ
t
[*
e
--];

454 --
dg
;

455 } --
i
 != 0);

456  
s
;

457 
	}
}

	@smallterm.h

5 
symmBlock
 
blockLi¡
;

8 
symmBlock
 
fšdBlock
(
n
, * 
degs
);

9 
symmBlock
 
symmC»©e
(
n
, * 
degs
, ** 
v¬Çmes
);

10 
´SymmBlock
(
symmBlock
 
symm
);

11 
sm®lmÚ
 
btos
(
symmBlock
 
glo
, * 
exp
);

12 
¡ob1
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
);

13 
sm®lmÚ
 
madd1
(
symmBlock
 
glo
, sm®lmÚ 
v®
, * 
exp
);

14 
¡ob2
(
symmBlock
 
glo
, 
sm®lmÚ
 
v®
, * 
exp
);

15 
sm®lmÚ
 
madd2
(
symmBlock
 
glo
, sm®lmÚ 
v®
, * 
exp
);

	@spcmds.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~"sh¬ed.h
"

7 
	~"¥cmds.h
"

8 
	~"¬¿y.h
"

9 
	~"cmds.h
"

10 
	~"v¬s.h
"

11 
	~"g’”ic.h
"

12 
	~"gm_pŞy.h
"

13 
	~"gm©rix.h
"

14 
	~"šput.h
"

15 
	~"mÚ™Ü.h
"

16 
	~"pŞy.h
"

17 
	~"qršg.h
"

18 
	~"ršg.h
"

19 
	~"‹rm.h
"

20 
	~"¶i¡.h
"

21 
	~<£tjmp.h
>

22 
	~"rv¬.h
"

23 
	~"¡dcmds.h
"

24 
	~"ch¬p.h
"

30 
boŞ—n
 
	$mÚeq
(
ex±”m
 
exp
, 
‹rm
 
t
,ƒx±”m 
v¬s
)

34 
i
;

35 
ex±”m
 
exp2
;

37 
	`sToExp
(
t
, 
exp2
);

38 
i
 = 0; i < 
numv¬s
; i++)

40 ià(
v¬s
[
i
] == 0)

42 ià(
exp
[
i
] !ğ
exp2
[i])

43  (
çl£
);

45 
exp2
[
i
] = 0;

47 
	`expToS
(
exp2
, 
	`tm_compÚ’t
(
t
),);

48  (
Œue
);

49 
	}
}

51 
pŞy
 
	$¡r_pŞy
(
pŞy
 *
f
, 
ex±”m
 
v¬s
,…Şy *
hmÚom
)

53 
i
;

54 
pŞy
 
»suÉ
, 
‹mp
;

55 
ex±”m
 
exp
;

56 
pŞy
 
š»suÉ
;

58 
pŞ
 
dummy_h—d
;

60 ià(*
f
 =ğ
NULL
)

61  (
NULL
);

62 
š»suÉ
 = &
dummy_h—d
;

63 
š»suÉ
->
Ãxt
 = *
f
;

64 
	`sToExp
(
	`pŞy_š™Ÿl
(*
f
), 
exp
);

65 
»suÉ
 = 
NULL
;

67 
i
 = 0; i < 
numv¬s
; i++)

68 ià(
v¬s
[
i
] == 0)

69 
exp
[
i
] = 0;

70 *
hmÚom
 = 
	`p_mÚom
(
fd_Úe
);

71 
	`expToS
(
exp
, 1, 
	`pŞy_š™Ÿl
(*
hmÚom
));

73 
š»suÉ
->
Ãxt
 !ğ
NULL
)

74 ià(
	`mÚeq
(
exp
, 
	`pŞy_š™Ÿl
(
š»suÉ
->
Ãxt
), 
v¬s
))

76 
‹mp
 = 
š»suÉ
->
Ãxt
;

77 
š»suÉ
->
Ãxt
 = 
‹mp
->next;

78 
‹mp
->
Ãxt
 = 
NULL
;

79 
	`p_add
(&
»suÉ
, &
‹mp
);

82 
š»suÉ
 = iÄesuÉ->
Ãxt
;

83 *
f
 = 
dummy_h—d
.
Ãxt
;

84  (
»suÉ
);

85 
	}
}

87 
	$gm_cÛf
(
gm©rix
 
M
, 
ex±”m
 
v¬s
, gm©rix *
MmÚoms
, gm©rix *
McÛfs
)

89 
pŞy
 
f
, 
g
, 
hmÚom
;

90 
j
;

92 *
MmÚoms
 = 
	`mod_š™
();

93 
	`dli¡_š£¹
(&(*
MmÚoms
)->
deg»es
, 0);

94 *
McÛfs
 = 
	`mod_š™
();

95 
	`dl_cİy
(&(
M
->
deg»es
), &((*
McÛfs
)->degrees));

96 
j
 = 1; j <ğ
	`Ëngth
(&(
M
->
g’s
)); j++)

98 
f
 = 
	`p_cİy
(
	`¶i¡_»f
(&
M
->
g’s
, 
j
));

99 
f
 !ğ
NULL
)

101 
g
 = 
	`¡r_pŞy
(&
f
, 
v¬s
, &
hmÚom
);

102 
	`gmIn£¹
(*
MmÚoms
, 
hmÚom
);

103 
	`gmIn£¹
(*
McÛfs
, 
g
);

106 
	}
}

108 
	$cÛf_cmd
(
¬gc
, *
¬gv
[])

110 
gm©rix
 
M
;

111 
gm©rix
 
MmÚoms
, 
McÛfs
;

112 
v¬ŸbË
 *
p
, *
q
;

113 
ex±”m
 
v¬s
;

115 ià(
¬gc
 <= 3)

117 
	`´šŠew
("coef <matrix> <result monoms> <result coefs> [variable†ist]\n");

120 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

122 
p
 = 
	`make_v¬
(
¬gv
[2], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

123 ià(
p
 =ğ
NULL
)

125 
q
 = 
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

126 ià(
q
 =ğ
NULL
)

128 ià(!
	`g‘V¬Li¡
(
¬gc
 - 4, (cÚ¡ **)(*)(
¬gv
 + 4), 
v¬s
))

130 
	`gm_cÛf
(
M
, 
v¬s
, &
MmÚoms
, &
McÛfs
);

131 
	`£t_v®ue
(
p
, 
MmÚoms
);

132 
	`£t_v®ue
(
q
, 
McÛfs
);

133 
	}
}

135 
pŞy
 
	$p_homog
(
gm©rix
 
M
, 
pŞy
 
f
, 
v
)

137 
pŞy
 
g
, 
h
, 
‹mp
, 
»suÉ
;

138 
d
, 
maxd
, 
a
;

139 
ex±”m
 
exp
;

140 
®loù”m
 
t
;

142 ià(
f
 =ğ
NULL
)

143  (
NULL
);

144 
g
 = 
f
;

145 
maxd
 = 
	`deg»e
(
M
, 
g
);

146 
g
 !ğ
NULL
)

148 
d
 = 
	`deg»e
(
M
, 
g
);

149 ià(
d
 > 
maxd
)

150 
maxd
 = 
d
;

151 
g
 = g->
Ãxt
;

154 
g
 = 
f
;

155 
»suÉ
 = 
NULL
;

156 
g
 !ğ
NULL
)

158 
d
 = 
maxd
 - 
	`deg»e
(
M
, 
g
);

160 
a
 = 0;‡ < 
numv¬s
;‡++)

161 
exp
[
a
] = 0;

162 
exp
[
v
] = 
d
;

163 
	`expToS
(
exp
, 1, 
t
);

164 
‹mp
 = 
g
;

165 
g
 = g->
Ãxt
;

166 
‹mp
->
Ãxt
 = 
NULL
;

167 
h
 = 
	`p1_muÉ
(
fd_Úe
, 
t
, 
‹mp
);

168 
‹mp
->
Ãxt
 = 
g
;

169 
	`p_add
(&
»suÉ
, &
h
);

171 
	`qrgReduû
(&
»suÉ
);

172  (
»suÉ
);

173 
	}
}

175 
gm©rix
 
	$gm_homog
(
gm©rix
 
M
, 
v
)

177 
gm©rix
 
N
;

178 
j
;

179 
pŞy
 
f
, 
g
;

181 
N
 = 
	`mod_š™
();

182 
	`dl_cİy
(&(
M
->
deg»es
), &(
N
->degrees));

183 
j
 = 1; j <ğ
	`Ëngth
(&(
M
->
g’s
)); j++)

185 
f
 = 
	`¶i¡_»f
(&
M
->
g’s
, 
j
);

186 ià(
f
 =ğ
NULL
)

188 
g
 = 
	`p_homog
(
M
, 
f
, 
v
);

189 
	`gmIn£¹
(
N
, 
g
);

190 
	`dli¡_š£¹
(&(
N
->
degg’s
), 
	`deg»e
(N, 
g
));

192  (
N
);

193 
	}
}

195 
	$homog_cmd
(
¬gc
, *
¬gv
[])

197 
gm©rix
 
M
;

198 
v¬ŸbË
 *
p
;

199 
v
;

201 ià(
¬gc
 != 4)

203 
	`´šŠew
("homog <matrix> <homog variable> <new matrix>\n");

206 ià((
M
 = 
	`vg‘_mod
(
¬gv
[1])è=ğ
NULL
)

208 
v
 = 
	`g‘V¬
(
¬gv
[2]);

209 ià(
v
 == -1)

211 
	`´”rÜ
("; v¬ % nÙ defšed\n", 
¬gv
[2]);

214 
p
 = 
	`make_v¬
(
¬gv
[3], 
MAINVAR
, 
VMODULE
, 
cu¼’t_ršg
);

215 ià(
p
 =ğ
NULL
)

217 
	`£t_v®ue
(
p
, 
	`gm_homog
(
M
, 
v
));

218 
	}
}

	@spcmds.h

7 
boŞ—n
 
mÚeq
(
ex±”m
 
exp
, 
‹rm
 
t
,ƒx±”m 
v¬s
);

8 
pŞy
 
¡r_pŞy
ÕŞy* 
f
, 
ex±”m
 
v¬s
,…Şy* 
hmÚom
);

9 
gm_cÛf
(
gm©rix
 
M
, 
ex±”m
 
v¬s
, gm©rix* 
MmÚoms
, gm©rix* 
McÛfs
);

12 
pŞy
 
p_homog
(
gm©rix
 
M
,…Şy 
f
, 
v
);

13 
gm©rix
 
gm_homog
(gm©rix 
M
, 
v
);

16 
cÛf_cmd
(
¬gc
, * 
¬gv
[]);

17 
homog_cmd
(
¬gc
, * 
¬gv
[]);

	@standard.c

4 
	~<¡dio.h
>

5 
	~"sh¬ed.h
"

6 
	~"¡ªd¬d.h
"

7 
	~"pŞy.h
"

8 
	~"‹rm.h
"

9 
	~"mÚoms.h
"

10 
	~"¶i¡.h
"

11 
	~"mÚ™Ü.h
"

12 
	~"sh–l.h
"

13 
	~"¡ash.h
"

14 
	~"gm©rix.h
"

15 
	~"ch¬p.h
"

16 
	~"v¬s.h
"

17 
	~"¬¿y.h
"

18 
	~"humª_io.h
"

19 
	~"mac.h
"

20 
	~"b‘ti.h
"

21 
	~"£t.h
"

22 
	~"mem.h
"

23 
	~"ršg.h
"

24 
	~"¡©s.h
"

26 
pŞy
 
	gdivnode
;

29 
šlše
 
‹rm
 
	$INITIAL
(
pŞy
 
f
)

31  (
‹rm
)(
f
->
mÚom
);

32 
	}
}

34 
šlše
 
f›ld
 
	$LEAD_COEF
(
pŞy
 
g
)

36  
g
->
cÛf
;

37 
	}
}

39 
šlše
 
	$LENGTH
(
¬¿y
 
a
)

41  
	`Ëngth
(&
a
);

42 
	}
}

44 
šlše
 
gm©rix
 
	$VAR_MODULE
(
v¬ŸbË
 *
p
)

46  (
gm©rix
)(
p
->
v®ue
);

47 
	}
}

49 
šlše
 
pŞy
 
	$PREF
(
¶i¡
 
¶
, 
i
)

51  
	`¶i¡_»f
(&
¶
, 
i
);

52 
	}
}

54 
šlše
 
	$DREF
(
dli¡
 
dl
, 
i
)

56  
	`dli¡_»f
(&
dl
, 
i
);

57 
	}
}

59 
šlše
 
	$¶_š£¹
(
¶i¡
 *
¶
, 
pŞy
 
f
)

61 
	`¶i¡_š£¹
(
¶
, 
f
);

62 
	}
}

64 
šlše
 
	$dl_š£¹
(
dli¡
 *
dl
, 
i
)

66 
	`dli¡_š£¹
(
dl
, 
i
);

67 
	}
}

70 
šlše
 
	$£nd_pŞy
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

73 ()
box
;

74 ()
f
;

75 ()
deg
;

76 
	}
}

79 #ifdeà
STATISTICS


80 
šlše
 
	$STAT
(*
x
)

82 (*
x
)++;

83 
	}
}

86 
šlše
 
	$STAT
(*
x
)

88 ()
x
;

89 
	}
}

93 
	$š™_divisiÚ
()

95 
divnode
 = 
	`p_li¡h—d
();

96 
	}
}

98 
	$deb_´št
(
pŞy
 
f
, 
n
)

100 
i
;

102 
	`´št
("[");

103 
i
 = 1; i < 
n
; i++)

105 
	`p_µršt
(
¡dout
, 
f
, 
i
);

106 
	`´št
(", ");

108 
	`p_µršt
(
¡dout
, 
f
, 
n
);

109 
	`´št
("]\n");

110 
	}
}

112 
pŞy
 
	$»duû
(
gm©rix
 
M
, 
pŞy
 *
f
)

114 
mn_¡ªd¬d
 
i
;

115 
®loù”m
 
t
;

116 
pŞy
 
š»suÉ
;

118 
š»suÉ
 = 
divnode
;

119 *
f
 !ğ
NULL
)

121 ià(
	`mo_fšd_div
(
M
, 
	`INITIAL
(*
f
), (**)&
i
, 
t
))

123 
	`div_sub
(
f
, 
	`LEAD_COEF
(*f), 
t
, 
i
->
¡ªd¬d
);

125 ià(
autoReduû
 <= 0)

127 
š»suÉ
->
Ãxt
 = *
f
;

128 
š»suÉ
 = *
f
;

129 *
f
 = (*f)->
Ãxt
;

133 
š»suÉ
->
Ãxt
 = *
f
;

134  
divnode
->
Ãxt
;

137 
š»suÉ
->
Ãxt
 = 
NULL
;

138  
divnode
->
Ãxt
;

139 
	}
}

141 
	$divisiÚ
(
gm©rix
 
M
, 
pŞy
 *
f
,…Şy *
g
,…Şy *
h
)

143 
pŞy
 
š»suÉ
;

144 
mn_¡ªd¬d
 
i
;

145 
®loù”m
 
t
;

147 
	`STAT
(&
¡div
);

148 *
g
 = 
NULL
;

149 
š»suÉ
 = 
divnode
;

150 *
f
 !ğ
NULL
)

152 
	`STAT
(&
¡loİ
);

153 ià(
	`mo_fšd_div
(
M
, 
	`INITIAL
(*
f
), (**)&
i
, 
t
))

155 
	`div_sub
(
g
, 
	`LEAD_COEF
(*
f
), 
t
, 
i
->
chªge
);

156 
	`div_sub
(
f
, 
	`LEAD_COEF
(*f), 
t
, 
i
->
¡ªd¬d
);

158 ià(
autoReduû
 <= 0)

160 
š»suÉ
->
Ãxt
 = *
f
;

161 
š»suÉ
 = *
f
;

162 *
f
 = (*f)->
Ãxt
;

166 
š»suÉ
->
Ãxt
 = *
f
;

167 *
f
 = 
NULL
;

168 *
h
 = 
divnode
->
Ãxt
;

172 
š»suÉ
->
Ãxt
 = 
NULL
;

173 *
h
 = 
divnode
->
Ãxt
;

174 
	}
}

178 
boŞ—n
 
	$ÿlc_¡ªd¬d
(
gm©rix
 
M
, 
deg
, 
v¬ŸbË
 *
B
)

180 
mn_¡ªd¬d
 
i
, 
j
;

181 
pŞy
 
h
, 
h»p
;

183 ià(
	`ncŞs
(
M
) > 0)

185 
	`´æush
(".");

186 ià(
show·œs
 > 0)

187 
	`¥aœs_æush
(
M
);

189 
	`mo_»£t
(
M
, (**)&
i
, (**)&
j
);

190 
	`mo_Ãxt_·œ
(
M
, 
deg
, (**)&
i
, (**)&
j
))

192 
	`ÿlc_s_·œ
(
M
, 
i
, 
j
, &
h
, &
h»p
);

193 
	`£nd_off
(
M
, 
deg
, 
B
, 
h
, 
h»p
);

195  
	`mo_iscom¶‘e
(
M
, 
deg
);

196 
	}
}

198 
	$£nd_off
(
gm©rix
 
M
, 
deg
, 
v¬ŸbË
 *
B
, 
pŞy
 
h
,…Şy 
h»p
)

200 ià(
show­aœ
)

202 
	`¥aœs_æush
(
M
);

203 
show­aœ
 = 0;

205 ià(
h
 !ğ
NULL
)

207 
	`šs_–em
(
M
, 
deg
, 
h
, 
h»p
);

208 ià(
v”bo£
 > 0)

210 
	`´æush
("m");

211 ià(
show·œs
 > 2)

212 
	`¥aœs_æush
(
M
);

215 ià(
h»p
 !ğ
NULL
)

217 
	`£nd_pŞy
(
B
, 
h»p
, 
deg
);

218 ià(
v”bo£
 > 0)

220 
	`´æush
("s");

221 ià(
show·œs
 > 3)

222 
	`¥aœs_æush
(
M
);

225 ià(
v”bo£
 > 0)

227 
	`´æush
("o");

228 ià(
show·œs
 > 3)

229 
	`¥aœs_æush
(
M
);

231 
	`šŒ_sh–l
();

232 
	}
}

234 
	$ÿlc_s_·œ
(
gm©rix
 
M
, 
mn_¡ªd¬d
 
i
, mn_¡ªd¬d 
j
, 
pŞy
 *
h
,…Şy *
h»p
)

236 
®loù”m
 
s1
, 
s2
;

237 
pŞy
 
f
, 
k
;

239 
	`tm_jošmšus
(
	`INITIAL
(
i
->
¡ªd¬d
), INITIAL(
j
->¡ªd¬d), 
s1
, 
s2
);

240 
f
 = 
	`muÉ_sub
(
s1
, 
i
->
¡ªd¬d
, 
s2
, 
j
->standard);

241 
k
 = 
	`muÉ_sub
(
s1
, 
i
->
chªge
, 
s2
, 
j
->change);

242 
	`divisiÚ
(
M
, &
f
, 
h»p
, 
h
);

243 
	`p_add
(
h»p
, &
k
);

244 
	}
}

246 
	$šs_–em
(
gm©rix
 
M
, 
deg
, 
pŞy
 
h
,…Şy 
h»p
)

248 
mn_¡ªd¬d
 
i
;

250 
	`make2_mÚic
(&
h
, &
h»p
);

251 
i
 = (
mn_¡ªd¬d
)(*)
	`g‘_¦ug
((
¡ash
 *)
¡d_¡ash
);

252 
i
->
¡ªd¬d
 = 
h
;

253 
i
->
chªge
 = 
h»p
;

254 
i
->
Ãxt
 = 
M
->
¡dbasis
;

255 
i
->
ismš
 = 
TRUE
;

256 
i
->
deg»e
 = 
deg
;

257 
M
->
¡dbasis
 = 
i
;

258 
M
->
n¡ªd¬d
++;

259 
M
->
modty³
 = 
MSTD
;

260 
	`mo_š£¹
(
M
, 
	`INITIAL
(
h
), (*)
i
);

261 ià(
autoReduû
 <= 0)

262 
	`auto_»duû
(
M
, 
deg
, 
h
, 
h»p
);

263 
	}
}

265 
	$auto_»duû
(
gm©rix
 
M
, 
deg
, 
pŞy
 
h
,…Şy 
h»p
)

267 
mn_¡ªd¬d
 
i
;

268 
f›ld
 
a
;

272 
i
 = 
M
->
¡dbasis
->
Ãxt
;

273 (
i
 !ğ
NULL
è&& (i->
deg»e
 =ğ
deg
))

275 ià(
	`occurs_š
(
i
->
¡ªd¬d
, 
	`INITIAL
(
h
), &
a
))

277 ià(
v”bo£
 > 0)

278 
	`´æush
("a");

279 
	`auto_sub
(&
i
->
¡ªd¬d
, 
a
, 
h
);

280 
	`auto_sub
(&
i
->
chªge
, 
a
, 
h»p
);

282 
i
 = i->
Ãxt
;

284 
	}
}

286 
boŞ—n
 
	$occurs_š
(
pŞy
 
f
, 
‹rm
 
t
, 
f›ld
 *
a
)

288 
comp
;

290 
f
 !ğ
NULL
)

292 
comp
 = 
	`tm_com·»
(
	`INITIAL
(
f
), 
t
);

293 ià(
comp
 =ğ
LT
)

294  
FALSE
;

295 ià(
comp
 =ğ
EQ
)

297 *
a
 = 
	`LEAD_COEF
(
f
);

298  
TRUE
;

300 
f
 = f->
Ãxt
;

302  
FALSE
;

303 
	}
}

305 
	$Üig_g’s
(
gm©rix
 
M
, 
deg
, 
štv®
, 
v¬ŸbË
 *
box
)

307 
i
;

308 
pŞy
 
f
, 
h
, 
h»p
, 
k
;

310 
i
 = 1; i <ğ
	`LENGTH
(
M
->
g’s
); i++)

311 ià(
	`DREF
(
M
->
degg’s
, 
i
è=ğ
deg
)

313 
f
 = 
	`p_cİy
(
	`PREF
(
M
->
g’s
, 
i
));

314 
	`divisiÚ
(
M
, &
f
, &
h»p
, &
h
);

315 ià((
štv®
 < 0è|| (štv® >ğ
i
))

317 
k
 = 
	`e_sub_i
(
i
);

318 
	`p_add
(&
h»p
, &
k
);

320 
	`£nd_off
(
M
, 
deg
, 
box
, 
h
, 
h»p
);

322 
	}
}

324 
	$šs_g’”©Ü
(
v¬ŸbË
 *
box
, 
pŞy
 
f
, 
deg
)

326 
pŞy
 
h
, 
h»p
;

327 
i
;

328 
gm©rix
 
M
;

330 
M
 = 
	`VAR_MODULE
(
box
);

331 
h
 = 
	`»duû
(
M
, &
f
);

333 ià(
h
 =ğ
NULL
)

335 
	`make1_mÚic
(&
h
);

336 
	`¶_š£¹
(&(
M
->
g’s
), 
h
);

337 
i
 = 
	`LENGTH
(
M
->
g’s
);

338 
	`dl_š£¹
(&(
M
->
degg’s
), 
deg
);

339 
h
 = 
	`p_cİy
(h);

340 ià((
box
->
štv®
 < 0è|| (box->štv® >ğ
i
))

341 
h»p
 = 
	`e_sub_i
(
i
);

343 
h»p
 = 
NULL
;

344 
	`šs_–em
(
M
, 
deg
, 
h
, 
h»p
);

345 
	}
}

350 
šlše
 
pŞy
 
	$®loc_pŞy_node
()

352 
pŞy
 
p
 = (pŞy)(*)
	`g‘_¦ug
((
¡ash
 *)
pSsh
);

354 
size_t
 
off£t
 = (
pŞ
);

355 
off£t
 = (offset + () - 1) & ~(() - 1);

356 
p
->
mÚom
 = (*í + 
off£t
;

357  
p
;

358 
	}
}

361 
šlše
 
boŞ
 
	$check_h_nuÎ
(
pŞy
 
h
,…Şy 
f
,…Şy 
š»suÉ
,…Şy *
f1
)

363 ià(
h
 =ğ
NULL
)

365 
š»suÉ
->
Ãxt
 = 
f
;

366 *
f1
 = 
addnode
->
Ãxt
;

367  
Œue
;

369  
çl£
;

370 
	}
}

373 
šlše
 
	$´oûss_f_nuÎ
(
pŞy
 *
f
,…Şy *
h
,…Şy *
š»suÉ
,…Şy *
Ãxth
, 
f›ld
 
a
,

374 
big‹rm
 
big
, 
pŞy
 *
f1
)

376 ià(*
f
 =ğ
NULL
)

378 
Œue
)

380 (*
Ãxth
)->
cÛf
 = 
	`nÜm®ize
(-()
a
 * ()(*
h
)->coef);

381 (*
š»suÉ
)->
Ãxt
 = *
Ãxth
;

382 *
š»suÉ
 = *
Ãxth
;

383 *
h
 = (*h)->
Ãxt
;

385 ià(
	`check_h_nuÎ
(*
h
, *
f
, *
š»suÉ
, 
f1
))

388 *
Ãxth
 = 
	`®loc_pŞy_node
();

389 
	`tm_add
(
	`INITIAL
(*
h
), 
big
, INITIAL(*
Ãxth
));

392 
	}
}

400 
	$div_sub
(
pŞy
 *
f1
, 
f›ld
 
a
, 
‹rm
 
t
,…Şy 
h1
)

402 
pŞy
 
š»suÉ
 = 
addnode
;

403 
pŞy
 
f
 = *
f1
;

404 
pŞy
 
h
 = 
h1
;

405 
pŞy
 
Ãxth
;

406 
pŞy
 
‹mp
;

407 
big‹rm
 
big
;

409 
	`sToBig
(
t
, 
big
);

412 ià(
	`check_h_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

416 
Ãxth
 = 
	`®loc_pŞy_node
();

417 
	`tm_add
(
	`INITIAL
(
h
), 
big
, INITIAL(
Ãxth
));

420 
	`´oûss_f_nuÎ
(&
f
, &
h
, &
š»suÉ
, &
Ãxth
, 
a
, 
big
, 
f1
);

421 ià(
f
 =ğ
NULL
)

424 
Œue
)

426 
	`tm_com·»
(
	`INITIAL
(
f
), INITIAL(
Ãxth
)))

428 
GT
:

429 
š»suÉ
->
Ãxt
 = 
f
;

430 
š»suÉ
 = 
f
;

431 
f
 = f->
Ãxt
;

432 
	`´oûss_f_nuÎ
(&
f
, &
h
, &
š»suÉ
, &
Ãxth
, 
a
, 
big
, 
f1
);

433 ià(
f
 =ğ
NULL
)

436 
LT
:

437 
Ãxth
->
cÛf
 = 
	`nÜm®ize
(-()
a
 * ()
h
->coef);

438 
š»suÉ
->
Ãxt
 = 
Ãxth
;

439 
š»suÉ
 = 
Ãxth
;

440 
h
 = h->
Ãxt
;

441 ià(
	`check_h_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

443 
Ãxth
 = 
	`®loc_pŞy_node
();

444 
	`tm_add
(
	`INITIAL
(
h
), 
big
, INITIAL(
Ãxth
));

446 
EQ
:

447 
f
->
cÛf
 = 
	`nÜm®ize
(()f->cÛà- ()
a
 * ()
h
->coef);

448 ià(
f
->
cÛf
 == 0)

450 
‹mp
 = 
f
;

451 
f
 = f->
Ãxt
;

452 
	`ä“_¦ug
((
¡ash
 *)
pSsh
, (
¦ug
 *)
‹mp
);

456 
š»suÉ
->
Ãxt
 = 
f
;

457 
š»suÉ
 = 
f
;

458 
f
 = f->
Ãxt
;

460 
	`ä“_¦ug
((
¡ash
 *)
pSsh
, (
¦ug
 *)
Ãxth
);

461 
h
 = h->
Ãxt
;

462 ià(
	`check_h_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

464 
Ãxth
 = 
	`®loc_pŞy_node
();

465 
	`tm_add
(
	`INITIAL
(
h
), 
big
, INITIAL(
Ãxth
));

466 
	`´oûss_f_nuÎ
(&
f
, &
h
, &
š»suÉ
, &
Ãxth
, 
a
, 
big
, 
f1
);

467 ià(
f
 =ğ
NULL
)

472 
	}
}

479 
šlše
 
boŞ
 
	$check_h_auto_nuÎ
(
pŞy
 
h
,…Şy 
f
,…Şy 
š»suÉ
,…Şy *
f1
)

481 ià(
h
 =ğ
NULL
)

483 
š»suÉ
->
Ãxt
 = 
f
;

484 *
f1
 = 
addnode
->
Ãxt
;

485  
Œue
;

487  
çl£
;

488 
	}
}

491 
šlše
 
	$´oûss_f_auto_nuÎ
(
pŞy
 *
f
,…Şy *
h
,…Şy *
š»suÉ
, 
f›ld
 
a
,…Şy *
f1
)

493 ià(*
f
 =ğ
NULL
)

495 
Œue
)

497 
pŞy
 
‹mp
 = (pŞy)(*)
	`g‘_¦ug
((
¡ash
 *)
pSsh
);

498 
‹mp
->
cÛf
 = 
	`nÜm®ize
(-()
a
 * ()(*
h
)->coef);

499 
	`tm_cİy
(
	`INITIAL
(*
h
), INITIAL(
‹mp
));

500 (*
š»suÉ
)->
Ãxt
 = 
‹mp
;

501 *
š»suÉ
 = 
‹mp
;

502 *
h
 = (*h)->
Ãxt
;

504 ià(
	`check_h_auto_nuÎ
(*
h
, *
f
, *
š»suÉ
, 
f1
))

508 
	}
}

510 
	$auto_sub
(
pŞy
 *
f1
, 
f›ld
 
a
,…Şy 
h1
)

512 
pŞy
 
š»suÉ
 = 
addnode
;

513 
pŞy
 
f
 = *
f1
;

514 
pŞy
 
h
 = 
h1
;

515 
pŞy
 
‹mp
;

518 ià(
	`check_h_auto_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

522 
	`´oûss_f_auto_nuÎ
(&
f
, &
h
, &
š»suÉ
, 
a
, 
f1
);

523 ià(
f
 =ğ
NULL
)

526 
Œue
)

528 
	`tm_com·»
(
	`INITIAL
(
f
), INITIAL(
h
)))

530 
GT
:

531 
š»suÉ
->
Ãxt
 = 
f
;

532 
š»suÉ
 = 
f
;

533 
f
 = f->
Ãxt
;

534 
	`´oûss_f_auto_nuÎ
(&
f
, &
h
, &
š»suÉ
, 
a
, 
f1
);

535 ià(
f
 =ğ
NULL
)

538 
LT
:

539 
‹mp
 = (
pŞy
)(*)
	`g‘_¦ug
((
¡ash
 *)
pSsh
);

540 
‹mp
->
cÛf
 = 
	`nÜm®ize
(-()
a
 * ()
h
->coef);

541 
	`tm_cİy
(
	`INITIAL
(
h
), INITIAL(
‹mp
));

542 
š»suÉ
->
Ãxt
 = 
‹mp
;

543 
š»suÉ
 = 
‹mp
;

544 
h
 = h->
Ãxt
;

545 ià(
	`check_h_auto_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

548 
EQ
:

549 
f
->
cÛf
 = 
	`nÜm®ize
(()f->cÛà- ()
a
 * ()
h
->coef);

550 ià(
f
->
cÛf
 == 0)

552 
‹mp
 = 
f
;

553 
f
 = f->
Ãxt
;

554 
	`ä“_¦ug
((
¡ash
 *)
pSsh
, (
¦ug
 *)
‹mp
);

558 
š»suÉ
->
Ãxt
 = 
f
;

559 
š»suÉ
 = 
f
;

560 
f
 = f->
Ãxt
;

562 
h
 = h->
Ãxt
;

563 ià(
	`check_h_auto_nuÎ
(
h
, 
f
, 
š»suÉ
, 
f1
))

565 
	`´oûss_f_auto_nuÎ
(&
f
, &
h
, &
š»suÉ
, 
a
, 
f1
);

566 ià(
f
 =ğ
NULL
)

571 
	}
}

	@standard.h

5 
pŞy
 
divnode
;

8 
š™_divisiÚ
();

9 
deb_´št
(
pŞy
 
f
, 
n
);

10 
pŞy
 
»duû
(
gm©rix
 
M
,…Şy* 
f
);

11 
divisiÚ
(
gm©rix
 
M
, 
pŞy
* 
f
,…Şy* 
g
,…Şy* 
h
);

12 
boŞ—n
 
ÿlc_¡ªd¬d
(
gm©rix
 
M
, 
deg
, 
v¬ŸbË
* 
B
);

13 
£nd_off
(
gm©rix
 
M
, 
deg
, 
v¬ŸbË
* 
B
, 
pŞy
 
h
,…Şy 
h»p
);

14 
ÿlc_s_·œ
(
gm©rix
 
M
, 
mn_¡ªd¬d
 
i
, mn_¡ªd¬d 
j
, 
pŞy
* 
h
,…Şy* 
h»p
);

15 
šs_–em
(
gm©rix
 
M
, 
deg
, 
pŞy
 
h
,…Şy 
h»p
);

16 
auto_»duû
(
gm©rix
 
M
, 
deg
, 
pŞy
 
h
,…Şy 
h»p
);

17 
boŞ—n
 
occurs_š
(
pŞy
 
f
, 
‹rm
 
t
, 
f›ld
* 
a
);

18 
Üig_g’s
(
gm©rix
 
M
, 
deg
, 
štv®
, 
v¬ŸbË
* 
box
);

19 
šs_g’”©Ü
(
v¬ŸbË
* 
box
, 
pŞy
 
f
, 
deg
);

20 
div_sub
(
pŞy
* 
f1
, 
f›ld
 
a
, 
‹rm
 
t
,…Şy 
h1
);

21 
auto_sub
(
pŞy
* 
f1
, 
f›ld
 
a
,…Şy 
h1
);

	@stash.c

4 
	~<£tjmp.h
>

5 
	~<¡dio.h
>

6 
	~<¡dlib.h
>

7 
	~<¡ršg.h
>

8 
	~"sh¬ed.h
"

9 
	~"¡ash.h
"

10 
	~"mÚ™Ü.h
"

11 
	~"·r£.h
"

12 
	~"sh–l.h
"

13 
	~"£t.h
"

15 
	gshow­aœ
 = 0;

17 
cÚ¡ex´
 
	gBLOCKSIZE
 = 4400;

18 
cÚ¡ex´
 
	gPOOLSIZE
 = 64412L;

19 
cÚ¡ex´
 
	gRESERVE
 = 40960L;

20 
cÚ¡ex´
 
	gALIGN
 = 0;

23 
cÚ¡ex´
 
size_t
 
	gWORD
 = (*);

25 
	spuddË


27 
puddË
* 
	mµud
;

28 
	mpudsize
, 
	mpudtİ
;

29 
	mpudmuck
[1];

32 
	s¦ug


34 
¦ug
* 
	mp¦ug
;

37 
	sblock


39 
block
* 
	mpblock
;

40 
	m¥aû
[
BLOCKSIZE
];

43 
	s¡ash


45 
¦ug
* 
	m¦ugs
;

46 
block
* 
	mblocks
;

47 
¡ash
* 
	m´ev
, * 
	mÃxt
;

48 cÚ¡ * 
	mÇme
;

49 
	m¦ug_size
;

50 
	mn_blocks
, 
	mn_¦ugs
, 
	m¦ugs_u£d
;

53 
puddË
* 
	gw‘_puddËs
 = 
NULL
, * 
	gdry_puddËs
 = NULL;

54 
block
* 
	gexŒa_blocks
 = 
NULL
;

55 
¡ash
 
	g´im®_¡ash
 = {

56 
NULL
, NULL, &
´im®_¡ash
, &´im®_¡ash, "¡Üag®loÿtÜ", (
¡ash
), 0, 0, 0

59 cÚ¡ * 
	gno_mem
 = "out of memory";

60 cÚ¡ * 
	gtoo_big
 = "slug sizeoo†arge";

62 * 
	gÏ¡_®loc
 = 
NULL
;

63 
puddË
* 
	gÏ¡_pud
;

64 
	gÏ¡_size
;

66 
	g¿šy_š
 = 0, 
	g¿šy_out
 = 0;

67 * 
	g¿šy_day_š
 = 
NULL
, * 
	g¿šy_day_out
 = NULL;

69 
	$¿šy_day_memÜy
(
š
, 
out
)

73 ià(
¿šy_š
 && 
¿šy_day_š
)

75 
	`»pÜt_mem
(
¿šy_day_š
, 
¿šy_š
 * 
BLOCKSIZE
);

76 
¿šy_day_š
 = 
NULL
;

77 
¿šy_š
 = 0;

79 ià(
š
)

81 
¿šy_day_š
 = 
	`m®loc
((
size_t
)(
š
 * 
BLOCKSIZE
));

82 ià(
¿šy_day_š
)

83 
¿šy_š
 = 
š
;

85 ià(
¿šy_out
 && 
¿šy_day_out
)

87 
	`ä“
(
¿šy_day_out
);

88 
¿šy_day_out
 = 
NULL
;

89 
¿šy_out
 = 0;

91 ià(
out
)

93 
¿šy_day_out
 = 
	`m®loc
((
size_t
)(
out
 * 1024));

94 ià(
¿šy_day_out
)

95 
¿šy_out
 = 
out
;

97 
	}
}

99 
	$mem_š™_Úû_Úly
()

102 ià(
baout
 <= 0)

103 
	`¿šy_day_memÜy
(2, 4);

104 
	}
}

106 
	$ÿchemem_cmd
(
¬gc
, * 
¬gv
[])

108 
š
, 
out
;

110 ià(
¬gc
 != 3)

112 
	`´šŠew
("cache_mem <internal‡llocator blocks> <K's for malloc>\n");

113 
	`´štf
("(cu¼’y„e£rvšg %ld blocks,‡nd %ldK fÜ m®loc)\n", 
¿šy_š
, 
¿šy_out
);

116 
š
 = 
	`·r£IÁ
(
¬gv
 + 1);

117 
out
 = 
	`·r£IÁ
(
¬gv
 + 2);

118 ià(
š
 >ğ0 && 
out
 >= 0)

119 
	`¿šy_day_memÜy
(
š
, 
out
);

120 
	}
}

128 
	$kaboom
(cÚ¡ * 
mes§ge
)

130 
	`´št
("\n");

131 
	`Ãwlše
();

132 
	`´št
("!!!!!! % !!!!!!\n", 
mes§ge
);

133 ià(
baout
 > 0)

134 
	`ex™
(0);

137 ++
baout
;

138 ià(
¿šy_š
 || 
¿šy_out
)

140 
	`´št
("Using„ainy day memory„eserves\n");

141 
	`¿šy_day_memÜy
(0, 0);

143 
	`to_sh–l
();

145 
	}
}

147 
	gtÙmem
 = 0;

149 
	$»pÜt_mem
(* 
p
, 
n
)

152 
puddË
* 
q
;

154 ià(
p
 =ğ
NULL
)

155 
	`kaboom
(
no_mem
);

156 
tÙmem
 +ğ
n
;

157 ià((
showmem
 || 
v”bo£
è&& 
tÙmem
 !ğ
n
)

159 
	`štæush
("[%dk]", 1 + ()(
tÙmem
 - 1) / 1024L);

160 ià(
show·œs
 > 1)

161 
show­aœ
 = 1;

164 
q
 = (
puddË
*)(*)
p
;

165 
q
->
µud
 = 
w‘_puddËs
;

166 
w‘_puddËs
 = 
q
;

167 
n
 -ğ
q
->
pudmuck
 - (*)q;

168 
n
 % ()
WORD
 != 0)

169 --
n
;

170 
q
->
pudsize
 = q->
pudtİ
 = 
n
;

171 
	}
}

173 *
	$gimmy
(
size
)

175 
puddË
* 
p
;

177 ià(
w‘_puddËs
 =ğ
NULL
)

178 
	`mÜe_mem
();

179 
p
 = 
w‘_puddËs
;

180 
p
->
pudtİ
 < 
BLOCKSIZE
)

182 
w‘_puddËs
 = 
p
->
µud
;

183 
p
->
µud
 = 
dry_puddËs
;

184 
dry_puddËs
 = 
p
;

185 ià(
w‘_puddËs
 =ğ
NULL
)

186 
	`mÜe_mem
();

187 
p
 = 
w‘_puddËs
;

189 
size
 % 
WORD
 != 0)

190 ++
size
;

191 ià(
size
 > 
BLOCKSIZE
)

192 
p
->
pudtİ
 < 
size
)

194 ià(
p
->
µud
 =ğ
NULL
)

196 
	`mÜe_mem
();

197 
p
 = 
w‘_puddËs
;

201 
p
 =…->
µud
;

203 
p
->
pudtİ
 -ğ
size
;

204 
Ï¡_®loc
 = &
p
->
pudmuck
[p->
pudtİ
];

205 
Ï¡_pud
 = 
p
;

206 
Ï¡_size
 = 
size
;

207  
Ï¡_®loc
;

208 
	}
}

210 
	$ungimmy
(* 
p
)

212 ià(
Ï¡_®loc
 =ğ
p
)

213 
Ï¡_pud
->
pudtİ
 +ğ
Ï¡_size
;

214 
	}
}

216 
	$»£t_mem
()

218 
puddË
* 
p
;

220 ià(
w‘_puddËs
 !ğ
NULL
)

222 
p
 = 
w‘_puddËs
;…->
µud
 !ğ
NULL
;… =…->ppud)

224 
p
->
µud
 = 
dry_puddËs
;

228 
w‘_puddËs
 = 
dry_puddËs
;

230 
dry_puddËs
 = 
NULL
;

231 
p
 = 
w‘_puddËs
;… !ğ
NULL
;… =…->
µud
)

232 
p
->
pudtİ
 =…->
pudsize
;

233 
Ï¡_®loc
 = 
NULL
;

234 
exŒa_blocks
 = 
NULL
;

235 
´im®_¡ash
.
¦ugs
 = 
NULL
;

236 
´im®_¡ash
.
blocks
 = 
NULL
;

237 
´im®_¡ash
.
´ev
 = &primal_stash;

238 
´im®_¡ash
.
Ãxt
 = &primal_stash;

239 
´im®_¡ash
.
n_blocks
 = 0L;

240 
´im®_¡ash
.
n_¦ugs
 = 0L;

241 
´im®_¡ash
.
¦ugs_u£d
 = 0L;

242 
	}
}

244 
	$š™_mem
()

246 
	}
}

248 
	$mÜe_mem
()

251 * 
p
;

252 
p
 = 
	`m®loc
((
size_t
)
POOLSIZE
);

253 
	`»pÜt_mem
(
p
, 
POOLSIZE
);

254 
	}
}

256 *
	$İ’_¡ash
(
size
, cÚ¡ * 
Çme
)

258 
¡ash
* 
p
;

260 
p
 = (
¡ash
*)(*)
	`g‘_¦ug
(&
´im®_¡ash
);

261 ià(
p
 =ğ
NULL
)

262  
NULL
;

263 
p
->
¦ugs
 = 
NULL
;

264 
p
->
blocks
 = 
NULL
;

267 
p
->
´ev
 = &
´im®_¡ash
;

268 
p
->
Ãxt
 = 
´im®_¡ash
.next;

269 
p
->
´ev
->
Ãxt
 =…;

270 
p
->
Ãxt
->
´ev
 =…;

272 
p
->
Çme
 =‚ame;

273 
p
->
n_blocks
 = 0;

274 
p
->
n_¦ugs
 = 0;

275 
p
->
¦ugs_u£d
 = 0;

276 
size
 % ()
WORD
 != 0)

277 ++
size
;

278 
p
->
¦ug_size
 = 
size
 > ()(*) ? size : ()(*);

279  (*)
p
;

280 
	}
}

282 *
	$g‘_¦ug
(
¡ash
* 
p¡ash
)

284 
¡ash
* 
p
;

285 
¦ug
* 
q
;

287 ià((
p
 = 
p¡ash
è=ğ
NULL
)

288  
NULL
;

289 ià(
p
->
¦ugs
 =ğ
NULL
)

291 
	`g‘_block
(
p
);

292 ià(
p
->
¦ugs
 =ğ
NULL
)

293  
NULL
;

295 
q
 = 
p
->
¦ugs
;

296 
p
->
¦ugs
 = 
q
->
p¦ug
;

297 ++
p
->
¦ugs_u£d
;

298  (*)
q
;

299 
	}
}

301 
	$memÜy_bomb
()

303 
i
, 
j
;

305 
	`´štf
("\n");

306 
i
 = 1024, 
j
 = 0; i >= 32; i /= 2)

308 
	`m®loc
((
size_t
)(
i
 * 1024)è!ğ
NULL
)

309 
j
 +ğ
i
;

310 
	`´štf
("[%12d]\n", 
j
 * 1024);

311 
	`fæush
(
¡dout
);

313 
	`´štf
("[%12d] DONE.\n", 
j
);

314 
	`fæush
(
¡dout
);

315 
	}
}

317 #ifdeà
COMMENT


318 
	gfu£
 = 10;

319 ià(--
	gfu£
 == 0)

320 
memÜy_bomb
();

323 
	$g‘_block
(
¡ash
* 
p¡ash
)

325 
¡ash
* 
p
;

326 
¦ug
* 
q
, * 
q2
;

327 
block
* 
r
;

328 
i
, 
j
;

329 
couÁ
, 
k
;

331 
p
 = 
p¡ash
;

332 
j
 = 
p
->
¦ug_size
;

333 ià(
j
 > 
BLOCKSIZE
 - 
ALIGN
)

334 
	`kaboom
(
too_big
);

335 ià(
exŒa_blocks
 =ğ
NULL
)

336 ià(!
	`g‘_mem
(
p
))

338 
r
 = 
exŒa_blocks
;

339 
exŒa_blocks
 = 
r
->
pblock
;

340 
q
 = (
¦ug
*)(*)(
r
->
¥aû
 + 
ALIGN
);

341 
couÁ
 = 1;

342 
q
->
p¦ug
 = 
NULL
;

343 
k
 = 
BLOCKSIZE
 - 
j
;

344 
i
 = 
j
 + 
ALIGN
;

345 
i
 <ğ
k
)

347 
q2
 = (
¦ug
*)(*)(
r
->
¥aû
 + 
i
);

348 ++
couÁ
;

349 
q2
->
p¦ug
 = 
q
;

350 
q
 = 
q2
;

351 
i
 +ğ
j
;

353 
p
->
¦ugs
 = 
q
;

354 
r
->
pblock
 = 
p
->
blocks
;

355 
p
->
blocks
 = 
r
;

356 ++
p
->
n_blocks
;

357 
p
->
n_¦ugs
 +ğ
couÁ
;

358 
	}
}

360 
	$g‘_mem
(
¡ash
* 
p¡ash
)

362 
block
* 
r
;

364 ()
p¡ash
;

365 
r
 = (
block
*)(*)
	`gimmy
((block));

366 ià(
r
 =ğ
NULL
)

368 
r
->
pblock
 = 
exŒa_blocks
;

369 
exŒa_blocks
 = 
r
;

371 
	}
}

373 
	$ä“_¦ug
(
¡ash
* 
p¡ash
, 
¦ug
* 
±r
)

375 
±r
->
p¦ug
 = 
p¡ash
->
¦ugs
;

376 
p¡ash
->
¦ugs
 = 
±r
;

377 --
p¡ash
->
¦ugs_u£d
;

378 
	}
}

380 
	$’dof_¡ash
(
¡ash
* 
p¡ash
)

382 
block
* 
p
;

384 
p
 = 
p¡ash
->
blocks
;

385 ià(
p
 !ğ
NULL
)

387 
p
->
pblock
 !ğ
NULL
)

388 
p
 =…->
pblock
;

390 
p
->
pblock
 = 
exŒa_blocks
;

391 
exŒa_blocks
 = 
p¡ash
->
blocks
;

395 
p¡ash
->
´ev
->
Ãxt
 =…stash->next;

396 
p¡ash
->
Ãxt
->
´ev
 =…stash->prev;

398 
	`ä“_¦ug
(&
´im®_¡ash
, (
¦ug
*)
p¡ash
);

399 
	}
}

401 
šlše
 
	$K
(
A
)

403  (1023 + 
A
) / 1024;

404 
	}
}

406 
šlše
 
	$PUP
(
A
, 
B
)

408  
B
 ? (100 * 
A
 + B - 1) / B : 100;

409 
	}
}

411 
šlše
 
	$PDN
(
A
, 
B
)

413  
B
 ? (100 * 
A
) / B : 100;

414 
	}
}

416 
	$¥aû_cmd
(
¬gc
)

418 
b_®loc
, 
b_¡ash
, 
b_ä“
, 
k_®loc
, 
k_¡ash
, 
k_ava
, 
k_u£d
;

419 
p_¡ash
, 
p_ava
, 
p_u£d
, 
k_this
, 
p_this
;

421 
k_ä“
 
	`__©Œibu‹__
((
unu£d
));

422 
p_ä“
 
	`__©Œibu‹__
((
unu£d
));

423 
block
* 
b
;

424 
¡ash
* 
p
;

425 
puddË
* 
q
;

428 ià(
¬gc
 > 1)

430 
	`´št
(" #blocks #slugs #used size %%used\n");

431 
b_¡ash
 = 
b_ä“
 = 
k_ava
 = 
k_u£d
 = 0;

432 
b
 = 
exŒa_blocks
; b !ğ
NULL
; b = b->
pblock
)

433 ++
b_ä“
;

434 
b_®loc
 = 
b_ä“
;

435 
p
 = &
´im®_¡ash
;

438 
b_¡ash
 +ğ
p
->
n_blocks
;

439 
k_this
 = 
p
->
n_blocks
 * ()(
block
);

440 
k_ava
 +ğ
p
->
n_¦ugs
 *…->
¦ug_size
;

441 
k_u£d
 +ğ
p
->
¦ugs_u£d
 *…->
¦ug_size
;

442 
p_this
 = 
	`PUP
(
p
->
¦ugs_u£d
,…->
n_¦ugs
);

443 
	`´št
("%5ldK%8ld%8ld%8ld%8d%7ld%% %s\n", 
	`K
(
k_this
), 
p
->
n_blocks
,…->
n_¦ugs
,

444 
p
->
¦ugs_u£d
,…->
¦ug_size
, 
p_this
,…->
Çme
);

445 
p
 =…->
´ev
;

446 } 
p
 !ğ&
´im®_¡ash
);

447 
b_®loc
 +ğ
b_¡ash
;

448 
k_®loc
 = 
b_®loc
 * ()(
block
);

449 
k_¡ash
 = 
b_¡ash
 * ()(
block
);

450 
k_ä“
 = 
b_ä“
 * ()(
block
);

451 
p_¡ash
 = 
	`PUP
(
b_¡ash
, 
b_®loc
);

452 
p_ä“
 = 
	`PDN
(
b_ä“
, 
b_®loc
);

453 
p_ava
 = 
	`PUP
(
k_ava
, 
k_¡ash
);

454 
p_u£d
 = 
	`PUP
(
k_u£d
, 
k_ava
);

455 
	`´št
("%5ldK %5ld block und” cÚŒŞ oà¡Üag®loÿtÜ\n", 
	`K
(
k_®loc
), 
b_®loc
);

456 
	`´št
("%5ldK %5ld block š u£ ", 
	`K
(
k_¡ash
), 
b_¡ash
);

457 
	`´št
("(%4ld%% oà®loÿ‹d block )\n", 
p_¡ash
);

458 
	`´št
("%5ldK‡Îoÿ‹d iÁØ¦ug  ", 
	`K
(
k_ava
));

459 
	`´št
("(%4ld%% y›ld )\n", 
p_ava
);

460 
	`´št
("%5ldK slug š‡ùu® u£ ", 
	`K
(
k_u£d
));

461 
	`´št
("(%4ld%% oà®loÿ‹d slug  )\n", 
p_u£d
);

465 
b_®loc
 = 
b_ä“
 = 0;

466 
q
 = 
w‘_puddËs
; q !ğ
NULL
; q = q->
µud
)

468 
b_®loc
 +ğ
q
->
pudsize
;

469 
b_ä“
 +ğ
q
->
pudtİ
;

471 
q
 = 
dry_puddËs
; q !ğ
NULL
; q = q->
µud
)

473 
b_®loc
 +ğ
q
->
pudsize
;

474 
b_ä“
 +ğ
q
->
pudtİ
;

476 
	`´št
("%5ldKÙ® memÜy„eque¡ed by‡ÎoÿtÜ\n", 
	`K
(
b_®loc
));

477 
	`´št
("%5ldK oà»que¡ed memÜy‚Ù y‘ u£d\n", 
	`K
(
b_ä“
));

478 
	}
}

	@stash.h

5 
	g¡ash
;

6 
	g¦ug
;

11 
mem_š™_Úû_Úly
();

12 
š™_mem
();

13 
»£t_mem
();

16 
¿šy_day_memÜy
(
š
, 
out
);

19 
kaboom
(cÚ¡ * 
mes§ge
);

22 
»pÜt_mem
(* 
p
, 
n
);

25 *
gimmy
(
size
);

26 
ungimmy
(* 
p
);

27 
mÜe_mem
();

30 *
İ’_¡ash
(
size
, cÚ¡ * 
Çme
);

31 *
g‘_¦ug
(
¡ash
* 
p¡ash
);

32 
ä“_¦ug
(
¡ash
* 
p¡ash
, 
¦ug
* 
±r
);

33 
’dof_¡ash
(
¡ash
* 
p¡ash
);

36 
g‘_block
(
¡ash
* 
p¡ash
);

37 
g‘_mem
(
¡ash
* 
p¡ash
);

40 
ÿchemem_cmd
(
¬gc
, * 
¬gv
[]);

41 
¥aû_cmd
(
¬gc
);

44 
memÜy_bomb
();

47 
show­aœ
;

48 cÚ¡ * 
no_mem
;

49 cÚ¡ * 
too_big
;

	@stats.c

4 
	~"sh¬ed.h
"

5 
	~"¡©s.h
"

6 
	~"mÚ™Ü.h
"

9 
	g¡comp
;

10 
	g¡add
;

11 
	g¡¿dd
;

12 
	g¡div
;

13 
	g¡loİ
;

14 
	g¡¥ecŸl
;

16 #ifdeà
STATISTICS


18 
	$i_¡©s
()

20 
¡comp
 = 
¡add
 = 
¡¿dd
 = 0L;

21 
¡div
 = 
¡loİ
 = 
¡¥ecŸl
 = 0L;

22 
	}
}

24 
	$´_¡©s
()

26 
	`´št
("#m_com·» = %ld\n", 
¡comp
);

27 
	`´št
("#m_add = %ld\n", 
¡add
);

28 
	`´št
("# divisiÚ = %ld\n", 
¡div
);

29 
	`´št
("# div†oİ  = %ld\n", 
¡loİ
);

30 
	`´št
("# s³cŸÈsub = %ld\n", 
¡¥ecŸl
);

31 
	}
}

35 
	$i_¡©s
()

37 
¡comp
 = 
¡add
 = 
¡¿dd
 = 0L;

38 
¡div
 = 
¡loİ
 = 
¡¥ecŸl
 = 0L;

39 
	}
}

41 
	$´_¡©s
()

43 
	}
}

	@stats.h

5 
¡comp
;

6 
¡add
;

7 
¡¿dd
;

8 
¡div
;

9 
¡loİ
;

10 
¡¥ecŸl
;

13 
i_¡©s
();

14 
´_¡©s
();

	@stdcmds.c

4 
	~"sh¬ed.h
"

5 
	~"¡dcmds.h
"

6 
	~<¡dio.h
>

7 
	~<¡ršg.h
>

8 
	~<£tjmp.h
>

9 
	~"gm©rix.h
"

10 
	~"pŞy.h
"

11 
	~"‹rm.h
"

12 
	~"hb.h
"

13 
	~"mÚid—l.h
"

14 
	~"cmds.h
"

15 
	~"¶i¡.h
"

16 
	~"gm_pŞy.h
"

17 
	~"gm_dli¡.h
"

18 
	~"rv¬.h
"

19 
	~"šput.h
"

20 
	~"v¬s.h
"

21 
	~"·r£.h
"

22 
	~"¡ash.h
"

23 
	~"¬¿y.h
"

24 
	~"mÚ™Ü.h
"

25 
	~"humª_io.h
"

26 
	~"sh–l.h
"

27 
	~"£t.h
"

28 
	~"ršg.h
"

29 
	~"mem.h
"

30 
	~"g’”ic.h
"

43 
šlše
 
pŞy
 
	$´ef
(
¶i¡
 
¶
, 
i
)

45  
	`¶i¡_»f
(&
¶
, 
i
);

46 
	}
}

51 
šlše
 
boŞ
 
	$g‘_mod
(
gm©rix
 *
m
, 
¬gc
, cÚ¡ **
¬gv
, 
i
)

53 ià(
i
 >ğ
¬gc
)

54  
çl£
;

55 *
m
 = 
	`vg‘_mod
(
¬gv
[
i
]);

56  (*
m
 !ğ
nuÎ±r
);

57 
	}
}

59 
šlše
 
boŞ
 
	$g‘_mod_w™h_”rÜ
(
gm©rix
 *
m
, 
¬gc
, cÚ¡ **
¬gv
, 
i
)

61 ià(!
	`g‘_mod
(
m
, 
¬gc
, 
¬gv
, 
i
))

63 
	`´šŠew
("variable‚ot defined");

64 
	`Ãwlše
();

65  
çl£
;

67  
Œue
;

68 
	}
}

70 
šlše
 
v¬ŸbË
 *
	$Ãw_mod_v¬
(
¬gc
, cÚ¡ **
¬gv
, 
i
)

72 ià(
i
 >ğ
¬gc
)

74 
	`´”rÜ
("notƒnough‡rguments");

75  
nuÎ±r
;

77 
v¬ŸbË
 *
p
 = 
	`make_v¬
(
¬gv
[
i
], 0, 
VMODULE
, 
nuÎ±r
);

78 ià(
p
 =ğ
nuÎ±r
)

80 
	`´”rÜ
("can't create variable");

82  
p
;

83 
	}
}

85 
	$¡dW¬nšg
(
gm©rix
 
M
)

87 ià(
M
 =ğ
nuÎ±r
)

89 ià(
M
->
modty³
 =ğ
MMAT
)

91 
	`Ãwlše
();

92 
	`´št
("warning:‚o standard basis. Using initialerms of");

93 
	`´št
(" matrix\n");

95 
	}
}

97 
	$¡dNum
(
gm©rix
 
M
)

99 ià(
M
 =ğ
nuÎ±r
)

101 ià(
M
->
modty³
 =ğ
MMAT
)

102  
	`ncŞs
(
M
);

104  
M
->
n¡ªd¬d
;

105 
	}
}

115 
	$¡dFœ¡
(
gm©rix
 
M
, 
modg’
 *
mg
, 
is¡d
)

117 
mg
->
mis¡d
 = 
is¡d
;

118 ià(
M
 =ğ
nuÎ±r
)

119 
mg
->
mty³
 = 
MNOTHING
;

124 ià((
is¡d
 !ğ
USEMAT
è&& (
M
->
modty³
 !ğ
MMAT
))

126 
mg
->
mty³
 = 
MISTD
;

127 
mg
->
mmÚb
 = &
M
->
mÚb
;

128 
mg
->
mi
 = 0;

129 
mg
->
mq
 = 
nuÎ±r
;

131 ià(
is¡d
 =ğ
USECHANGE
)

133 
mg
->
mty³
 = 
MNOTHING
;

137 
mg
->
mty³
 = 
MMAT
;

138 
mg
->
mg’s
 = &
M
->
g’s
;

139 
mg
->
mi
 = 1;

141 
	}
}

143 
pŞy
 
	$¡dNext
(
modg’
 *
mg
)

145 
pŞy
 
»suÉ
;

146 
¬row
 
h—d
;

147 
mn_¡ªd¬d
 
q
;

149 ià(
mg
->
mty³
 =ğ
MNOTHING
)

150  
nuÎ±r
;

163 ià(
mg
->
mty³
 !ğ
MMAT
)

165 ià(
mg
->
mq
 !ğ
nuÎ±r
)

167 
mg
->
mq
 = 
	`mÚÃxt
(mg->mq);

168 ià(
mg
->
mq
 !ğ
nuÎ±r
)

170 
q
 = (
mn_¡ªd¬d
)
mg
->
mq
->
umn
.
ba£
.
ldc
.
ÿ
;

171 ià(
mg
->
mis¡d
 =ğ
USESTD
)

172 
»suÉ
 = 
q
->
¡ªd¬d
;

174 
»suÉ
 = 
q
->
chªge
;

175  
»suÉ
;

178 
mg
->
mi
++;

179 ; 
mg
->
mi
 <ğ
	`Ëngth
(mg->
mmÚb
); mg->mi++)

181 
h—d
 = *(
¬row
 *)
	`»f
(
mg
->
mmÚb
, mg->
mi
);

182 ià(
h—d
 =ğ
nuÎ±r
)

184 
	`mÚ»£t
(
h—d
, 0);

185 
mg
->
mq
 = 
	`mÚÃxt
(
h—d
);

186 ià(
mg
->
mq
 =ğ
nuÎ±r
)

188 
q
 = (
mn_¡ªd¬d
)
mg
->
mq
->
umn
.
ba£
.
ldc
.
ÿ
;

189 ià(
mg
->
mis¡d
 =ğ
USESTD
)

190  
q
->
¡ªd¬d
;

192  
q
->
chªge
;

194 
mg
->
mty³
 = 
MNOTHING
;

195  
nuÎ±r
;

199 ià(
mg
->
mi
 <ğ
	`Ëngth
(mg->
mg’s
))

201 
»suÉ
 = 
	`´ef
(*(
mg
->
mg’s
), mg->
mi
);

202 
mg
->
mi
++;

203  
»suÉ
;

205 
mg
->
mty³
 = 
MNOTHING
;

206  
nuÎ±r
;

208 
	}
}

212 
gm©rix
 
	$gm_–im
(
gm©rix
 
M
, 
n
, 
boŞ—n
 
dÛlim
)

214 
gm©rix
 
N
;

215 
modg’
 
mg
;

216 
pŞy
 
f
;

217 
boŞ—n
 
do™
;

219 
N
 = 
	`mod_š™
();

220 
	`dl_cİy
(&
M
->
deg»es
, &
N
->degrees);

221 
	`¡dW¬nšg
(
M
);

222 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

223 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

225 
do™
 = 
	`š_subršg
(
	`š™Ÿl
(
f
), 
n
);

226 ià(!
dÛlim
)

227 
do™
 = !doit;

228 ià(
do™
)

230 
f
 = 
	`p_cİy
(f);

231 
	`gmIn£¹
(
N
, 
f
);

234  
N
;

235 
	}
}

237 
	$–im_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

239 
gm©rix
 
M
;

240 
v¬ŸbË
 *
p
;

241 
n
;

243 ià((
¬gc
 < 3) || (argc > 4))

245 
	`´šŠew
("elim <standard basis> <result matrix>");

246 
	`´št
(" [n]\n");

249 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

251 ià(
¬gc
 == 3)

252 
n
 = 1;

254 
n
 = 
	`g‘IÁ
(
¬gv
[3]);

255 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

256 ià(
p
 =ğ
nuÎ±r
)

258 
	`£t_v®ue
(
p
, 
	`gm_–im
(
M
, 
n
, 1));

259 
	}
}

261 
	$k“p_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

263 
gm©rix
 
M
;

264 
v¬ŸbË
 *
p
;

265 
n
;

267 ià((
¬gc
 < 3) || (argc > 4))

269 
	`´šŠew
("keep <standard basis> <result matrix>");

270 
	`´št
(" [n]\n");

273 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

275 ià(
¬gc
 == 3)

276 
n
 = 1;

278 
n
 = 
	`g‘IÁ
(
¬gv
[3]);

279 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

280 ià(
p
 =ğ
nuÎ±r
)

282 
	`£t_v®ue
(
p
, 
	`gm_–im
(
M
, 
n
, 0));

283 
	}
}

287 
gm©rix
 
	$gm_š
(
gm©rix
 
M
, 
n
)

289 
gm©rix
 
»suÉ
;

290 
modg’
 
mg
;

291 
pŞy
 
f
;

293 
»suÉ
 = 
	`mod_š™
();

294 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

295 
	`¡dW¬nšg
(
M
);

296 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

297 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

298 
	`gmIn£¹
(
»suÉ
, 
	`p_š
(
f
, 
n
));

299  
»suÉ
;

300 
	}
}

302 
	$š_µršt
(
FILE
 *
f
, 
‹rm
 
t
, 
comp
)

304 ià(
comp
 !ğ
	`tm_compÚ’t
(
t
))

305 
	`åršt
(
f
, "0");

307 
	`tm_µršt
(
f
, 
t
);

308 
	}
}

310 
	$put_š
(
FILE
 *
f
, 
gm©rix
 
M
)

312 
modg’
 
mg
;

313 
pŞy
 
f
;

314 
j
, 
r
;

315 
c
;

317 
r
 = 
	`Äows
(
M
);

318 
c
 = 
	`¡dNum
(
M
);

319 
	`âewlše
(
f
);

320 
	`åršt
(
f
, "%d\n", 
r
);

321 
	`âewlše
(
f
);

322 
	`åršt
(
f
, "%d\n", 
c
);

323 
	`¡dW¬nšg
(
M
);

324 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

325 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

327 
j
 = 1; j <ğ
r
; j++)

329 
	`âewlše
(
f
);

330 
	`š_µršt
(
f
, 
	`š™Ÿl
(
f
), 
j
);

331 
	`åršt
(
f
, "\n");

334 
	`dlDi¥Ïy
(
f
, &
M
->
deg»es
, 
lšesize
);

335 
	}
}

337 
	$š_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

339 
gm©rix
 
M
;

340 
v¬ŸbË
 *
p
;

341 
n
;

343 ià((
¬gc
 < 2) || (argc > 4))

345 
	`´šŠew
("in <standard basis> [optional„esult matrix] [n]\n");

348 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

350 ià(
¬gc
 == 2)

351 
	`put_š
(
outfe
, 
M
);

354 ià(
¬gc
 == 3)

355 
n
 = 
nblocks
;

357 
n
 = 
	`g‘IÁ
(
¬gv
[3]);

358 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

359 ià(
p
 =ğ
nuÎ±r
)

361 
	`£t_v®ue
(
p
, 
	`gm_š
(
M
, 
n
));

363 
	}
}

367 
boŞ—n
 
	$v¬LoHi
(cÚ¡ *
s
, 
ex±”m
 
exp
)

369 
s_cİy
[256];

370 
	`¡ºıy
(
s_cİy
, 
s
, (s_copy) - 1);

371 
s_cİy
[(s_copy) - 1] = '\0';

372 *
s_±r
 = 
s_cİy
;

373 
i
, 
lo
, 
hi
;

375 
lo
 = 
	`·r£V¬
(&
s_±r
);

376 ià(*
s_±r
 == '\0')

377 
hi
 = 
lo
;

380 ià(*
s_±r
 == '.')

381 
s_±r
++;

382 ià(*
s_±r
 != '.')

383 
hi
 = 
lo
 - 1;

386 
s_±r
++;

387 
hi
 = 
	`·r£V¬
(&
s_±r
);

390 ià((
lo
 < 0è|| (
hi
 < 0) || (hi <†o))

392 
	`´”rÜ
("; bad variable†ist\n");

395 
i
 = 
lo
; i <ğ
hi
; i++)

396 
exp
[
i
] = 1;

398 
	}
}

400 
boŞ—n
 
	$g‘V¬Li¡
(
¬gc
, cÚ¡ *
¬gv
[], 
ex±”m
 
exp
)

402 
i
;

403 
boŞ—n
 
æ
;

405 
loÿl_¬gc
 = 
¬gc
;

406 **
loÿl_¬gv
 = (**)(*)
¬gv
;

408 
i
 = 0; i < 
numv¬s
; i++)

409 
exp
[
i
] = 0;

410 ià(
loÿl_¬gc
 == 0)

412 
	`g‘fœ¡block
(
exp
);

416 ià(*
loÿl_¬gv
[0] == '!')

418 
æ
 = 1;

419 
loÿl_¬gc
--;

420 
loÿl_¬gv
++;

423 
æ
 = 0;

425 
i
 = 0;

426 
i
 < 
loÿl_¬gc
)

428 ià(*
loÿl_¬gv
[
i
] == '\\')

430 
	`´šput
("more variables");

431 
	`g‘_lše
(&
loÿl_¬gc
, &
loÿl_¬gv
);

432 
i
 = 0;

435 ià(!
	`v¬LoHi
(
loÿl_¬gv
[
i
], 
exp
))

437 
i
++;

439 ià(
æ
)

441 
i
 = 0; i < 
numv¬s
; i++)

442 ià(
exp
[
i
] == 0)

443 
exp
[
i
] = 1;

445 
exp
[
i
] = 0;

448 
	}
}

452 
boŞ—n
 
	$exp_eqcÛf
(
ex±”m
 
exp
,ƒx±”m 
exp2
,ƒx±”m 
v¬s
)

454 
i
;

456 
i
 = 0; i < 
numv¬s
; i++)

457 ià(
v¬s
[
i
] != 0)

459 ià(
exp
[
i
] !ğ
exp2
[i])

462 
exp2
[
i
] = 0;

465 
	}
}

467 
pŞy
 
	$p_šcÛf
(
pŞy
 
f
, 
ex±”m
 
v¬s
)

469 
‹rm
 
t
;

470 
ex±”m
 
exp
, 
exp2
;

471 
pŞy
 
»suÉ
, 
g
;

473 ià(
f
 =ğ
nuÎ±r
)

474  
nuÎ±r
;

475 
t
 = (
‹rm
)
	`š™Ÿl
(
f
);

476 
	`sToExp
(
t
, 
exp
);

477 
»suÉ
 = 
nuÎ±r
;

478 
f
 !ğ
nuÎ±r
)

480 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp2
);

481 ià(!
	`exp_eqcÛf
(
exp
, 
exp2
, 
v¬s
))

483 
g
 = 
	`p_mÚom
(
f
->
cÛf
);

484 
	`expToS
(
exp2
, 
	`g‘_comp
(
f
), 
	`š™Ÿl
(
g
));

485 
f
 = f->
Ãxt
;

486 
	`p_add
(&
»suÉ
, &
g
);

488  
»suÉ
;

489 
	}
}

491 
gm©rix
 
	$gm_šcÛf
(
gm©rix
 
M
, 
ex±”m
 
v¬s
)

493 
gm©rix
 
»suÉ
;

494 
modg’
 
mg
;

495 
pŞy
 
f
;

497 
»suÉ
 = 
	`mod_š™
();

498 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

499 
	`¡dW¬nšg
(
M
);

500 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

501 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

502 
	`gmIn£¹
(
»suÉ
, 
	`p_šcÛf
(
f
, 
v¬s
));

503  
»suÉ
;

504 
	}
}

506 
	$šcÛf_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

508 
gm©rix
 
M
;

509 
v¬ŸbË
 *
p
;

510 
ex±”m
 
v¬s
;

512 ià(
¬gc
 < 3)

514 
	`´šŠew
("incoef <standard basis> <result matrix> [variable†ist]\n");

517 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

519 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

520 ià(
p
 =ğ
nuÎ±r
)

522 ià(!
	`g‘V¬Li¡
(
¬gc
 - 3, 
¬gv
 + 3, 
v¬s
))

524 
	`£t_v®ue
(
p
, 
	`gm_šcÛf
(
M
, 
v¬s
));

525 
	}
}

529 
	$exp_š·¹
(
ex±”m
 
exp
,ƒx±”m 
v¬s
)

531 
i
;

533 
i
 = 0; i <ğ
numv¬s
; i++)

534 ià(
v¬s
[
i
] == 0)

535 
exp
[
i
] = 0;

536 
	}
}

538 
pŞy
 
	$p_š·¹
(
pŞy
 
f
, 
ex±”m
 
v¬s
)

540 
pŞy
 
»suÉ
;

541 
ex±”m
 
exp
;

543 ià(
f
 =ğ
nuÎ±r
)

544  
nuÎ±r
;

545 
»suÉ
 = 
	`p_mÚom
(
f
->
cÛf
);

546 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

547 
	`exp_š·¹
(
exp
, 
v¬s
);

548 
	`expToS
(
exp
, 
	`g‘_comp
(
f
), 
	`š™Ÿl
(
»suÉ
));

549  
»suÉ
;

550 
	}
}

552 
gm©rix
 
	$gm_¡d·¹
(
gm©rix
 
M
, 
ex±”m
 
v¬s
, 
boŞ—n
 
š™ŸlOÆy
)

554 
gm©rix
 
»suÉ
;

555 
i
;

556 
¬row
 
p
, 
h—d
;

557 
modg’
 
mg
;

558 
ex±”m
 
exp
;

559 
pŞy
 
f
;

561 
»suÉ
 = 
	`mod_š™
();

562 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

563 
	`¡dW¬nšg
(
M
);

564 
i
 = 1; i <ğ
	`Äows
(
M
); i++)

566 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

567 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

568 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

570 ià(
i
 !ğ
	`g‘_comp
(
f
))

572 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

573 
	`exp_š·¹
(
exp
, 
v¬s
);

574 
	`mÚbagadjoš
(
h—d
, 
exp
, (*)
f
);

576 
p
 = 
h—d
;

577 (
p
 = 
	`mÚÃxt
Õ)è!ğ
nuÎ±r
)

579 
f
 = (
pŞy
)
p
->
uld
.
ldc
.
ÿ
;

580 ià(
š™ŸlOÆy
)

581 
f
 = 
	`p_š·¹
(f, 
v¬s
);

583 
f
 = 
	`p_cİy
(f);

584 
	`gmIn£¹
(
»suÉ
, 
f
);

586 
	`mÚ»fund
(
h—d
);

588  
»suÉ
;

589 
	}
}

591 
	$¡d·¹_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

593 
gm©rix
 
M
;

594 
v¬ŸbË
 *
p
;

595 
ex±”m
 
v¬s
;

597 ià(
¬gc
 < 3)

599 
	`´šŠew
("stdpart <standard basis> <result matrix> [variable†ist]\n");

602 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

604 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

605 ià(
p
 =ğ
nuÎ±r
)

607 ià(!
	`g‘V¬Li¡
(
¬gc
 - 3, 
¬gv
 + 3, 
v¬s
))

609 
	`£t_v®ue
(
p
, 
	`gm_¡d·¹
(
M
, 
v¬s
, 0));

610 
	}
}

612 
	$š·¹_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

614 
gm©rix
 
M
;

615 
v¬ŸbË
 *
p
;

616 
ex±”m
 
v¬s
;

618 ià(
¬gc
 < 3)

620 
	`´šŠew
("inpart <standard basis> <result matrix> [variable†ist]\n");

623 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

625 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

626 ià(
p
 =ğ
nuÎ±r
)

628 ià(!
	`g‘V¬Li¡
(
¬gc
 - 3, 
¬gv
 + 3, 
v¬s
))

630 
	`£t_v®ue
(
p
, 
	`gm_¡d·¹
(
M
, 
v¬s
, 1));

631 
	}
}

635 
	$šs_¡dmš
(
gm©rix
 
»suÉ
, gm©rix 
M
, 
ex±”m
 
Ãxp
, 
thiscomp
,ƒx±”m 
v¬s
)

637 
modg’
 
mg
;

638 
pŞy
 
f
;

639 
ex±”m
 
exp
;

641 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

642 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

644 ià(
thiscomp
 !ğ
	`g‘_comp
(
f
))

646 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

647 ià(
	`exp_eqcÛf
(
Ãxp
, 
exp
, 
v¬s
))

648 
	`gmIn£¹
(
»suÉ
, 
	`p_cİy
(
f
));

650 
	}
}

652 
gm©rix
 
	$gm_¡dmš
(
gm©rix
 
M
, 
ex±”m
 
v¬s
)

654 
gm©rix
 
»suÉ
;

655 
i
;

656 
¬row
 
p
, 
h—d
;

657 
modg’
 
mg
;

658 
pŞy
 
f
;

659 
ex±”m
 
exp
;

661 
»suÉ
 = 
	`mod_š™
();

662 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

663 
	`¡dW¬nšg
(
M
);

664 
i
 = 1; i <ğ
	`Äows
(
M
); i++)

666 
h—d
 = 
	`mÚÃwh—d
(
numv¬s
);

667 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

668 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

670 ià(
i
 !ğ
	`g‘_comp
(
f
))

672 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

673 
	`exp_š·¹
(
exp
, 
v¬s
);

674 
	`mÚbagadjoš
(
h—d
, 
exp
, (*)
f
);

676 
p
 = 
h—d
;

677 (
p
 = 
	`mÚÃxt
Õ)è!ğ
nuÎ±r
)

679 
	`šs_¡dmš
(
»suÉ
, 
M
, 
p
->
umn
.
mexp
, 
i
, 
v¬s
);

681 
	`mÚ»fund
(
h—d
);

683  
»suÉ
;

684 
	}
}

686 
	$¡dmš_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

688 
gm©rix
 
M
;

689 
v¬ŸbË
 *
p
;

690 
ex±”m
 
v¬s
;

692 ià(
¬gc
 < 3)

694 
	`´šŠew
("std_minimal <standard basis> <result matrix> [variable†ist]\n");

697 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

699 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

700 ià(
p
 =ğ
nuÎ±r
)

702 ià(!
	`g‘V¬Li¡
(
¬gc
 - 3, 
¬gv
 + 3, 
v¬s
))

704 
	`£t_v®ue
(
p
, 
	`gm_¡dmš
(
M
, 
v¬s
));

705 
	}
}

709 
	$p_maxdiv
(
pŞy
 
f
, 
n
)

711 
»suÉ
;

712 
ex±”m
 
exp
;

714 ià(
f
 =ğ
nuÎ±r
)

716 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

717 
»suÉ
 = 
exp
[
n
];

718 (
f
 = f->
Ãxt
è!ğ
nuÎ±r
)

720 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

721 ià(
exp
[
n
] < 
»suÉ
)

722 
»suÉ
 = 
exp
[
n
];

723 ià(
»suÉ
 == 0)

726  
»suÉ
;

727 
	}
}

729 
pŞy
 
	$p_v¬div
(
pŞy
 
f
, 
n
, 
maxpow”
)

731 
ex±”m
 
exp
;

732 
pŞy
 
»suÉ
, 
g
;

734 
»suÉ
 = 
nuÎ±r
;

735 
f
 !ğ
nuÎ±r
)

737 
	`sToExp
(
	`š™Ÿl
(
f
), 
exp
);

738 ià(
maxpow”
 <ğ
exp
[
n
])

739 
exp
[
n
] -ğ
maxpow”
;

741 
exp
[
n
] = 0;

742 
g
 = 
	`p_mÚom
(
f
->
cÛf
);

743 
	`expToS
(
exp
, 
	`g‘_comp
(
f
), 
	`š™Ÿl
(
g
));

744 
	`p_add
(&
»suÉ
, &
g
);

745 
f
 = f->
Ãxt
;

747  
»suÉ
;

748 
	}
}

750 
gm©rix
 
	$gm_v¬div
(
gm©rix
 
M
, 
n
, 
maxpow”
)

752 
gm©rix
 
»suÉ
;

753 
i
, 
max
;

754 
pŞy
 
f
;

755 
modg’
 
mg
;

757 
»suÉ
 = 
	`mod_š™
();

758 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

759 
	`¡dW¬nšg
(
M
);

760 
	`¡dFœ¡
(
M
, &
mg
, 
USESTD
);

761 
max
 = -1;

762 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

764 
i
 = 
	`p_maxdiv
(
f
, 
n
);

765 ià((
maxpow”
 > 0è&& (
i
 > maxpower))

766 
i
 = 
maxpow”
;

767 ià(
max
 == -1)

768 
max
 = 
i
;

770 
max
 = 
	`max_št
(max, 
i
);

771 
	`gmIn£¹
(
»suÉ
, 
	`p_v¬div
(
f
, 
n
, 
i
));

774 ià(
max
 > 0)

776 
	`Ãwlše
();

777 
	`´št
("Ïrge¡ divisiÚ wa by %s", 
v¬Çmes
[
n
]);

778 ià(
max
 > 1)

779 
	`´št
("%d", 
max
);

780 
	`´št
("\n");

782  
»suÉ
;

783 
	}
}

785 
	$§t_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

787 
gm©rix
 
M
;

788 
v¬ŸbË
 *
p
;

789 
maxpow”
, 
v¬num
;

791 ià((
¬gc
 < 3) || (argc > 5))

793 
	`´šŠew
("sat <standard basis> <result matrix> <variable> [max…ower]\n");

796 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

798 
v¬num
 = 
	`g‘V¬
(
¬gv
[3]);

799 ià(
v¬num
 == -1)

801 
	`´”rÜ
("; bad„ing variable‚ame\n");

804 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

805 ià(
p
 =ğ
nuÎ±r
)

807 ià(
¬gc
 < 5)

808 
maxpow”
 = -1;

810 
maxpow”
 = 
	`g‘IÁ
(
¬gv
[4]);

812 
	`£t_v®ue
(
p
, 
	`gm_v¬div
(
M
, 
v¬num
, 
maxpow”
));

813 
	}
}

817 
gm©rix
 
	$gm_¡d
(
gm©rix
 
M
, 
is¡d
)

819 
gm©rix
 
»suÉ
;

820 
modg’
 
mg
;

821 
pŞy
 
f
;

823 
»suÉ
 = 
	`mod_š™
();

824 ià(
is¡d
 =ğ
USESTD
)

825 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

827 
	`dl_cİy
(&
M
->
degg’s
, &
»suÉ
->
deg»es
);

828 
	`¡dFœ¡
(
M
, &
mg
, 
is¡d
);

829 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

830 
	`gmIn£¹
(
»suÉ
, 
	`p_cİy
(
f
));

831  
»suÉ
;

832 
	}
}

834 
	$put_¡d
(
FILE
 *
f
, 
gm©rix
 
M
, 
is¡d
)

836 
i
, 
j
, 
r
;

837 
modg’
 
mg
;

838 
pŞy
 
f
;

840 
r
 = (
is¡d
 =ğ
USESTD
 ? 
	`Äows
(
M
è: 
	`ncŞs
(M));

841 
	`âewlše
(
f
);

842 
	`åršt
(
f
, "%d\n", 
r
);

843 
	`âewlše
(
f
);

844 
	`åršt
(
f
, "%d\n", 
	`¡dNum
(
M
));

845 
	`¡dFœ¡
(
M
, &
mg
, 
is¡d
);

846 
i
 = 1; i <ğ
	`¡dNum
(
M
); i++)

848 
f
 = 
	`¡dNext
(&
mg
);

849 
j
 = 1; j <ğ
r
; j++)

851 
	`âewlše
(
f
);

852 
	`p_µršt
(
f
, 
f
, 
j
);

853 
	`åršt
(
f
, "\n");

856 
	}
}

860 
gm©rix
 
	$gm_fÜû
(
gm©rix
 
M
, gm©rix 
Mchªge
)

862 
gm©rix
 
»suÉ
;

863 
pŞy
 
f
, 
g
;

864 
mn_¡ªd¬d
 
q
;

865 
modg’
 
mg
, 
mgchªge
;

867 ià(
M
 =ğ
nuÎ±r
)

868  
nuÎ±r
;

869 ià(
Mchªge
 !ğ
nuÎ±r
)

871 ià(
	`Äows
(
Mchªge
è> 
	`ncŞs
(
M
))

873 
	`´”rÜ
("; change of basis matrix hasoo many„ows\n");

874  
nuÎ±r
;

877 
»suÉ
 = 
	`mod_š™
();

878 ià(
	`check_homog
(
M
))

879 
»suÉ
->
modty³
 = 
MSTD
;

881 
»suÉ
->
modty³
 = 
MISTD
;

883 
	`dl_cİy
(&
M
->
deg»es
, &
»suÉ
->degrees);

884 
	`¡dFœ¡
(
M
, &
mg
, 
USEMAT
);

885 
	`¡dFœ¡
(
Mchªge
, &
mgchªge
, 
USEMAT
);

886 (
f
 = 
	`¡dNext
(&
mg
)è!ğ
nuÎ±r
)

888 
f
 = 
	`p_cİy
(f);

889 
	`gmIn£¹
(
»suÉ
, 
f
);

890 
g
 = 
	`¡dNext
(&
mgchªge
);

891 
f
 = 
	`p_cİy
(f);

892 
g
 = 
	`p_cİy
(g);

893 
	`make2_mÚic
(&
f
, &
g
);

894 
q
 = (
mn_¡ªd¬d
)(*)
	`g‘_¦ug
((
¡ash
 *)
¡d_¡ash
);

895 
q
->
¡ªd¬d
 = 
f
;

896 
q
->
chªge
 = 
g
;

897 
q
->
deg»e
 = 
	`deg»e
(
M
, 
f
);

898 ià(
»suÉ
->
modty³
 =ğ
MSTD
)

900 
q
->
Ãxt
 = 
»suÉ
->
¡dbasis
;

901 
»suÉ
->
¡dbasis
 = 
q
;

904 
q
->
Ãxt
 = 
nuÎ±r
;

905 
»suÉ
->
n¡ªd¬d
++;

906 
	`mn_¡dš£¹
(
»suÉ
, 
	`š™Ÿl
(
f
), (*)
q
);

908  
»suÉ
;

909 
	}
}

911 
	$fÜû¡d_cmd
(
¬gc
, cÚ¡ *
¬gv
[])

913 
gm©rix
 
M
, 
Mchªge
;

914 
v¬ŸbË
 *
p
;

916 ià((
¬gc
 < 3) || (argc > 4))

918 
	`´šŠew
("forcestd <matrix> <result standard basis> [change of basis]\n");

921 ià(!
	`g‘_mod_w™h_”rÜ
(&
M
, 
¬gc
, 
¬gv
, 1))

923 ià(
¬gc
 == 4)

925 ià(!
	`g‘_mod_w™h_”rÜ
(&
Mchªge
, 
¬gc
, 
¬gv
, 3))

929 
Mchªge
 = 
nuÎ±r
;

930 
p
 = 
	`Ãw_mod_v¬
(
¬gc
, 
¬gv
, 2);

931 ià(
p
 =ğ
nuÎ±r
)

933 
	`£t_v®ue
(
p
, 
	`gm_fÜû
(
M
, 
Mchªge
));

934 
	}
}

	@stdcmds.h

7 
¡dW¬nšg
(
gm©rix
 
M
);

8 
¡dFœ¡
(
gm©rix
 
M
, 
modg’
* 
mg
, 
is¡d
);

9 
pŞy
 
¡dNext
(
modg’
* 
mg
);

12 
¡dNum
(
gm©rix
 
M
);

15 
–im_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

16 
k“p_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

17 
š_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

18 
šcÛf_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

19 
š·¹_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

20 
¡d·¹_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

21 
¡dmš_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

22 
§t_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

23 
fÜû¡d_cmd
(
¬gc
, cÚ¡ * 
¬gv
[]);

26 
gm©rix
 
gm_–im
(gm©rix 
M
, 
n
, 
boŞ—n
 
dÛlim
);

27 
gm©rix
 
gm_š
(gm©rix 
M
, 
n
);

28 
š_µršt
(
FILE
* 
f
, 
‹rm
 
t
, 
comp
);

29 
put_š
(
FILE
* 
f
, 
gm©rix
 
M
);

30 
boŞ—n
 
v¬LoHi
(cÚ¡ * 
s
, 
ex±”m
 
exp
);

31 
boŞ—n
 
g‘V¬Li¡
(
¬gc
, cÚ¡ * 
¬gv
[], 
ex±”m
 
exp
);

32 
boŞ—n
 
exp_eqcÛf
(
ex±”m
 
exp
,ƒx±”m 
exp2
,ƒx±”m 
v¬s
);

33 
pŞy
 
p_šcÛf
ÕŞy 
f
, 
ex±”m
 
v¬s
);

34 
gm©rix
 
gm_šcÛf
(gm©rix 
M
, 
ex±”m
 
v¬s
);

35 
exp_š·¹
(
ex±”m
 
exp
,ƒx±”m 
v¬s
);

36 
pŞy
 
p_š·¹
ÕŞy 
f
, 
ex±”m
 
v¬s
);

37 
gm©rix
 
gm_¡d·¹
(gm©rix 
M
, 
ex±”m
 
v¬s
, 
boŞ—n
 
š™ŸlOÆy
);

38 
šs_¡dmš
(
gm©rix
 
»suÉ
, gm©rix 
M
, 
ex±”m
 
Ãxp
, 
thiscomp
,ƒx±”m 
v¬s
);

39 
gm©rix
 
gm_¡dmš
(gm©rix 
M
, 
ex±”m
 
v¬s
);

40 
p_maxdiv
(
pŞy
 
f
, 
n
);

41 
pŞy
 
p_v¬div
ÕŞy 
f
, 
n
, 
maxpow”
);

42 
gm©rix
 
gm_v¬div
(gm©rix 
M
, 
n
, 
maxpow”
);

43 
gm©rix
 
gm_¡d
(gm©rix 
M
, 
is¡d
);

44 
put_¡d
(
FILE
* 
f
, 
gm©rix
 
M
, 
is¡d
);

45 
gm©rix
 
gm_fÜû
(gm©rix 
M
, gm©rix 
Mchªge
);

	@tables.c

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~"sh¬ed.h
"

7 
	~"bËs.h
"

8 
	~"comb_»c.h
"

9 
	~"gm©rix.h
"

10 
	~"pŞy.h
"

12 #ifdeà
TABLESTAT


13 
	gh™
 = 0, 
	gmiss
 = 0;

14 
	gh™li¡
[20], 
	gmis¦i¡
[20];

19 
pŞy
* 
	md©um
;

20 
	mwidth
, 
	mheight
;

21 } 
	tbË
;

23 
pŞy
 
	gNO_ENTRY
;

26 
šlše
 
pŞy
*
	$bË_g‘_±r
(
bË
 
b
, 
x
, 
y
)

28  
b
.
d©um
 +ab.
width
 * 
y
 + 
x
;

29 
	}
}

31 
šlše
 
pŞy
 
	$bË_g‘
(
bË
 
b
, 
x
, 
y
)

33  *(
	`bË_g‘_±r
(
b
, 
x
, 
y
));

34 
	}
}

36 
šlše
 
	$bË_£t
(
bË
 
b
, 
x
, 
y
, 
pŞy
 
v®ue
)

38 *(
	`bË_g‘_±r
(
b
, 
x
, 
y
)èğ
v®ue
;

39 
	}
}

42 
šlše
 
	$combs
(
n
, 
r
)

44  
comb_bË
[
n
][
r
];

45 
	}
}

47 
bË
* 
	gbËpe
;

49 
	gwidth¿nge
, 
	gheighŒªge
, 
	gbËd•th
;

58 
	$š™_bËs
(
gm©rix
 
M
, 
width
, 
height
, 
mšÜsize
)

60 
i
, 
x
, 
y
;

62 ià((
NO_ENTRY
 = (
pŞy
)
	`m®loc
((
pŞ
))è=ğ
nuÎ±r
)

65 ià((
bËpe
 = (
bË
*)
	`m®loc
((
size_t
)(
mšÜsize
è* ÑabË))è=ğ
nuÎ±r
)

68 
bËpe
 -= 1;

70 
bËpe
[1].
width
 = 
	`combs
(width, 1);

71 
bËpe
[1].
height
 = 
	`combs
(height, 1);

72 ià((
bËpe
[1].
d©um
 = (
pŞy
*)
	`m®loc
(

73 (
size_t
)
bËpe
[1].
width
 * (size_téabËpe[1].
height
 * (
pŞy
))è=ğ
nuÎ±r
)

75 
bËd•th
 = 0;

76 
	`ä“_bËs
();

80 
x
 = 0; x < 
bËpe
[1].
width
; x++)

81 
y
 = 0; y < 
bËpe
[1].
height
; y++)

83 
	`bË_£t
(
bËpe
[1], 
x
, 
y
, 
	`gm_–em
(
M
, y + 1, x + 1, 1));

85 
	`´štf
("read in matrix...\n");

86 
	`fæush
(
¡dout
);

87 
i
 = 2; i <ğ
mšÜsize
; i++)

89 
bËpe
[
i
].
width
 = 
	`combs
(width, i);

90 
bËpe
[
i
].
height
 = 
	`combs
(height, i);

91 ià((
bËpe
[
i
].
d©um
 = (
pŞy
*)
	`m®loc
((
size_t
éabËpe[i].
width


92 * (
size_t
)
bËpe
[
i
].
height
 * (
pŞy
)))

93 =ğ
nuÎ±r
)

95 
bËd•th
 = 
i
 - 1;

96 
	`ä“_bËs
();

101 
x
 = 0; x < 
bËpe
[
i
].
width
; x++)

102 
y
 = 0; y < 
bËpe
[
i
].
height
; y++)

104 
	`bË_£t
(
bËpe
[
i
], 
x
, 
y
, 
NO_ENTRY
);

109 
width¿nge
 = 
width
;

110 
heighŒªge
 = 
height
;

111 
bËd•th
 = 
mšÜsize
;

113 #ifdeà
TABLESTAT


115 
i
 = 0; i <ğ
mšÜsize
; i++)

116 
h™li¡
[
i
] = 
mis¦i¡
[i] = 0;

120 
	}
}

127 
	$ä“_bËs
()

129 
i
, 
x
, 
y
;

131 
i
 = 2; i <ğ
bËd•th
; i++)

133 
x
 = 0; x < 
bËpe
[
i
].
width
; x++)

134 
y
 = 0; y < 
bËpe
[
i
].
height
; y++)

135 ià(
	`bË_g‘
(
bËpe
[
i
], 
x
, 
y
è!ğ
NO_ENTRY
)

136 
	`p_kl
(
	`bË_g‘_±r
(
bËpe
[
i
], 
x
, 
y
));

137 
	`ä“
(
bËpe
[
i
].
d©um
);

140 
bËpe
 += 1;

141 
	`ä“
(
bËpe
);

143 
	`ä“
(
NO_ENTRY
);

145 #ifdeà
TABLESTAT


146 
	`årštf
(
¡d”r
, "%d h™s, %d mis£s, (%dÙ®).\n", 
h™
, 
miss
, hit + miss);

147 
	`årštf
(
¡d”r
, "breakdown:\n\tsize\thits\tmisses\ttotal\n");

148 
i
 = 2; i < 
bËd•th
; i++)

149 
	`årštf
(
¡d”r
, "\t%d\t%d\t%d\t%d\n", 
i
, 
h™li¡
[i], 
mis¦i¡
[i], hitlist[i] + misslist[i]);

151 
	}
}

160 
pŞy
*
	$¡Üed_v®ue
(* 
r
, * 
c
, 
l
)

162 
x
, 
y
;

164 #ifdeà
TABLESTAT


165 
pŞy
* 
‹mp
;

168 
x
 = 
	`comb_num
(
c
, 
l
, 
width¿nge
);

169 
y
 = 
	`comb_num
(
r
, 
l
, 
heighŒªge
);

171 #ifdeà
TABLESTAT


173 ià(*(
‹mp
 = 
	`bË_g‘_±r
(
bËpe
[
l
], 
x
, 
y
)è!ğ
NO_ENTRY
)

175 
h™
++;

176 
h™li¡
[
l
]++;

180 
miss
++;

181 
mis¦i¡
[
l
]++;

184  
‹mp
;

188  
	`bË_g‘_±r
(
bËpe
[
l
], 
x
, 
y
);

191 
	}
}

193 
pŞy
 
	$m©rixsub
(
cŞ
, 
row
)

195  
	`bË_g‘
(
bËpe
[1], 
cŞ
, 
row
);

196 
	}
}

	@tables.h

5 #ifdeà
TABLESTAT


6 
h™
, 
miss
;

7 
h™li¡
[20], 
mis¦i¡
[20];

11 
š™_bËs
(
gm©rix
 
M
, 
width
, 
height
, 
mšÜsize
);

12 
ä“_bËs
();

13 
pŞy
*
¡Üed_v®ue
(* 
r
, * 
c
, 
l
);

14 
pŞy
 
m©rixsub
(
cŞ
, 
row
);

	@term.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~"sh¬ed.h
"

7 
	~"‹rm.h
"

8 
	~"mÚ™Ü.h
"

9 
	~"humª_io.h
"

10 
	~"ršg.h
"

14 #´agm¨
GCC
 
dŸgno¡ic
 
push


15 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wpedantic"

35 
	$´Sm®l
(
‹rm
 
t
)

37 
i
;

39 
i
 = 0; i < 
nblocks
; i++)

40 
	`´št
("%ld ", 
t
[
i
]);

41 
	`´št
("\n");

42 
	}
}

44 
	$´Big
(
big‹rm
 
big
)

46 
symmBlock
* 
sy
 = 
blocks
;

47 
symmBlock
 
this
 = *
sy
;

48 
i
;

52 ià(
this
->
¹yp
 =ğ
RSYMM
)

54 
i
 = 0; i < 
this
->
nv¬s
; i++)

55 
	`´št
("%lu ", *
big
++);

58 
	`´št
("%ld ", *
big
++);

59 
sy
++;

60 
this
 = *
sy
;

61 } 
this
 !ğ
NULL
);

62 
	`´št
("\n");

63 
	}
}

65 
	$´Exp
(
big‹rm
 
exp
)

67 
i
;

69 
i
 = 0; i < 
numv¬s
; i++)

70 
	`´št
("%d ", 
exp
[
i
]);

71 
	`´št
("\n");

72 
	}
}

74 
big‹rm
 
	gh–³xp
;

76 
	$expToS
(
big‹rm
 
£xp
, 
compÚ’t
, 
‹rm
 
»suÉ
)

78 
symmBlock
* 
sy
 = 
blocks
;

79 
symmBlock
 
this
 = *
sy
;

80 * 
exp
 = 
£xp
;

81 
i
;

82 
n
, * 
deg
;

86 ià(
this
->
¹yp
 =ğ
RSYMM
)

88 
n
 = 
this
->
nv¬s
;

89 
deg
 = 
this
->
degs
;

90 
h–³xp
[0] = (*
exp
++è* (*
deg
++);

91 
i
 = 1; i < 
n
; i++)

92 
h–³xp
[
i
] = (*
exp
++è* (*
deg
++) + helpexp[i - 1];

94 
	`sm®lmÚ
 (*
func
)(
symmBlock
, *) =

95 (
	`sm®lmÚ
 (*)(
symmBlock
, *))(*è
this
->
btos
;

96 *
»suÉ
 = 
	`func
(
this
, 
h–³xp
);

99 ià(
this
->
¹yp
 =ğ
RCOMP
)

100 *
»suÉ
 = (
sm®lmÚ
)
compÚ’t
;

103 
sum
 = 0;

104 
deg
 = 
this
->
degs
;

105 
i
 = 
numv¬s
 - 1; i >= 0; i--)

106 
sum
 +ğ
deg
[
i
] * 
£xp
[i];

107 *
»suÉ
 = (
sm®lmÚ
)
sum
;

109 
»suÉ
++;

110 
sy
++;

111 
this
 = *
sy
;

112 } 
this
 !ğ
NULL
);

113 
	}
}

115 
	$sToExp
(
‹rm
 
s
, 
big‹rm
 
exp
)

117 
symmBlock
* 
sy
 = 
blocks
;

118 
symmBlock
 
this
 = *
sy
;

119 
i
, * 
deg
, 
n
;

123 ià(
this
->
¹yp
 =ğ
RSYMM
)

125 
n
 = 
this
->
nv¬s
;

126 
deg
 = 
this
->
degs
;

128 (*
func
)(
symmBlock
, 
sm®lmÚ
, *) =

129 ((*)(
symmBlock
, 
sm®lmÚ
, *))(*è
this
->
¡ob
;

130 
	`func
(
this
, *
s
, 
exp
);

132 
i
 = 
n
 - 1; i >= 1; i--)

134 
exp
[
i
] -=ƒxp[i - 1];

135 
exp
[
i
] /ğ
deg
[i];

137 
exp
[0] /ğ
deg
[0];

138 
exp
 +ğ
n
;

140 
sy
++;

141 
s
++;

142 
this
 = *
sy
;

143 } 
this
 !ğ
NULL
);

144 
	}
}

146 
	$sToBig
(
‹rm
 
t
, 
big‹rm
 
big
)

148 
symmBlock
* 
sy
 = 
blocks
;

149 
symmBlock
 
this
 = *
sy
;

153 ià(
this
->
¹yp
 =ğ
RSYMM
)

156 (*
func
)(
symmBlock
, 
sm®lmÚ
, *) =

157 ((*)(
symmBlock
, 
sm®lmÚ
, *))(*è
this
->
¡ob
;

158 
	`func
(
this
, *
t
, 
big
);

160 
big
 +ğ
this
->
nv¬s
;

163 *
big
++ = ()*
t
;

164 
sy
++;

165 
t
++;

166 
this
 = *
sy
;

167 } 
this
 !ğ
NULL
);

168 
	}
}

170 
	$bigToS
(
big‹rm
 
big
, 
‹rm
 
t
)

172 
symmBlock
* 
sy
 = 
blocks
;

173 
symmBlock
 
this
 = *
sy
;

177 ià(
this
->
¹yp
 =ğ
RSYMM
)

180 
	`sm®lmÚ
 (*
func
)(
symmBlock
, *) =

181 (
	`sm®lmÚ
 (*)(
symmBlock
, *))(*è
this
->
btos
;

182 *
t
 = 
	`func
(
this
, 
big
);

184 
big
 +ğ
this
->
nv¬s
;

187 *
big
++ = ()*
t
;

188 
sy
++;

189 
t
++;

190 
this
 = *
sy
;

191 } 
this
 !ğ
NULL
);

192 
	}
}

194 
	$hbToS
(
big‹rm
 
hexp
, 
compÚ’t
, 
‹rm
 
»suÉ
)

196 
symmBlock
* 
sy
 = 
blocks
;

197 
symmBlock
 
this
 = *
sy
;

198 * 
exp
 = 
hexp
;

199 
i
, 
j
;

200 
n
, * 
deg
;

204 ià(
this
->
¹yp
 =ğ
RSYMM
)

206 
n
 = 
this
->
nv¬s
;

207 
h–³xp
[0] = 
exp
[
n
 - 1];

208 
j
 = 1, 
i
 = 
n
 - 2; i >= 0; i--, j++)

209 
h–³xp
[
j
] = 
exp
[
i
] + helpexp[j - 1];

211 
	`sm®lmÚ
 (*
func
)(
symmBlock
, *) =

212 (
	`sm®lmÚ
 (*)(
symmBlock
, *))(*è
this
->
btos
;

213 *
»suÉ
 = 
	`func
(
this
, 
h–³xp
);

216 ià(
this
->
¹yp
 =ğ
RCOMP
)

217 *
»suÉ
 = (
sm®lmÚ
)
compÚ’t
;

220 
sum
 = 0;

221 
deg
 = 
this
->
degs
;

222 
i
 = 
numv¬s
 - 1, 
j
 = 0; i >= 0; i--, j++)

223 
sum
 +ğ
deg
[
j
] * 
hexp
[
i
];

224 *
»suÉ
 = (
sm®lmÚ
)
sum
;

226 
»suÉ
++;

227 
sy
++;

228 
this
 = *
sy
;

229 } 
this
 !ğ
NULL
);

230 
	}
}

232 
	$sToHb
(
‹rm
 
s
, 
big‹rm
 
hexp
, * 
compÚ’t
)

234 
symmBlock
* 
sy
 = 
blocks
;

235 
symmBlock
 
this
 = *
sy
;

236 
i
, 
j
, 
n
;

237 
big‹rm


238 
big
;

242 ià(
this
->
¹yp
 =ğ
RSYMM
)

244 
n
 = 
this
->
nv¬s
;

246 (*
func
)(
symmBlock
, 
sm®lmÚ
, *) =

247 ((*)(
symmBlock
, 
sm®lmÚ
, *))(*è
this
->
¡ob
;

248 
	`func
(
this
, *
s
, 
big
);

250 
hexp
[
n
 - 1] = 
big
[0];

251 
j
 = 
n
 - 2, 
i
 = 1; j >= 0; i++, j--)

252 
hexp
[
j
] = 
big
[
i
] - big[i - 1];

253 
hexp
 +ğ
n
;

255 ià(
this
->
¹yp
 =ğ
RCOMP
)

256 *
compÚ’t
 = ()*
s
;

257 
sy
++;

258 
s
++;

259 
this
 = *
sy
;

260 } 
this
 !ğ
NULL
);

261 
	}
}

263 
	$tm_µršt
(
FILE
* 
f
, 
‹rm
 
t
)

265 
i
, 
a
;

266 
big‹rm
 
exp
;

268 
	`sToExp
(
t
, 
exp
);

269 
i
 = 0; i < 
numv¬s
; i++)

271 
a
 = 
exp
[
i
];

272 ià(
a
 > 0)

273 
	`åršt
(
f
, "%s", 
v¬Çmes
[
i
]);

274 ià(
a
 > 1)

275 
	`št_µršt
(
f
, 
a
, 
çl£
, false);

277 
	}
}

279 
	$tm_size
(
‹rm
 
t
)

281 
i
, 
a
, 
sum
;

282 
big‹rm
 
exp
;

284 
sum
 = 0;

285 
	`sToExp
(
t
, 
exp
);

286 
i
 = 0; i < 
numv¬s
; i++)

288 
a
 = 
exp
[
i
];

289 ià(
a
 > 0)

290 
sum
 +ğ()
	`¡¾’
(
v¬Çmes
[
i
]);

291 ià(
a
 > 1)

292 
sum
 +ğ
	`št_size
(
a
, 
çl£
, false);

294  (
sum
);

295 
	}
}

297 
	$tm_add
(
‹rm
 
s
, 
big‹rm
 
big
, ‹rm 
»suÉ
)

299 
symmBlock
* 
sy
 = 
blocks
;

300 
symmBlock
 
this
 = *
sy
;

304 ià(
this
->
¹yp
 =ğ
RSYMM
)

307 
	`sm®lmÚ
 (*
func
)(
symmBlock
, 
sm®lmÚ
, *) =

308 (
	`sm®lmÚ
 (*)(
symmBlock
, 
sm®lmÚ
, *))(*è
this
->
madd
;

309 *
»suÉ
 = 
	`func
(
this
, *
s
, 
big
);

311 
big
 +ğ
this
->
nv¬s
;

313 ià(
this
->
¹yp
 =ğ
RCOMP
)

315 *
»suÉ
 = (
sm®lmÚ
)
	`max_št
(()*
s
, *
big
);

316 
big
++;

319 *
»suÉ
 = (
sm®lmÚ
)((*
big
++è+ ()(*
s
));

320 
sy
++;

321 
s
++;

322 
»suÉ
++;

323 
this
 = *
sy
;

324 } 
this
 !ğ
NULL
);

325 
	}
}

327 
	$tm_com·»
(
‹rm
 
s
, ‹rm 
t
)

329 
n
 = 
nblocks
;

330 
i
;

332 
i
 = 
n
; i > 0; i--, 
s
++, 
t
++)

333 ià(*
s
 > *
t
)

334  (
GT
);

335 ià(*
s
 < *
t
)

336  (
LT
);

337  (
EQ
);

338 
	}
}

342 
	$‹rm_i
(
i
, 
‹rm
 
t
)

344 
j
;

346 
j
 = 0; j < 
nblocks
; j++)

347 
t
[
j
] = 0;

348 ià(
compLoc
 >= 0)

349 
t
[
compLoc
] = (
sm®lmÚ
)
i
;

350 
	}
}

352 
	$tm_xjei
(
j
, 
i
, 
‹rm
 
t
)

354 
big‹rm
 
exp
;

355 
a
;

357 
a
 = 0;‡ < 
numv¬s
;‡++)

358 
exp
[
a
] = 0;

359 
exp
[
j
] = 1;

360 
	`expToS
(
exp
, 
i
, 
t
);

361 
	}
}

363 
	$tm_cİy
(
‹rm
 
s
,”m 
t
)

365 
i
;

367 
i
 = 
nblocks
; i > 0; i--)

368 *
t
++ = *
s
++;

369 
	}
}

371 
	$tm_compÚ’t
(
‹rm
 
t
)

373 ià(
compLoc
 >= 0)

374  (()
t
[
compLoc
]);

377 
	}
}

379 
	$tm_£tcomp
(
‹rm
 
t
, 
c
)

381 ià(
compLoc
 >= 0)

382 
t
[
compLoc
] = (
sm®lmÚ
)
c
;

383 
	}
}

385 
boŞ—n
 
	$tm_isz”o
(
‹rm
 
t
)

387 
i
;

389 
i
 = 0; i < 
nblocks
; i++)

390 ià((*
t
++ !ğ0è&& (
compLoc
 !ğ
i
))

391  (
FALSE
);

392  (
TRUE
);

393 
	}
}

395 
	$tm_deg»e
(
‹rm
 
t
)

397 
big‹rm
 
exp
;

398 
i
, 
sum
;

400 
	`sToExp
(
t
, 
exp
);

401 
sum
 = 0;

402 
i
 = 0; i < 
numv¬s
; i++)

403 
sum
 +ğ
exp
[
i
] * 
	`dli¡_»f
(&
rgDegs
, i + 1);

404  (
sum
);

405 
	}
}

407 
	$exp_deg»e
(
ex±”m
 
exp
)

409 
sum
, 
i
;

411 
sum
 = 0;

412 
i
 = 0; i < 
numv¬s
; i++)

413 
sum
 +ğ
exp
[
i
] * 
	`dli¡_»f
(&
rgDegs
, i + 1);

414  (
sum
);

415 
	}
}

424 
	$jošmšus
(
‹rm
 
t1
,”m 
t2
, 
c1
, 
c2
,”m 
»suÉ1
,”m 
»suÉ2
)

426 
big‹rm
 
exp1
, 
exp2
;

427 
i
, 
d
;

429 
	`sToExp
(
t1
, 
exp1
);

430 
	`sToExp
(
t2
, 
exp2
);

431 
i
 = 
numv¬s
 - 1; i >= 0; i--)

433 
d
 = 
	`max_št
(
exp1
[
i
], 
exp2
[i]);

434 
exp1
[
i
] = 
d
 -ƒxp1[i];

435 
exp2
[
i
] = 
d
 -ƒxp2[i];

437 
	`expToS
(
exp1
, 
c1
, 
»suÉ1
);

438 
	`expToS
(
exp2
, 
c2
, 
»suÉ2
);

439 
	}
}

444 
	$tm_jošmšus
(
‹rm
 
t1
,”m 
t2
,”m 
»suÉ1
,”m 
»suÉ2
)

446 
	`jošmšus
(
t1
, 
t2
, 0, 0, 
»suÉ1
, 
»suÉ2
);

447 
	}
}

452 
	$tm_rg_još
(
‹rm
 
t1
,”m 
t2
,”m 
»suÉ1
,”m 
»suÉ2
)

454 
	`jošmšus
(
t1
, 
t2
, 
	`tm_compÚ’t
Ñ2), 0, 
»suÉ1
, 
»suÉ2
);

455 
	}
}

462 
boŞ—n
 
	$tm_divides
(
‹rm
 
s
,”m 
t
, 
c
,”m 
»suÉ
)

464 
ex±”m
 
bs
, 
bt
;

465 
i
, 
a
;

467 
	`sToExp
(
s
, 
bs
);

468 
	`sToExp
(
t
, 
bt
);

469 
i
 = 0; i < 
numv¬s
; i++)

471 
a
 = 
bs
[
i
] - 
bt
[i];

472 ià(
a
 < 0)

473  (
FALSE
);

475 
bs
[
i
] = 
a
;

477 
	`expToS
(
bs
, 
c
, 
»suÉ
);

478  (
TRUE
);

479 
	}
}

486 
	$tm_diff
(
‹rm
 
s
,”m 
»suÉ
, 
v
, * 
pow”
)

488 
big‹rm
 
exp
;

490 
	`sToExp
(
s
, 
exp
);

491 *
pow”
 = 
exp
[
v
];

492 ià(*
pow”
 == 0)

494 
exp
[
v
]--;

495 
	`expToS
(
exp
, 
	`tm_compÚ’t
(
s
), 
»suÉ
);

496 
	}
}

502 
	$tm_cÚŒaù
(
‹rm
 
x
,”m 
s
,”m 
»suÉ
, * 
cÛfv®
)

504 
big‹rm
 
expx
;

505 
big‹rm
 
exps
;

506 
i
, 
j
, 
a
;

508 
	`sToExp
(
s
, 
exps
);

509 
	`sToExp
(
x
, 
expx
);

510 *
cÛfv®
 = 1;

511 
i
 = 0; i < 
numv¬s
; i++)

513 ià(
expx
[
i
] > 
exps
[i])

515 *
cÛfv®
 = 0;

518 
j
 = 1; j <ğ
expx
[
i
]; j++)

520 
a
 = 
exps
[
i
];

521 (*
cÛfv®
è*ğ
a
;

522 
exps
[
i
]--;

525 
	`expToS
(
exps
, 
	`tm_compÚ’t
(
s
), 
»suÉ
);

526 
	}
}

531 
boŞ—n
 
	$š_subršg
(
‹rm
 
t
, 
i
)

533 
j
;

535 ià((
compLoc
 >ğ0è&& (compLoø< 
i
))

536 
i
++;

537 ià(
i
 > 
nblocks
)

538 
i
 = 
nblocks
;

539 
j
 = 0; j < 
i
; j++)

540 ià((
compLoc
 !ğ
j
è&& (
t
[j] != 0))

541  (
FALSE
);

542  (
TRUE
);

543 
	}
}

549 
boŞ—n
 
	$tm_šEq
(
‹rm
 
s
,”m 
t
, 
i
)

551 
j
;

553 ià(
i
 > 
nblocks
)

554 
i
 = 
nblocks
;

555 
j
 = 0; j < 
i
; j++)

556 ià(
t
[
j
] !ğ
s
[j])

557  (
FALSE
);

558  (
TRUE
);

559 
	}
}

564 
	$g‘fœ¡block
(
ex±”m
 
exp
)

566 
symmBlock
* 
sy
 = 
blocks
;

567 
symmBlock
 
this
 = *
sy
;

568 
i
;

572 ià(
this
->
¹yp
 =ğ
RSYMM
)

574 
i
 = 0; i < 
this
->
nv¬s
; i++)

575 
exp
[
i
] = 1;

578 
this
 = *
sy
++;

579 } 
this
 !ğ
NULL
);

580 
	}
}

583 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


	@term.h

5 
big‹rm
 
h–³xp
;

8 
´Sm®l
(
‹rm
 
t
);

9 
´Big
(
big‹rm
 
big
);

10 
´Exp
(
big‹rm
 
exp
);

11 
expToS
(
big‹rm
 
£xp
, 
compÚ’t
, 
‹rm
 
»suÉ
);

12 
sToExp
(
‹rm
 
s
, 
big‹rm
 
exp
);

13 
sToBig
(
‹rm
 
t
, 
big‹rm
 
big
);

14 
bigToS
(
big‹rm
 
big
, 
‹rm
 
t
);

15 
hbToS
(
big‹rm
 
hexp
, 
compÚ’t
, 
‹rm
 
»suÉ
);

16 
sToHb
(
‹rm
 
s
, 
big‹rm
 
hexp
, * 
compÚ’t
);

17 
tm_µršt
(
FILE
* 
f
, 
‹rm
 
t
);

18 
tm_size
(
‹rm
 
t
);

19 
tm_add
(
‹rm
 
s
, 
big‹rm
 
big
,”m 
»suÉ
);

20 
tm_com·»
(
‹rm
 
s
,”m 
t
);

21 
‹rm_i
(
i
, 
‹rm
 
t
);

22 
tm_xjei
(
j
, 
i
, 
‹rm
 
t
);

23 
tm_cİy
(
‹rm
 
s
,”m 
t
);

24 
tm_compÚ’t
(
‹rm
 
t
);

25 
tm_£tcomp
(
‹rm
 
t
, 
c
);

26 
boŞ—n
 
tm_isz”o
(
‹rm
 
t
);

27 
tm_deg»e
(
‹rm
 
t
);

28 
exp_deg»e
(
ex±”m
 
exp
);

29 
jošmšus
(
‹rm
 
t1
,”m 
t2
, 
c1
, 
c2
,”m 
»suÉ1
,”m 
»suÉ2
);

30 
tm_jošmšus
(
‹rm
 
t1
,”m 
t2
,”m 
»suÉ1
,”m 
»suÉ2
);

31 
tm_rg_još
(
‹rm
 
t1
,”m 
t2
,”m 
»suÉ1
,”m 
»suÉ2
);

32 
boŞ—n
 
tm_divides
(
‹rm
 
s
,”m 
t
, 
c
,”m 
»suÉ
);

33 
tm_diff
(
‹rm
 
s
,”m 
»suÉ
, 
v
, * 
pow”
);

34 
tm_cÚŒaù
(
‹rm
 
x
,”m 
s
,”m 
»suÉ
, * 
cÛfv®
);

35 
boŞ—n
 
š_subršg
(
‹rm
 
t
, 
i
);

36 
boŞ—n
 
tm_šEq
(
‹rm
 
s
,”m 
t
, 
i
);

37 
g‘fœ¡block
(
ex±”m
 
exp
);

	@vars.c

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<ùy³.h
>

7 
	~<£tjmp.h
>

8 
	~<lim™s.h
>

9 
	~"sh¬ed.h
"

10 
	~"v¬s.h
"

11 
	~"¬¿y.h
"

12 
	~"mÚ™Ü.h
"

13 
	~"ršg.h
"

14 
	~"gm©rix.h
"

15 
	~"humª_io.h
"

16 
	~"·r£.h
"

17 
	~"¡ash.h
"

18 
	~"mem.h
"

19 
	~"šput.h
"

20 
	~"box´ocs.h
"

21 
	~"pŞy.h
"

22 
	~"£t.h
"

23 
	~"sh–l.h
"

24 
	~"g’”ic.h
"

25 
	~"cmds.h
"

26 
	~"ed.h
"

29 
šlše
 
	$VAR_INT
(
v¬ŸbË
 *
p
)

31  
	`v¬_g‘_št
(
p
);

32 
	}
}

34 
šlše
 
ršg
 
	$VAR_RING
(
v¬ŸbË
 *
p
)

36  (
ršg
)
p
->
v®ue
;

37 
	}
}

40 
šlše
 
v¬ŸbË
 *
	$VREF
(
n
)

42  (
v¬ŸbË
 *)
	`»f
(&
v¬_li¡
, 
n
);

43 
	}
}

48 
	mVKNAME
 = 1,

49 
	mVKINDEX
 = 2

57 cÚ¡ 
	gDEAD
 = 0;

58 cÚ¡ 
	gKEEP
 = 1;

65 
šlše
 
	$v¬b_kl
(
v¬ŸbË
 *
pv
)

67 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
pv
->
ty³
);

68 ià(
vbË
 && vbË->
kl
)

70 
vbË
->
	`kl
(
pv
->
v®ue
);

72 
	}
}

74 
šlše
 
	$v¬b_ty³
(
v¬ŸbË
 *
pv
)

76 
v¬ŸbË
 *
rg‘
 = (
pv
->
b_®Ÿs
 =ğ
NULL
) ?…v :…v->b_alias;

77 cÚ¡ 
objeù_vbË
 *
vbË
 = 
	`g‘_vbË
(
rg‘
->
ty³
);

78 ià(
vbË
 && vbË->
g‘_ty³
)

80 
vbË
->
	`g‘_ty³
(
rg‘
->
v®ue
);

82 
	}
}

84 
¬¿y
 
	gv¬_li¡
;

85 
	gÏ¡_v¬
;

86 
v¬ŸbË
 *
	gÏ¡v
;

88 
v¬ŸbË
 *
	gcu¼’t_ršg
;

89 
v¬ŸbË
 *
	gcur_ršg
;

92 
boŞ—n
 
	g®locSŒ
 = 
TRUE
;

96 
	$rgDebug
(
v¬ŸbË
 *
R
)

98 
ršg
 
RR
;

99 
RR
 = 
	`VAR_RING
(
R
);

100 
	`´štf
("numb” oàv¬ŸbË ğ%d\n", 
	`nv¬s
(
RR
));

101 
	}
}

105 
	$vrg_ty³
(
ršg
 
R
)

107 
	`rgDi¥Ïy
(
outfe
, 
R
);

108 
	}
}

110 
	$vmod_ty³
(
gm©rix
 
M
)

112 ià(
M
 =ğ
NULL
)

114 
	`¶_µršt
(
outfe
, &(
M
->
g’s
), 
	`Äows
(M), 
lšesize
);

115 
	}
}

117 
	$št_ty³
(
n
)

119 
	`âewlše
(
outfe
);

120 
	`åršt
(
outfe
, "%d\n", 
n
);

121 
	}
}

123 
boŞ—n
 
	$ÿnS¹V¬
(
c
)

125  ((
	`i§Íha
(
c
) || (c == '\'') || (c == '@') || (c == '_') || (c == '{')));

126 
	}
}

128 
boŞ—n
 
	$g‘Id’tif›r
(**
¡r
, *
id’t
)

130 *
t
;

131 
c
;

132 
n
;

133 
boŞ—n
 
hasb¿û
;

135 ià(!
	`ÿnS¹V¬
(**
¡r
))

136  (
FALSE
);

137 
t
 = 
id’t
;

138 
hasb¿û
 = 
FALSE
;

139 ià(**
¡r
 == '{')

141 
hasb¿û
 = 
TRUE
;

142 (*
¡r
)++;

144 
c
 = *(*
¡r
)++;

146 (
	`i§Íha
(
c
è|| (ø=ğ'\''è|| (ø=ğ'@'è|| (ø=ğ'_'è|| (
	`isdig™
(c)) || (c == '.')))

149 ià(
c
 == '.')

151 ià((**
¡r
) == '.')

153 
n
 = 
	`·r£IÁ
(
¡r
);

154 
	`¥rštf
(
t
, ".%d", 
n
);

155 ià(
hasb¿û
)

157 ià((**
¡r
) != '}')

158 
	`´”rÜ
("; missšg '}' fÜ id’tif›¸%s\n", 
id’t
);

160 (*
¡r
)++;

162  (
TRUE
);

165 *
t
++ = 
c
;

166 
c
 = *(*
¡r
)++;

168 *
t
 = '\0';

169 ià(
hasb¿û
)

171 ià(
c
 != '}')

173 
	`´”rÜ
("; missšg '}' fÜ id’tif›¸%s\n", 
id’t
);

174 (*
¡r
)--;

178 (*
¡r
)--;

179  (
TRUE
);

180 
	}
}

182 
	$g‘IdV®
(cÚ¡ *
Çme
)

184 
v¬ŸbË
 *
p
;

186 
p
 = 
	`fšd_v¬
(
Çme
);

187 ià(
p
 =ğ
NULL
)

189 ià(
p
->
ty³
 !ğ
VINT
)

191 
	`´”rÜ
("; variable isn't‡n integer\n");

194  (
	`VAR_INT
(
p
));

195 
	}
}

197 
pŞy
 
	$g‘PŞyId
(cÚ¡ *
s
, 
comp
)

199 
v¬ŸbË
 *
p
;

200 
n
;

201 
gm©rix
 
M
;

203 
p
 = 
	`fšd_v¬
(
s
);

204 ià(
p
 =ğ
NULL
)

205  (
NULL
);

206 ià(
p
->
ty³
 =ğ
VINT
)

208 
n
 = 
	`VAR_INT
(
p
);

209  (
	`p_šŞy
(
n
, 
comp
));

213 
M
 = 
	`vg‘_rgmod
(
s
);

214 ià(
M
 =ğ
NULL
)

215  (
NULL
);

216  (
	`gm_–em
(
M
, 1, 1, 
comp
));

218 
	}
}

223 
	$š™_v¬s
()

225 
	`š™_¬¿y
(&
v¬_li¡
, (
v¬ŸbË
));

226 
Ï¡_v¬
 = 0;

227 
Ï¡v
 = 
NULL
;

228 
cu¼’t_ršg
 = 
NULL
;

229 
	}
}

237 
	$whichkšd
(*
Çme
, *
n
, **
p
, **
·¹Çme
)

239 *
p
 = (*)
Çme
;

240 (**
p
 != '\0') && (**p != '.'))

241 (*
p
)++;

242 ià(**
p
 == '\0')

244  (
VKNAME
);

246 **
p
 = '\0';

247 *
·¹Çme
 = (*
p
) + 1;

248  (
VKINDEX
);

249 
	}
}

251 
v¬ŸbË
 *
	$£Ëù
(
v¬ŸbË
 *
p
, cÚ¡ *
·¹Çme
)

253 
j
;

254 
v¬ŸbË
 *
q
;

256 
j
 = 
p
->
v¬_num
;

257 
j
++; j <ğ
Ï¡_v¬
; j++)

259 
q
 = 
	`VREF
(
j
);

260 ià(
q
->
exi¡s
 !ğ
PARTVAR
)

261  (
NULL
);

262 ià(
	`¡rcmp
(
q
->
Çme
, 
·¹Çme
) == 0)

263  (
q
);

265  (
NULL
);

266 
	}
}

268 
v¬ŸbË
 *
	$fv¬
(cÚ¡ *
Çme
, cÚ¡ *
·¹Çme
)

270 
j
;

271 
v¬ŸbË
 *
p
;

273 
j
 = 
Ï¡_v¬
; j >= 1; j--)

275 
p
 = 
	`VREF
(
j
);

276 ià(
p
->
exi¡s
 !ğ
MAINVAR
)

278 ià(
	`¡rcmp
(
p
->
Çme
,‚ame) == 0)

280 ià(
·¹Çme
 =ğ
NULL
)

281  (
p
);

282  (
	`£Ëù
(
p
, 
·¹Çme
));

285  (
NULL
);

286 
	}
}

288 
v¬ŸbË
 *
	$Ãwv¬
(cÚ¡ *
Çme
, 
isMaš
, 
ty³
, 
v¬ŸbË
 *
bršg
)

290 
v¬ŸbË
 *
»suÉ
;

292 
Ï¡_v¬
++;

293 ià(
Ï¡_v¬
 > 
	`Ëngth
(&
v¬_li¡
))

295 
»suÉ
 = (
v¬ŸbË
 *)
	`šs_¬¿y
(&
v¬_li¡
);

299 
»suÉ
 = 
	`VREF
(
Ï¡_v¬
);

301 ià((
®locSŒ
è&& (
	`¡¾’
(
Çme
) > 0))

303 
size_t
 
Ën
 = 
	`¡¾’
(
Çme
) + 1;

304 ià(
Ën
 > 
INT_MAX
)

306 
	`´”rÜ
("; variable‚ameoo†ong\n");

307  
NULL
;

309 
»suÉ
->
Çme
 = 
	`g‘_sm®l
(()
Ën
);

310 
	`¡rıy
(
»suÉ
->
Çme
,‚ame);

316 
»suÉ
->
Çme
 = (*)(*)(
ušŒ_t
)name;

318 
»suÉ
->
ty³
 =ype;

319 
»suÉ
->
exi¡s
 = ()
isMaš
;

320 ià(
isMaš
 =ğ
PARTVAR
)

321 
Ï¡v
->
b_Ãxt
 = 
»suÉ
;

322 
»suÉ
->
b_ršg
 = 
bršg
;

323 
»suÉ
->
b_Ãxt
 = 
NULL
;

324 
»suÉ
->
b_®Ÿs
 = 
NULL
;

325 
»suÉ
->
štv®
 = 0;

326 
»suÉ
->
v®ue
 = 
NULL
;

327 
»suÉ
->
v¬_num
 = 
Ï¡_v¬
;

328 
Ï¡v
 = 
»suÉ
;

329  (
»suÉ
);

330 
	}
}

339 
v¬ŸbË
 *
	$fšd_v¬
(cÚ¡ *
Çme
)

341 
kšd
;

342 
v¬ŸbË
 *
»suÉ
;

343 *
q
, *
·¹Çme
, *
šÇme
, 
id’t
[100];

344 
n
;

345 
v¬ŸbË
 *
maš»s
;

346 
s
[100];

347 
Çmecİy
[256];

350 
	`¡ºıy
(
Çmecİy
, 
Çme
, (namecopy) - 1);

351 
Çmecİy
[(namecopy) - 1] = '\0';

352 
šÇme
 = 
Çmecİy
;

353 ià(!
	`g‘Id’tif›r
(&
šÇme
, 
id’t
))

355 
	`´”rÜ
("; bad id’tif›r: %s\n", 
Çme
);

356  (
NULL
);

358 ià(*
šÇme
 != '\0')

360 
	`´”rÜ
("; bad id’tif›r: %s\n", 
Çme
);

361  (
NULL
);

364 
kšd
 = 
	`whichkšd
(
id’t
, &
n
, &
q
, &
·¹Çme
);

365 
kšd
)

367 
VKNAME
:

368 
»suÉ
 = 
	`fv¬
(
id’t
, 
NULL
);

370 
VKINDEX
:

371 
»suÉ
 = 
	`fv¬
(
id’t
, 
·¹Çme
);

372 ià(
»suÉ
 =ğ
NULL
)

374 
maš»s
 = 
	`fv¬
(
id’t
, 
NULL
);

375 ià((
maš»s
 !ğ
NULL
è&& (maš»s->
b_ršg
 != NULL))

377 
	`¥rštf
(
s
, "%s'z”o", 
maš»s
->
b_ršg
->
Çme
);

378 
»suÉ
 = 
	`fv¬
(
s
, 
NULL
);

381 *
q
 = '.';

384 ià(
»suÉ
 =ğ
NULL
)

385 
	`´”rÜ
("; v¬ % dÛ¢'ˆexi¡\n", 
id’t
);

386  (
»suÉ
);

387 
	}
}

399 
v¬ŸbË
 *
	$make_v¬
(cÚ¡ *
Çme
, 
isMaš
, 
ty³
, 
v¬ŸbË
 *
bršg
)

401 
kšd
;

402 
n
;

403 *
q
, *
·¹Çme
, *
šÇme
, 
id’t
[100];

404 
v¬ŸbË
 *
»suÉ
, *
p
;

405 
Çmecİy
[256];

407 ià(
isMaš
 =ğ
PARTVAR
)

409 
»suÉ
 = 
	`Ãwv¬
(
Çme
, 
PARTVAR
, 
ty³
, 
bršg
);

410  (
»suÉ
);

414 
	`¡ºıy
(
Çmecİy
, 
Çme
, (namecopy) - 1);

415 
Çmecİy
[(namecopy) - 1] = '\0';

416 
šÇme
 = 
Çmecİy
;

417 ià(!
	`g‘Id’tif›r
(&
šÇme
, 
id’t
))

419 
	`´”rÜ
("; bad id’tif›r: %s\n", 
Çme
);

420  (
NULL
);

422 ià(*
šÇme
 != '\0')

424 
	`´”rÜ
("; bad id’tif›r: %s\n", 
Çme
);

425  (
NULL
);

428 
kšd
 = 
	`whichkšd
(
id’t
, &
n
, &
q
, &
·¹Çme
);

429 ià(
kšd
 !ğ
VKNAME
)

431 
	`´”rÜ
("; can't create‡n indexed variable\n");

432  (
NULL
);

435 
p
 = 
	`fv¬
(
id’t
, 
NULL
);

436 ià(
p
 !ğ
NULL
)

439 
	`»m_v¬
(
p
);

442 
»suÉ
 = 
	`Ãwv¬
(
id’t
, 
MAINVAR
, 
ty³
, 
bršg
);

443  (
»suÉ
);

444 
	}
}

448 
	$vrg_š¡®l
(
v¬ŸbË
 *
p
)

450 ià((
p
 !ğ
NULL
è&& (°!ğ
cu¼’t_ršg
è&& (
	`VAR_RING
(p) != NULL))

452 
cu¼’t_ršg
 = 
p
;

453 
	`rgIn¡®l
(
	`VAR_RING
(
p
));

455 ià(
p
 !ğ
cu¼’t_ršg
)

456 
cu¼’t_ršg
 = 
NULL
;

457 
	}
}

462 
boŞ—n
 
	$is_a_moduË
(
v¬ŸbË
 *
p
)

464 
t
;

466 
t
 = 
p
->
ty³
;

467  ((
t
 =ğ
VMODULE
è|| (ˆ=ğ
VCOLLECT
è|| (ˆ=ğ
VRES
è|| (ˆ=ğ
VNRES
è|| (ˆ=ğ
VSTD
) ||

468 (
t
 =ğ
VISTD
));

469 
	}
}

471 
boŞ—n
 
	$is_®Ÿs
(
v¬ŸbË
 *
p
)

473 
t
;

475 
t
 = 
p
->
ty³
;

476  ((
t
 =ğ
VEMIT
è|| (ˆ=ğ
VSTDEMIT
è|| (ˆ=ğ
VLIFT
));

477 
	}
}

482 
	$£t_v®ue
(
v¬ŸbË
 *
p
, 
ADDRESS
 
v®
)

484 
p
->
v®ue
 = 
v®
;

485 
	}
}

487 
	$£t_®Ÿs
(
v¬ŸbË
 *
p
, v¬ŸbË *
®Ÿ¥
)

489 
p
->
b_®Ÿs
 = 
®Ÿ¥
;

490 
	}
}

492 
	$cÚÃù_v¬s
(
v¬ŸbË
 *
p
, v¬ŸbË *
b_Ãxt
)

494 
p
->
b_Ãxt
 = b_next;

495 
	}
}

497 
	$putIÁ”Çls
(
v¬ŸbË
 *
p
)

499 
	`´št
(" ");

500 ià(
p
->
b_ršg
 =ğ
NULL
)

501 
	`´št
(" -- ");

503 
	`´št
("%4d ", 
p
->
b_ršg
->
v¬_num
);

504 ià(
p
->
b_Ãxt
 =ğ
NULL
)

505 
	`´št
(" -- ");

507 
	`´št
("%4d ", 
p
->
b_Ãxt
->
v¬_num
);

508 ià(
p
->
exi¡s
 =ğ
MAINVAR
)

509 
	`´št
(" main ");

510 ià(
p
->
exi¡s
 =ğ
PARTVAR
)

511 
	`´št
("…art ");

513 
	`´št
("„emoved");

514 
	`´št
("\n");

515 
	}
}

517 
	$li¡v¬s_cmd
(
¬gc
, *
¬gv
[])

519 
v¬ŸbË
 *
p
;

520 
i
;

522 ià(
Ï¡_v¬
 == 0)

524 
	`Ãwlše
();

525 
	`´št
("no variables defined\n");

528 
	`Ãwlše
();

529 
	`´št
(" var#‚ameype ");

530 ià(
¬gc
 >= 3)

531 
	`´št
("„ing‚ext status\n");

533 
	`´št
("\n");

534 
	`Ãwlše
();

535 
	`´št
(" ------------------\n");

536 
i
 = 1; i <ğ
Ï¡_v¬
; i++)

538 
p
 = 
	`VREF
(
i
);

540 ià(
¬gc
 == 1)

542 *
s
;

543 
s
 = 
p
->
Çme
; *s != '\0' && *s != '\''; ++s)

545 ià(*
s
 !ğ'\0' && 
	`¡rcmp
("'zero", s) == 0)

549 ià((
p
->
exi¡s
 =ğ
MAINVAR
è|| ((
¬gc
 >ğ3è&& (p->exi¡ =ğ
REMOVED
)))

551 
	`Ãwlše
();

552 
	`´št
("%6d %-10 %-14s", 
p
->
v¬_num
,…->
Çme
, 
ty³_Çmes
[p->
ty³
]);

553 ià(
¬gc
 >= 3)

554 
	`putIÁ”Çls
(
p
);

556 
	`´št
("\n");

558 ià((
¬gc
 >ğ2è&& (
p
->
exi¡s
 =ğ
PARTVAR
))

560 ià((
¬gc
 >ğ3è|| (*(
p
->
Çme
) != '\0'))

561 
	`Ãwlše
();

562 
	`´št
("%6d %-8 %-14s", 
p
->
v¬_num
,…->
Çme
, 
ty³_Çmes
[p->
ty³
]);

563 ià(
¬gc
 >= 3)

564 
	`putIÁ”Çls
(
p
);

566 
	`´št
("\n");

569 
	}
}

574 
	$m¬k
(
v¬ŸbË
 *
p
)

576 ià(
p
 =ğ
NULL
)

578 ià(
p
->
g¬bage
 =ğ
KEEP
)

580 
p
->
g¬bage
 = 
KEEP
;

581 
	`m¬k
(
p
->
b_ršg
);

582 
	`m¬k
(
p
->
b_Ãxt
);

583 
	`m¬k
(
p
->
b_®Ÿs
);

584 ià(
	`is_®Ÿs
(
p
))

585 
	`m¬k
((
v¬ŸbË
 *)
p
->
v®ue
);

586 
	}
}

588 
	$m¬k_v¬s
()

590 
v¬ŸbË
 *
p
;

591 
i
;

593 
i
 = 1; i <ğ
Ï¡_v¬
; i++)

595 
p
 = 
	`VREF
(
i
);

596 
p
->
g¬bage
 = 
DEAD
;

598 
i
 = 1; i <ğ
Ï¡_v¬
; i++)

600 
p
 = 
	`VREF
(
i
);

601 ià(
p
->
exi¡s
 !ğ
REMOVED
)

602 
	`m¬k
(
p
);

604 
	}
}

606 
	$ı_v¬node
(
Ãw_idx
, 
v¬ŸbË
 *
²ew
, v¬ŸbË *
pŞd
)

608 
v¬ŸbË
 *
p
;

609 
i
;

611 *
²ew
 = *
pŞd
;

612 
²ew
->
v¬_num
 = 
Ãw_idx
;

613 
pŞd
->
g¬bage
 = 
DEAD
;

614 ià(
cur_ršg
 =ğ
pŞd
)

615 
cur_ršg
 = 
²ew
;

616 ià(
ed™v¬
 =ğ
pŞd
)

617 
ed™v¬
 = 
²ew
;

618 
i
 = 1; i <ğ
Ï¡_v¬
; i++)

620 
p
 = 
	`VREF
(
i
);

621 ià(
p
->
b_ršg
 =ğ
pŞd
)

622 
p
->
b_ršg
 = 
²ew
;

623 ià(
p
->
b_Ãxt
 =ğ
pŞd
)

624 
p
->
b_Ãxt
 = 
²ew
;

625 ià(
p
->
b_®Ÿs
 =ğ
pŞd
)

626 
p
->
b_®Ÿs
 = 
²ew
;

627 ià((
	`is_®Ÿs
(
p
)è&& (p->
v®ue
 =ğ(
ADDRESS
)
pŞd
))

628 
p
->
v®ue
 = (
ADDRESS
)
²ew
;

630 
	}
}

632 
v¬ŸbË
 *
	$Ãxt_u£d
(
n
)

634 
i
;

635 
v¬ŸbË
 *
p
;

637 
i
 = 
n
 + 1; i <ğ
Ï¡_v¬
; i++)

639 
p
 = 
	`VREF
(
i
);

640 ià(
p
->
g¬bage
 =ğ
KEEP
)

641  (
p
);

643  (
NULL
);

644 
	}
}

646 
	$cÚŒaù_v¬s
()

648 
fœ¡_ä“
;

649 
v¬ŸbË
 *
p
;

650 
v¬ŸbË
 *
pŞd
;

652 ià(
Ï¡_v¬
 == 0)

654 
fœ¡_ä“
 = 1; fœ¡_ä“ <ğ
Ï¡_v¬
; first_free++)

656 
p
 = 
	`VREF
(
fœ¡_ä“
);

657 ià(
p
->
g¬bage
 =ğ
DEAD
)

660 ià(
p
->
g¬bage
 =ğ
KEEP
)

662 (
pŞd
 = 
	`Ãxt_u£d
(
fœ¡_ä“
)è!ğ
NULL
)

664 
p
 = 
	`VREF
(
fœ¡_ä“
);

665 
	`ı_v¬node
(
fœ¡_ä“
, 
p
, 
pŞd
);

666 
fœ¡_ä“
++;

668 
Ï¡_v¬
 = 
fœ¡_ä“
 - 1;

669 
Ï¡v
 = 
p
;

670 
	}
}

672 
	$g¬b_cŞËù
()

674 
i
;

675 
v¬ŸbË
 *
p
;

677 
	`m¬k_v¬s
();

678 ià(
cu¼’t_ršg
 =ğ
NULL
)

679 
cur_ršg
 = 
NULL
;

680 ià(
cu¼’t_ršg
->
g¬bage
 =ğ
DEAD
)

681 
cur_ršg
 = 
NULL
;

683 
cur_ršg
 = 
cu¼’t_ršg
;

684 ià((
ed™v¬
 !ğ
NULL
è&& (ed™v¬->
exi¡s
 =ğ
REMOVED
))

685 
ed™v¬
 = 
NULL
;

686 
i
 = 
Ï¡_v¬
; i >= 1; i--)

688 
p
 = 
	`VREF
(
i
);

689 ià(
p
->
g¬bage
 =ğ
DEAD
)

691 
	`vrg_š¡®l
(
p
->
b_ršg
);

692 #ifdeà
__şªg__


693 #´agm¨
şªg
 
dŸgno¡ic
 
push


694 #´agm¨
şªg
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type-mismatch"

696 #´agm¨
GCC
 
dŸgno¡ic
 
push


697 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

698 
	`v¬b_kl
(
p
);

699 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


700 #ifdeà
__şªg__


701 #´agm¨
şªg
 
dŸgno¡ic
 
pİ


703 
p
->
v®ue
 = 
NULL
;

706 
	`cÚŒaù_v¬s
();

707 
	`vrg_š¡®l
(
cur_ršg
);

708 
	}
}

710 
	$»m_v¬
(
v¬ŸbË
 *
p
)

712 
v¬ŸbË
 *
q
;

713 
i
;

715 
p
->
exi¡s
 = 
REMOVED
;

716 
i
 = 
p
->
v¬_num
 + 1; i <ğ
Ï¡_v¬
; i++)

718 
q
 = 
	`VREF
(
i
);

719 ià(
q
->
exi¡s
 =ğ
PARTVAR
)

720 
q
->
exi¡s
 = 
REMOVED
;

724 
	}
}

726 
	$kl_cmd
(
¬gc
, *
¬gv
[])

728 
v¬ŸbË
 *
p
;

729 
i
;

731 ià(
¬gc
 == 1)

733 
	`´šŠew
("kill <var1> ... <var‚>\n");

736 
i
 = 1; i < 
¬gc
; i++)

738 
p
 = 
	`fšd_v¬
(
¬gv
[
i
]);

739 ià(
p
 =ğ
NULL
)

741 
	`»m_v¬
(
p
);

743 
	}
}

745 
	$¥¬e_cmd
(
¬gc
, *
¬gv
[])

748 
v¬ŸbË
 *
p
;

749 
i
, 
j
;

750 
©
[8], *
s
;

752 
	`¥rštf
(
©
, "@%02d@", 
cur_voiû
);

753 
i
 = 1; i <ğ
Ï¡_v¬
; ++i)

755 
p
 = 
	`VREF
(
i
);

756 
s
 = 
p
->
Çme
; *s != '\0' && *s != '\''; ++s)

758 ià(
p
->
exi¡s
 !ğ
MAINVAR
 || 
	`¡ºcmp
(
©
,…->
Çme
, 4) != 0 ||

759 (*
s
 !ğ'\0' && 
	`¡rcmp
("'zero", s) == 0))

761 
j
 = 1; j < 
¬gc
; ++j)

763 ià(
	`¡rcmp
(
¬gv
[
j
], 
p
->
Çme
) == 0)

766 ià(
j
 =ğ
¬gc
)

767 
	`»m_v¬
(
p
);

769 
	}
}

771 
	$ty³_cmd
(
¬gc
, *
¬gv
[])

773 
v¬ŸbË
 *
p
;

775 ià(
¬gc
 != 2)

777 
	`´šŠew
("type <var>\n");

780 ià((
p
 = 
	`fšd_v¬
(
¬gv
[1])è=ğ
NULL
)

782 ià(
p
->
b_ršg
 !ğ
NULL
)

783 
	`vrg_š¡®l
(
p
->
b_ršg
);

784 #ifdeà
__şªg__


785 #´agm¨
şªg
 
dŸgno¡ic
 
push


786 #´agm¨
şªg
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type-mismatch"

788 #´agm¨
GCC
 
dŸgno¡ic
 
push


789 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-function-type"

790 
	`v¬b_ty³
(
p
);

791 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


792 #ifdeà
__şªg__


793 #´agm¨
şªg
 
dŸgno¡ic
 
pİ


795 
	}
}

	@vars.h

5 
¬¿y
 
v¬_li¡
;

6 
Ï¡_v¬
;

7 
v¬ŸbË
 *
Ï¡v
;

8 
v¬ŸbË
 *
cur_ršg
;

9 
boŞ—n
 
®locSŒ
;

12 
rgDebug
(
v¬ŸbË
 *
R
);

13 
vrg_ty³
(
ršg
 
R
);

14 
vmod_ty³
(
gm©rix
 
M
);

15 
št_ty³
(
n
);

16 
boŞ—n
 
ÿnS¹V¬
(
c
);

17 
boŞ—n
 
g‘Id’tif›r
(**
¡r
, *
id’t
);

18 
g‘IdV®
(cÚ¡ *
Çme
);

19 
pŞy
 
g‘PŞyId
(cÚ¡ *
s
, 
comp
);

20 
š™_v¬s
();

21 
whichkšd
(*
Çme
, *
n
, **
p
, **
·¹Çme
);

22 
v¬ŸbË
 *
£Ëù
(v¬ŸbË *
p
, cÚ¡ *
·¹Çme
);

23 
v¬ŸbË
 *
fv¬
(cÚ¡ *
Çme
, cÚ¡ *
·¹Çme
);

24 
v¬ŸbË
 *
Ãwv¬
(cÚ¡ *
Çme
, 
isMaš
, 
ty³
, v¬ŸbË *
bršg
);

25 
v¬ŸbË
 *
fšd_v¬
(cÚ¡ *
Çme
);

26 
v¬ŸbË
 *
make_v¬
(cÚ¡ *
Çme
, 
isMaš
, 
ty³
, v¬ŸbË *
bršg
);

27 
vrg_š¡®l
(
v¬ŸbË
 *
p
);

28 
boŞ—n
 
is_a_moduË
(
v¬ŸbË
 *
p
);

29 
boŞ—n
 
is_®Ÿs
(
v¬ŸbË
 *
p
);

30 
£t_v®ue
(
v¬ŸbË
 *
p
, 
ADDRESS
 
v®
);

31 
£t_®Ÿs
(
v¬ŸbË
 *
p
, v¬ŸbË *
®Ÿ¥
);

32 
cÚÃù_v¬s
(
v¬ŸbË
 *
p
, v¬ŸbË *
b_Ãxt
);

33 
putIÁ”Çls
(
v¬ŸbË
 *
p
);

34 
li¡v¬s_cmd
(
¬gc
, *
¬gv
[]);

35 
m¬k
(
v¬ŸbË
 *
p
);

36 
m¬k_v¬s
();

37 
ı_v¬node
(
Ãw_idx
, 
v¬ŸbË
 *
²ew
, v¬ŸbË *
pŞd
);

38 
v¬ŸbË
 *
Ãxt_u£d
(
n
);

39 
cÚŒaù_v¬s
();

40 
g¬b_cŞËù
();

41 
»m_v¬
(
v¬ŸbË
 *
p
);

42 
kl_cmd
(
¬gc
, *
¬gv
[]);

43 
¥¬e_cmd
(
¬gc
, *
¬gv
[]);

44 
ty³_cmd
(
¬gc
, *
¬gv
[]);

	@version.c

4 
	~"sh¬ed.h
"

5 
	~"v”siÚ.h
"

7 cÚ¡ * 
	gV”siÚ
 = "3.0";

8 cÚ¡ * 
	gD©e
 = "12 September 1994";

	@version.h

5 cÚ¡ * 
V”siÚ
;

6 cÚ¡ * 
D©e
;

	@
1
.
0
115
1011
array.c
array.h
betti.c
betti.h
boxcmds.c
boxcmds.h
boxprocs.c
boxprocs.h
charp.c
charp.h
cmdnames.c
cmdnames.h
cmds.c
cmds.h
comb_rec.c
comb_rec.h
debug.c
debug.h
det.c
det.h
detach.c
detach.h
dot_fns.c
dot_fns.h
ed.c
ed.h
generic.c
generic.h
getdet.c
getdet.h
gm_cmds.c
gm_cmds.h
gm_dlist.c
gm_dlist.h
gm_plist.c
gm_plist.h
gm_poly.c
gm_poly.h
gmatrix.c
gmatrix.h
help.c
help.h
hilb.c
hilb.h
hilb2.c
hilb2.h
hulb.c
hulb.h
human_io.c
human_io.h
inhomog.c
inhomog.h
input.c
input.h
intersect.c
intersect.h
koszul.c
koszul.h
mac.c
mac.h
mem.c
mem.h
monideal.c
monideal.h
monitor.c
monitor.h
monoms.c
monoms.h
parse.c
parse.h
parsepoly.c
parsepoly.h
plist.c
plist.h
poly.c
poly.h
printf.c
printf.h
prpoly.c
prpoly.h
qring.c
qring.h
rescmds.c
rescmds.h
ring.c
ring.h
rmap.c
rmap.h
rvar.c
rvar.h
set.c
set.h
shared.h
shell.c
shell.h
smallterm.c
smallterm.h
spcmds.c
spcmds.h
standard.c
standard.h
stash.c
stash.h
stats.c
stats.h
stdcmds.c
stdcmds.h
tables.c
tables.h
term.c
term.h
vars.c
vars.h
version.c
version.h
